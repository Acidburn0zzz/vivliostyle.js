!function(){return function t(e,n,i){function s(o,a){if(!n[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){return s(e[o][1][t]||t)},c,c.exports,t,e,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}}()({1:[function(t,e,n){!function(t){var i=this||(0,eval)("this"),s=i.document,r=i.navigator,o=i.jQuery,a=i.JSON;o||"undefined"==typeof jQuery||(o=jQuery),function(t){"function"==typeof define&&define.amd?define(["exports","require"],t):t("object"==typeof n&&"object"==typeof e?e.exports||n:i.ko={})}(function(e,n){function h(t,e){return(null===t||typeof t in y)&&t===e}function l(e,n){var i;return function(){i||(i=v.a.setTimeout(function(){i=t,e()},n))}}function c(t,e){var n;return function(){clearTimeout(n),n=v.a.setTimeout(t,e)}}function u(t,e){e&&"change"!==e?"beforeChange"===e?this.oc(t):this.bb(t,e):this.pc(t)}function f(t,e){null!==e&&e.s&&e.s()}function d(t,e){var n=this.pd,i=n[C];i.qa||(this.Pb&&this.kb[e]?(n.tc(e,t,this.kb[e]),this.kb[e]=null,--this.Pb):i.F[e]||n.tc(e,t,i.G?{da:t}:n.Zc(t)),t.Ka&&t.fd())}var p,g,m,b,E,w,v=void 0!==e?e:{};v.b=function(t,e){for(var n=t.split("."),i=v,s=0;s<n.length-1;s++)i=i[n[s]];i[n[n.length-1]]=e},v.J=function(t,e,n){t[e]=n},v.version="3.5.0",v.b("version",v.version),v.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},v.a=function(){function e(t,e){for(var n in t)c.call(t,n)&&e(n,t[n])}function n(t,e){if(e)for(var n in e)c.call(e,n)&&(t[n]=e[n]);return t}function h(t,e){return t.__proto__=e,t}function l(t,e,n,i){var s=t[e].match(E)||[];v.a.C(n.match(E),function(t){v.a.Oa(s,t,i)}),t[e]=s.join(" ")}var c=Object.prototype.hasOwnProperty,u={__proto__:[]}instanceof Array,f="function"==typeof Symbol,d={},p={};d[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(d,function(t,e){if(e.length)for(var n=0,i=e.length;n<i;n++)p[e[n]]=t});var g,m={propertychange:!0},b=s&&function(){for(var e=3,n=s.createElement("div"),i=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",i[0];);return 4<e?e:t}(),E=/\S+/g;return{Ic:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],C:function(t,e,n){for(var i=0,s=t.length;i<s;i++)e.call(n,t[i],i,t)},A:"function"==typeof Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e)}:function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},Lb:function(e,n,i){for(var s=0,r=e.length;s<r;s++)if(n.call(i,e[s],s,e))return e[s];return t},hb:function(t,e){var n=v.a.A(t,e);0<n?t.splice(n,1):0===n&&t.shift()},vc:function(t){var e=[];return t&&v.a.C(t,function(t){0>v.a.A(e,t)&&e.push(t)}),e},Mb:function(t,e,n){var i=[];if(t)for(var s=0,r=t.length;s<r;s++)i.push(e.call(n,t[s],s));return i},fb:function(t,e,n){var i=[];if(t)for(var s=0,r=t.length;s<r;s++)e.call(n,t[s],s)&&i.push(t[s]);return i},gb:function(t,e){if(e instanceof Array)t.push.apply(t,e);else for(var n=0,i=e.length;n<i;n++)t.push(e[n]);return t},Oa:function(t,e,n){var i=v.a.A(v.a.$b(t),e);0>i?n&&t.push(e):n||t.splice(i,1)},Ba:u,extend:n,setPrototypeOf:h,zb:u?h:n,O:e,Ha:function(t,e,n){if(!t)return t;var i,s={};for(i in t)c.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s},Sb:function(t){for(;t.firstChild;)v.removeNode(t.firstChild)},Xb:function(t){for(var e=((t=v.a.la(t))[0]&&t[0].ownerDocument||s).createElement("div"),n=0,i=t.length;n<i;n++)e.appendChild(v.na(t[n]));return e},Ca:function(t,e){for(var n=0,i=t.length,s=[];n<i;n++){var r=t[n].cloneNode(!0);s.push(e?v.na(r):r)}return s},ua:function(t,e){if(v.a.Sb(t),e)for(var n=0,i=e.length;n<i;n++)t.appendChild(e[n])},Wc:function(t,e){var n=t.nodeType?[t]:t;if(0<n.length){for(var i=n[0],s=i.parentNode,r=0,o=e.length;r<o;r++)s.insertBefore(e[r],i);for(r=0,o=n.length;r<o;r++)v.removeNode(n[r])}},Ua:function(t,e){if(t.length){for(e=8===e.nodeType&&e.parentNode||e;t.length&&t[0].parentNode!==e;)t.splice(0,1);for(;1<t.length&&t[t.length-1].parentNode!==e;)t.length--;if(1<t.length){var n=t[0],i=t[t.length-1];for(t.length=0;n!==i;)t.push(n),n=n.nextSibling;t.push(i)}}return t},Yc:function(t,e){7>b?t.setAttribute("selected",e):t.selected=e},Cb:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Td:function(t,e){return t=t||"",!(e.length>t.length)&&t.substring(0,e.length)===e},ud:function(t,e){if(t===e)return!0;if(11===t.nodeType)return!1;if(e.contains)return e.contains(1!==t.nodeType?t.parentNode:t);if(e.compareDocumentPosition)return 16==(16&e.compareDocumentPosition(t));for(;t&&t!=e;)t=t.parentNode;return!!t},Rb:function(t){return v.a.ud(t,t.ownerDocument.documentElement)},jd:function(t){return!!v.a.Lb(t,v.a.Rb)},P:function(t){return t&&t.tagName&&t.tagName.toLowerCase()},zc:function(t){return v.onError?function(){try{return t.apply(this,arguments)}catch(t){throw v.onError&&v.onError(t),t}}:t},setTimeout:function(t,e){return setTimeout(v.a.zc(t),e)},Fc:function(t){setTimeout(function(){throw v.onError&&v.onError(t),t},0)},H:function(t,e,n){var i=v.a.zc(n);if(n=m[e],v.options.useOnlyNativeEvents||n||!o)if(n||"function"!=typeof t.addEventListener){if(void 0===t.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var s=function(e){i.call(t,e)},r="on"+e;t.attachEvent(r,s),v.a.I.za(t,function(){t.detachEvent(r,s)})}else t.addEventListener(e,i,!1);else g||(g="function"==typeof o(t).on?"on":"bind"),o(t)[g](e,i)},Fb:function(t,e){if(!t||!t.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==v.a.P(t)||!t.type||"click"!=e.toLowerCase())&&("checkbox"==(n=t.type)||"radio"==n),v.options.useOnlyNativeEvents||!o||n)if("function"==typeof s.createEvent){if("function"!=typeof t.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=s.createEvent(p[e]||"HTMLEvents")).initEvent(e,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,t),t.dispatchEvent(n)}else if(n&&t.click)t.click();else{if(void 0===t.fireEvent)throw Error("Browser doesn't support triggering events");t.fireEvent("on"+e)}else o(t).trigger(e)},c:function(t){return v.N(t)?t():t},$b:function(t){return v.N(t)?t.w():t},Eb:function(t,e,n){var i;e&&("object"==typeof t.classList?(i=t.classList[n?"add":"remove"],v.a.C(e.match(E),function(e){i.call(t.classList,e)})):"string"==typeof t.className.baseVal?l(t.className,"baseVal",e,n):l(t,"className",e,n))},Ab:function(e,n){var i=v.a.c(n);null!==i&&i!==t||(i="");var s=v.h.firstChild(e);!s||3!=s.nodeType||v.h.nextSibling(s)?v.h.ua(e,[e.ownerDocument.createTextNode(i)]):s.data=i,v.a.zd(e)},Xc:function(t,e){if(t.name=e,7>=b)try{var n=t.name.replace(/[&<>'"]/g,function(t){return"&#"+t.charCodeAt(0)+";"});t.mergeAttributes(s.createElement("<input name='"+n+"'/>"),!1)}catch(t){}},zd:function(t){9<=b&&(t=1==t.nodeType?t:t.parentNode).style&&(t.style.zoom=t.style.zoom)},vd:function(t){if(b){var e=t.style.width;t.style.width=0,t.style.width=e}},Od:function(t,e){t=v.a.c(t),e=v.a.c(e);for(var n=[],i=t;i<=e;i++)n.push(i);return n},la:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(t[n]);return e},Da:function(t){return f?Symbol(t):t},Xd:6===b,Yd:7===b,W:b,Kc:function(t,e){for(var n=v.a.la(t.getElementsByTagName("input")).concat(v.a.la(t.getElementsByTagName("textarea"))),i="string"==typeof e?function(t){return t.name===e}:function(t){return e.test(t.name)},s=[],r=n.length-1;0<=r;r--)i(n[r])&&s.push(n[r]);return s},Md:function(t){return"string"==typeof t&&(t=v.a.Cb(t))?a&&a.parse?a.parse(t):new Function("return "+t)():null},fc:function(t,e,n){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(v.a.c(t),e,n)},Nd:function(t,n,i){var r=(i=i||{}).params||{},o=i.includeFields||this.Ic,a=t;if("object"==typeof t&&"form"===v.a.P(t)){a=t.action;for(var h=o.length-1;0<=h;h--)for(var l=v.a.Kc(t,o[h]),c=l.length-1;0<=c;c--)r[l[c].name]=l[c].value}n=v.a.c(n);var u=s.createElement("form");for(var f in u.style.display="none",u.action=a,u.method="post",n)(t=s.createElement("input")).type="hidden",t.name=f,t.value=v.a.fc(v.a.c(n[f])),u.appendChild(t);e(r,function(t,e){var n=s.createElement("input");n.type="hidden",n.name=t,n.value=e,u.appendChild(n)}),s.body.appendChild(u),i.submitter?i.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),v.b("utils",v.a),v.b("utils.arrayForEach",v.a.C),v.b("utils.arrayFirst",v.a.Lb),v.b("utils.arrayFilter",v.a.fb),v.b("utils.arrayGetDistinctValues",v.a.vc),v.b("utils.arrayIndexOf",v.a.A),v.b("utils.arrayMap",v.a.Mb),v.b("utils.arrayPushAll",v.a.gb),v.b("utils.arrayRemoveItem",v.a.hb),v.b("utils.cloneNodes",v.a.Ca),v.b("utils.createSymbolOrString",v.a.Da),v.b("utils.extend",v.a.extend),v.b("utils.fieldsIncludedWithJsonPost",v.a.Ic),v.b("utils.getFormFields",v.a.Kc),v.b("utils.objectMap",v.a.Ha),v.b("utils.peekObservable",v.a.$b),v.b("utils.postJson",v.a.Nd),v.b("utils.parseJson",v.a.Md),v.b("utils.registerEventHandler",v.a.H),v.b("utils.stringifyJson",v.a.fc),v.b("utils.range",v.a.Od),v.b("utils.toggleDomNodeCssClass",v.a.Eb),v.b("utils.triggerEvent",v.a.Fb),v.b("utils.unwrapObservable",v.a.c),v.b("utils.objectForEach",v.a.O),v.b("utils.addOrRemoveItem",v.a.Oa),v.b("utils.setTextContent",v.a.Ab),v.b("unwrap",v.a.c),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(1===arguments.length)return function(){return e.apply(t,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice(0);return i.push.apply(i,arguments),e.apply(t,i)}}),v.a.g=new function(){var e,n,i=0,s="__ko__"+(new Date).getTime(),r={};return v.a.W?(e=function(e,n){var o=e[s];if(!o||"null"===o||!r[o]){if(!n)return t;o=e[s]="ko"+i++,r[o]={}}return r[o]},n=function(t){var e=t[s];return!!e&&(delete r[e],t[s]=null,!0)}):(e=function(t,e){var n=t[s];return!n&&e&&(n=t[s]={}),n},n=function(t){return!!t[s]&&(delete t[s],!0)}),{get:function(t,n){var i=e(t,!1);return i&&i[n]},set:function(n,i,s){(n=e(n,s!==t))&&(n[i]=s)},Tb:function(t,n,i){return(t=e(t,!0))[n]||(t[n]=i)},clear:n,Z:function(){return i+++s}}},v.b("utils.domData",v.a.g),v.b("utils.domData.clear",v.a.g.clear),v.a.I=new function(){function e(e,n){var i=v.a.g.get(e,s);return i===t&&n&&(i=[],v.a.g.set(e,s,i)),i}function n(t){if(n=e(t,!1))for(var n=n.slice(0),s=0;s<n.length;s++)n[s](t);v.a.g.clear(t),v.a.I.cleanExternalData(t),a[t.nodeType]&&i(t.childNodes,!0)}function i(t,e){for(var i,s=[],r=0;r<t.length;r++)if((!e||8===t[r].nodeType)&&(n(s[s.length]=i=t[r]),t[r]!==i))for(;r--&&-1==v.a.A(s,t[r]););}var s=v.a.g.Z(),r={1:!0,8:!0,9:!0},a={1:!0,9:!0};return{za:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},xb:function(n,i){var r=e(n,!1);r&&(v.a.hb(r,i),0==r.length&&v.a.g.set(n,s,t))},na:function(t){return r[t.nodeType]&&(n(t),a[t.nodeType]&&i(t.getElementsByTagName("*"))),t},removeNode:function(t){v.na(t),t.parentNode&&t.parentNode.removeChild(t)},cleanExternalData:function(t){o&&"function"==typeof o.cleanData&&o.cleanData([t])}}},v.na=v.a.I.na,v.removeNode=v.a.I.removeNode,v.b("cleanNode",v.na),v.b("removeNode",v.removeNode),v.b("utils.domNodeDisposal",v.a.I),v.b("utils.domNodeDisposal.addDisposeCallback",v.a.I.za),v.b("utils.domNodeDisposal.removeDisposeCallback",v.a.I.xb),p=[0,"",""],E={thead:g=[1,"<table>","</table>"],tbody:g,tfoot:g,tr:[2,"<table><tbody>","</tbody></table>"],td:m=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:m,option:b=[1,"<select multiple='multiple'>","</select>"],optgroup:b},w=8>=v.a.W,v.a.ta=function(t,e){var n;if(o){if(o.parseHTML)n=o.parseHTML(t,e)||[];else if((n=o.clean([t],e))&&n[0]){for(var r=n[0];r.parentNode&&11!==r.parentNode.nodeType;)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}}else{(n=e)||(n=s),r=n.parentWindow||n.defaultView||i;var a,h=v.a.Cb(t).toLowerCase(),l=n.createElement("div");for(a=(h=h.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&E[h[1]]||p,h=a[0],a="ignored<div>"+a[1]+t+a[2]+"</div>","function"==typeof r.innerShiv?l.appendChild(r.innerShiv(a)):(w&&n.body.appendChild(l),l.innerHTML=a,w&&l.parentNode.removeChild(l));h--;)l=l.lastChild;n=v.a.la(l.lastChild.childNodes)}return n},v.a.Ld=function(t,e){var n=v.a.ta(t,e);return n.length&&n[0].parentElement||v.a.Xb(n)},v.a.dc=function(e,n){if(v.a.Sb(e),null!==(n=v.a.c(n))&&n!==t)if("string"!=typeof n&&(n=n.toString()),o)o(e).html(n);else for(var i=v.a.ta(n,e.ownerDocument),s=0;s<i.length;s++)e.appendChild(i[s])},v.b("utils.parseHtmlFragment",v.a.ta),v.b("utils.setHtml",v.a.dc),v.aa=function(){var e={};return{Wb:function(t){if("function"!=typeof t)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return e[n]=t,"\x3c!--[ko_memo:"+n+"]--\x3e"},ad:function(n,i){var s=e[n];if(s===t)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return s.apply(null,i||[]),!0}finally{delete e[n]}},bd:function(t,e){var n=[];!function t(e,n){if(e)if(8==e.nodeType)null!=(i=v.aa.Tc(e.nodeValue))&&n.push({sd:e,Jd:i});else if(1==e.nodeType)for(var i=0,s=e.childNodes,r=s.length;i<r;i++)t(s[i],n)}(t,n);for(var i=0,s=n.length;i<s;i++){var r=n[i].sd,o=[r];e&&v.a.gb(o,e),v.aa.ad(n[i].Jd,o),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)}},Tc:function(t){return(t=t.match(/^\[ko_memo\:(.*?)\]$/))?t[1]:null}}}(),v.b("memoization",v.aa),v.b("memoization.memoize",v.aa.Wb),v.b("memoization.unmemoize",v.aa.ad),v.b("memoization.parseMemoText",v.aa.Tc),v.b("memoization.unmemoizeDomNodeAndDescendants",v.aa.bd),v.ma=function(){function t(){if(r)for(var t,e=r,i=0;a<r;)if(t=n[a++]){if(a>e){if(5e3<=++i){a=r,v.a.Fc(Error("'Too much recursion' after processing "+i+" task groups."));break}e=r}try{t()}catch(t){v.a.Fc(t)}}}function e(){t(),a=r=n.length=0}var n=[],r=0,o=1,a=0;return{scheduler:i.MutationObserver?function(t){var e=s.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}(e):s&&"onreadystatechange"in s.createElement("script")?function(t){var e=s.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,s.documentElement.removeChild(e),e=null,t()},s.documentElement.appendChild(e)}:function(t){setTimeout(t,0)},yb:function(t){return r||v.ma.scheduler(e),n[r++]=t,o++},cancel:function(t){(t-=o-r)>=a&&t<r&&(n[t]=null)},resetForTesting:function(){var t=r-a;return a=r=n.length=0,t},Rd:t}}(),v.b("tasks",v.ma),v.b("tasks.schedule",v.ma.yb),v.b("tasks.runEarly",v.ma.Rd),v.Ta={throttle:function(t,e){t.throttleEvaluation=e;var n=null;return v.$({read:t,write:function(i){clearTimeout(n),n=v.a.setTimeout(function(){t(i)},e)}})},rateLimit:function(t,e){var n,i,s;"number"==typeof e?n=e:(n=e.timeout,i=e.method),t.Hb=!1,s="function"==typeof i?i:"notifyWhenChangesStop"==i?c:l,t.tb(function(t){return s(t,n,e)})},deferred:function(e,n){if(!0!==n)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.Hb||(e.Hb=!0,e.tb(function(n){var i,s=!1;return function(){if(!s){v.ma.cancel(i),i=v.ma.yb(n);try{s=!0,e.notifySubscribers(t,"dirty")}finally{s=!1}}}}))},notify:function(t,e){t.equalityComparer="always"==e?null:h}};var y={undefined:1,boolean:1,number:1,string:1};v.b("extenders",v.Ta),v.gc=function(t,e,n){this.da=t,this.kc=e,this.lc=n,this.Ib=!1,this.ab=this.Jb=null,v.J(this,"dispose",this.s),v.J(this,"disposeWhenNodeIsRemoved",this.l)},v.gc.prototype.s=function(){this.Ib||(this.ab&&v.a.I.xb(this.Jb,this.ab),this.Ib=!0,this.lc(),this.da=this.kc=this.lc=this.Jb=this.ab=null)},v.gc.prototype.l=function(t){this.Jb=t,v.a.I.za(t,this.ab=this.s.bind(this))},v.R=function(){v.a.zb(this,T),T.ob(this)};var T={ob:function(t){t.S={change:[]},t.rc=1},subscribe:function(t,e,n){var i=this;n=n||"change";var s=new v.gc(i,e?t.bind(e):t,function(){v.a.hb(i.S[n],s),i.cb&&i.cb(n)});return i.Qa&&i.Qa(n),i.S[n]||(i.S[n]=[]),i.S[n].push(s),s},notifySubscribers:function(t,e){if("change"===(e=e||"change")&&this.Gb(),this.Wa(e)){var n="change"===e&&this.dd||this.S[e].slice(0);try{v.v.wc();for(var i,s=0;i=n[s];++s)i.Ib||i.kc(t)}finally{v.v.end()}}},mb:function(){return this.rc},Cd:function(t){return this.mb()!==t},Gb:function(){++this.rc},tb:function(t){var e,n,i,s,r,o=this,a=v.N(o);o.bb||(o.bb=o.notifySubscribers,o.notifySubscribers=u);var h=t(function(){o.Ka=!1,a&&s===o&&(s=o.mc?o.mc():o());var t=n||r&&o.qb(i,s);r=n=e=!1,t&&o.bb(i=s)});o.pc=function(t,n){n&&o.Ka||(r=!n),o.dd=o.S.change.slice(0),o.Ka=e=!0,s=t,h()},o.oc=function(t){e||(i=t,o.bb(t,"beforeChange"))},o.qc=function(){r=!0},o.fd=function(){o.qb(i,o.w(!0))&&(n=!0)}},Wa:function(t){return this.S[t]&&this.S[t].length},Ad:function(t){if(t)return this.S[t]&&this.S[t].length||0;var e=0;return v.a.O(this.S,function(t,n){"dirty"!==t&&(e+=n.length)}),e},qb:function(t,e){return!this.equalityComparer||!this.equalityComparer(t,e)},toString:function(){return"[object Object]"},extend:function(t){var e=this;return t&&v.a.O(t,function(t,n){var i=v.Ta[t];"function"==typeof i&&(e=i(e,n)||e)}),e}};v.J(T,"init",T.ob),v.J(T,"subscribe",T.subscribe),v.J(T,"extend",T.extend),v.J(T,"getSubscriptionsCount",T.Ad),v.a.Ba&&v.a.setPrototypeOf(T,Function.prototype),v.R.fn=T,v.Pc=function(t){return null!=t&&"function"==typeof t.subscribe&&"function"==typeof t.notifySubscribers},v.b("subscribable",v.R),v.b("isSubscribable",v.Pc),v.U=v.v=function(){function t(t){i.push(n),n=t}function e(){n=i.pop()}var n,i=[],s=0;return{wc:t,end:e,ac:function(t){if(n){if(!v.Pc(t))throw Error("Only subscribable things can act as dependencies");n.nd.call(n.od,t,t.ed||(t.ed=++s))}},K:function(n,i,s){try{return t(),n.apply(i,s||[])}finally{e()}},pa:function(){if(n)return n.o.pa()},Va:function(){if(n)return n.o.Va()},rb:function(){if(n)return n.rb},o:function(){if(n)return n.o}}}(),v.b("computedContext",v.U),v.b("computedContext.getDependenciesCount",v.U.pa),v.b("computedContext.getDependencies",v.U.Va),v.b("computedContext.isInitial",v.U.rb),v.b("computedContext.registerDependency",v.U.ac),v.b("ignoreDependencies",v.Wd=v.v.K);var N=v.a.Da("_latestValue");v.sa=function(t){function e(){return 0<arguments.length?(e.qb(e[N],arguments[0])&&(e.xa(),e[N]=arguments[0],e.wa()),this):(v.v.ac(e),e[N])}return e[N]=t,v.a.Ba||v.a.extend(e,v.R.fn),v.R.fn.ob(e),v.a.zb(e,S),v.options.deferUpdates&&v.Ta.deferred(e,!0),e};var S={equalityComparer:h,w:function(){return this[N]},wa:function(){this.notifySubscribers(this[N],"spectate"),this.notifySubscribers(this[N])},xa:function(){this.notifySubscribers(this[N],"beforeChange")}};v.a.Ba&&v.a.setPrototypeOf(S,v.R.fn);var x=v.sa.Na="__ko_proto__";S[x]=v.sa,v.N=function(t){if((t="function"==typeof t&&t[x])&&t!==S[x]&&t!==v.o.fn[x])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!t},v.Ya=function(t){return"function"==typeof t&&(t[x]===S[x]||t[x]===v.o.fn[x]&&t.Mc)},v.b("observable",v.sa),v.b("isObservable",v.N),v.b("isWriteableObservable",v.Ya),v.b("isWritableObservable",v.Ya),v.b("observable.fn",S),v.J(S,"peek",S.w),v.J(S,"valueHasMutated",S.wa),v.J(S,"valueWillMutate",S.xa),v.Ia=function(t){if("object"!=typeof(t=t||[])||!("length"in t))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return t=v.sa(t),v.a.zb(t,v.Ia.fn),t.extend({trackArrayChanges:!0})},v.Ia.fn={remove:function(t){for(var e=this.w(),n=[],i="function"!=typeof t||v.N(t)?function(e){return e===t}:t,s=0;s<e.length;s++){var r=e[s];if(i(r)){if(0===n.length&&this.xa(),e[s]!==r)throw Error("Array modified during remove; cannot remove item");n.push(r),e.splice(s,1),s--}}return n.length&&this.wa(),n},removeAll:function(e){if(e===t){var n=this.w(),i=n.slice(0);return this.xa(),n.splice(0,n.length),this.wa(),i}return e?this.remove(function(t){return 0<=v.a.A(e,t)}):[]},destroy:function(t){var e=this.w(),n="function"!=typeof t||v.N(t)?function(e){return e===t}:t;this.xa();for(var i=e.length-1;0<=i;i--){var s=e[i];n(s)&&(s._destroy=!0)}this.wa()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=v.a.A(e,t)}):[]},indexOf:function(t){var e=this();return v.a.A(e,t)},replace:function(t,e){var n=this.indexOf(t);0<=n&&(this.xa(),this.w()[n]=e,this.wa())},sorted:function(t){var e=this().slice(0);return t?e.sort(t):e.sort()},reversed:function(){return this().slice(0).reverse()}},v.a.Ba&&v.a.setPrototypeOf(v.Ia.fn,v.sa.fn),v.a.C("pop push reverse shift sort splice unshift".split(" "),function(t){v.Ia.fn[t]=function(){var e=this.w();this.xa(),this.yc(e,t,arguments);var n=e[t].apply(e,arguments);return this.wa(),n===e?this:n}}),v.a.C(["slice"],function(t){v.Ia.fn[t]=function(){var e=this();return e[t].apply(e,arguments)}}),v.Oc=function(t){return v.N(t)&&"function"==typeof t.remove&&"function"==typeof t.push},v.b("observableArray",v.Ia),v.b("isObservableArray",v.Oc),v.Ta.trackArrayChanges=function(e,n){function i(){function t(){if(l){var t,n=[].concat(e.w()||[]);e.Wa("arrayChange")&&((!h||1<l)&&(h=v.a.Ob(r,n,e.Nb)),t=h),r=n,h=null,l=0,t&&t.length&&e.notifySubscribers(t,"arrayChange")}}a?t():(a=!0,o=e.notifySubscribers,e.notifySubscribers=function(t,e){return e&&"change"!==e||++l,o.apply(this,arguments)},r=[].concat(e.w()||[]),h=null,s=e.subscribe(t))}if(e.Nb={},n&&"object"==typeof n&&v.a.extend(e.Nb,n),e.Nb.sparse=!0,!e.yc){var s,r,o,a=!1,h=null,l=0,c=e.Qa,u=e.cb;e.Qa=function(t){c&&c.call(e,t),"arrayChange"===t&&i()},e.cb=function(n){u&&u.call(e,n),"arrayChange"!==n||e.Wa("arrayChange")||(o&&(e.notifySubscribers=o,o=t),s&&s.s(),s=null,a=!1,r=t)},e.yc=function(t,e,n){function i(t,e,n){return s[s.length]={status:t,value:e,index:n}}if(a&&!l){var s=[],r=t.length,o=n.length,c=0;switch(e){case"push":c=r;case"unshift":for(e=0;e<o;e++)i("added",n[e],c+e);break;case"pop":c=r-1;case"shift":r&&i("deleted",t[c],c);break;case"splice":e=Math.min(Math.max(0,0>n[0]?r+n[0]:n[0]),r),r=1===o?r:Math.min(e+(n[1]||0),r),o=e+o-2,c=Math.max(r,o);for(var u=[],f=[],d=2;e<c;++e,++d)e<r&&f.push(i("deleted",t[e],e)),e<o&&u.push(i("added",n[d],e));v.a.Jc(f,u);break;default:return}h=s}}}};var C=v.a.Da("_state");v.o=v.$=function(e,n,i){function s(){if(0<arguments.length){if("function"!=typeof r)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return r.apply(o.lb,arguments),this}return o.qa||v.v.ac(s),(o.ka||o.G&&s.Xa())&&s.ha(),o.X}if("object"==typeof e?i=e:(i=i||{},e&&(i.read=e)),"function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var r=i.write,o={X:t,ra:!0,ka:!0,pb:!1,hc:!1,qa:!1,vb:!1,G:!1,Vc:i.read,lb:n||i.owner,l:i.disposeWhenNodeIsRemoved||i.l||null,Sa:i.disposeWhen||i.Sa,Qb:null,F:{},V:0,Hc:null};return s[C]=o,s.Mc="function"==typeof r,v.a.Ba||v.a.extend(s,v.R.fn),v.R.fn.ob(s),v.a.zb(s,_),i.pure?(o.vb=!0,o.G=!0,v.a.extend(s,I)):i.deferEvaluation&&v.a.extend(s,A),v.options.deferUpdates&&v.Ta.deferred(s,!0),o.l&&(o.hc=!0,o.l.nodeType||(o.l=null)),o.G||i.deferEvaluation||s.ha(),o.l&&s.ja()&&v.a.I.za(o.l,o.Qb=function(){s.s()}),s};var _={equalityComparer:h,pa:function(){return this[C].V},Va:function(){var t=[];return v.a.O(this[C].F,function(e,n){t[n.La]=n.da}),t},Ub:function(t){if(!this[C].V)return!1;var e=this.Va();return-1!==v.a.A(e,t)||!!v.a.Lb(e,function(e){return e.Ub&&e.Ub(t)})},tc:function(t,e,n){if(this[C].vb&&e===this)throw Error("A 'pure' computed must not be called recursively");this[C].F[t]=n,n.La=this[C].V++,n.Ma=e.mb()},Xa:function(){var t,e,n=this[C].F;for(t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&(e=n[t],this.Ja&&e.da.Ka||e.da.Cd(e.Ma)))return!0},Id:function(){this.Ja&&!this[C].pb&&this.Ja(!1)},ja:function(){var t=this[C];return t.ka||0<t.V},Qd:function(){this.Ka?this[C].ka&&(this[C].ra=!0):this.Gc()},Zc:function(t){if(t.Hb){var e=t.subscribe(this.Id,this,"dirty"),n=t.subscribe(this.Qd,this);return{da:t,s:function(){e.s(),n.s()}}}return t.subscribe(this.Gc,this)},Gc:function(){var t=this,e=t.throttleEvaluation;e&&0<=e?(clearTimeout(this[C].Hc),this[C].Hc=v.a.setTimeout(function(){t.ha(!0)},e)):t.Ja?t.Ja(!0):t.ha(!0)},ha:function(t){var e=this[C],n=e.Sa,i=!1;if(!e.pb&&!e.qa){if(e.l&&!v.a.Rb(e.l)||n&&n()){if(!e.hc)return void this.s()}else e.hc=!1;e.pb=!0;try{i=this.yd(t)}finally{e.pb=!1}return i}},yd:function(e){var n=this[C],i=!1,s=n.vb?t:!n.V;i={pd:this,kb:n.F,Pb:n.V},v.v.wc({od:i,nd:d,o:this,rb:s}),n.F={},n.V=0;var r=this.xd(n,i);return n.V?i=this.qb(n.X,r):(this.s(),i=!0),i&&(n.G?this.Gb():this.notifySubscribers(n.X,"beforeChange"),n.X=r,this.notifySubscribers(n.X,"spectate"),!n.G&&e&&this.notifySubscribers(n.X),this.qc&&this.qc()),s&&this.notifySubscribers(n.X,"awake"),i},xd:function(t,e){try{var n=t.Vc;return t.lb?n.call(t.lb):n()}finally{v.v.end(),e.Pb&&!t.G&&v.a.O(e.kb,f),t.ra=t.ka=!1}},w:function(t){var e=this[C];return(e.ka&&(t||!e.V)||e.G&&this.Xa())&&this.ha(),e.X},tb:function(t){v.R.fn.tb.call(this,t),this.mc=function(){return this[C].G||(this[C].ra?this.ha():this[C].ka=!1),this[C].X},this.Ja=function(t){this.oc(this[C].X),this[C].ka=!0,t&&(this[C].ra=!0),this.pc(this,!t)}},s:function(){var e=this[C];!e.G&&e.F&&v.a.O(e.F,function(t,e){e.s&&e.s()}),e.l&&e.Qb&&v.a.I.xb(e.l,e.Qb),e.F=t,e.V=0,e.qa=!0,e.ra=!1,e.ka=!1,e.G=!1,e.l=t,e.Sa=t,e.Vc=t,this.Mc||(e.lb=t)}},I={Qa:function(t){var e=this,n=e[C];if(!n.qa&&n.G&&"change"==t){if(n.G=!1,n.ra||e.Xa())n.F=null,n.V=0,e.ha()&&e.Gb();else{var i=[];v.a.O(n.F,function(t,e){i[e.La]=t}),v.a.C(i,function(t,i){var s=n.F[t],r=e.Zc(s.da);r.La=i,r.Ma=s.Ma,n.F[t]=r}),e.Xa()&&e.ha()&&e.Gb()}n.qa||e.notifySubscribers(n.X,"awake")}},cb:function(e){var n=this[C];n.qa||"change"!=e||this.Wa("change")||(v.a.O(n.F,function(t,e){e.s&&(n.F[t]={da:e.da,La:e.La,Ma:e.Ma},e.s())}),n.G=!0,this.notifySubscribers(t,"asleep"))},mb:function(){var t=this[C];return t.G&&(t.ra||this.Xa())&&this.ha(),v.R.fn.mb.call(this)}},A={Qa:function(t){"change"!=t&&"beforeChange"!=t||this.w()}};v.a.Ba&&v.a.setPrototypeOf(_,v.R.fn);var O=v.sa.Na;_[O]=v.o,v.Nc=function(t){return"function"==typeof t&&t[O]===_[O]},v.Ed=function(t){return v.Nc(t)&&t[C]&&t[C].vb},v.b("computed",v.o),v.b("dependentObservable",v.o),v.b("isComputed",v.Nc),v.b("isPureComputed",v.Ed),v.b("computed.fn",_),v.J(_,"peek",_.w),v.J(_,"dispose",_.s),v.J(_,"isActive",_.ja),v.J(_,"getDependenciesCount",_.pa),v.J(_,"getDependencies",_.Va),v.wb=function(t,e){return"function"==typeof t?v.o(t,e,{pure:!0}):((t=v.a.extend({},t)).pure=!0,v.o(t,e))},v.b("pureComputed",v.wb),function(){function e(i,s,r){if(r=r||new n,"object"!=typeof(i=s(i))||null===i||i===t||i instanceof RegExp||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i;var o=i instanceof Array?[]:{};return r.save(i,o),function(t,e){if(t instanceof Array){for(var n=0;n<t.length;n++)e(n);"function"==typeof t.toJSON&&e("toJSON")}else for(n in t)e(n)}(i,function(n){var a=s(i[n]);switch(typeof a){case"boolean":case"number":case"string":case"function":o[n]=a;break;case"object":case"undefined":var h=r.get(a);o[n]=h!==t?h:e(a,s,r)}}),o}function n(){this.keys=[],this.values=[]}v.$c=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(t){for(var e=0;v.N(t)&&10>e;e++)t=t();return t})},v.toJSON=function(t,e,n){return t=v.$c(t),v.a.fc(t,e,n)},n.prototype={constructor:n,save:function(t,e){var n=v.a.A(this.keys,t);0<=n?this.values[n]=e:(this.keys.push(t),this.values.push(e))},get:function(e){return 0<=(e=v.a.A(this.keys,e))?this.values[e]:t}}}(),v.b("toJS",v.$c),v.b("toJSON",v.toJSON),v.Vd=function(t,e,n){function i(e){var i=v.wb(t,n).extend({Ga:"always"}),s=i.subscribe(function(t){t&&(s.s(),e(t))});return i.notifySubscribers(i.w()),s}return"function"!=typeof Promise||e?i(e.bind(n)):new Promise(i)},v.b("when",v.Vd),v.u={L:function(e){switch(v.a.P(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?v.a.g.get(e,v.f.options.Yb):7>=v.a.W?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?v.u.L(e.options[e.selectedIndex]):t;default:return e.value}},ya:function(e,n,i){switch(v.a.P(e)){case"option":"string"==typeof n?(v.a.g.set(e,v.f.options.Yb,t),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=n):(v.a.g.set(e,v.f.options.Yb,n),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof n?n:"");break;case"select":""!==n&&null!==n||(n=t);for(var s,r=-1,o=0,a=e.options.length;o<a;++o)if((s=v.u.L(e.options[o]))==n||""===s&&n===t){r=o;break}(i||0<=r||n===t&&1<e.size)&&(e.selectedIndex=r,6===v.a.W&&v.a.setTimeout(function(){e.selectedIndex=r},0));break;default:null!==n&&n!==t||(n=""),e.value=n}}},v.b("selectExtensions",v.u),v.b("selectExtensions.readValue",v.u.L),v.b("selectExtensions.writeValue",v.u.ya),v.m=function(){function t(t){123===(t=v.a.Cb(t)).charCodeAt(0)&&(t=t.slice(1,-1));var e,n=[],o=(t+="\n,").match(i),a=[],h=0;if(1<o.length){for(var l,c=0;l=o[c];++c){var u=l.charCodeAt(0);if(44===u){if(0>=h){n.push(e&&a.length?{key:e,value:a.join("")}:{unknown:e||a.join("")}),e=h=0,a=[];continue}}else if(58===u){if(!h&&!e&&1===a.length){e=a.pop();continue}}else{if(47===u&&1<l.length&&(47===l.charCodeAt(1)||42===l.charCodeAt(1)))continue;47===u&&c&&1<l.length?(u=o[c-1].match(s))&&!r[u[0]]&&(o=(t=t.substr(t.indexOf(l)+1)).match(i),c=-1,l="/"):40===u||123===u||91===u?++h:41===u||125===u||93===u?--h:e||a.length||34!==u&&39!==u||(l=l.slice(1,-1))}a.push(l)}if(0<h)throw Error("Unbalanced parentheses, braces, or brackets")}return n}var e=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),s=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},o={};return{Ra:[],va:o,Zb:t,ub:function(i,s){function r(t,i){var s;if(!c){var u=v.getBindingHandler(t);if(u&&u.preprocess&&!(i=u.preprocess(i,t,r)))return;(u=o[t])&&(s=i,0<=v.a.A(e,s)?s=!1:(u=s.match(n),s=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:s)),u=s),u&&h.push("'"+("string"==typeof o[t]?o[t]:t)+"':function(_z){"+s+"=_z}")}l&&(i="function(){return "+i+" }"),a.push("'"+t+"':"+i)}var a=[],h=[],l=(s=s||{}).valueAccessors,c=s.bindingParams,u="string"==typeof i?t(i):i;return v.a.C(u,function(t){r(t.key||t.unknown,t.value)}),h.length&&r("_ko_property_writers","{"+h.join(",")+" }"),a.join(",")},Hd:function(t,e){for(var n=0;n<t.length;n++)if(t[n].key==e)return!0;return!1},$a:function(t,e,n,i,s){t&&v.N(t)?!v.Ya(t)||s&&t.w()===i||t(i):(t=e.get("_ko_property_writers"))&&t[n]&&t[n](i)}}}(),v.b("expressionRewriting",v.m),v.b("expressionRewriting.bindingRewriteValidators",v.m.Ra),v.b("expressionRewriting.parseObjectLiteral",v.m.Zb),v.b("expressionRewriting.preProcessBindings",v.m.ub),v.b("expressionRewriting._twoWayBindings",v.m.va),v.b("jsonExpressionRewriting",v.m),v.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",v.m.ub),function(){function t(t){return 8==t.nodeType&&o.test(r?t.text:t.nodeValue)}function e(t){return 8==t.nodeType&&a.test(r?t.text:t.nodeValue)}function n(n,i){for(var s=n,r=1,o=[];s=s.nextSibling;){if(e(s)&&(v.a.g.set(s,l,!0),0==--r))return o;o.push(s),t(s)&&r++}if(!i)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function i(t,e){var i=n(t,e);return i?0<i.length?i[i.length-1].nextSibling:t.nextSibling:null}var r=s&&"\x3c!--test--\x3e"===s.createComment("test").text,o=r?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,a=r?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,h={ul:!0,ol:!0},l="__ko_matchedEndComment__";v.h={ea:{},childNodes:function(e){return t(e)?n(e):e.childNodes},Ea:function(e){if(t(e))for(var n=0,i=(e=v.h.childNodes(e)).length;n<i;n++)v.removeNode(e[n]);else v.a.Sb(e)},ua:function(e,n){if(t(e)){v.h.Ea(e);for(var i=e.nextSibling,s=0,r=n.length;s<r;s++)i.parentNode.insertBefore(n[s],i)}else v.a.ua(e,n)},Uc:function(e,n){t(e)?e.parentNode.insertBefore(n,e.nextSibling):e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)},Vb:function(e,n,i){i?t(e)?e.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):v.h.Uc(e,n)},firstChild:function(n){if(t(n))return!n.nextSibling||e(n.nextSibling)?null:n.nextSibling;if(n.firstChild&&e(n.firstChild))throw Error("Found invalid end comment, as the first child of "+n);return n.firstChild},nextSibling:function(n){if(t(n)&&(n=i(n)),n.nextSibling&&e(n.nextSibling)){var s=n.nextSibling;if(e(s)&&!v.a.g.get(s,l))throw Error("Found end comment without a matching opening comment, as child of "+n);return null}return n.nextSibling},Bd:t,Ud:function(t){return(t=(r?t.text:t.nodeValue).match(o))?t[1]:null},Rc:function(n){if(h[v.a.P(n)]){var s=n.firstChild;if(s)do{if(1===s.nodeType){var r,o=null;if(r=s.firstChild)do{if(o)o.push(r);else if(t(r)){var a=i(r,!0);a?r=a:o=[r]}else e(r)&&(o=[r])}while(r=r.nextSibling);if(r=o)for(o=s.nextSibling,a=0;a<r.length;a++)o?n.insertBefore(r[a],o):n.appendChild(r[a])}}while(s=s.nextSibling)}}}}(),v.b("virtualElements",v.h),v.b("virtualElements.allowedBindings",v.h.ea),v.b("virtualElements.emptyNode",v.h.Ea),v.b("virtualElements.insertAfter",v.h.Vb),v.b("virtualElements.prepend",v.h.Uc),v.b("virtualElements.setDomNodeChildren",v.h.ua),v.ga=function(){this.md={}},v.a.extend(v.ga.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return null!=t.getAttribute("data-bind")||v.i.getComponentNameForNode(t);case 8:return v.h.Bd(t);default:return!1}},getBindings:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t):null;return v.i.sc(n,t,e,!1)},getBindingAccessors:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t,{valueAccessors:!0}):null;return v.i.sc(n,t,e,!0)},getBindingsString:function(t){switch(t.nodeType){case 1:return t.getAttribute("data-bind");case 8:return v.h.Ud(t);default:return null}},parseBindingsString:function(t,e,n,i){try{var s,r=this.md,o=t+(i&&i.valueAccessors||"");if(!(s=r[o])){var a,h="with($context){with($data||{}){return{"+v.m.ub(t,i)+"}}}";a=new Function("$context","$element",h),s=r[o]=a}return s(e,n)}catch(e){throw e.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+e.message,e}}}),v.ga.instance=new v.ga,v.b("bindingProvider",v.ga),function(){function e(t){var e=(t=v.a.g.get(t,y))&&t.M;e&&(t.M=null,e.Sc())}function n(t,n,i){this.node=t,this.xc=n,this.ib=[],this.T=!1,n.M||v.a.I.za(t,e),i&&i.M&&(i.M.ib.push(t),this.Kb=i)}function r(t){return function(){return t}}function a(t){return t()}function h(t){return v.a.Ha(v.v.K(t),function(e,n){return function(){return t()[n]}})}function l(t,e,n){return"function"==typeof t?h(t.bind(null,e,n)):v.a.Ha(t,r)}function c(t,e){return h(this.getBindings.bind(this,t,e))}function u(t,e){var n=v.h.firstChild(e);if(n){var i,s=v.ga.instance,r=s.preprocessNode;if(r){for(;i=n;)n=v.h.nextSibling(i),r.call(s,i);n=v.h.firstChild(e)}for(;i=n;)n=v.h.nextSibling(i),f(t,i)}v.j.Ga(e,v.j.T)}function f(t,e){var n=t,i=1===e.nodeType;i&&v.h.Rc(e),(i||v.ga.instance.nodeHasBindings(e))&&(n=d(e,null,t).bindingContextForDescendants),n&&!E[v.a.P(e)]&&u(n,e)}function d(e,n,i){var s,r=v.a.g.Tb(e,y,{}),o=r.gd;if(!n){if(o)throw Error("You cannot apply bindings multiple times to the same element.");r.gd=!0}if(o||(r.context=i),n&&"function"!=typeof n)s=n;else{var h=v.ga.instance,l=h.getBindingAccessors||c,u=v.$(function(){return(s=n?n(i,e):l.call(h,e,i))&&(i[g]&&i[g](),i[b]&&i[b]()),s},null,{l:e});s&&u.ja()||(u=null)}var f,d=i;if(s){var p=function(){return v.a.Ha(u?u():s,a)},m=u?function(t){return function(){return a(u()[t])}}:function(t){return s[t]};p.get=function(t){return s[t]&&a(m(t))},p.has=function(t){return t in s},v.j.T in s&&v.j.subscribe(e,v.j.T,function(){var t=(0,s[v.j.T])();if(t){var n=v.h.childNodes(e);n.length&&t(n,v.Dc(n[0]))}}),v.j.oa in s&&(d=v.j.Bb(e,i),v.j.subscribe(e,v.j.oa,function(){var t=(0,s[v.j.oa])();t&&v.h.firstChild(e)&&t(e)})),r=function(t){var e=[],n={},i=[];return v.a.O(t,function s(r){if(!n[r]){var o=v.getBindingHandler(r);o&&(o.after&&(i.push(r),v.a.C(o.after,function(e){if(t[e]){if(-1!==v.a.A(i,e))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));s(e)}}),i.length--),e.push({key:r,Lc:o})),n[r]=!0}}),e}(s),v.a.C(r,function(n){var i=n.Lc.init,r=n.Lc.update,o=n.key;if(8===e.nodeType&&!v.h.ea[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof i&&v.v.K(function(){var n=i(e,m(o),p,d.$data,d);if(n&&n.controlsDescendantBindings){if(f!==t)throw Error("Multiple bindings ("+f+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");f=o}}),"function"==typeof r&&v.$(function(){r(e,m(o),p,d.$data,d)},null,{l:e})}catch(t){throw t.message='Unable to process binding "'+o+": "+s[o]+'"\nMessage: '+t.message,t}})}return{shouldBindDescendants:r=f===t,bindingContextForDescendants:r&&d}}function p(e,n){return e&&e instanceof v.fa?e:new v.fa(e,t,t,n)}var g=v.a.Da("_subscribable"),m=v.a.Da("_ancestorBindingInfo"),b=v.a.Da("_dataDependency");v.f={};var E={script:!0,textarea:!0,template:!0};v.getBindingHandler=function(t){return v.f[t]};var w={};v.fa=function(e,n,i,s,r){function o(){var t=u?c():c,e=v.a.c(t);return n?(v.a.extend(h,n),m in n&&(h[m]=n[m])):(h.$parents=[],h.$root=e,h.ko=v),h[g]=a,l?e=h.$data:(h.$rawData=t,h.$data=e),i&&(h[i]=e),s&&s(h,n,e),n&&n[g]&&!v.U.o().Ub(n[g])&&n[g](),f&&(h[b]=f),h.$data}var a,h=this,l=e===w,c=l?t:e,u="function"==typeof c&&!v.N(c),f=r&&r.dataDependency;r&&r.exportDependencies?o():((a=v.wb(o)).w(),a.ja()?a.equalityComparer=null:h[g]=t)},v.fa.prototype.createChildContext=function(t,e,n,i){if(!i&&e&&"object"==typeof e&&(e=(i=e).as,n=i.extend),e&&i&&i.noChildContext){var s="function"==typeof t&&!v.N(t);return new v.fa(w,this,null,function(i){n&&n(i),i[e]=s?t():t},i)}return new v.fa(t,this,e,function(t,e){t.$parentContext=e,t.$parent=e.$data,t.$parents=(e.$parents||[]).slice(0),t.$parents.unshift(t.$parent),n&&n(t)},i)},v.fa.prototype.extend=function(t,e){return new v.fa(w,this,null,function(e){v.a.extend(e,"function"==typeof t?t(e):t)},e)};var y=v.a.g.Z();n.prototype.Sc=function(){this.Kb&&this.Kb.M&&this.Kb.M.rd(this.node)},n.prototype.rd=function(t){v.a.hb(this.ib,t),!this.ib.length&&this.T&&this.Bc()},n.prototype.Bc=function(){this.T=!0,this.xc.M&&!this.ib.length&&(this.xc.M=null,v.a.I.xb(this.node,e),v.j.Ga(this.node,v.j.oa),this.Sc())},v.j={T:"childrenComplete",oa:"descendantsComplete",subscribe:function(t,e,n,i){return(t=v.a.g.Tb(t,y,{})).Fa||(t.Fa=new v.R),t.Fa.subscribe(n,i,e)},Ga:function(e,n){var i=v.a.g.get(e,y);if(i&&(i.Fa&&i.Fa.notifySubscribers(e,n),n==v.j.T))if(i.M)i.M.Bc();else if(i.M===t&&i.Fa&&i.Fa.Wa(v.j.oa))throw Error("descendantsComplete event not supported for bindings on this node")},Bb:function(t,e){var i=v.a.g.Tb(t,y,{});return i.M||(i.M=new n(t,i,e[m])),e[m]==i?e:e.extend(function(t){t[m]=i})}},v.Sd=function(t){return(t=v.a.g.get(t,y))&&t.context},v.eb=function(t,e,n){return 1===t.nodeType&&v.h.Rc(t),d(t,e,p(n))},v.kd=function(t,e,n){return n=p(n),v.eb(t,l(e,n,t),n)},v.Pa=function(t,e){1!==e.nodeType&&8!==e.nodeType||u(p(t),e)},v.uc=function(t,e,n){if(!o&&i.jQuery&&(o=i.jQuery),2>arguments.length){if(!(e=s.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!e||1!==e.nodeType&&8!==e.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");f(p(t,n),e)},v.Cc=function(e){return!e||1!==e.nodeType&&8!==e.nodeType?t:v.Sd(e)},v.Dc=function(e){return(e=v.Cc(e))?e.$data:t},v.b("bindingHandlers",v.f),v.b("bindingEvent",v.j),v.b("bindingEvent.subscribe",v.j.subscribe),v.b("bindingEvent.startPossiblyAsyncContentBinding",v.j.Bb),v.b("applyBindings",v.uc),v.b("applyBindingsToDescendants",v.Pa),v.b("applyBindingAccessorsToNode",v.eb),v.b("applyBindingsToNode",v.kd),v.b("contextFor",v.Cc),v.b("dataFor",v.Dc)}(),function(t){function e(e,i){var o,a=Object.prototype.hasOwnProperty.call(s,e)?s[e]:t;a?a.subscribe(i):((a=s[e]=new v.R).subscribe(i),n(e,function(t,n){var i=!(!n||!n.synchronous);r[e]={definition:t,Fd:i},delete s[e],o||i?a.notifySubscribers(t):v.ma.yb(function(){a.notifySubscribers(t)})}),o=!0)}function n(t,e){i("getConfig",[t],function(n){n?i("loadComponent",[t,n],function(t){e(t,n)}):e(null,null)})}function i(e,n,s,r){r||(r=v.i.loaders.slice(0));var o=r.shift();if(o){var a=o[e];if(a){var h=!1;if(a.apply(o,n.concat(function(t){h?s(null):null!==t?s(t):i(e,n,s,r)}))!==t&&(h=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(e,n,s,r)}else s(null)}var s={},r={};v.i={get:function(n,i){var s=Object.prototype.hasOwnProperty.call(r,n)?r[n]:t;s?s.Fd?v.v.K(function(){i(s.definition)}):v.ma.yb(function(){i(s.definition)}):e(n,i)},Ac:function(t){delete r[t]},nc:i},v.i.loaders=[],v.b("components",v.i),v.b("components.get",v.i.get),v.b("components.clearCachedDefinition",v.i.Ac)}(),function(){function t(t,e,n,i){function s(){0==--a&&i(r)}var r={},a=2,h=n.template;n=n.viewModel,h?o(e,h,function(e){v.i.nc("loadTemplate",[t,e],function(t){r.template=t,s()})}):s(),n?o(e,n,function(e){v.i.nc("loadViewModel",[t,e],function(t){r[l]=t,s()})}):s()}function e(t){switch(v.a.P(t)){case"script":return v.a.ta(t.text);case"textarea":return v.a.ta(t.value);case"template":if(r(t.content))return v.a.Ca(t.content.childNodes)}return v.a.Ca(t.childNodes)}function r(t){return i.DocumentFragment?t instanceof DocumentFragment:t&&11===t.nodeType}function o(t,e,s){"string"==typeof e.require?n||i.require?(n||i.require)([e.require],s):t("Uses require, but no AMD loader is present"):s(e)}function a(t){return function(e){throw Error("Component '"+t+"': "+e)}}var h={};v.i.register=function(t,e){if(!e)throw Error("Invalid configuration for "+t);if(v.i.sb(t))throw Error("Component "+t+" is already registered");h[t]=e},v.i.sb=function(t){return Object.prototype.hasOwnProperty.call(h,t)},v.i.unregister=function(t){delete h[t],v.i.Ac(t)},v.i.Ec={getConfig:function(t,e){e(v.i.sb(t)?h[t]:null)},loadComponent:function(e,n,i){var s=a(e);o(s,n,function(n){t(e,s,n,i)})},loadTemplate:function(t,n,o){if(t=a(t),"string"==typeof n)o(v.a.ta(n));else if(n instanceof Array)o(n);else if(r(n))o(v.a.la(n.childNodes));else if(n.element)if(n=n.element,i.HTMLElement?n instanceof HTMLElement:n&&n.tagName&&1===n.nodeType)o(e(n));else if("string"==typeof n){var h=s.getElementById(n);h?o(e(h)):t("Cannot find element with ID "+n)}else t("Unknown element type: "+n);else t("Unknown template value: "+n)},loadViewModel:function(t,e,n){!function t(e,n,i){if("function"==typeof n)i(function(t){return new n(t)});else if("function"==typeof n[l])i(n[l]);else if("instance"in n){var s=n.instance;i(function(){return s})}else"viewModel"in n?t(e,n.viewModel,i):e("Unknown viewModel value: "+n)}(a(t),e,n)}};var l="createViewModel";v.b("components.register",v.i.register),v.b("components.isRegistered",v.i.sb),v.b("components.unregister",v.i.unregister),v.b("components.defaultLoader",v.i.Ec),v.i.loaders.push(v.i.Ec),v.i.cd=h}(),function(){function t(t,n){if(i=t.getAttribute("params")){var i=e.parseBindingsString(i,n,t,{valueAccessors:!0,bindingParams:!0}),s=(i=v.a.Ha(i,function(e){return v.o(e,null,{l:t})}),v.a.Ha(i,function(e){var n=e.w();return e.ja()?v.o({read:function(){return v.a.c(e())},write:v.Ya(n)&&function(t){e()(t)},l:t}):n}));return Object.prototype.hasOwnProperty.call(s,"$raw")||(s.$raw=i),s}return{$raw:{}}}v.i.getComponentNameForNode=function(t){var e=v.a.P(t);if(v.i.sb(e)&&(-1!=e.indexOf("-")||"[object HTMLUnknownElement]"==""+t||8>=v.a.W&&t.tagName===e))return e},v.i.sc=function(e,n,i,s){if(1===n.nodeType){var r=v.i.getComponentNameForNode(n);if(r){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:r,params:t(n,i)};e.component=s?function(){return o}:o}}return e};var e=new v.ga;9>v.a.W&&(v.i.register=function(t){return function(e){return t.apply(this,arguments)}}(v.i.register),s.createDocumentFragment=function(t){return function(){var e,n=t(),i=v.i.cd;for(e in i);return n}}(s.createDocumentFragment))}(),function(){var t=0;v.f.component={init:function(e,n,i,s,r){function o(){var t=a&&a.dispose;"function"==typeof t&&t.call(a),l&&l.s(),h=a=l=null}var a,h,l,c=v.a.la(v.h.childNodes(e));return v.h.Ea(e),v.a.I.za(e,o),v.o(function(){var i,s,u=v.a.c(n());if("string"==typeof u?i=u:(i=v.a.c(u.name),s=v.a.c(u.params)),!i)throw Error("No component name specified");var f=v.j.Bb(e,r),d=h=++t;v.i.get(i,function(t){if(h===d){if(o(),!t)throw Error("Unknown component '"+i+"'");!function(t,e,n){if(!(e=e.template))throw Error("Component '"+t+"' has no template");t=v.a.Ca(e),v.h.ua(n,t)}(i,t,e);var n=function(t,e,n){var i=t.createViewModel;return i?i.call(t,e,n):e}(t,s,{element:e,templateNodes:c});t=f.createChildContext(n,{extend:function(t){t.$component=n,t.$componentTemplateNodes=c}}),n&&n.koDescendantsComplete&&(l=v.j.subscribe(e,v.j.oa,n.koDescendantsComplete,n)),a=n,v.Pa(t,e)}})},null,{l:e}),{controlsDescendantBindings:!0}}},v.h.ea.component=!0}();var k={class:"className",for:"htmlFor"};v.f.attr={update:function(e,n){var i=v.a.c(n())||{};v.a.O(i,function(n,i){i=v.a.c(i);var s=n.indexOf(":"),r=(s="lookupNamespaceURI"in e&&0<s&&e.lookupNamespaceURI(n.substr(0,s)),!1===i||null===i||i===t);r?s?e.removeAttributeNS(s,n):e.removeAttribute(n):i=i.toString(),8>=v.a.W&&n in k?(n=k[n],r?e.removeAttribute(n):e[n]=i):r||(s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)),"name"===n&&v.a.Xc(e,r?"":i)})}},v.f.checked={after:["value","attr"],init:function(e,n,i){function s(){var s=e.checked,h=r();if(!v.U.rb()&&(s||!a&&!v.U.pa())){var u=v.v.K(n);if(l){var d=c?u.w():u,p=f;f=h,p!==h?s&&(v.a.Oa(d,h,!0),v.a.Oa(d,p,!1)):v.a.Oa(d,h,s),c&&v.Ya(u)&&u(d)}else o&&(h===t?h=s:s||(h=t)),v.m.$a(u,i,"checked",h,!0)}}var r=v.wb(function(){return i.has("checkedValue")?v.a.c(i.get("checkedValue")):u?i.has("value")?v.a.c(i.get("value")):e.value:void 0}),o="checkbox"==e.type,a="radio"==e.type;if(o||a){var h=n(),l=o&&v.a.c(h)instanceof Array,c=!(l&&h.push&&h.splice),u=a||l,f=l?r():t;a&&!e.name&&v.f.uniqueName.init(e,function(){return!0}),v.o(s,null,{l:e}),v.a.H(e,"click",s),v.o(function(){var i=v.a.c(n()),s=r();l?(e.checked=0<=v.a.A(i,s),f=s):e.checked=o&&s===t?!!i:r()===i},null,{l:e}),h=t}}},v.m.va.checked=!0,v.f.checkedValue={update:function(t,e){t.value=v.a.c(e())}},v.f.class={update:function(t,e){var n=v.a.Cb(v.a.c(e()));v.a.Eb(t,t.__ko__cssValue,!1),t.__ko__cssValue=n,v.a.Eb(t,n,!0)}},v.f.css={update:function(t,e){var n=v.a.c(e());null!==n&&"object"==typeof n?v.a.O(n,function(e,n){n=v.a.c(n),v.a.Eb(t,e,n)}):v.f.class.update(t,e)}},v.f.enable={update:function(t,e){var n=v.a.c(e());n&&t.disabled?t.removeAttribute("disabled"):n||t.disabled||(t.disabled=!0)}},v.f.disable={update:function(t,e){v.f.enable.update(t,function(){return!v.a.c(e())})}},v.f.event={init:function(t,e,n,i,s){var r=e()||{};v.a.O(r,function(r){"string"==typeof r&&v.a.H(t,r,function(t){var o,a=e()[r];if(a){try{var h=v.a.la(arguments);i=s.$data,h.unshift(i),o=a.apply(i,h)}finally{!0!==o&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}!1===n.get(r+"Bubble")&&(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation())}})})}},v.f.foreach={Qc:function(t){return function(){var e=t(),n=v.a.$b(e);return n&&"number"!=typeof n.length?(v.a.c(e),{foreach:n.data,as:n.as,noChildContext:n.noChildContext,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:v.ba.Na}):{foreach:e,templateEngine:v.ba.Na}}},init:function(t,e){return v.f.template.init(t,v.f.foreach.Qc(e))},update:function(t,e,n,i,s){return v.f.template.update(t,v.f.foreach.Qc(e),n,i,s)}},v.m.Ra.foreach=!1,v.h.ea.foreach=!0,v.f.hasfocus={init:function(t,e,n){function i(i){t.__ko_hasfocusUpdating=!0;var s=t.ownerDocument;if("activeElement"in s){var r;try{r=s.activeElement}catch(t){r=s.body}i=r===t}s=e(),v.m.$a(s,n,"hasfocus",i,!0),t.__ko_hasfocusLastValue=i,t.__ko_hasfocusUpdating=!1}var s=i.bind(null,!0),r=i.bind(null,!1);v.a.H(t,"focus",s),v.a.H(t,"focusin",s),v.a.H(t,"blur",r),v.a.H(t,"focusout",r),t.__ko_hasfocusLastValue=!1},update:function(t,e){var n=!!v.a.c(e());t.__ko_hasfocusUpdating||t.__ko_hasfocusLastValue===n||(n?t.focus():t.blur(),!n&&t.__ko_hasfocusLastValue&&t.ownerDocument.body.focus(),v.v.K(v.a.Fb,null,[t,n?"focusin":"focusout"]))}},v.m.va.hasfocus=!0,v.f.hasFocus=v.f.hasfocus,v.m.va.hasFocus="hasfocus",v.f.html={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){v.a.dc(t,e())}},function(){function t(t,e,n){v.f[t]={init:function(t,i,s,r,o){var a,h,l,c,u,f={};if(e){r=s.get("as");var d=s.get("noChildContext");f={as:r,noChildContext:d,exportDependencies:u=!(r&&d)}}return c=(l="render"==s.get("completeOn"))||s.has(v.j.oa),v.o(function(){var s,r=v.a.c(i()),d=!n!=!r,p=!h;(u||d!==a)&&(c&&(o=v.j.Bb(t,o)),d&&(e&&!u||(f.dataDependency=v.U.o()),s=e?o.createChildContext("function"==typeof r?r:i,f):v.U.pa()?o.extend(null,f):o),p&&v.U.pa()&&(h=v.a.Ca(v.h.childNodes(t),!0)),d?(p||v.h.ua(t,v.a.Ca(h)),v.Pa(s,t)):(v.h.Ea(t),l||v.j.Ga(t,v.j.T)),a=d)},null,{l:t}),{controlsDescendantBindings:!0}}},v.m.Ra[t]=!1,v.h.ea[t]=!0}t("if"),t("ifnot",!1,!0),t("with",!0)}(),v.f.let={init:function(t,e,n,i,s){return e=s.extend(e),v.Pa(e,t),{controlsDescendantBindings:!0}}},v.h.ea.let=!0;var D={};v.f.options={init:function(t){if("select"!==v.a.P(t))throw Error("options binding applies only to SELECT elements");for(;0<t.length;)t.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,i){function s(){return v.a.fb(e.options,function(t){return t.selected})}function r(t,e,n){var i=typeof e;return"function"==i?e(t):"string"==i?t[e]:n}function o(t,n){if(p&&c)v.u.ya(e,v.a.c(i.get("value")),!0);else if(d.length){var s=0<=v.a.A(d,v.u.L(n[0]));v.a.Yc(n[0],s),p&&!s&&v.v.K(v.a.Fb,null,[e,"change"])}}var a=e.multiple,h=0!=e.length&&a?e.scrollTop:null,l=v.a.c(n()),c=i.get("valueAllowUnset")&&i.has("value"),u=i.get("optionsIncludeDestroyed");n={};var f,d=[];c||(a?d=v.a.Mb(s(),v.u.L):0<=e.selectedIndex&&d.push(v.u.L(e.options[e.selectedIndex]))),l&&(void 0===l.length&&(l=[l]),f=v.a.fb(l,function(e){return u||e===t||null===e||!v.a.c(e._destroy)}),i.has("optionsCaption")&&null!==(l=v.a.c(i.get("optionsCaption")))&&l!==t&&f.unshift(D));var p=!1;n.beforeRemove=function(t){e.removeChild(t)},l=o,i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(l=function(e,n){o(0,n),v.v.K(i.get("optionsAfterRender"),null,[n[0],e!==D?e:t])}),v.a.cc(e,f,function(n,s,o){return o.length&&(d=!c&&o[0].selected?[v.u.L(o[0])]:[],p=!0),s=e.ownerDocument.createElement("option"),n===D?(v.a.Ab(s,i.get("optionsCaption")),v.u.ya(s,t)):(o=r(n,i.get("optionsValue"),n),v.u.ya(s,v.a.c(o)),n=r(n,i.get("optionsText"),o),v.a.Ab(s,n)),[s]},n,l),v.v.K(function(){c?v.u.ya(e,v.a.c(i.get("value")),!0):(a?d.length&&s().length<d.length:d.length&&0<=e.selectedIndex?v.u.L(e.options[e.selectedIndex])!==d[0]:d.length||0<=e.selectedIndex)&&v.a.Fb(e,"change")}),v.a.vd(e),h&&20<Math.abs(h-e.scrollTop)&&(e.scrollTop=h)}},v.f.options.Yb=v.a.g.Z(),v.f.selectedOptions={after:["options","foreach"],init:function(t,e,n){v.a.H(t,"change",function(){var i=e(),s=[];v.a.C(t.getElementsByTagName("option"),function(t){t.selected&&s.push(v.u.L(t))}),v.m.$a(i,n,"selectedOptions",s)})},update:function(t,e){if("select"!=v.a.P(t))throw Error("values binding applies only to SELECT elements");var n=v.a.c(e()),i=t.scrollTop;n&&"number"==typeof n.length&&v.a.C(t.getElementsByTagName("option"),function(t){var e=0<=v.a.A(n,v.u.L(t));t.selected!=e&&v.a.Yc(t,e)}),t.scrollTop=i}},v.m.va.selectedOptions=!0,v.f.style={update:function(e,n){var i=v.a.c(n()||{});v.a.O(i,function(n,i){if(null!==(i=v.a.c(i))&&i!==t&&!1!==i||(i=""),o)o(e).css(n,i);else if(/^--/.test(n))e.style.setProperty(n,i);else{n=n.replace(/-(\w)/g,function(t,e){return e.toUpperCase()});var s=e.style[n];e.style[n]=i,i===s||e.style[n]!=s||isNaN(i)||(e.style[n]=i+"px")}})}},v.f.submit={init:function(t,e,n,i,s){if("function"!=typeof e())throw Error("The value for a submit binding must be a function");v.a.H(t,"submit",function(n){var i,r=e();try{i=r.call(s.$data,t)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},v.f.text={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){v.a.Ab(t,e())}},v.h.ea.text=!0,function(){if(i&&i.navigator){var e,n,s,r,o,a=function(t){if(t)return parseFloat(t[1])},h=i.navigator.userAgent;(e=i.opera&&i.opera.version&&parseInt(i.opera.version()))||(o=a(h.match(/Edge\/([^ ]+)$/)))||a(h.match(/Chrome\/([^ ]+)/))||(n=a(h.match(/Version\/([^ ]+) Safari/)))||(s=a(h.match(/Firefox\/([^ ]+)/)))||(r=v.a.W||a(h.match(/MSIE ([^ ]+)/)))||(r=a(h.match(/rv:([^ )]+)/)))}if(8<=r&&10>r)var l=v.a.g.Z(),c=v.a.g.Z(),u=function(t){var e=this.activeElement;(e=e&&v.a.g.get(e,c))&&e(t)},f=function(t,e){var n=t.ownerDocument;v.a.g.get(n,l)||(v.a.g.set(n,l,!0),v.a.H(n,"selectionchange",u)),v.a.g.set(t,c,e)};v.f.textInput={init:function(i,a,h){function l(t,e){v.a.H(i,t,e)}function c(){d||(p=i.value,d=v.a.setTimeout(u,4))}function u(){clearTimeout(d),p=d=t;var e=i.value;g!==e&&(g=e,v.m.$a(a(),h,"textInput",e))}var d,p,g=i.value,m=9==v.a.W?c:u,b=!1;r&&l("keypress",u),11>r&&l("propertychange",function(t){b||"value"!==t.propertyName||m(t)}),8==r&&(l("keyup",u),l("keydown",u)),f&&(f(i,m),l("dragend",c)),(!r||9<=r)&&l("input",m),5>n&&"textarea"===v.a.P(i)?(l("keydown",c),l("paste",c),l("cut",c)):11>e?l("keydown",c):4>s?(l("DOMAutoComplete",u),l("dragdrop",u),l("drop",u)):o&&"number"===i.type&&l("keydown",c),l("change",u),l("blur",u),v.o(function e(){var n=v.a.c(a());null!==n&&n!==t||(n=""),p!==t&&n===p?v.a.setTimeout(e,4):i.value!==n&&(b=!0,i.value=n,b=!1,g=i.value)},null,{l:i})}},v.m.va.textInput=!0,v.f.textinput={preprocess:function(t,e,n){n("textInput",t)}}}(),v.f.uniqueName={init:function(t,e){if(e()){var n="ko_unique_"+ ++v.f.uniqueName.qd;v.a.Xc(t,n)}}},v.f.uniqueName.qd=0,v.f.using={init:function(t,e,n,i,s){var r;return n.has("as")&&(r={as:n.get("as"),noChildContext:n.get("noChildContext")}),e=s.createChildContext(e,r),v.Pa(e,t),{controlsDescendantBindings:!0}}},v.h.ea.using=!0,v.f.value={after:["options","foreach"],init:function(e,n,i){var s=v.a.P(e),r="input"==s;if(!r||"checkbox"!=e.type&&"radio"!=e.type){var o=["change"],a=i.get("valueUpdate"),h=!1,l=null;a&&("string"==typeof a&&(a=[a]),v.a.gb(o,a),o=v.a.vc(o));var c,u=function(){l=null,h=!1;var t=n(),s=v.u.L(e);v.m.$a(t,i,"value",s)};!v.a.W||!r||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=v.a.A(o,"propertychange")||(v.a.H(e,"propertychange",function(){h=!0}),v.a.H(e,"focus",function(){h=!1}),v.a.H(e,"blur",function(){h&&u()})),v.a.C(o,function(t){var n=u;v.a.Td(t,"after")&&(n=function(){l=v.u.L(e),v.a.setTimeout(u,0)},t=t.substring(5)),v.a.H(e,t,n)}),c=r&&"file"==e.type?function(){var i=v.a.c(n());null===i||i===t||""===i?e.value="":v.v.K(u)}:function(){var r=v.a.c(n()),o=v.u.L(e);null!==l&&r===l?v.a.setTimeout(c,0):r===o&&o!==t||("select"===s?(o=i.get("valueAllowUnset"),v.u.ya(e,r,o),o||r===v.u.L(e)||v.v.K(u)):v.u.ya(e,r))},v.o(c,null,{l:e})}else v.eb(e,{checkedValue:n})},update:function(){}},v.m.va.value=!0,v.f.visible={update:function(t,e){var n=v.a.c(e()),i="none"!=t.style.display;n&&!i?t.style.display="":!n&&i&&(t.style.display="none")}},v.f.hidden={update:function(t,e){v.f.visible.update(t,function(){return!v.a.c(e())})}},function(t){v.f[t]={init:function(e,n,i,s,r){return v.f.event.init.call(this,e,function(){var e={};return e[t]=n(),e},i,s,r)}}}("click"),v.ca=function(){},v.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},v.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},v.ca.prototype.makeTemplateSource=function(t,e){if("string"==typeof t){var n=(e=e||s).getElementById(t);if(!n)throw Error("Cannot find template with ID "+t);return new v.B.D(n)}if(1==t.nodeType||8==t.nodeType)return new v.B.ia(t);throw Error("Unknown template type: "+t)},v.ca.prototype.renderTemplate=function(t,e,n,i){return t=this.makeTemplateSource(t,i),this.renderTemplateSource(t,e,n,i)},v.ca.prototype.isTemplateRewritten=function(t,e){return!1===this.allowTemplateRewriting||this.makeTemplateSource(t,e).data("isRewritten")},v.ca.prototype.rewriteTemplate=function(t,e,n){e=e((t=this.makeTemplateSource(t,n)).text()),t.text(e),t.data("isRewritten",!0)},v.b("templateEngine",v.ca),v.ic=function(){function t(t,e,n,i){t=v.m.Zb(t);for(var s=v.m.Ra,r=0;r<t.length;r++){var o=t[r].key;if(Object.prototype.hasOwnProperty.call(s,o)){var a=s[o];if("function"==typeof a){if(o=a(t[r].value))throw Error(o)}else if(!a)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+v.m.ub(t,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+e}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{wd:function(t,e,n){e.isTemplateRewritten(t,n)||e.rewriteTemplate(t,function(t){return v.ic.Kd(t,e)},n)},Kd:function(i,s){return i.replace(e,function(e,n,i,r,o){return t(o,n,i,s)}).replace(n,function(e,n){return t(n,"\x3c!-- ko --\x3e","#comment",s)})},ld:function(t,e){return v.aa.Wb(function(n,i){var s=n.nextSibling;s&&s.nodeName.toLowerCase()===e&&v.eb(s,t,i)})}}}(),v.b("__tr_ambtns",v.ic.ld),function(){v.B={},v.B.D=function(t){if(this.D=t){var e=v.a.P(t);this.Db="script"===e?1:"textarea"===e?2:"template"==e&&t.content&&11===t.content.nodeType?3:4}},v.B.D.prototype.text=function(){var t=1===this.Db?"text":2===this.Db?"value":"innerHTML";if(0==arguments.length)return this.D[t];var e=arguments[0];"innerHTML"===t?v.a.dc(this.D,e):this.D[t]=e};var e=v.a.g.Z()+"_";v.B.D.prototype.data=function(t){if(1===arguments.length)return v.a.g.get(this.D,e+t);v.a.g.set(this.D,e+t,arguments[1])};var n=v.a.g.Z();v.B.D.prototype.nodes=function(){var e=this.D;if(0==arguments.length){var i=v.a.g.get(e,n)||{},s=i.jb||(3===this.Db?e.content:4===this.Db?e:t);return s&&!i.hd||(i=this.text())&&(s=v.a.Ld(i,e.ownerDocument),this.text(""),v.a.g.set(e,n,{jb:s,hd:!0})),s}v.a.g.set(e,n,{jb:arguments[0]})},v.B.ia=function(t){this.D=t},v.B.ia.prototype=new v.B.D,v.B.ia.prototype.constructor=v.B.ia,v.B.ia.prototype.text=function(){if(0==arguments.length){var e=v.a.g.get(this.D,n)||{};return e.jc===t&&e.jb&&(e.jc=e.jb.innerHTML),e.jc}v.a.g.set(this.D,n,{jc:arguments[0]})},v.b("templateSources",v.B),v.b("templateSources.domElement",v.B.D),v.b("templateSources.anonymousTemplate",v.B.ia)}(),function(){function e(t,e,n){var i;for(e=v.h.nextSibling(e);t&&(i=t)!==e;)n(i,t=v.h.nextSibling(i))}function n(t,n){if(t.length){var i=t[0],s=t[t.length-1],r=i.parentNode,o=v.ga.instance,a=o.preprocessNode;if(a){if(e(i,s,function(t,e){var n=t.previousSibling,r=a.call(o,t);r&&(t===i&&(i=r[0]||e),t===s&&(s=r[r.length-1]||n))}),t.length=0,!i)return;i===s?t.push(i):(t.push(i,s),v.a.Ua(t,r))}e(i,s,function(t){1!==t.nodeType&&8!==t.nodeType||v.uc(n,t)}),e(i,s,function(t){1!==t.nodeType&&8!==t.nodeType||v.aa.bd(t,[n])}),v.a.Ua(t,r)}}function i(t){return t.nodeType?t:0<t.length?t[0]:null}function s(t,e,s,r,a){a=a||{};var h=(t&&i(t)||s||{}).ownerDocument,l=a.templateEngine||o;if(v.ic.wd(s,l,h),"number"!=typeof(s=l.renderTemplate(s,r,a,h)).length||0<s.length&&"number"!=typeof s[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(h=!1,e){case"replaceChildren":v.h.ua(t,s),h=!0;break;case"replaceNode":v.a.Wc(t,s),h=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return h&&(n(s,r),a.afterRender&&v.v.K(a.afterRender,null,[s,r[a.as||"$data"]]),"replaceChildren"==e&&v.j.Ga(t,v.j.T)),s}function r(t,e,n){return v.N(t)?t():"function"==typeof t?t(e,n):t}var o;v.ec=function(e){if(e!=t&&!(e instanceof v.ca))throw Error("templateEngine must inherit from ko.templateEngine");o=e},v.bc=function(e,n,a,h,l){if(((a=a||{}).templateEngine||o)==t)throw Error("Set a template engine before calling renderTemplate");if(l=l||"replaceChildren",h){var c=i(h);return v.$(function(){var t=n&&n instanceof v.fa?n:new v.fa(n,null,null,null,{exportDependencies:!0}),o=r(e,t.$data,t);t=s(h,l,o,t,a),"replaceNode"==l&&(c=i(h=t))},null,{Sa:function(){return!c||!v.a.Rb(c)},l:c&&"replaceNode"==l?c.parentNode:c})}return v.aa.Wb(function(t){v.bc(e,n,a,t,"replaceNode")})},v.Pd=function(e,i,o,a,h){function l(t,e){v.v.K(v.a.cc,null,[a,t,u,o,c,e]),v.j.Ga(a,v.j.T)}function c(t,e){n(e,f),o.afterRender&&o.afterRender(e,t),f=null}function u(t,n){f=h.createChildContext(t,{as:d,noChildContext:o.noChildContext,extend:function(t){t.$index=n,d&&(t[d+"Index"]=n)}});var i=r(e,t,f);return s(a,"ignoreTargetNode",i,f,o)}var f,d=o.as,p=!1===o.includeDestroyed||v.options.foreachHidesDestroyed&&!o.includeDestroyed;if(p||o.beforeRemove||!v.Oc(i))return v.$(function(){var e=v.a.c(i)||[];void 0===e.length&&(e=[e]),p&&(e=v.a.fb(e,function(e){return e===t||null===e||!v.a.c(e._destroy)})),l(e)},null,{l:a});l(i.w());var g=i.subscribe(function(t){l(i(),t)},null,"arrayChange");return g.l(a),g};var a=v.a.g.Z(),h=v.a.g.Z();v.f.template={init:function(t,e){var n=v.a.c(e());if("string"==typeof n||n.name)v.h.Ea(t);else if("nodes"in n){if(n=n.nodes||[],v.N(n))throw Error('The "nodes" option must be a plain, non-observable array.');var i=n[0]&&n[0].parentNode;i&&v.a.g.get(i,h)||(i=v.a.Xb(n),v.a.g.set(i,h,!0)),new v.B.ia(t).nodes(i)}else{if(!(0<(n=v.h.childNodes(t)).length))throw Error("Anonymous template defined, but no template content was provided");i=v.a.Xb(n),new v.B.ia(t).nodes(i)}return{controlsDescendantBindings:!0}},update:function(e,n,i,s,r){var o=n();i=!0,s=null,"string"==typeof(n=v.a.c(o))?n={}:(o=n.name,"if"in n&&(i=v.a.c(n.if)),i&&"ifnot"in n&&(i=!v.a.c(n.ifnot))),"foreach"in n?s=v.Pd(o||e,i&&n.foreach||[],n,e,r):i?(i=r,"data"in n&&(i=r.createChildContext(n.data,{as:n.as,noChildContext:n.noChildContext,exportDependencies:!0})),s=v.bc(o||e,i,n,e)):v.h.Ea(e),r=s,(n=v.a.g.get(e,a))&&"function"==typeof n.s&&n.s(),v.a.g.set(e,a,!r||r.ja&&!r.ja()?t:r)}},v.m.Ra.template=function(t){return 1==(t=v.m.Zb(t)).length&&t[0].unknown||v.m.Hd(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},v.h.ea.template=!0}(),v.b("setTemplateEngine",v.ec),v.b("renderTemplate",v.bc),v.a.Jc=function(t,e,n){var i,s,r,o,a;if(t.length&&e.length)for(i=s=0;(!n||i<n)&&(o=t[s]);++s){for(r=0;a=e[r];++r)if(o.value===a.value){o.moved=a.index,a.moved=o.index,e.splice(r,1),i=r=0;break}i+=r}},v.a.Ob=function(){function t(t,e,n,i,s){var r,o,a,h,l,c=Math.min,u=Math.max,f=[],d=t.length,p=e.length,g=p-d||1,m=d+p+1;for(r=0;r<=d;r++)for(h=a,f.push(a=[]),l=c(p,r+g),o=u(0,r-1);o<=l;o++)a[o]=o?r?t[r-1]===e[o-1]?h[o-1]:c(h[o]||m,a[o-1]||m)+1:o+1:r+1;for(c=[],u=[],g=[],r=d,o=p;r||o;)p=f[r][o]-1,o&&p===f[r][o-1]?u.push(c[c.length]={status:n,value:e[--o],index:o}):r&&p===f[r-1][o]?g.push(c[c.length]={status:i,value:t[--r],index:r}):(--o,--r,s.sparse||c.push({status:"retained",value:e[o]}));return v.a.Jc(g,u,!s.dontLimitMoves&&10*d),c.reverse()}return function(e,n,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},n=n||[],(e=e||[]).length<n.length?t(e,n,"added","deleted",i):t(n,e,"deleted","added",i)}}(),v.b("utils.compareArrays",v.a.Ob),function(){function e(e,n,i,s,r){var o=[],a=v.$(function(){var t=n(i,r,v.a.Ua(o,e))||[];0<o.length&&(v.a.Wc(o,t),s&&v.v.K(s,null,[i,t,r])),o.length=0,v.a.gb(o,t)},null,{l:e,Sa:function(){return!v.a.jd(o)}});return{Y:o,$:a.ja()?a:t}}var n=v.a.g.Z(),i=v.a.g.Z();v.a.cc=function(s,r,o,a,h,l){function c(t){d={Aa:t,nb:v.sa(T++)},w.push(d),E||_.push(d)}function u(t){d=b[t],T!==d.nb.w()&&C.push(d),d.nb(T++),v.a.Ua(d.Y,s),w.push(d)}function f(t,e){if(t)for(var n=0,i=e.length;n<i;n++)v.a.C(e[n].Y,function(i){t(i,n,e[n].Aa)})}void 0===(r=r||[]).length&&(r=[r]),a=a||{};var d,p,g,m,b=v.a.g.get(s,n),E=!b,w=[],y=0,T=0,N=[],S=[],x=[],C=[],_=[],I=0;if(E)v.a.C(r,c);else{if(!l||b&&b._countWaitingForRemove){var A=v.a.Mb(b,function(t){return t.Aa});l=v.a.Ob(A,r,{dontLimitMoves:a.dontLimitMoves,sparse:!0})}var O,k,D;for(A=0;O=l[A];A++)switch(k=O.moved,D=O.index,O.status){case"deleted":for(;y<D;)u(y++);k===t&&((d=b[y]).$&&(d.$.s(),d.$=t),v.a.Ua(d.Y,s).length&&(a.beforeRemove&&(w.push(d),I++,d.Aa===i?d=null:x.push(d)),d&&N.push.apply(N,d.Y))),y++;break;case"added":for(;T<D;)u(y++);k!==t?(S.push(w.length),u(k)):c(O.value)}for(;T<r.length;)u(y++);w._countWaitingForRemove=I}v.a.g.set(s,n,w),f(a.beforeMove,C),v.a.C(N,a.beforeRemove?v.na:v.removeNode);try{m=s.ownerDocument.activeElement}catch(t){}if(S.length)for(;(A=S.shift())!=t;){for(d=w[A],p=t;A;)if((g=w[--A].Y)&&g.length){p=g[g.length-1];break}for(r=0;y=d.Y[r];p=y,r++)v.h.Vb(s,y,p)}for(A=0,S=v.h.firstChild(s);d=w[A];A++){for(d.Y||v.a.extend(d,e(s,o,d.Aa,h,d.nb)),r=0;y=d.Y[r];S=y.nextSibling,p=y,r++)y!==S&&v.h.Vb(s,y,p);!d.Dd&&h&&(h(d.Aa,d.Y,d.nb),d.Dd=!0,p=d.Y[d.Y.length-1])}for(m&&s.ownerDocument.activeElement!=m&&m.focus(),f(a.beforeRemove,x),A=0;A<x.length;++A)x[A].Aa=i;f(a.afterMove,C),f(a.afterAdd,_)}}(),v.b("utils.setDomNodeChildrenFromArrayMapping",v.a.cc),v.ba=function(){this.allowTemplateRewriting=!1},v.ba.prototype=new v.ca,v.ba.prototype.constructor=v.ba,v.ba.prototype.renderTemplateSource=function(t,e,n,i){return(e=9>v.a.W||!t.nodes?null:t.nodes())?v.a.la(e.cloneNode(!0).childNodes):(t=t.text(),v.a.ta(t,i))},v.ba.Na=new v.ba,v.ec(v.ba.Na),v.b("nativeTemplateEngine",v.ba),function(){v.Za=function(){var t=this.Gd=function(){if(!o||!o.tmpl)return 0;try{if(0<=o.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(t){}return 1}();this.renderTemplateSource=function(e,n,i,r){if(r=r||s,i=i||{},2>t)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var a=e.data("precompiled");return a||(a=e.text()||"",a=o.template(null,"{{ko_with $item.koBindingContext}}"+a+"{{/ko_with}}"),e.data("precompiled",a)),e=[n.$data],n=o.extend({koBindingContext:n},i.templateOptions),(n=o.tmpl(a,e,n)).appendTo(r.createElement("div")),o.fragments={},n},this.createJavaScriptEvaluatorBlock=function(t){return"{{ko_code ((function() { return "+t+" })()) }}"},this.addTemplate=function(t,e){s.write("<script type='text/html' id='"+t+"'>"+e+"<\/script>")},0<t&&(o.tmpl.tag.ko_code={open:"__.push($1 || '');"},o.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},v.Za.prototype=new v.ca,v.Za.prototype.constructor=v.Za;var t=new v.Za;0<t.Gd&&v.ec(t),v.b("jqueryTmplTemplateEngine",v.Za)}()})}()},{}],2:[function(t,e,n){var i,s;i=window,s=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){"use strict";n.d(e,"m",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"o",function(){return l}),n.d(e,"w",function(){return u}),n.d(e,"k",function(){return f}),n.d(e,"f",function(){return p}),n.d(e,"r",function(){return g}),n.d(e,"i",function(){return m}),n.d(e,"h",function(){return b}),n.d(e,"g",function(){return E}),n.d(e,"a",function(){return w}),n.d(e,"l",function(){return v}),n.d(e,"j",function(){return T}),n.d(e,"b",function(){return N}),n.d(e,"e",function(){return S}),n.d(e,"c",function(){return x}),n.d(e,"x",function(){return C}),n.d(e,"n",function(){return _}),n.d(e,"t",function(){return I}),n.d(e,"s",function(){return A}),n.d(e,"q",function(){return O}),n.d(e,"p",function(){return k}),n.d(e,"u",function(){return D}),n.d(e,"v",function(){return R});var i=n(1),s=n(4);class r{S(t){for(let e=0;e<t.length;e++)t[e].visit(this)}T(t){throw new Error("E_CSS_EMPTY_NOT_ALLOWED")}_(t){throw new Error("E_CSS_SLASH_NOT_ALLOWED")}R(t){throw new Error("E_CSS_STR_NOT_ALLOWED")}$(t){throw new Error("E_CSS_IDENT_NOT_ALLOWED")}U(t){throw new Error("E_CSS_NUMERIC_NOT_ALLOWED")}V(t){throw new Error("E_CSS_NUM_NOT_ALLOWED")}X(t){return this.V(t)}W(t){throw new Error("E_CSS_COLOR_NOT_ALLOWED")}Y(t){throw new Error("E_CSS_URL_NOT_ALLOWED")}Z(t){throw new Error("E_CSS_LIST_NOT_ALLOWED")}tt(t){throw new Error("E_CSS_COMMA_NOT_ALLOWED")}et(t){throw new Error("E_CSS_FUNC_NOT_ALLOWED")}st(t){throw new Error("E_CSS_EXPR_NOT_ALLOWED")}}class o extends r{constructor(){super()}S(t){let e=null;for(let n=0;n<t.length;n++){const i=t[n],s=i.visit(this);if(e)e[n]=s;else if(i!==s){e=new Array(t.length);for(let i=0;i<n;i++)e[i]=t[i];e[n]=s}}return e||t}R(t){return t}$(t){return t}_(t){return t}U(t){return t}V(t){return t}X(t){return t}W(t){return t}Y(t){return t}Z(t){const e=this.S(t.values);return e===t.values?t:new T(e)}tt(t){const e=this.S(t.values);return e===t.values?t:new N(e)}et(t){const e=this.S(t.values);return e===t.values?t:new S(t.name,e)}st(t){return t}}class a{toString(){const t=new i.d;return this.it(t,!0),t.toString()}stringValue(){const t=new i.d;return this.it(t,!1),t.toString()}nt(t,e){throw new Error("F_ABSTRACT")}it(t,e){t.append("[error]")}rt(){return!1}ot(){return!1}ht(){return!1}ct(){return!1}lt(){return!1}visit(t){throw new Error("F_ABSTRACT")}}class h extends a{static get instance(){return this.empty||(this.empty=new h),this.empty}constructor(){super()}nt(t,e){return new s.f(t,"")}it(t,e){}visit(t){return t.T(this)}}const l=h.instance;class c extends a{static get instance(){return this.slash||(this.slash=new c),this.slash}constructor(){super()}nt(t,e){return new s.f(t,"/")}it(t,e){t.append("/")}visit(t){return t._(this)}}const u=c.instance;class f extends a{constructor(t){super(),this.str=t}nt(t,e){return new s.f(t,this.str)}it(t,e){e?(t.append('"'),t.append(i.q(this.str)),t.append('"')):t.append(this.str)}visit(t){return t.R(this)}}const d={};class p extends a{constructor(t){if(super(),this.name=t,d[t])throw new Error("E_INVALID_CALL");d[t]=this}nt(t,e){return new s.f(t,this.name)}it(t,e){e?t.append(i.p(this.name)):t.append(this.name)}visit(t){return t.$(this)}ct(){return!0}}function g(t){let e=d[t];return e||(e=new p(t)),e}class m extends a{constructor(t,e){super(),this.num=t,this.unit=e.toLowerCase()}nt(t,e){return 0==this.num?t.zero:e&&"%"==this.unit?100==this.num?e:new s.r(t,e,new s.f(t,this.num/100)):new s.x(t,this.num,this.unit)}it(t,e){t.append(this.num.toString()),t.append(this.unit)}visit(t){return t.U(this)}ot(){return!0}}class b extends a{constructor(t){super(),this.num=t}nt(t,e){return 0==this.num?t.zero:1==this.num?t.one:new s.f(t,this.num)}it(t,e){t.append(this.num.toString())}visit(t){return t.V(this)}ht(){return!0}}class E extends b{constructor(t){super(t)}visit(t){return t.X(this)}}class w extends a{constructor(t){super(),this.rgb=t}it(t,e){t.append("#");const n=this.rgb.toString(16);t.append("000000".substr(n.length)),t.append(n)}visit(t){return t.W(this)}}class v extends a{constructor(t){super(),this.url=t}it(t,e){t.append('url("'),t.append(i.q(this.url)),t.append('")')}visit(t){return t.Y(this)}}function y(t,e,n,i){const s=e.length;e[0].it(t,i);for(let r=1;r<s;r++)t.append(n),e[r].it(t,i)}class T extends a{constructor(t){super(),this.values=t}it(t,e){y(t,this.values," ",e)}visit(t){return t.Z(this)}lt(){return!0}}class N extends a{constructor(t){super(),this.values=t}it(t,e){y(t,this.values,",",e)}visit(t){return t.tt(this)}}class S extends a{constructor(t,e){super(),this.name=t,this.values=e}it(t,e){t.append(i.p(this.name)),t.append("("),y(t,this.values,",",e),t.append(")")}visit(t){return t.et(this)}}class x extends a{constructor(t){super(),this.expr=t}nt(){return this.expr}it(t,e){t.append("-epubx-expr("),this.expr.it(t,0),t.append(")")}visit(t){return t.st(this)}rt(){return!0}}function C(t,e){if(t){if(t.ot()){const n=t;return e.ut(n.unit,!1)*n.num}if(t.ht())return t.num}return 0}function _(t,e){return new m(C(t,e),"px")}const I={absolute:g("absolute"),all:g("all"),always:g("always"),auto:g("auto"),avoid:g("avoid"),balance:g("balance"),balance_all:g("balance-all"),block:g("block"),block_end:g("block-end"),block_start:g("block-start"),both:g("both"),bottom:g("bottom"),border_box:g("border-box"),break_all:g("break-all"),break_word:g("break-word"),crop:g("crop"),cross:g("cross"),column:g("column"),exclusive:g("exclusive"),_false:g("false"),fixed:g("fixed"),flex:g("flex"),footnote:g("footnote"),footer:g("footer"),header:g("header"),hidden:g("hidden"),horizontal_tb:g("horizontal-tb"),inherit:g("inherit"),inline:g("inline"),inline_block:g("inline-block"),inline_end:g("inline-end"),inline_start:g("inline-start"),landscape:g("landscape"),left:g("left"),line:g("line"),list_item:g("list-item"),ltr:g("ltr"),manual:g("manual"),none:g("none"),normal:g("normal"),oeb_page_foot:g("oeb-page-foot"),oeb_page_head:g("oeb-page-head"),page:g("page"),relative:g("relative"),right:g("right"),same:g("same"),scale:g("scale"),snap_block:g("snap-block"),spread:g("spread"),_static:g("static"),rtl:g("rtl"),table:g("table"),table_caption:g("table-caption"),table_cell:g("table-cell"),table_footer_group:g("table-footer-group"),table_header_group:g("table-header-group"),table_row:g("table-row"),top:g("top"),transparent:g("transparent"),vertical_lr:g("vertical-lr"),vertical_rl:g("vertical-rl"),visible:g("visible"),_true:g("true")},A=new m(100,"%"),O=new m(100,"pvw"),k=new m(100,"pvh"),D=new m(0,"px"),L={"font-size":1,color:2};function R(t,e){return(L[t]||Number.MAX_VALUE)-(L[e]||Number.MAX_VALUE)}},function(t,e,n){"use strict";n.d(e,"o",function(){return s}),n.d(e,"H",function(){return r}),n.d(e,"I",function(){return o}),n.d(e,"h",function(){return a}),n.d(e,"E",function(){return h}),n.d(e,"D",function(){return l}),n.d(e,"G",function(){return c}),n.d(e,"C",function(){return u}),n.d(e,"n",function(){return f}),n.d(e,"a",function(){return d}),n.d(e,"g",function(){return p}),n.d(e,"b",function(){return g}),n.d(e,"v",function(){return w}),n.d(e,"F",function(){return v}),n.d(e,"t",function(){return y}),n.d(e,"u",function(){return T}),n.d(e,"d",function(){return N}),n.d(e,"p",function(){return x}),n.d(e,"q",function(){return C}),n.d(e,"y",function(){return _}),n.d(e,"x",function(){return I}),n.d(e,"r",function(){return A}),n.d(e,"s",function(){return O}),n.d(e,"J",function(){return k}),n.d(e,"i",function(){return D}),n.d(e,"B",function(){return L}),n.d(e,"e",function(){return P}),n.d(e,"w",function(){return M}),n.d(e,"f",function(){return F}),n.d(e,"A",function(){return U}),n.d(e,"z",function(){return z}),n.d(e,"c",function(){return B}),n.d(e,"m",function(){return $}),n.d(e,"j",function(){return j}),n.d(e,"k",function(){return G}),n.d(e,"l",function(){return Q});var i=n(6);let s={};function r(t){return JSON.parse(t)}function o(t){const e=t.match(/^([^#]*)/);return e?e[1]:t}let a=window.location.href;function h(t){a=t}let l=window.location.href;function c(t){l=t}function u(t,e){if(e.startsWith("data:"))return t||e;if(!e||t.match(/^\w{2,}:/))return t.toLowerCase().match("^javascript:")?"#":(t.match(/^\w{2,}:\/\/[^\/]+$/)&&(t=`${t}/`),t);let n;if(e.match(/^\w{2,}:\/\/[^\/]+$/)&&(e=`${e}/`),t.match(/^\/\//))return(n=e.match(/^(\w{2,}:)\/\//))?n[1]+t:t;if(t.match(/^\//))return(n=e.match(/^(\w{2,}:\/\/[^\/]+)\//))?n[1]+t:t;if(t.match(/^\.(\/|$)/)&&(t=t.substr(2)),e=function(t){const e=t.match(/^([^#?]*)/);return e?e[1]:t}(e),t.match(/^#/))return e+t;let i=e.lastIndexOf("/");if(i<0)return t;if(i<e.length-1&&e.lastIndexOf(".")<i){if(""==t)return e;i=(e+="/").length-1}let s=e.substr(0,i+1)+t;for(;!((i=s.indexOf("/../"))<=0);){const t=s.lastIndexOf("/",i-1);if(t<=0)break;s=s.substr(0,t)+s.substr(i+3)}return s.replace(/\/(\.\/)+/g,"/")}function f(t){let e;return(e=/^(https?:)\/\/github\.com\/([^\/]+\/[^\/]+)\/(blob\/|tree\/|raw\/)?(.*)$/.exec(t))?t=`${e[1]}//raw.githubusercontent.com/${e[2]}/${e[3]?"":"master/"}${e[4]}`:(e=/^(https?:)\/\/www\.aozora\.gr\.jp\/(cards\/[^\/]+\/files\/[^\/.]+\.html)$/.exec(t))?t=`${e[1]}//raw.githubusercontent.com/aozorabunko/aozorabunko/master/${e[2]}`:(e=/^(https?:)\/\/gist\.github\.com\/([^\/]+\/\w+)(\/|$)(raw(\/|$))?(.*)$/.exec(t))?t=`${e[1]}//gist.githubusercontent.com/${e[2]}/raw/${e[6]}`:(e=/^(https?:)\/\/(?:[^\/.]+\.)?jsbin\.com\/(?!(?:blog|help)\b)(\w+)((\/\d+)?).*$/.exec(t))&&(t=`${e[1]}//output.jsbin.com/${e[2]}${e[3]}/`),t}var d;function p(t){return null==t?t:t.toString()}!function(t){t.FB2="http://www.gribuser.ru/xml/fictionbook/2.0",t.epub="http://www.idpf.org/2007/ops",t.EV="http://www.w3.org/2001/xml-events",t.MATHML="http://www.w3.org/1998/Math/MathML",t.XML="http://www.w3.org/XML/1998/namespace",t.XHTML="http://www.w3.org/1999/xhtml",t.XLINK="http://www.w3.org/1999/xlink",t.SHADOW="http://www.pyroxy.com/ns/shadow",t.SVG="http://www.w3.org/2000/svg",t.DC="http://purl.org/dc/elements/1.1/",t.NCX="http://www.daisy.org/z3986/2005/ncx/",t.SSE="http://example.com/sse"}(d||(d={}));class g{constructor(){this.queue=[null]}length(){return this.queue.length-1}add(t){let e=this.queue.length;for(;e>1;){const n=Math.floor(e/2),i=this.queue[n];if(i.compare(t)>0)return void(this.queue[e]=t);this.queue[e]=i,e=n}this.queue[1]=t}peek(){return this.queue[1]}remove(){const t=this.queue[1],e=this.queue.pop(),n=this.queue.length;if(n>1){let t=1;for(;;){let i=2*t;if(i>=n)break;if(this.queue[i].compare(e)>0)i+1<n&&this.queue[i+1].compare(this.queue[i])>0&&i++;else{if(!(i+1<n&&this.queue[i+1].compare(e)>0))break;i++}this.queue[t]=this.queue[i],t=i}this.queue[t]=e}return t}}const m=["","-webkit-","-moz-","-ms-","-o-","-epub-"],b={};function E(t,e){if("writing-mode"===e){const n=document.createElement("span");return"-ms-"===t?(n.style.setProperty(t+e,"tb-rl"),"tb-rl"===n.style["writing-mode"]):(n.style.setProperty(t+e,"vertical-rl"),"vertical-rl"===n.style[t+e])}return"string"==typeof document.documentElement.style[function(t,e){return t&&(e=`-${e}`,"moz"===(t=t.replace(/-/g,""))&&(t="Moz")),t+e.replace(/-[a-z]/g,t=>t.substr(1).toUpperCase())}(t,e)]}function w(t){let e=b[t];if(e||null===e)return e;switch(t){case"text-combine-upright":if(E("-webkit-","text-combine")&&!E("","text-combine-upright"))return b[t]=["-webkit-text-combine"],["-webkit-text-combine"];break;case"writing-mode":if(E("-ms-","writing-mode"))return b[t]=["-ms-writing-mode"],["-ms-writing-mode"];break;case"filter":if(E("-webkit-","filter"))return b[t]=["-webkit-filter"],["-webkit-filter"];break;case"clip-path":if(E("-webkit-","clip-path"))return b[t]=["-webkit-clip-path","clip-path"];break;case"margin-inline-start":if(E("-webkit-","margin-start"))return b[t]=["-webkit-margin-start"],["-webkit-margin-start"];break;case"margin-inline-end":if(E("-webkit-","margin-end"))return b[t]=["-webkit-margin-end"],["-webkit-margin-end"];break;case"padding-inline-start":if(E("-webkit-","padding-start"))return b[t]=["-webkit-padding-start"],["-webkit-padding-start"];break;case"padding-inline-end":if(E("-webkit-","padding-end"))return b[t]=["-webkit-padding-end"],["-webkit-padding-end"]}for(const n of m)if(E(n,t))return e=n+t,b[t]=[e],[e];return i.b.warn("Property not supported by the browser: ",t),b[t]=null,null}function v(t,e,n){try{const s=w(e);if(!s)return;s.forEach(e=>{if("-ms-writing-mode"===e)switch(n){case"horizontal-tb":n="lr-tb";break;case"vertical-rl":n="tb-rl";break;case"vertical-lr":n="tb-lr"}else if("-webkit-text-combine"===e)switch(n){case"all":n="horizontal"}t&&t.style&&t.style.setProperty(e,n)})}catch(t){i.b.warn(t)}}function y(t,e,n){try{const n=b[e];return t.style.getPropertyValue(n?n[0]:e)}catch(t){}return n||""}function T(t){let e=t.getAttributeNS(d.XML,"lang");return e||t.namespaceURI!=d.XHTML||(e=t.getAttribute("lang")),e}class N{constructor(){this.list=[]}append(t){return this.list.push(t),this}clear(){this.list=[]}toString(){const t=this.list.join("");return this.list=[t],t}}function S(t){return`\\${t.charCodeAt(0).toString(16)} `}function x(t){return t.replace(/[^-_a-zA-Z0-9\u0080-\uFFFF]/g,S)}function C(t){return t.replace(/[\u0000-\u001F"\\]/g,S)}function _(t){return t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent)}function I(t){return!!t.match(/^[a-zA-Z\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u024F\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]$/)}function A(t,e){return t.replace(/[^-a-zA-Z0-9_]/g,function(t){return function(t,e){return(e="string"==typeof e?e:"\\u")+(65536|t.charCodeAt(0)).toString(16).substr(1)}(t,e)})}function O(t){return A(t)}function k(t,e){e="string"==typeof e?e:"\\u";const n=new RegExp(`${O(e)}[0-9a-fA-F]{4}`,"g");return t.replace(n,function(t){return function(t,e){return e="string"==typeof e?e:"\\u",0===t.indexOf(e)?String.fromCharCode(parseInt(t.substring(e.length),16)):t}(t,e)})}function D(t,e){let n=0,i=t;for(;;){if(n==i)return n;const t=n+i>>1;e(t)?i=t:n=t+1}}function L(t,e){return t-e}const R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function P(t,e){const n=e.length,i=3*Math.floor(n/3);for(let n=0;n<i;n+=3){const i=255&e.charCodeAt(n),s=255&e.charCodeAt(n+1),r=255&e.charCodeAt(n+2);t.append(R.charAt(i>>2)),t.append(R.charAt(63&(i<<4|s>>4))),t.append(R.charAt(63&(s<<2|r>>6))),t.append(R.charAt(63&r))}switch(n-i){case 1:{const n=255&e.charCodeAt(i);t.append(R.charAt(n>>2)),t.append(R.charAt(n<<4&63)),t.append("==");break}case 2:{const n=255&e.charCodeAt(i),s=255&e.charCodeAt(i+1);t.append(R.charAt(n>>2)),t.append(R.charAt(63&(n<<4|s>>4))),t.append(R.charAt(s<<2&63)),t.append("=");break}}}function M(t,e){const n={};for(const i of t){const t=e(i);t&&!n[t]&&(n[t]=i)}return n}function F(t){const e={};for(let n=0;n<t.length;n++)e[t[n]]=!0;return e}function U(t,e){const n={};for(const i of t){const t=e(i);t&&(n[t]?n[t].push(i):n[t]=[i])}return n}function z(t,e){const n={};for(const i in t)n[i]=e(t[i],i);return n}class B{constructor(){this.listeners={}}dispatchEvent(t){const e=this.listeners[t.type];if(e){t.target=this,t.currentTarget=this;for(let n=0;n<e.length;n++)e[n](t)}}addEventListener(t,e,n){if(n)return;const i=this.listeners[t];i?i.push(e):this.listeners[t]=[e]}removeEventListener(t,e,n){if(n)return;const i=this.listeners[t];if(i){const t=i.indexOf(e);t>=0&&i.splice(t,1)}}}let V=null;function $(t){if(null==V){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="100px",n.style.height="100px",n.style.overflow="hidden",n.style.lineHeight="16px",n.style.fontSize="16px",v(n,"writing-mode","vertical-rl"),t.appendChild(n);const i=e.createTextNode("a a a a a a a a a a a a a a a a");n.appendChild(i);const s=e.createRange();s.setStart(i,0),s.setEnd(i,1);const r=s.getBoundingClientRect();V=r.right-r.left<10,t.removeChild(n)}return V}let H=null;function j(t){if(null===H){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="30px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a | ");n.appendChild(i);const s=e.createElement("span");s.style.display="inline-block",s.style.width="30px",n.appendChild(s);const r=e.createRange();r.setStart(i,0),r.setEnd(i,3);const o=r.getBoundingClientRect();H=o.right<27,t.removeChild(n)}return H}let X=null;function G(t){if(null===X){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a a-");n.appendChild(i);const s=e.createElement("span");s.style.display="inline-block",s.style.width="40px",n.appendChild(s);const r=e.createRange();r.setStart(i,2),r.setEnd(i,4);const o=r.getBoundingClientRect();X=o.right<37,t.removeChild(n)}return X}let W=null;function Q(t){if(null===W){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a a-");n.appendChild(i),n.appendChild(e.createElement("wbr"));const s=e.createElement("span");s.style.display="inline-block",s.style.width="40px",n.appendChild(s);const r=e.createRange();r.setStart(i,2),r.setEnd(i,4);const o=r.getBoundingClientRect();W=o.right<37,t.removeChild(n)}return W}},function(t,e,n){"use strict";function i(t){if((t=t.substr(1)).match(/^[^0-9a-fA-F\n\r]$/))return t;const e=parseInt(t,16);return isNaN(e)?"":e<=65535?String.fromCharCode(e):e<=1114111?String.fromCharCode(55296|e>>10&1023,56320|1023&e):"�"}function s(t){return t.replace(/\\([0-9a-fA-F]{0,6}(\r\n|[ \n\r\t\f])?|[^0-9a-fA-F\n\r])/g,i)}var r,o;n.d(e,"a",function(){return r}),n.d(e,"b",function(){return U}),function(t){t[t.EOF=0]="EOF",t[t.IDENT=1]="IDENT",t[t.STR=2]="STR",t[t.NUMERIC=3]="NUMERIC",t[t.NUM=4]="NUM",t[t.INT=5]="INT",t[t.FUNC=6]="FUNC",t[t.HASH=7]="HASH",t[t.URL=8]="URL",t[t.CLASS=9]="CLASS",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.O_BRC=12]="O_BRC",t[t.C_BRC=13]="C_BRC",t[t.O_BRK=14]="O_BRK",t[t.C_BRK=15]="C_BRK",t[t.COMMA=16]="COMMA",t[t.SEMICOL=17]="SEMICOL",t[t.COLON=18]="COLON",t[t.SLASH=19]="SLASH",t[t.AT=20]="AT",t[t.PERCENT=21]="PERCENT",t[t.QMARK=22]="QMARK",t[t.PLUS=23]="PLUS",t[t.MINUS=24]="MINUS",t[t.BAR_BAR=25]="BAR_BAR",t[t.AMP_AMP=26]="AMP_AMP",t[t.BANG=31]="BANG",t[t.DOLLAR=32]="DOLLAR",t[t.HAT=33]="HAT",t[t.BAR=34]="BAR",t[t.TILDE=35]="TILDE",t[t.STAR=36]="STAR",t[t.GT=37]="GT",t[t.LT=38]="LT",t[t.EQ=39]="EQ",t[t.BANG_EQ=41]="BANG_EQ",t[t.DOLLAR_EQ=42]="DOLLAR_EQ",t[t.HAT_EQ=43]="HAT_EQ",t[t.BAR_EQ=44]="BAR_EQ",t[t.TILDE_EQ=45]="TILDE_EQ",t[t.STAR_EQ=46]="STAR_EQ",t[t.GT_EQ=47]="GT_EQ",t[t.LT_EQ=48]="LT_EQ",t[t.EQ_EQ=49]="EQ_EQ",t[t.COL_COL=50]="COL_COL",t[t.INVALID=51]="INVALID",t[t.LAST=51]="LAST"}(r||(r={}));class a{constructor(){this.at=!1,this.num=0,this.text="",this.position=0,this.type=r.EOF}}function h(t,e){const n=Array(128);let i;for(i=0;i<128;i++)n[i]=t;for(n.NaN=t==o.END?o.END:o.INVALID,i=0;i<e.length;i+=2)n[e[i]]=e[i+1];return n}!function(t){t[t.SPACE=1]="SPACE",t[t.INT=2]="INT",t[t.IDENT=3]="IDENT",t[t.BANG=4]="BANG",t[t.HASH=6]="HASH",t[t.DOLLAR=7]="DOLLAR",t[t.PERCENT=8]="PERCENT",t[t.AMP=9]="AMP",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.STAR=12]="STAR",t[t.PLUS=13]="PLUS",t[t.COMMA=14]="COMMA",t[t.MINUS=15]="MINUS",t[t.DOT=16]="DOT",t[t.SLASH=17]="SLASH",t[t.COLON=18]="COLON",t[t.SEMICOL=19]="SEMICOL",t[t.LT=20]="LT",t[t.EQ=21]="EQ",t[t.GT=22]="GT",t[t.QMARK=23]="QMARK",t[t.AT=24]="AT",t[t.O_BRK=25]="O_BRK",t[t.C_BRK=26]="C_BRK",t[t.O_BRC=27]="O_BRC",t[t.C_BRC=28]="C_BRC",t[t.BSLASH=29]="BSLASH",t[t.HAT=30]="HAT",t[t.BAR=31]="BAR",t[t.TILDE=32]="TILDE",t[t.STR1=33]="STR1",t[t.STR2=34]="STR2",t[t.END=35]="END",t[t.EQTAIL=36]="EQTAIL",t[t.ENDINT=37]="ENDINT",t[t.ENDNUM=38]="ENDNUM",t[t.CONT=39]="CONT",t[t.UNIT=40]="UNIT",t[t.PCUNIT=41]="PCUNIT",t[t.NUMBER=42]="NUMBER",t[t.ENDIDNT=43]="ENDIDNT",t[t.IDNTESC=44]="IDNTESC",t[t.ENDIDES=45]="ENDIDES",t[t.ENDSTR=46]="ENDSTR",t[t.ENDESTR=47]="ENDESTR",t[t.STR1ESC=48]="STR1ESC",t[t.STR2ESC=49]="STR2ESC",t[t.BAR_BAR=50]="BAR_BAR",t[t.AMP_AMP=51]="AMP_AMP",t[t.FUNC=52]="FUNC",t[t.FUNCES=53]="FUNCES",t[t.COMMENT=54]="COMMENT",t[t.COMMST=55]="COMMST",t[t.ENDNOTK=56]="ENDNOTK",t[t.MINMIN=57]="MINMIN",t[t.TOINT=58]="TOINT",t[t.TONUM=59]="TONUM",t[t.TOIDENT=60]="TOIDENT",t[t.TOIDES=61]="TOIDES",t[t.KILL1=62]="KILL1",t[t.KILL2=63]="KILL2",t[t.URL=64]="URL",t[t.URL1=65]="URL1",t[t.URL2=66]="URL2",t[t.ENDURL=67]="ENDURL",t[t.TERMURL=68]="TERMURL",t[t.FINURL=69]="FINURL",t[t.LT_BG=70]="LT_BG",t[t.LT_BG_M=71]="LT_BG_M",t[t.INVALID=72]="INVALID",t[t.CHKPOSS=73]="CHKPOSS",t[t.CHKPOSN=74]="CHKPOSN",t[t.URLESC=75]="URLESC",t[t.IDESCH=76]="IDESCH",t[t.COL_COL=77]="COL_COL",t[t.TOCLASS=78]="TOCLASS",t[t.CHKSP=79]="CHKSP",t[t.EOF=80]="EOF"}(o||(o={}));const l=[o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.SPACE,o.SPACE,o.INVALID,o.SPACE,o.SPACE,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.SPACE,o.BANG,o.STR2,o.HASH,o.DOLLAR,o.PERCENT,o.AMP,o.STR1,o.O_PAR,o.C_PAR,o.STAR,o.PLUS,o.COMMA,o.MINUS,o.DOT,o.SLASH,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.COLON,o.SEMICOL,o.LT,o.EQ,o.GT,o.QMARK,o.AT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.O_BRK,o.BSLASH,o.C_BRK,o.HAT,o.IDENT,o.INVALID,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.O_BRC,o.BAR,o.C_BRC,o.TILDE,o.INVALID];l.NaN=o.EOF;const c=[o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.FUNC,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.IDNTESC,o.ENDIDNT,o.ENDIDNT,o.CONT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT];c.NaN=o.ENDIDNT;const u=[o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.TOCLASS,o.TONUM,o.INVALID,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.INVALID,o.TOIDES,o.INVALID,o.INVALID,o.TOCLASS,o.INVALID,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID];c.NaN=o.ENDIDNT;const f=[o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.MINMIN,o.TONUM,o.END,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.END,o.TOIDES,o.END,o.END,o.TOIDENT,o.END,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.END,o.END,o.END,o.END,o.END];f.NaN=o.END;const d=[o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CHKPOSS,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CHKPOSS,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.FUNCES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.IDNTESC,o.ENDIDES,o.ENDIDES,o.CONT,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES];d.NaN=o.ENDIDES;const p=[o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.PCUNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.NUMBER,o.ENDINT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.UNIT,o.ENDINT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT];p.NaN=o.ENDINT;const g=[o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.PCUNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.UNIT,o.ENDNUM,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM];g.NaN=o.ENDNUM;const m=h(o.END,[61,o.EQTAIL]),b=h(o.END,[58,o.COL_COL]),E=h(o.END,[61,o.EQTAIL,124,o.BAR_BAR]),w=h(o.END,[38,o.AMP_AMP]),v=h(o.END,[42,o.COMMENT]),y=h(o.CONT,[42,o.COMMST]),T=h(o.COMMENT,[42,o.COMMST,47,o.ENDNOTK]),N=h(o.KILL1,[62,o.ENDNOTK]),S=h(o.END,[61,o.EQTAIL,33,o.LT_BG]),x=h(o.KILL1,[45,o.LT_BG_M]),C=h(o.KILL2,[45,o.ENDNOTK]),_=h(o.IDESCH,[9,o.INVALID,10,o.INVALID,13,o.INVALID,32,o.INVALID]),I=h(o.CONT,[39,o.ENDSTR,10,o.INVALID,13,o.INVALID,92,o.STR1ESC]),A=h(o.CONT,[34,o.ENDSTR,10,o.INVALID,13,o.INVALID,92,o.STR2ESC]),O=h(o.CONT,[39,o.ENDESTR,10,o.CHKPOSN,13,o.CHKPOSN,92,o.STR1ESC]),k=h(o.CONT,[34,o.ENDESTR,10,o.CHKPOSN,13,o.CHKPOSN,92,o.STR2ESC]),D=h(o.URL,[9,o.CONT,32,o.CONT,34,o.URL2,39,o.URL1,41,o.INVALID,10,o.CONT,13,o.CONT]),L=h(o.CONT,[41,o.ENDURL,9,o.CHKSP,10,o.CHKSP,13,o.CHKSP,32,o.CHKSP,92,o.URLESC,40,o.INVALID,91,o.INVALID,93,o.INVALID,123,o.INVALID,125,o.INVALID,NaN,o.ENDURL]),R=h(o.CONT,[39,o.TERMURL,10,o.CHKPOSN,13,o.CHKPOSN,92,o.URLESC,NaN,o.ENDURL]),P=h(o.CONT,[34,o.TERMURL,10,o.CHKPOSN,13,o.CHKPOSN,92,o.URLESC,NaN,o.ENDURL]),M=h(o.INVALID,[9,o.CONT,10,o.CONT,13,o.CONT,32,o.CONT,41,o.FINURL]),F=15;class U{constructor(t,e){this.input=t,this.handler=e,this.head=-1,this.tail=0,this.curr=0,this.position=0,this.ft=F,this.buffer=Array(this.ft+1);for(let t=0;t<=this.ft;t++)this.buffer[t]=new a}token(){return this.tail==this.curr&&this.dt(),this.buffer[this.curr]}wt(t){return(this.tail-this.curr&this.ft)<=t&&this.dt(),this.buffer[this.curr+t&this.ft]}consume(){this.curr=this.curr+1&this.ft}mark(){if(this.head>=0)throw new Error("F_CSSTOK_BAD_CALL mark");this.head=this.curr}reset(){if(this.head<0)throw new Error("F_CSSTOK_BAD_CALL reset");this.curr=this.head,this.head=-1}unmark(){this.head=-1}gt(){return this.head>=0}reallocate(){const t=2*(this.ft+1)-1,e=Array(t+1);let n=this.head,i=0;for(;n!=this.tail;)e[i]=this.buffer[n],n==this.curr&&(this.curr=i),n=n+1&this.ft,i++;for(this.head=0,this.tail=i,this.ft=t,this.buffer=e;i<=t;)e[i++]=new a}error(t,e,n){this.handler&&this.handler.error(n,e)}dt(){let t=this.tail,e=this.head>=0?this.head:this.curr,n=this.ft;if(t>=e?e+=n:e--,e==t){if(this.head<0)throw new Error("F_CSSTOK_INTERNAL");this.reallocate(),t=this.tail,e=n=this.ft}let i=l;const a=this.input;let h=this.position;const F=this.buffer;let U=r.EOF,z=0,B="",V=0,$=!1,H=F[t],j=-9;for(;;){const X=a.charCodeAt(h);switch(i[X]||i[65]){case o.INVALID:U=r.INVALID,B=isNaN(X)?"E_CSS_UNEXPECTED_EOF":"E_CSS_UNEXPECTED_CHAR",i=l,h++;break;case o.SPACE:h++,$=!0;continue;case o.INT:z=h++,i=p;continue;case o.IDENT:U=r.IDENT,z=h++,i=c;continue;case o.BANG:z=h++,U=r.BANG,i=m;continue;case o.STR1:U=r.STR,z=++h,i=I;continue;case o.STR2:U=r.STR,z=++h,i=A;continue;case o.HASH:z=++h,U=r.HASH,i=c;continue;case o.DOLLAR:z=h++,U=r.DOLLAR,i=m;continue;case o.PERCENT:z=h++,U=r.PERCENT;break;case o.AMP:z=h++,U=r.DOLLAR,i=w;continue;case o.O_PAR:z=h++,U=r.O_PAR;break;case o.C_PAR:z=h++,U=r.C_PAR;break;case o.STAR:z=h++,U=r.STAR,i=m;continue;case o.PLUS:z=h++,U=r.PLUS;break;case o.COMMA:z=h++,U=r.COMMA;break;case o.MINUS:U=r.MINUS,z=h++,i=f;continue;case o.DOT:z=h++,i=u;continue;case o.TOCLASS:z=h++,U=r.CLASS,i=c;continue;case o.SLASH:z=h++,U=r.SLASH,i=v;continue;case o.COLON:z=h++,U=r.COLON,i=b;continue;case o.COL_COL:h++,U=r.COL_COL;break;case o.SEMICOL:z=h++,U=r.SEMICOL;break;case o.LT:z=h++,U=r.LT,i=S;continue;case o.EQ:z=h++,U=r.EQ,i=m;continue;case o.GT:z=h++,U=r.GT,i=m;continue;case o.QMARK:z=h++,U=r.QMARK;break;case o.AT:z=++h,U=r.AT,i=c;continue;case o.O_BRK:z=h++,U=r.O_BRK;break;case o.C_BRK:z=h++,U=r.C_BRK;break;case o.O_BRC:z=h++,U=r.O_BRC;break;case o.C_BRC:z=h++,U=r.C_BRC;break;case o.BSLASH:j=z=h++,U=r.IDENT,i=_;continue;case o.HAT:z=h++,U=r.HAT,i=m;continue;case o.BAR:z=h++,U=r.BAR,i=E;continue;case o.TILDE:z=h++,U=r.TILDE,i=m;continue;case o.END:break;case o.EQTAIL:h++,U=U+r.BANG_EQ-r.BANG;break;case o.ENDINT:U=r.INT,V=parseInt(a.substring(z,h),10);break;case o.ENDNUM:U=r.NUM,V=parseFloat(a.substring(z,h));break;case o.CONT:h++;continue;case o.UNIT:U=r.NUMERIC,V=parseFloat(a.substring(z,h)),z=h++,i=c;continue;case o.PCUNIT:U=r.NUMERIC,V=parseFloat(a.substring(z,h)),B="%",z=h++;break;case o.NUMBER:h++,i=g;continue;case o.ENDIDNT:B=a.substring(z,h);break;case o.IDNTESC:j=h++,i=_;continue;case o.ENDIDES:B=s(a.substring(z,h));break;case o.ENDSTR:B=a.substring(z,h),h++;break;case o.ENDESTR:B=s(a.substring(z,h)),h++;break;case o.STR1ESC:j=h,h+=2,i=O;continue;case o.STR2ESC:j=h,h+=2,i=k;continue;case o.BAR_BAR:h++,U=r.BAR_BAR;break;case o.AMP_AMP:h++,U=r.AMP_AMP;break;case o.FUNC:if(B=a.substring(z,h),U==r.IDENT){if(h++,"url"==B.toLowerCase()){i=D;continue}U=r.FUNC}break;case o.FUNCES:if(B=s(a.substring(z,h)),U==r.IDENT){if(h++,"url"==B.toLowerCase()){i=D;continue}U=r.FUNC}break;case o.COMMENT:i=y,h++;continue;case o.COMMST:i=T,h++;continue;case o.ENDNOTK:i=l,h++;continue;case o.MINMIN:i=N,h++;continue;case o.TOINT:U=r.INT,i=p,h++;continue;case o.TONUM:U=r.NUM,i=g,h++;continue;case o.TOIDENT:U=r.IDENT,i=c,h++;continue;case o.TOIDES:U=r.IDENT,i=_,j=h++;continue;case o.KILL1:h--;break;case o.KILL2:h-=2;break;case o.URL:z=h++,i=L;continue;case o.URL1:z=++h,i=R;continue;case o.URL2:z=++h,i=P;continue;case o.ENDURL:U=r.URL,B=s(a.substring(z,h)),h++;break;case o.FINURL:h++;break;case o.LT_BG:i=x,h++;continue;case o.LT_BG_M:i=C,h++;continue;case o.CHKSP:if(h-j<8&&a.substring(j+1,h+1).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])|[ \t]$/)){h++;continue}case o.TERMURL:U=r.URL,B=s(a.substring(z,h)),h++,i=M;continue;case o.CHKPOSN:if(++h-j<9&&a.substring(j+1,h).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])$/))continue;U=r.INVALID,B="E_CSS_UNEXPECTED_NEWLINE",i=l;break;case o.CHKPOSS:if(h-j<9&&a.substring(j+1,h+1).match(/^[0-9a-fA-F]{0,6}[ \t]$/)){h++;continue}B=s(a.substring(z,h));break;case o.URLESC:j=h++;continue;case o.IDESCH:h++,i=d;continue;default:if(i!==l){U=r.INVALID,B="E_CSS_UNEXPECTED_STATE";break}z=h,U=r.EOF}if(H.type=U,H.at=$,H.num=V,H.text=B,H.position=z,++t>=e)break;i=l,$=!1,H=F[t&n]}this.position=h,this.tail=t&n}}},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return h}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return c}),n.d(e,"e",function(){return u});var i=n(1),s=n(6);let r=null,o=null;function a(){return r}function h(t){if(!r)throw new Error("E_TASK_NO_CONTEXT");r.name||(r.name=t);const e=r,n=new w(e,e.top,t);return e.top=n,n.state=f.ACTIVE,n}function l(t){return new b(t)}function c(t,e,n){const i=h(t);i.handler=n;try{e(i)}catch(t){i.task.raise(t,i)}return i.result()}function u(t,e){return(r?r.bt():o||new p(new d)).run(t,e)}var f;!function(t){t[t.INIT=0]="INIT",t[t.ACTIVE=1]="ACTIVE",t[t.FINISHED=2]="FINISHED",t[t.DEAD=3]="DEAD"}(f||(f={}));class d{currentTime(){return(new Date).valueOf()}setTimeout(t,e){return setTimeout(t,e)}clearTimeout(t){clearTimeout(t)}}class p{constructor(t){this.timer=t,this.timeout=1,this.slice=25,this.Et=0,this.xt=null,this.yt=null,this.vt=!1,this.order=0,this.queue=new i.b,o||(o=this)}kt(t){this.slice=t}setTimeout(t){this.timeout=t}St(){return this.timer.currentTime()>=this.Et}arm(){if(this.vt)return;const t=this.queue.peek().Ct,e=this.timer.currentTime();if(null!=this.yt){if(e+this.timeout>this.xt)return;this.timer.clearTimeout(this.yt)}let n=t-e;n<=this.timeout&&(n=this.timeout),this.xt=e+n;const i=this;this.yt=this.timer.setTimeout(()=>{i.yt=null,i.Pt()},n)}schedule(t,e){const n=t,i=this.timer.currentTime();n.order=this.order++,n.Ct=i+(e||0),this.queue.add(n),this.arm()}Pt(){null!=this.yt&&(this.timer.clearTimeout(this.yt),this.yt=null),this.vt=!0;try{let t=this.timer.currentTime();for(this.Et=t+this.slice;this.queue.length();){const e=this.queue.peek();if(e.Ct>t)break;if(this.queue.remove(),e.canceled||e.Tt(),(t=this.timer.currentTime())>=this.Et)break}}catch(t){s.b.error(t)}this.vt=!1,this.queue.length()&&this.arm()}run(t,e){const n=new m(this,e||"");n.top=new w(n,null,"bootstrap"),n.top.state=f.ACTIVE,n.top.then(()=>{const e=()=>{n.running=!1;for(const t of n.callbacks)try{t()}catch(t){s.b.error(t)}};try{t().then(t=>{n.result=t,e()})}catch(t){n.raise(t),e()}});const i=r;return r=n,this.schedule(n.top.suspend("bootstrap")),r=i,n}}class g{constructor(t){this.task=t,this.Ct=0,this.order=0,this.result=null,this.canceled=!1}compare(t){const e=t;return e.Ct-this.Ct||e.order-this.order}_t(){return this.task}schedule(t,e){this.result=t,this.task.scheduler.schedule(this,e)}Tt(){const t=this.task;if(this.task=null,t&&t.continuation==this){t.continuation=null;const e=r;return r=t,t.top.finish(this.result),r=e,!0}return!1}cancel(){this.canceled=!0}}class m{constructor(t,e){this.scheduler=t,this.name=e,this.callbacks=[],this.exception=null,this.running=!0,this.result=null,this.Rt=null,this.top=null,this.continuation=null}Nt(){return this.name}interrupt(t){if(this.raise(t||new Error("E_TASK_INTERRUPT")),this!==r&&this.continuation){this.continuation.cancel();const t=new g(this);this.Rt="interrupt",this.continuation=t,this.scheduler.schedule(t)}}bt(){return this.scheduler}It(){return this.running}Ft(t){this.callbacks.push(t)}join(){const t=h("Task.join");if(this.running){const e=t.suspend(this),n=this;this.Ft(()=>{e.schedule(n.result)})}else t.finish(this.result);return t.result()}unwind(){for(;this.top&&!this.top.handler;)this.top=this.top.parent;if(this.top&&this.top.handler&&this.exception){const t=this.exception;this.exception=null,this.top.handler(this.top,t)}else this.exception&&s.b.error(this.exception,"Unhandled exception in task",this.name)}raise(t,e){if(this.At(t),e){let t=this.top;for(;t&&t!=e;)t=t.parent;t==e&&(this.top=t)}this.exception=t,this.unwind()}At(t){let e=t.frameTrace;if(!e){e=t.stack?`${t.stack}\n\t---- async ---\n`:"";for(let t=this.top;t;t=t.parent)e+="\t",e+=t.Nt(),e+="\n";t.frameTrace=e}}}class b{constructor(t){this.value=t}then(t){t(this.value)}Ot(t){return t(this.value)}Lt(t){return new b(t)}$t(t){t.finish(this.value)}Mt(){return!1}get(){return this.value}}class E{constructor(t){this.frame=t}then(t){this.frame.then(t)}Ot(t){if(this.Mt()){const e=new w(this.frame.task,this.frame.parent,"AsyncResult.thenAsync");return e.state=f.ACTIVE,this.frame.parent=e,this.frame.then(n=>{t(n).then(t=>{e.finish(t)})}),e.result()}return t(this.frame.res)}Lt(t){return this.Mt()?this.Ot(()=>new b(t)):new b(t)}$t(t){this.Mt()?this.then(e=>{t.finish(e)}):t.finish(this.frame.res)}Mt(){return this.frame.state==f.ACTIVE}get(){if(this.Mt())throw new Error("Result is pending");return this.frame.res}}class w{constructor(t,e,n){this.task=t,this.parent=e,this.name=n,this.res=null,this.callback=null,this.handler=null,this.state=f.INIT}Dt(){if(!r)throw new Error("F_TASK_NO_CONTEXT");if(this!==r.top)throw new Error("F_TASK_NOT_TOP_FRAME")}result(){return new E(this)}finish(t){this.Dt(),r&&!r.exception&&(this.res=t),this.state=f.FINISHED;const e=this.parent;if(r&&(r.top=e),this.callback){try{this.callback(t)}catch(t){this.task.raise(t,e)}this.state=f.DEAD}}_t(){return this.task}Nt(){return this.name}bt(){return this.task.scheduler}then(t){switch(this.state){case f.ACTIVE:if(this.callback)throw new Error("F_TASK_FRAME_ALREADY_HAS_CALLBACK");this.callback=t;break;case f.FINISHED:{const e=this.task,n=this.parent;try{t(this.res),this.state=f.DEAD}catch(t){this.state=f.DEAD,e.raise(t,n)}break}case f.DEAD:throw new Error("F_TASK_DEAD_FRAME");default:throw new Error(`F_TASK_UNEXPECTED_FRAME_STATE ${this.state}`)}}Bt(){const t=h("Frame.timeSlice");return t.bt().St()?(s.b.debug("-- time slice --"),t.suspend().schedule(!0)):t.finish(!0),t.result()}sleep(t){const e=h("Frame.sleep");return e.suspend().schedule(!0,t),e.result()}loop(t){const e=h("Frame.loop"),n=i=>{try{for(;i;){const e=t();if(e.Mt())return void e.then(n);e.then(t=>{i=t})}e.finish(!0)}catch(t){e.task.raise(t,e)}};return n(!0),e.result()}Ut(t){const e=r;if(!e)throw new Error("E_TASK_NO_CONTEXT");return this.loop(()=>{let n;do{const i=new v(e,e.top);e.top=i,i.state=f.ACTIVE,t(i),n=i.result()}while(!n.Mt()&&n.get());return n})}suspend(t){if(this.Dt(),this.task.continuation)throw new Error("E_TASK_ALREADY_SUSPENDED");const e=new g(this.task);return this.task.continuation=e,r=null,this.task.Rt=t||null,e}}class v extends w{constructor(t,e){super(t,e,"loop")}zt(){this.finish(!0)}Vt(){this.finish(!1)}}},function(t,e,n){"use strict";n.d(e,"F",function(){return s}),n.d(e,"E",function(){return r}),n.d(e,"L",function(){return h}),n.d(e,"M",function(){return u}),n.d(e,"m",function(){return d}),n.d(e,"I",function(){return p}),n.d(e,"K",function(){return g}),n.d(e,"J",function(){return m}),n.d(e,"G",function(){return b}),n.d(e,"O",function(){return E}),n.d(e,"g",function(){return w}),n.d(e,"w",function(){return _}),n.d(e,"v",function(){return I}),n.d(e,"b",function(){return A}),n.d(e,"c",function(){return O}),n.d(e,"y",function(){return k}),n.d(e,"z",function(){return D}),n.d(e,"n",function(){return L}),n.d(e,"l",function(){return R}),n.d(e,"k",function(){return P}),n.d(e,"j",function(){return M}),n.d(e,"i",function(){return F}),n.d(e,"u",function(){return U}),n.d(e,"a",function(){return z}),n.d(e,"B",function(){return B}),n.d(e,"r",function(){return V}),n.d(e,"h",function(){return $}),n.d(e,"q",function(){return H}),n.d(e,"x",function(){return j}),n.d(e,"s",function(){return X}),n.d(e,"o",function(){return G}),n.d(e,"t",function(){return W}),n.d(e,"d",function(){return Q}),n.d(e,"e",function(){return K}),n.d(e,"f",function(){return Y}),n.d(e,"p",function(){return q}),n.d(e,"A",function(){return Z}),n.d(e,"D",function(){return J}),n.d(e,"C",function(){return tt}),n.d(e,"P",function(){return et}),n.d(e,"N",function(){return nt}),n.d(e,"H",function(){return it});var i=n(1);function s(){return{fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,jt:!1,pageBorder:1,Xt:{vivliostyle:!0,print:!0},defaultPaperSize:void 0}}function r(t){return{fontFamily:t.fontFamily,lineHeight:t.lineHeight,margin:t.margin,hyphenate:t.hyphenate,columnWidth:t.columnWidth,horizontal:t.horizontal,nightMode:t.nightMode,jt:t.jt,pageBorder:t.pageBorder,Xt:Object.assign({},t.Xt),defaultPaperSize:t.defaultPaperSize?Object.assign({},t.defaultPaperSize):void 0}}const o={fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,jt:!1,pageBorder:1,Xt:{vivliostyle:!0,print:!0},defaultPaperSize:void 0},a={PENDING:{}};function h(t,e,n,i){const s=Math.min((t-0)/n,(e-0)/i);return`matrix(${s},0,0,${s},0,0)`}function l(t){return`"${i.q(`${t}`)}"`}function c(t){return i.p(`${t}`)}function u(t,e){return t?`${i.p(t)}.${i.p(e)}`:i.p(e)}let f=0;class d{constructor(t,e){if(this.parent=t,this.resolver=e,this.children=[],this.values={},this.funcs={},this.Wt={},this.Ht=`S${f++}`,this.zero=new Y(this,0),this.one=new Y(this,1),this._true=new Y(this,!0),this._false=new Y(this,!1),t&&t.children.push(this),!t){const t=this.Wt;t.floor=Math.floor,t.ceil=Math.ceil,t.round=Math.round,t.sqrt=Math.sqrt,t.min=Math.min,t.max=Math.max,t.letterbox=h,t["css-string"]=l,t["css-name"]=c,t.typeof=(t=>typeof t),this.Gt("page-width",function(){return this.Yt()}),this.Gt("page-height",function(){return this.qt()}),this.Gt("pref-font-family",function(){return this.pref.fontFamily}),this.Gt("pref-night-mode",function(){return this.pref.nightMode}),this.Gt("pref-hyphenate",function(){return this.pref.hyphenate}),this.Gt("pref-margin",function(){return this.pref.margin}),this.Gt("pref-line-height",function(){return this.pref.lineHeight}),this.Gt("pref-column-width",function(){return this.pref.columnWidth*this.fontSize}),this.Gt("pref-horizontal",function(){return this.pref.horizontal}),this.Gt("pref-spread-view",function(){return this.pref.jt}),this.Gt("pub-title",function(){return l(this.Kt?this.Kt:"")}),this.Gt("doc-title",function(){return l(this.docTitle?this.docTitle:"")})}}Gt(t,e){this.values[t]=new W(this,e,t)}Zt(t,e){this.values[t]=e}Qt(t,e){this.funcs[t]=e}Jt(t,e){this.Wt[t]=e}}function p(t){switch(t.toLowerCase()){case"px":case"in":case"pt":case"pc":case"cm":case"mm":case"q":return!0;default:return!1}}function g(t){switch(t.toLowerCase()){case"vw":case"vh":case"vi":case"vb":case"vmin":case"vmax":case"pvw":case"pvh":case"pvi":case"pvb":case"pvmin":case"pvmax":return!0;default:return!1}}function m(t){switch(t.toLowerCase()){case"em":case"ex":case"rem":return!0;default:return!1}}const b={px:1,in:96,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,q:96/2.54/40,em:16,rem:16,ex:8,dppx:1,dpi:1/96,dpcm:2.54/96};function E(t){switch(t){case"q":case"rem":return!0;default:return!1}}class w{constructor(t,e,n,i){this.te=t,this.ee=e,this.se=n,this.ie=null,this.ne=null,this.re=null,this.scopes={},this.oe=null,this.he=null,this.ce=null,this.Kt=null,this.docTitle=null,this.Yt=function(){return this.ie?this.ie:this.pref.jt?Math.floor(e/2)-this.pref.pageBorder:e},this.qt=function(){return this.ne?this.ne:n},this.le=i,this.fontSize=function(){return this.re?this.re:i},this.pref=o}ue(t){let e=this.scopes[t.Ht];return e||(e={},this.scopes[t.Ht]=e),e}ae(t){this.scopes[t.Ht]={};for(let e=0;e<t.children.length;e++)this.ae(t.children[e])}ut(t,e){if(g(t)){const e=this.Yt()/100,n=this.qt()/100,i=null!=this.oe?this.oe/100:e,s=null!=this.he?this.he/100:n;switch(t){case"vw":return i;case"vh":return s;case"vi":return this.ce?s:i;case"vb":return this.ce?i:s;case"vmin":return i<s?i:s;case"vmax":return i>s?i:s;case"pvw":return e;case"pvh":return n;case"pvi":return this.ce?n:e;case"pvb":return this.ce?e:n;case"pvmin":return e<n?e:n;case"pvmax":return e>n?e:n}}return"em"==t||"rem"==t?e?this.le:this.fontSize():"ex"==t?b.ex*(e?this.le:this.fontSize())/b.em:b[t]}fe(t,e){do{let n=t.values[e];if(n)return n;if(t.resolver&&(n=t.resolver.call(this,e,!1)))return n;t=t.parent}while(t);throw new Error(`Name '${e}' is undefined`)}de(t,e,n,i){do{let s=t.funcs[e];if(s)return s;if(t.resolver&&(s=t.resolver.call(this,e,!0)))return s;const r=t.Wt[e];if(r){if(i)return t.zero;const e=Array(n.length);for(let t=0;t<n.length;t++)e[t]=n[t].evaluate(this);return new Y(t,r.apply(this,e))}t=t.parent}while(t);throw new Error(`Function '${e}' is undefined`)}pe(t,e){const n="all"===t||!!this.pref.Xt[t];return e?!n:n}we(t,e){let n="";const i=t.match(/^(min|max)-(.*)$/);i&&(n=i[1],t=i[2]);let s=null,r=null;switch(t){case"width":case"height":case"device-width":case"device-height":case"color":e&&(s=e.evaluate(this))}switch(t){case"width":r=this.Yt();break;case"height":r=this.qt();break;case"device-width":r=window.screen.availWidth;break;case"device-height":r=window.screen.availHeight;break;case"color":r=window.screen.pixelDepth}if(null!=r&&null!=s)switch(n){case"min":return r>=s;case"max":return r<=s;default:return r==s}else if(null!=r&&null==e)return 0!==r;return!1}ge(t,e){const n=this.scopes[t.Ht];return n?n[e]:void 0}me(t,e,n){this.ue(t)[e]=n}}class v{constructor(t){this.scope=t,this.scope=t,this.key=`_${f++}`}toString(){const t=new i.d;return this.it(t,0),t.toString()}it(t,e){throw new Error("F_ABSTRACT")}be(t){throw new Error("F_ABSTRACT")}expand(t,e){return this}Ee(t,e,n){return t===this}xe(t,e,n){const i=n[this.key];if(null!=i)return i!==a.PENDING&&i;{n[this.key]=a.PENDING;const i=this.Ee(t,e,n);return n[this.key]=i,i}}depend(t,e){return this.xe(t,e,{})}evaluate(t){let e=t.ge(this.scope,this.key);return void 0!==e?e:(e=this.be(t),t.me(this.scope,this.key,e),e)}ye(){return!1}}class y extends v{constructor(t,e){super(t),this.val=e}ve(){throw new Error("F_ABSTRACT")}ke(t){throw new Error("F_ABSTRACT")}be(t){const e=this.val.evaluate(t);return this.ke(e)}Ee(t,e,n){return t===this||this.val.xe(t,e,n)}it(t,e){10<e&&t.append("("),t.append(this.ve()),this.val.it(t,10),10<e&&t.append(")")}expand(t,e){const n=this.val.expand(t,e);return n===this.val?this:new this.constructor(this.scope,n)}}class T extends v{constructor(t,e,n){super(t),this.lhs=e,this.rhs=n}Se(){throw new Error("F_ABSTRACT")}ve(){throw new Error("F_ABSTRACT")}Ce(t,e){throw new Error("F_ABSTRACT")}be(t){const e=this.lhs.evaluate(t),n=this.rhs.evaluate(t);return this.Ce(e,n)}Ee(t,e,n){return t===this||this.lhs.xe(t,e,n)||this.rhs.xe(t,e,n)}it(t,e){const n=this.Se();n<=e&&t.append("("),this.lhs.it(t,n),t.append(this.ve()),this.rhs.it(t,n),n<=e&&t.append(")")}expand(t,e){const n=this.lhs.expand(t,e),i=this.rhs.expand(t,e);return n===this.lhs&&i===this.rhs?this:new this.constructor(this.scope,n,i)}}class N extends T{constructor(t,e,n){super(t,e,n)}Se(){return 1}}class S extends T{constructor(t,e,n){super(t,e,n)}Se(){return 2}}class x extends T{constructor(t,e,n){super(t,e,n)}Se(){return 3}}class C extends T{constructor(t,e,n){super(t,e,n)}Se(){return 4}}class _ extends y{constructor(t,e){super(t,e)}ve(){return"!"}ke(t){return!t}}class I extends y{constructor(t,e){super(t,e)}ve(){return"-"}ke(t){return-t}}class A extends N{constructor(t,e,n){super(t,e,n)}ve(){return"&&"}be(t){return this.lhs.evaluate(t)&&this.rhs.evaluate(t)}}class O extends A{constructor(t,e,n){super(t,e,n)}ve(){return" and "}}class k extends N{constructor(t,e,n){super(t,e,n)}ve(){return"||"}be(t){return this.lhs.evaluate(t)||this.rhs.evaluate(t)}}class D extends k{constructor(t,e,n){super(t,e,n)}ve(){return", "}}class L extends S{constructor(t,e,n){super(t,e,n)}ve(){return"<"}Ce(t,e){return t<e}}class R extends S{constructor(t,e,n){super(t,e,n)}ve(){return"<="}Ce(t,e){return t<=e}}class P extends S{constructor(t,e,n){super(t,e,n)}ve(){return">"}Ce(t,e){return t>e}}class M extends S{constructor(t,e,n){super(t,e,n)}ve(){return">="}Ce(t,e){return t>=e}}class F extends S{constructor(t,e,n){super(t,e,n)}ve(){return"=="}Ce(t,e){return t==e}}class U extends S{constructor(t,e,n){super(t,e,n)}ve(){return"!="}Ce(t,e){return t!=e}}class z extends x{constructor(t,e,n){super(t,e,n)}ve(){return"+"}Ce(t,e){return t+e}}class B extends x{constructor(t,e,n){super(t,e,n)}ve(){return" - "}Ce(t,e){return t-e}}class V extends C{constructor(t,e,n){super(t,e,n)}ve(){return"*"}Ce(t,e){return t*e}}class $ extends C{constructor(t,e,n){super(t,e,n)}ve(){return"/"}Ce(t,e){return t/e}}class H extends C{constructor(t,e,n){super(t,e,n)}ve(){return"%"}Ce(t,e){return t%e}}class j extends v{constructor(t,e,n){super(t),this.num=e,this.unit=n.toLowerCase()}it(t,e){t.append(this.num.toString()),t.append(i.p(this.unit))}be(t){return this.num*t.ut(this.unit,!1)}}class X extends v{constructor(t,e){super(t),this.Pe=e}it(t,e){t.append(this.Pe)}be(t){return t.fe(this.scope,this.Pe).evaluate(t)}Ee(t,e,n){return t===this||e.fe(this.scope,this.Pe).xe(t,e,n)}}class G extends v{constructor(t,e,n){super(t),this.not=e,this.name=n}it(t,e){this.not&&t.append("not "),t.append(i.p(this.name))}be(t){return t.pe(this.name,this.not)}Ee(t,e,n){return t===this||this.value.xe(t,e,n)}ye(){return!0}}class W extends v{constructor(t,e,n){super(t),this.fn=e,this.str=n}it(t,e){t.append(this.str)}be(t){return this.fn.call(t)}}class Q extends v{constructor(t,e,n){super(t),this.Pe=e,this.params=n}it(t,e){t.append(this.Pe),function(t,e){t.append("(");for(let n=0;n<e.length;n++)n&&t.append(","),e[n].it(t,0);t.append(")")}(t,this.params)}be(t){return t.de(this.scope,this.Pe,this.params,!1).expand(t,this.params).evaluate(t)}Ee(t,e,n){if(t===this)return!0;for(let i=0;i<this.params.length;i++)if(this.params[i].xe(t,e,n))return!0;return e.de(this.scope,this.Pe,this.params,!0).xe(t,e,n)}expand(t,e){const n=function(t,e,n){let i=e;for(let s=0;s<e.length;s++){const r=e[s].expand(t,n);if(e!==i)i[s]=r;else if(r!==e[s]){i=Array(e.length);for(let t=0;t<s;t++)i[t]=e[t];i[s]=r}}return i}(t,this.params,e);return n===this.params?this:new Q(this.scope,this.Pe,n)}}class K extends v{constructor(t,e,n,i){super(t),this.cond=e,this.Te=n,this._e=i}it(t,e){e>0&&t.append("("),this.cond.it(t,0),t.append("?"),this.Te.it(t,0),t.append(":"),this._e.it(t,0),e>0&&t.append(")")}be(t){return this.cond.evaluate(t)?this.Te.evaluate(t):this._e.evaluate(t)}Ee(t,e,n){return t===this||this.cond.xe(t,e,n)||this.Te.xe(t,e,n)||this._e.xe(t,e,n)}expand(t,e){const n=this.cond.expand(t,e),i=this.Te.expand(t,e),s=this._e.expand(t,e);return n===this.cond&&i===this.Te&&s===this._e?this:new K(this.scope,n,i,s)}}class Y extends v{constructor(t,e){super(t),this.val=e}it(t,e){switch(typeof this.val){case"number":case"boolean":t.append(this.val.toString());break;case"string":t.append('"'),t.append(i.q(this.val)),t.append('"');break;default:throw new Error("F_UNEXPECTED_STATE")}}be(t){return this.val}}class q extends v{constructor(t,e,n){super(t),this.name=e,this.value=n}it(t,e){t.append("("),t.append(i.q(this.name.name)),t.append(":"),this.value.it(t,0),t.append(")")}be(t){return t.we(this.name.name,this.value)}Ee(t,e,n){return t===this||this.value.xe(t,e,n)}expand(t,e){const n=this.value.expand(t,e);return n===this.value?this:new q(this.scope,this.name,n)}}class Z extends v{constructor(t,e){super(t),this.index=e}it(t,e){t.append("$"),t.append(this.index.toString())}expand(t,e){const n=e[this.index];if(!n)throw new Error(`Parameter missing: ${this.index}`);return n}}function J(t,e,n){return e===t._false||e===t.zero||n==t._false||n==t.zero?t._false:e===t._true||e===t.one?n:n===t._true||n===t.one?e:new A(t,e,n)}function tt(t,e,n){return e===t.zero?n:n===t.zero?e:new z(t,e,n)}function et(t,e,n){return e===t.zero?new I(t,n):n===t.zero?e:new B(t,e,n)}function nt(t,e,n){return e===t.zero||n===t.zero?t.zero:e===t.one?n:n===t.one?e:new V(t,e,n)}function it(t,e,n){return e===t.zero?t.zero:n===t.one?e:new $(t,e,n)}},function(t,e,n){"use strict";n.d(e,"v",function(){return d}),n.d(e,"r",function(){return g}),n.d(e,"H",function(){return m}),n.d(e,"m",function(){return y}),n.d(e,"l",function(){return T}),n.d(e,"c",function(){return x}),n.d(e,"i",function(){return _}),n.d(e,"x",function(){return O}),n.d(e,"w",function(){return k}),n.d(e,"s",function(){return D}),n.d(e,"F",function(){return L}),n.d(e,"u",function(){return R}),n.d(e,"q",function(){return P}),n.d(e,"t",function(){return F}),n.d(e,"B",function(){return z}),n.d(e,"A",function(){return B}),n.d(e,"g",function(){return $}),n.d(e,"j",function(){return H}),n.d(e,"a",function(){return W}),n.d(e,"d",function(){return Q}),n.d(e,"e",function(){return It}),n.d(e,"G",function(){return Vt}),n.d(e,"b",function(){return $t}),n.d(e,"f",function(){return Gt}),n.d(e,"h",function(){return Wt}),n.d(e,"p",function(){return Kt}),n.d(e,"D",function(){return Yt}),n.d(e,"E",function(){return qt}),n.d(e,"z",function(){return Zt}),n.d(e,"y",function(){return Jt}),n.d(e,"n",function(){return te}),n.d(e,"o",function(){return ee}),n.d(e,"C",function(){return ne}),n.d(e,"k",function(){return ie});var i=n(7),s=n(1),r=n(0),o=n(10),a=n(20),h=n(2),l=n(4),c=n(6),u=n(25),f=n(9);const d={azimuth:!0,"border-collapse":!0,"border-spacing":!0,"caption-side":!0,"clip-rule":!0,color:!0,"color-interpolation":!0,"color-rendering":!0,cursor:!0,direction:!0,elevation:!0,"empty-cells":!0,fill:!0,"fill-opacity":!0,"fill-rule":!0,"font-kerning":!0,"font-size":!0,"font-size-adjust":!0,"font-family":!0,"font-feature-settings":!0,"font-style":!0,"font-stretch":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-vertical":!0,hyphens:!0,"hyphenate-character":!0,"hyphenate-limit-chars":!0,"hyphenate-limit-last":!0,"image-rendering":!0,"image-resolution":!0,"letter-spacing":!0,"line-break":!0,"line-height":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,marker:!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,orphans:!0,"overflow-wrap":!0,"paint-order":!0,"pointer-events":!0,"pitch-range":!0,quotes:!0,richness:!0,"ruby-align":!0,"ruby-position":!0,"speak-header":!0,"speak-numeral":!0,"speak-punctuation":!0,"speech-rate":!0,"shape-rendering":!0,stress:!0,stroke:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,"tab-size":!0,"text-align":!0,"text-align-last":!0,"text-anchor":!0,"text-decoration-skip":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-combine-upright":!0,"text-indent":!0,"text-justify":!0,"text-rendering":!0,"text-size-adjust":!0,"text-transform":!0,"text-underline-position":!0,visibility:!0,"voice-family":!0,volume:!0,"white-space":!0,widows:!0,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"writing-mode":!0},p=["box-decoration-break","image-resolution","orphans","widows"];function g(){return f.b(f.a.POLYFILLED_INHERITED_PROPS).reduce((t,e)=>t.concat(e()),[].concat(p))}const m={"http://www.idpf.org/2007/ops":!0,"http://www.w3.org/1999/xhtml":!0,"http://www.w3.org/2000/svg":!0},b=["margin-%","padding-%","border-%-width","border-%-style","border-%-color","%"],E=["max-%","min-%","%"],w=(()=>{const t=["left","right","top","bottom"],e={width:!0,height:!0,"max-width":!0,"max-height":!0,"min-width":!0,"min-height":!0};for(let n=0;n<b.length;n++)for(let i=0;i<t.length;i++)e[b[n].replace("%",t[i])]=!0;return e})();function v(t,e){const n={};for(const e of b)for(const i in t){const s=e.replace("%",i),r=e.replace("%",t[i]);n[s]=r,n[r]=s}for(const t of E)for(const i in e){const s=t.replace("%",i),r=t.replace("%",e[i]);n[s]=r,n[r]=s}return n}const y=v({"block-start":"right","block-end":"left","inline-start":"top","inline-end":"bottom"},{"block-size":"width","inline-size":"height"}),T=v({"block-start":"top","block-end":"bottom","inline-start":"left","inline-end":"right"},{"block-size":"height","inline-size":"width"}),N=v({"block-start":"right","block-end":"left","inline-start":"bottom","inline-end":"top"},{"block-size":"width","inline-size":"height"}),S=v({"block-start":"top","block-end":"bottom","inline-start":"right","inline-end":"left"},{"block-size":"height","inline-size":"width"});class x{constructor(t,e){this.value=t,this.priority=e}Re(){return this}Ne(t){const e=this.value.visit(t);return e===this.value?this:new x(e,this.priority)}Ie(t){return 0==t?this:new x(this.value,this.priority+t)}evaluate(t,e){return o.i(t,this.value,e)}isEnabled(t){return!0}}class C extends x{constructor(t,e,n){super(t,e),this.condition=n}Re(){return new x(this.value,this.priority)}Ne(t){const e=this.value.visit(t);return e===this.value?this:new C(e,this.priority,this.condition)}Ie(t){return 0==t?this:new C(this.value,this.priority+t,this.condition)}isEnabled(t){return!!this.condition.evaluate(t)}}function _(t,e,n){return(null==e||n.priority>e.priority)&&n.isEnabled(t)?n.Re():e}const I={"region-id":!0,"fragment-selector-id":!0};function A(t){return!!I[t]}function O(t){return"_"!=t.charAt(0)&&!I[t]}function k(t){return!!d[t]}function D(t,e){return t[e]}function L(t,e,n){n?t[e]=n:delete t[e]}function R(t,e){return t[e]}function P(t,e){let n=t[e];return n||(n={},t[e]=n),n}const M=t=>{let e=t._viewConditionalStyles;return e||(e=[],t._viewConditionalStyles=e),e};function F(t,e){return t[e]}function U(t,e){let n=t[e];return n||(n=[],t[e]=n),n}function z(t,e,n,i,s,r,o){if([{id:s,Fe:"_pseudos"},{id:r,Fe:"_regions"}].forEach(t=>{if(t.id){const n=P(e,t.Fe);(e=n[t.id])||(e={},n[t.id]=e)}}),o){const t=M(e);e={},t.push({styles:e,matcher:o})}for(const s in n)if("_"!=s.charAt(0))if(A(s)){const t=F(n,s),i=U(e,s);Array.prototype.push.apply(i,t)}else{const r=D(n,s).Ie(i),o=D(e,s);L(e,s,_(t,o,r))}}function B(t,e){const n={};for(let i=0;i<e.length;i++)z(t,n,e[i],0,null,null,null);return n}function V(t,e){if(t.length>0){t.sort((t,e)=>e.Se()-t.Se());let n=null;for(let i=t.length-1;i>=0;i--)(n=t[i]).chained=e,e=n;return n}return e}class $ extends r.d{constructor(t,e){super(),this.props=t,this.context=e,this.Ae=""}Oe(t){this.Ae=t}Le(){const t=D(this.props,"font-size").value;if(!l.I(t.unit))throw new Error("Unexpected state");return t.num*l.G[t.unit]}U(t){if(i.a(this.context),"font-size"===this.Ae)return function(t,e,n){const i=(t=H(t,e,n)).unit,s=t.num;return"px"===i?t:"%"===i?new r.i(s/100*e,"px"):new r.i(s*n.ut(i,!1),"px")}(t,this.Le(),this.context);if("em"==t.unit||"ex"==t.unit||"rem"==t.unit)return H(t,this.Le(),this.context);if("%"==t.unit){if("line-height"===this.Ae)return t;const e=this.Ae.match(/height|^(top|bottom)$/)?"vh":"vw";return new r.i(t.num,e)}return t}st(t){return"font-size"==this.Ae?o.i(this.context,t,this.Ae).visit(this):t}}function H(t,e,n){const i=t.unit,s=t.num;if("em"===i||"ex"===i){const t=l.G[i]/l.G.em;return new r.i(s*t*e,"px")}return"rem"===i?new r.i(s*n.fontSize(),"px"):t}class j{apply(t){}$e(t){return new G([this,t])}clone(){return this}}class X extends j{constructor(t){super(),this.Me=t}apply(t){t.De(this.Me.fresh(t))}}class G extends j{constructor(t){super(),this.list=t}apply(t){for(let e=0;e<this.list.length;e++)this.list[e].apply(t)}$e(t){return this.list.push(t),this}clone(){return new G([].concat(this.list))}}class W extends j{constructor(t,e,n,i,s){super(),this.style=t,this.specificity=e,this.pseudoelement=n,this.regionId=i,this.Be=s}apply(t){z(t.context,t.currentStyle,this.style,this.specificity,this.pseudoelement,this.regionId,t.Ue(this.Be))}}class Q extends j{constructor(){super(),this.chained=null}apply(t){this.chained.apply(t)}Se(){return 0}ze(t){return!1}}class K extends Q{constructor(t){super(),this.className=t}apply(t){t.Ve.includes(this.className)&&this.chained.apply(t)}Se(){return 10}ze(t){return this.chained&&t.je(t.classes,this.className,this.chained),!0}}class Y extends Q{constructor(t){super(),this.id=t}apply(t){t.Xe!=this.id&&t.We!=this.id||this.chained.apply(t)}Se(){return 11}ze(t){return this.chained&&t.je(t.ids,this.id,this.chained),!0}}class q extends Q{constructor(t){super(),this.localName=t}apply(t){t.He==this.localName&&this.chained.apply(t)}Se(){return 8}ze(t){return this.chained&&t.je(t.tags,this.localName,this.chained),!0}}class Z extends Q{constructor(t,e){super(),this.ns=t,this.localName=e}apply(t){t.He==this.localName&&t.Ge==this.ns&&this.chained.apply(t)}Se(){return 8}ze(t){if(this.chained){let e=t.Ye[this.ns];e||(e=`ns${t.qe++}:`,t.Ye[this.ns]=e);const n=e+this.localName;t.je(t.nstags,n,this.chained)}return!0}}class J extends Q{constructor(t){super(),this.Ke=t}apply(t){const e=t.Ze;if(e&&"a"==t.He){const n=e.getAttribute("href");if(n&&n.match(/^#/)){const i=n.substring(1),r=e.ownerDocument.getElementById(i);if(r){const e=r.getAttributeNS(s.a.epub,"type");e&&e.match(this.Ke)&&this.chained.apply(t)}}}}}class tt extends Q{constructor(t){super(),this.ns=t}apply(t){t.Ge==this.ns&&this.chained.apply(t)}}class et extends Q{constructor(t,e){super(),this.ns=t,this.name=e}apply(t){t.Ze&&t.Ze.hasAttributeNS(this.ns,this.name)&&this.chained.apply(t)}}class nt extends Q{constructor(t,e,n){super(),this.ns=t,this.name=e,this.value=n}apply(t){t.Ze&&t.Ze.getAttributeNS(this.ns,this.name)==this.value&&this.chained.apply(t)}Se(){return"type"==this.name&&this.ns==s.a.epub?9:0}ze(t){return"type"==this.name&&this.ns==s.a.epub&&(this.chained&&t.je(t.epubtypes,this.value,this.chained),!0)}}class it extends Q{constructor(t,e){super(),this.ns=t,this.name=e}apply(t){if(t.Ze){const e=t.Ze.getAttributeNS(this.ns,this.name);e&&m[e]&&this.chained.apply(t)}}Se(){return 0}ze(t){return!1}}class st extends Q{constructor(t,e,n){super(),this.ns=t,this.name=e,this.regexp=n}apply(t){if(t.Ze){const e=t.Ze.getAttributeNS(this.ns,this.name);e&&e.match(this.regexp)&&this.chained.apply(t)}}}class rt extends Q{constructor(t){super(),this.Qe=t}apply(t){t.lang.match(this.Qe)&&this.chained.apply(t)}}class ot extends Q{constructor(){super()}apply(t){t.Je&&this.chained.apply(t)}Se(){return 6}}class at extends Q{constructor(){super()}apply(t){t.ts&&this.chained.apply(t)}Se(){return 12}}class ht extends Q{constructor(t,e){super(),this.a=t,this.b=e}es(t){return u.c(t,this.a,this.b)}}class lt extends ht{constructor(t,e){super(t,e)}apply(t){const e=t.ss[t.Ge][t.He];this.es(e)&&this.chained.apply(t)}Se(){return 5}}class ct extends ht{constructor(t,e){super(t,e)}apply(t){let e=t.rs;null===e&&(e=t.rs=t.Ze.parentNode.childElementCount-t.os+1),this.es(e)&&this.chained.apply(t)}Se(){return 4}}class ut extends ht{constructor(t,e){super(t,e)}apply(t){const e=t.hs;if(!e[t.Ge]){let n=t.Ze;do{const t=n.namespaceURI,i=n.localName;let s=e[t];s||(s=e[t]={}),s[i]=(s[i]||0)+1}while(n=n.nextElementSibling)}this.es(e[t.Ge][t.He])&&this.chained.apply(t)}Se(){return 4}}class ft extends Q{constructor(){super()}apply(t){let e=t.Ze.firstChild;for(;e;){switch(e.nodeType){case Node.ELEMENT_NODE:return;case Node.TEXT_NODE:if(e.length>0)return}e=e.nextSibling}this.chained.apply(t)}Se(){return 4}}class dt extends Q{constructor(){super()}apply(t){!1===t.Ze.disabled&&this.chained.apply(t)}Se(){return 5}}class pt extends Q{constructor(){super()}apply(t){!0===t.Ze.disabled&&this.chained.apply(t)}Se(){return 5}}class gt extends Q{constructor(){super()}apply(t){const e=t.Ze;!0!==e.selected&&!0!==e.checked||this.chained.apply(t)}Se(){return 5}}class mt extends Q{constructor(t){super(),this.condition=t}apply(t){if(t.conditions[this.condition])try{t.cs.push(this.condition),this.chained.apply(t)}finally{t.cs.pop()}}Se(){return 5}}class bt extends j{constructor(){super(),this.applied=!1}apply(t){this.applied=!0}clone(){const t=new bt;return t.applied=this.applied,t}}class Et extends Q{constructor(t){super(),this.ls=new bt,this.us=V(t,this.ls)}apply(t){this.us.apply(t),this.ls.applied||this.chained.apply(t),this.ls.applied=!1}Se(){return this.us.Se()}}class wt{constructor(t,e,n){this.condition=t,this.Be=e,this.as=n}increment(t){t.increment(this.condition,this.as)}decrement(t){t.decrement(this.condition,this.as)}Ue(t){return t.Ue(this.Be)}}class vt extends wt{constructor(t,e,n){super(t,e,n)}fresh(t){return new vt(this.condition,this.Be,this.Ue(t))}push(t,e){return 0==e&&this.increment(t),!1}pop(t,e){return 0==e&&(this.decrement(t),!0)}}class yt extends wt{constructor(t,e,n){super(t,e,n)}fresh(t){return new yt(this.condition,this.Be,this.Ue(t))}push(t,e){return 0==e?this.increment(t):1==e&&this.decrement(t),!1}pop(t,e){return 0==e?(this.decrement(t),!0):(1==e&&this.increment(t),!1)}}class Tt extends wt{constructor(t,e,n){super(t,e,n),this.fired=!1}fresh(t){return new Tt(this.condition,this.Be,this.Ue(t))}push(t,e){return!!this.fired&&(this.decrement(t),!0)}pop(t,e){return this.fired?(this.decrement(t),!0):(0==e&&(this.fired=!0,this.increment(t)),!1)}}class Nt extends wt{constructor(t,e,n){super(t,e,n),this.fired=!1}fresh(t){return new Nt(this.condition,this.Be,this.Ue(t))}push(t,e){return this.fired&&(-1==e?this.increment(t):0==e&&this.decrement(t)),!1}pop(t,e){if(this.fired){if(-1==e)return this.decrement(t),!0;0==e&&this.increment(t)}else 0==e&&(this.fired=!0,this.increment(t));return!1}}class St{constructor(t,e){this.afterprop=t,this.element=e}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.fs(this.afterprop,this.element),!0)}}class xt{constructor(t){this.lang=t}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.lang=this.lang,!0)}}class Ct{constructor(t){this.ds=t}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.quotes=this.ds,!0)}}class _t extends r.d{constructor(t){super(),this.element=t}ps(t,e){switch(e){case"url":return t?new r.l(t):new r.l("about:invalid");case"string":default:return t?new r.k(t):new r.k("")}}et(t){if("attr"!==t.name)return super.et(t);let e="string",n=null,i=null;if(t.values[0]instanceof r.j){const i=t.values[0].values;i.length>=2&&(e=i[1].stringValue()),n=i[0].stringValue()}else n=t.values[0].stringValue();return i=t.values.length>1?this.ps(t.values[1].stringValue(),e):this.ps(null,e),this.element&&this.element.hasAttribute(n)?this.ps(this.element.getAttribute(n),e):i}}class It extends r.d{constructor(t,e,n){super(),this.cascade=t,this.element=e,this.ws=n}$(t){const e=this.cascade,n=e.quotes,i=Math.floor(n.length/2)-1;switch(t.name){case"open-quote":{const t=n[2*Math.min(i,e.gs)];return e.gs++,t}case"close-quote":return e.gs>0&&e.gs--,n[2*Math.min(i,e.gs)+1];case"no-open-quote":return e.gs++,new r.k("");case"no-close-quote":return e.gs>0&&e.gs--,new r.k("")}return t}format(t,e){let n,i=!1,r=!1;null!=(n=e.match(/^upper-(.*)/))?(i=!0,e=n[1]):null!=(n=e.match(/^lower-(.*)/))&&(r=!0,e=n[1]);let o="";return At[e]?o=function(t,e){if(e>t[0]||e<=0||e!=Math.round(e))return"";let n="";for(let i=1;i<t.length;i+=2){const s=t[i];let r=Math.floor(e/s);if(r>20)return"";for(e-=r*s;r>0;)n+=t[i+1],r--}return n}(At[e],t):Ot[e]?o=function(t,e){if(e<=0||e!=Math.round(e))return"";const n=function(t){const e=[];let n=0;for(;n<t.length;)if("-"==t.substr(n+1,1)){const i=t.charCodeAt(n),s=t.charCodeAt(n+2);n+=3;for(let t=i;t<=s;t++)e.push(String.fromCharCode(t))}else e.push(t.substr(n++,1));return e}(t);let i="";do{const t=--e%n.length;i=n[t]+i,e=(e-t)/n.length}while(e>0);return i}(Ot[e],t):null!=kt[e]?o=kt[e]:"decimal-leading-zero"==e?1==(o=`${t}`).length&&(o=`0${o}`):o="cjk-ideographic"==e||"trad-chinese-informal"==e?function(t,e){if(t>9999||t<-9999)return`${t}`;if(0==t)return e.digits.charAt(0);const n=new s.d;if(t<0&&(n.append(e.negative),t=-t),t<10)n.append(e.digits.charAt(t));else if(!e.formal&&t<=19)n.append(e.markers.charAt(0)),0!=t&&n.append(e.digits.charAt(t-10));else{const i=Math.floor(t/1e3);i&&(n.append(e.digits.charAt(i)),n.append(e.markers.charAt(2)));const s=Math.floor(t/100)%10;s&&(n.append(e.digits.charAt(s)),n.append(e.markers.charAt(1)));const r=Math.floor(t/10)%10;r&&(n.append(e.digits.charAt(r)),n.append(e.markers.charAt(0)));const o=t%10;o&&n.append(e.digits.charAt(o))}return n.toString()}(t,Dt):`${t}`,i?o.toUpperCase():r?o.toLowerCase():o}bs(t){const e=t[0].toString(),n=t.length>1?t[1].stringValue():"decimal",i=this.cascade.counters[e];if(i&&i.length){const t=i&&i.length&&i[i.length-1]||0;return new r.k(this.format(t,n))}{const t=this,i=new r.c(this.ws.Es(e,e=>t.format(e||0,n)));return new r.j([i])}}xs(t){const e=t[0].toString(),n=t[1].stringValue(),i=t.length>2?t[2].stringValue():"decimal",o=this.cascade.counters[e],a=new s.d;if(o&&o.length)for(let t=0;t<o.length;t++)t>0&&a.append(n),a.append(this.format(o[t],i));const h=this,l=new r.c(this.ws.ys(e,t=>{const e=[];if(t.length)for(let n=0;n<t.length;n++)e.push(h.format(t[n],i));const s=a.toString();return s.length&&e.push(s),e.length?e.join(n):h.format(0,i)}));return new r.j([l])}vs(t){const e=t[0];let n;n=e instanceof r.l?e.url:e.stringValue();const i=t[1].toString(),s=t.length>2?t[2].stringValue():"decimal",o=this,a=new r.c(this.ws.ks(n,i,t=>o.format(t||0,s)));return new r.j([a])}Ss(t){const e=t[0];let n;n=e instanceof r.l?e.url:e.stringValue();const i=t[1].toString(),s=t[2].stringValue(),o=t.length>3?t[3].stringValue():"decimal",a=this,h=new r.c(this.ws.Cs(n,i,t=>{const e=t.map(t=>a.format(t,o));return e.length?e.join(s):a.format(0,o)}));return new r.j([h])}et(t){switch(t.name){case"counter":if(t.values.length<=2)return this.bs(t.values);break;case"counters":if(t.values.length<=3)return this.xs(t.values);break;case"target-counter":if(t.values.length<=3)return this.vs(t.values);break;case"target-counters":if(t.values.length<=4)return this.Ss(t.values)}return c.b.warn("E_CSS_CONTENT_PROP:",t.toString()),new r.k("")}}const At={roman:[4999,1e3,"M",900,"CM",500,"D",400,"CD",100,"C",90,"XC",50,"L",40,"XL",10,"X",9,"IX",5,"V",4,"IV",1,"I"],armenian:[9999,9e3,"ք",8e3,"փ",7e3,"ւ",6e3,"ց",5e3,"ր",4e3,"տ",3e3,"վ",2e3,"ս",1e3,"ռ",900,"ջ",800,"պ",700,"չ",600,"ո",500,"շ",400,"ն",300,"յ",200,"մ",100,"ճ",90,"ղ",80,"ձ",70,"հ",60,"կ",50,"ծ",40,"խ",30,"լ",20,"ի",10,"ժ",9,"թ",8,"ը",7,"է",6,"զ",5,"ե",4,"դ",3,"գ",2,"բ",1,"ա"],georgian:[19999,1e4,"ჵ",9e3,"ჰ",8e3,"ჯ",7e3,"ჴ",6e3,"ხ",5e3,"ჭ",4e3,"წ",3e3,"ძ",2e3,"ც",1e3,"ჩ",900,"შ",800,"ყ",700,"ღ",600,"ქ",500,"ფ",400,"ჳ",300,"ტ",200,"ს",100,"რ",90,"ჟ",80,"პ",70,"ო",60,"ჲ",50,"ნ",40,"მ",30,"ლ",20,"კ",10,"ი",9,"თ",8,"ჱ",7,"ზ",6,"ვ",5,"ე",4,"დ",3,"გ",2,"ბ",1,"ა"],hebrew:[999,400,"ת",300,"ש",200,"ר",100,"ק",90,"צ",80,"פ",70,"ע",60,"ס",50,"נ",40,"מ",30,"ל",20,"כ",19,"יט",18,"יח",17,"יז",16,"טז",15,"טו",10,"י",9,"ט",8,"ח",7,"ז",6,"ו",5,"ה",4,"ד",3,"ג",2,"ב",1,"א"]},Ot={latin:"a-z",alpha:"a-z",greek:"α-ρσ-ω",russian:"а-ик-щэ-я"},kt={square:"■",disc:"•",circle:"◦",none:""},Dt={formal:!1,digits:"零一二三四五六七八九",markers:"十百千",negative:"負"},Lt=1/1048576;function Rt(t,e){for(const n in t)e[n]=t[n].clone()}class Pt{constructor(){this.qe=0,this.Ye={},this.tags={},this.nstags={},this.epubtypes={},this.classes={},this.ids={},this.pagetypes={},this.order=0}clone(){const t=new Pt;t.qe=this.qe;for(const e in this.Ye)t.Ye[e]=this.Ye[e];return Rt(this.tags,t.tags),Rt(this.nstags,t.nstags),Rt(this.epubtypes,t.epubtypes),Rt(this.classes,t.classes),Rt(this.ids,t.ids),Rt(this.pagetypes,t.pagetypes),t.order=this.order,t}je(t,e,n){const i=t[e];i&&(n=i.$e(n)),t[e]=n}Ps(t,e,n,i){return new Mt(this,t,e,n,i)}Ts(){return this.order+=Lt}}class Mt{constructor(t,e,n,i,s){this.context=e,this._s=n,this.ws=i,this.stack=[[],[]],this.conditions={},this.Ze=null,this.Rs=null,this.currentStyle=null,this.Ve=null,this.He="",this.Ge="",this.Xe="",this.We="",this.Ns="",this.Is=null,this.Fs=null,this.Je=!0,this.ts=!0,this.counters={},this.As=[{}],this.gs=0,this.lang="",this.Os=[0],this.os=0,this.Ls=[{}],this.rs=null,this.$s=[{}],this.Ms={},this.cs=[],this.code=t,this.quotes=[new r.k("“"),new r.k("”"),new r.k("‘"),new r.k("’")],this.ss=this.Ls[0],this.Ds=[this.rs],this.hs=this.Ls[0]}De(t){this.stack[this.stack.length-1].push(t)}increment(t,e){this.conditions[t]=(this.conditions[t]||0)+1,e&&(this.Ms[t]?this.Ms[t].push(e):this.Ms[t]=[e])}decrement(t,e){this.conditions[t]--,this.Ms[t]&&(this.Ms[t]=this.Ms[t].filter(t=>t!==e),0===this.Ms[t].length&&delete this.Ms[t])}Ue(t){let e=null;t&&(i.a(this.Rs),e=u.a.Ue(this.Rs,t));const n=this.cs.map(t=>{const e=this.Ms[t];return e&&e.length>0?1===e.length?e[0]:u.a.Bs([].concat(e)):null}).filter(t=>t);return n.length<=0?e:null===e?1===n.length?n[0]:u.a.Us(n):u.a.Us([e].concat(n))}zs(t,e){const n=t[e];n&&n.apply(this)}Vs(t,e,n){this.Ze=null,this.Rs=null,this.currentStyle=n,this.Ge="",this.He="",this.Xe="",this.We="",this.Ve=t,this.Ns="",this.Is=Ft,this.Fs=e,this.js()}Xs(t,e){this.counters[t]?this.counters[t].push(e):this.counters[t]=[e];let n=this.As[this.As.length-1];n||(n={},this.As[this.As.length-1]=n),n[t]=!0}Ws(t){let e=r.t.inline;const n=t.display;n&&(e=n.evaluate(this.context));let i=null,o=null,h=null;const l=t["counter-reset"];if(l){const t=l.evaluate(this.context);t&&(i=a.b(t,!0))}const c=t["counter-set"];if(c){const t=c.evaluate(this.context);t&&(h=a.b(t,!1))}const u=t["counter-increment"];if(u){const t=u.evaluate(this.context);t&&(o=a.b(t,!1))}if("ol"!=this.He&&"ul"!=this.He||this.Ge!=s.a.XHTML||(i||(i={}),i["ua-list-item"]=0),e===r.t.list_item&&(o||(o={}),o["ua-list-item"]=1),i)for(const t in i)this.Xs(t,i[t]);if(h)for(const t in h)if(this.counters[t]){const e=this.counters[t];e[e.length-1]=h[t]}else this.Xs(t,h[t]);if(o)for(const t in o){this.counters[t]||this.Xs(t,0);const e=this.counters[t];e[e.length-1]+=o[t]}if(e===r.t.list_item){const e=this.counters["ua-list-item"],n=e[e.length-1];t["ua-list-item-count"]=new x(new r.h(n),0)}this.As.push(null)}Hs(){const t=this.As.pop();if(t)for(const e in t){const t=this.counters[e];t&&(1==t.length?delete this.counters[e]:t.pop())}}fs(t,e){this.Ws(t),t.content&&(t.content=t.content.Ne(new It(this,e,this.ws))),this.Hs()}Gs(t,e,n){this.Fs=null,this.Ze=t,this.Rs=n,this.currentStyle=e,this.Ge=t.namespaceURI,this.He=t.localName;const i=this.code.Ye[this.Ge];this.Ns=i?i+this.He:"",this.Xe=t.getAttribute("id"),this.We=t.getAttributeNS(s.a.XML,"id");const o=t.getAttribute("class");this.Ve=o?o.split(/\s+/):Ft;const a=t.getAttributeNS(s.a.epub,"type");if(this.Is=a?a.split(/\s+/):Ft,"style"==this.He&&this.Ge==s.a.FB2){const e=t.getAttribute("name")||"";this.Ve=[e]}const h=s.u(t);h&&(this.stack[this.stack.length-1].push(new xt(this.lang)),this.lang=h.toLowerCase());const l=this.ts,c=this.Os;this.os=++c[c.length-1],c.push(0);const u=this.Ls,f=this.ss=u[u.length-1];let d=f[this.Ge];d||(d=f[this.Ge]={}),d[this.He]=(d[this.He]||0)+1,u.push({});const p=this.Ds;null!==p[p.length-1]?this.rs=--p[p.length-1]:this.rs=null,p.push(null);const g=this.$s,m=this.hs=g[g.length-1];m&&m[this.Ge]&&m[this.Ge][this.He]--,g.push({}),this.js(),this.Ys(t);const b=e.quotes;let E=null;if(b){const t=b.evaluate(this.context);t&&(E=new Ct(this.quotes),t===r.t.none?this.quotes=[new r.k(""),new r.k("")]:t instanceof r.j&&(this.quotes=t.values))}this.Ws(this.currentStyle);const w=this.Xe||this.We||t.getAttribute("name")||"";if(l||w){const t={};Object.keys(this.counters).forEach(e=>{t[e]=Array.from(this.counters[e])}),this._s.qs(w,t)}const v=R(this.currentStyle,"_pseudos");if(v){let e=!0;for(const n of Ut){n||(e=!1);const i=v[n];i&&(e?this.fs(i,t):this.stack[this.stack.length-2].push(new St(i,t)))}}E&&this.stack[this.stack.length-2].push(E)}Ks(t,e){for(const n in e)O(n)&&(e[n]=e[n].Ne(t))}Ys(t){const e=new _t(t),n=this.currentStyle,i=R(n,"_pseudos");for(const t in i)this.Ks(e,i[t]);this.Ks(e,n)}js(){let t;for(t=0;t<this.Ve.length;t++)this.zs(this.code.classes,this.Ve[t]);for(t=0;t<this.Is.length;t++)this.zs(this.code.epubtypes,this.Is[t]);this.zs(this.code.ids,this.Xe),this.zs(this.code.tags,this.He),""!=this.He&&this.zs(this.code.tags,"*"),this.zs(this.code.nstags,this.Ns),null!==this.Fs&&(this.zs(this.code.pagetypes,this.Fs),this.zs(this.code.pagetypes,"*")),this.Ze=null,this.Zs=null,this.stack.push([]);for(let e=1;e>=-1;--e){const n=this.stack[this.stack.length-e-2];for(t=0;t<n.length;)n[t].push(this,e)?n.splice(t,1):t++}this.Je=!0,this.ts=!1}pop(){for(let t=1;t>=-1;--t){const e=this.stack[this.stack.length-t-2];let n=0;for(;n<e.length;)e[n].pop(this,t)?e.splice(n,1):n++}this.stack.pop(),this.Je=!1}Qs(){this.pop()}Js(t){this.Os.pop(),this.Ls.pop(),this.Ds.pop(),this.$s.pop(),this.pop(),this.Hs()}}const Ft=[],Ut=["before","transclusion-before","footnote-call","footnote-marker","inner","first-letter","first-line","","transclusion-after","after"];var zt;!function(t){t[t.TOP=0]="TOP",t[t.SELECTOR=1]="SELECTOR",t[t.RULE=2]="RULE"}(zt||(zt={}));let Bt=null;function Vt(t){Bt=t}class $t extends o.f{constructor(t,e,n,i,s,r,o){super(t,e,o),this.condition=n,this.regionId=s,this.ti=r,this.chain=null,this.specificity=0,this.ei=null,this.si=0,this.pseudoelement=null,this.ii=!1,this.Be=null,this.cascade=i?i.cascade:Bt?Bt.clone():new Pt,this.state=zt.TOP}ni(t){this.cascade.je(this.cascade.tags,"*",t)}ri(t){const e=V(this.chain,t);e!==t&&e.ze(this.cascade)||this.ni(e)}oi(t){return this.state!=zt.TOP&&(this.hi(t),!0)}ci(t,e){(e||t)&&(this.specificity+=1,e&&t?this.chain.push(new Z(t,e.toLowerCase())):e?this.chain.push(new q(e.toLowerCase())):this.chain.push(new tt(t)))}li(t){if(this.pseudoelement)return c.b.warn(`::${this.pseudoelement}`,`followed by .${t}`),void this.chain.push(new mt(""));this.specificity+=256,this.chain.push(new K(t))}ui(t,e){if(this.pseudoelement)return c.b.warn(`::${this.pseudoelement}`,`followed by :${t}`),void this.chain.push(new mt(""));switch(t.toLowerCase()){case"enabled":this.chain.push(new dt);break;case"disabled":this.chain.push(new pt);break;case"checked":this.chain.push(new gt);break;case"root":this.chain.push(new at);break;case"link":this.chain.push(new q("a")),this.chain.push(new et("","href"));break;case"-adapt-href-epub-type":case"href-epub-type":if(e&&1==e.length&&"string"==typeof e[0]){const t=e[0],n=new RegExp(`(^|s)${s.s(t)}($|s)`);this.chain.push(new J(n))}else this.chain.push(new mt(""));break;case"-adapt-footnote-content":case"footnote-content":this.ii=!0;break;case"visited":case"active":case"hover":case"focus":this.chain.push(new mt(""));break;case"lang":if(e&&1==e.length&&"string"==typeof e[0]){const t=e[0];this.chain.push(new rt(new RegExp(`^${s.s(t.toLowerCase())}($|-)`)))}else this.chain.push(new mt(""));break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":{const n=Ht[t.toLowerCase()];e&&2==e.length?this.chain.push(new n(e[0],e[1])):this.chain.push(new mt(""));break}case"first-child":this.chain.push(new ot);break;case"last-child":this.chain.push(new ct(0,1));break;case"first-of-type":this.chain.push(new lt(0,1));break;case"last-of-type":this.chain.push(new ut(0,1));break;case"only-child":this.chain.push(new ot),this.chain.push(new ct(0,1));break;case"only-of-type":this.chain.push(new lt(0,1)),this.chain.push(new ut(0,1));break;case"empty":this.chain.push(new ft);break;case"before":case"after":case"first-line":case"first-letter":return void this.ai(t,e);default:c.b.warn(`unknown pseudo-class selector: ${t}`),this.chain.push(new mt(""))}this.specificity+=256}ai(t,e){switch(t){case"before":case"after":case"first-line":case"first-letter":case"footnote-call":case"footnote-marker":case"inner":case"after-if-continues":this.pseudoelement?(c.b.warn(`Double pseudoelement ::${this.pseudoelement}::${t}`),this.chain.push(new mt(""))):this.pseudoelement=t;break;case"first-n-lines":if(e&&1==e.length&&"number"==typeof e[0]){const n=Math.round(e[0]);if(n>0&&n==e[0]){this.pseudoelement?(c.b.warn(`Double pseudoelement ::${this.pseudoelement}::${t}`),this.chain.push(new mt(""))):this.pseudoelement=`first-${n}-lines`;break}}this.chain.push(new mt(""));break;case"nth-fragment":e&&2==e.length?this.Be=`NFS_${e[0]}_${e[1]}`:this.chain.push(new mt(""));break;default:c.b.warn(`Unrecognized pseudoelement: ::${t}`),this.chain.push(new mt(""))}this.specificity+=1}fi(t){this.specificity+=65536,this.chain.push(new Y(t))}di(t,e,n,i){let r;switch(this.specificity+=256,e=e.toLowerCase(),i=i||"",n){case h.a.EOF:r=new et(t,e);break;case h.a.EQ:r=new nt(t,e,i);break;case h.a.TILDE_EQ:r=!i||i.match(/\s/)?new mt(""):new st(t,e,new RegExp(`(^|\\s)${s.s(i)}($|\\s)`));break;case h.a.BAR_EQ:r=new st(t,e,new RegExp(`^${s.s(i)}($|-)`));break;case h.a.HAT_EQ:r=i?new st(t,e,new RegExp(`^${s.s(i)}`)):new mt("");break;case h.a.DOLLAR_EQ:r=i?new st(t,e,new RegExp(`${s.s(i)}$`)):new mt("");break;case h.a.STAR_EQ:r=i?new st(t,e,new RegExp(s.s(i))):new mt("");break;case h.a.COL_COL:"supported"==i?r=new it(t,e):(c.b.warn("Unsupported :: attr selector op:",i),r=new mt(""));break;default:c.b.warn("Unsupported attr selector:",n),r=new mt("")}this.chain.push(r)}pi(){const t=`d${jt++}`;this.ri(new X(new vt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}wi(){const t=`c${jt++}`;this.ri(new X(new yt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}gi(){const t=`a${jt++}`;this.ri(new X(new Tt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}mi(){const t=`f${jt++}`;this.ri(new X(new Nt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}bi(){this.Ei(),this.pseudoelement=null,this.ii=!1,this.specificity=0,this.chain=[]}xi(){this.oi("E_CSS_UNEXPECTED_SELECTOR")||(this.state=zt.SELECTOR,this.ei={},this.pseudoelement=null,this.specificity=0,this.ii=!1,this.chain=[])}error(t,e){super.error(t,e),this.state==zt.SELECTOR&&(this.state=zt.TOP)}yi(t){super.yi(t),this.state=zt.TOP}ki(){this.Ei(),super.ki(),this.state==zt.SELECTOR&&(this.state=zt.TOP)}Si(){super.Si(),this.Ci=zt.TOP}Ei(){if(this.chain){const t=this.specificity+this.cascade.Ts();this.ri(this.Pi(t)),this.chain=null,this.pseudoelement=null,this.Be=null,this.ii=!1,this.specificity=0}}Pi(t){let e=this.regionId;return this.ii&&(e=e?"xxx-bogus-xxx":"footnote"),new W(this.ei,t,this.pseudoelement,e,this.Be)}special(t,e){let n;n=this.condition?new C(e,0,this.condition):new x(e,0),U(this.ei,t).push(n)}property(t,e,n){this.ti.Ti(t,e,n,this)}_i(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Ri(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}Ni(t,e,n){"display"!=t||e!==r.t.oeb_page_head&&e!==r.t.oeb_page_foot||(this.Ni("flow-options",new r.j([r.t.exclusive,r.t._static]),n),this.Ni("flow-into",e,n),e=r.t.block),f.b("SIMPLE_PROPERTY").forEach(i=>{const s=i({name:t,value:e,important:n});t=s.name,e=s.value,n=s.important});const i=n?this.Ii():this.Fi(),s=this.condition?new C(e,i,this.condition):new x(e,i);L(this.ei,t,s)}finish(){return this.cascade}Ai(t){switch(t){case"not":{const t=new Xt(this);t.xi(),this.owner.Oi(t);break}}}}const Ht={"nth-child":class extends ht{constructor(t,e){super(t,e)}apply(t){this.es(t.os)&&this.chained.apply(t)}Se(){return 5}},"nth-of-type":lt,"nth-last-child":ct,"nth-last-of-type":ut};let jt=0;class Xt extends $t{constructor(t){super(t.scope,t.owner,t.condition,t,t.regionId,t.ti,!1),this.parent=t,this.Li=t.chain}Ai(t){"not"==t&&this.hi("E_CSS_UNEXPECTED_NOT")}ki(){this.hi("E_CSS_UNEXPECTED_RULE_BODY")}bi(){this.hi("E_CSS_UNEXPECTED_NEXT_SELECTOR")}$i(){this.chain&&this.chain.length>0&&this.Li.push(new Et(this.chain)),this.parent.specificity+=this.specificity,this.owner.Mi()}error(t,e){super.error(t,e),this.owner.Mi()}}class Gt extends o.f{constructor(t,e){super(t,e,!1)}property(t,e,n){if(this.scope.values[t])this.error(`E_CSS_NAME_REDEFINED ${t}`,this.Di());else{const n=t.match(/height|^(top|bottom)$/)?"vh":"vw",i=new l.x(this.scope,100,n);this.scope.Zt(t,e.nt(this.scope,i))}}}class Wt extends o.f{constructor(t,e,n,i,s){super(t,e,!1),this.condition=n,this.ei=i,this.ti=s,this.order=0}property(t,e,n){n?c.b.warn("E_IMPORTANT_NOT_ALLOWED"):this.ti.Ti(t,e,n,this)}_i(t,e){c.b.warn("E_INVALID_PROPERTY_VALUE",`${t}:`,e.toString())}Ri(t,e){c.b.warn("E_INVALID_PROPERTY",`${t}:`,e.toString())}Ni(t,e,n){let i=n?this.Ii():this.Fi();i+=this.order,this.order+=Lt;const s=this.condition?new C(e,i,this.condition):new x(e,i);L(this.ei,t,s)}}class Qt extends o.b{constructor(t,e){super(t),this.ti=e,this.ei={},this.order=0}property(t,e,n){this.ti.Ti(t,e,n,this)}_i(t,e){c.b.warn("E_INVALID_PROPERTY_VALUE",`${t}:`,e.toString())}Ri(t,e){c.b.warn("E_INVALID_PROPERTY",`${t}:`,e.toString())}Ni(t,e,n){let i=n?o.e:o.d;i+=this.order,this.order+=Lt;const s=new x(e,i);L(this.ei,t,s)}}function Kt(t,e){const n=M(t);n&&n.forEach(t=>{t.matcher.matches()&&e(t.styles)})}function Yt(t,e,n){Kt(n,n=>{ne(t,n,e)})}function qt(t,e,n,i){const s=new Qt(t,e),r=new h.b(i,s);try{o.j(r,s,n)}catch(t){c.b.warn(t,"Style attribute parse error:")}return s.ei}function Zt(t,e,n){const i=t["writing-mode"];if(i){const t=i.evaluate(e,"writing-mode");if(t&&t!==r.t.inherit)return t===r.t.vertical_rl}return n}function Jt(t,e,n){const i=t.direction;if(i){const t=i.evaluate(e,"direction");if(t&&t!==r.t.inherit)return t===r.t.rtl}return n}function te(t,e,n,i,s){const r={};for(const e in t)O(e)&&(r[e]=D(t,e));return Yt(r,e,t),ee(t,n,i,(t,n)=>{ne(r,n,e),Yt(r,e,n)}),r}function ee(t,e,n,i){const s=R(t,"_regions");if((e||n)&&s){if(n){const t=["footnote"];e=e?e.concat(t):t}for(const t of e){const e=s[t];e&&i(t,e)}}}function ne(t,e,n){for(const i in e)if(O(i)){const s=D(e,i),r=t[i];t[i]=_(n,r,s)}}const ie=(t,e,n,i,s)=>{const r=n?i?N:y:i?S:T;for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];if(!i)continue;const o=r[n];let a;if(o){const e=t[o];if(e&&e.priority>i.priority)continue;a=w[o]?o:n}else a=n;e[a]=s(n,i)}}},function(t,e,n){"use strict";var i;function s(t){const e=Array.from(t);let n=null;return e[0]instanceof Error&&(n=e.shift()),{error:n,messages:e}}function r(t){const e=t.error,n=e&&(e.frameTrace||e.stack);let i=[].concat(t.messages);return e&&(i.length>0&&(i=i.concat(["\n"])),i=i.concat([e.toString()]),n&&(i=i.concat(["\n"]).concat(n))),i}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"}(i||(i={}));const o=new class{constructor(t){this.opt_console=t,this.listeners={}}Bi(t){this.opt_console?this.opt_console.debug?this.opt_console.debug(...t):this.opt_console.log(...t):console.debug(...t)}Ui(t){this.opt_console?this.opt_console.info?this.opt_console.info(...t):this.opt_console.log(...t):console.info(...t)}zi(t){this.opt_console?this.opt_console.warn?this.opt_console.warn(...t):this.opt_console.log(...t):console.warn(...t)}Vi(t){this.opt_console?this.opt_console.error?this.opt_console.error(...t):this.opt_console.log(...t):console.error(...t)}ji(t,e){const n=this.listeners[t];n&&n.forEach(t=>{t(e)})}addListener(t,e){let n=this.listeners[t];n||(n=this.listeners[t]=[]),n.push(e)}debug(...t){const e=s(arguments);this.Bi(r(e)),this.ji(i.DEBUG,e)}info(...t){const e=s(arguments);this.Ui(r(e)),this.ji(i.INFO,e)}warn(...t){const e=s(arguments);this.zi(r(e)),this.ji(i.WARN,e)}error(...t){const e=s(arguments);this.Vi(r(e)),this.ji(i.ERROR,e)}}},function(t,e,n){"use strict";function i(t){}function s(t){}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})},function(t,e,n){"use strict";n.d(e,"s",function(){return d}),n.d(e,"t",function(){return p}),n.d(e,"d",function(){return g}),n.d(e,"l",function(){return E}),n.d(e,"m",function(){return w}),n.d(e,"z",function(){return y}),n.d(e,"p",function(){return T}),n.d(e,"f",function(){return N}),n.d(e,"g",function(){return S}),n.d(e,"r",function(){return x}),n.d(e,"q",function(){return C}),n.d(e,"u",function(){return I}),n.d(e,"w",function(){return A}),n.d(e,"x",function(){return O}),n.d(e,"v",function(){return k}),n.d(e,"o",function(){return D}),n.d(e,"n",function(){return L}),n.d(e,"e",function(){return P}),n.d(e,"k",function(){return M}),n.d(e,"a",function(){return F}),n.d(e,"h",function(){return U}),n.d(e,"i",function(){return z}),n.d(e,"j",function(){return B}),n.d(e,"b",function(){return V}),n.d(e,"c",function(){return $}),n.d(e,"y",function(){return H});var i=n(7),s=n(1),r=n(0),o=n(10),a=n(20),h=n(2),l=n(27),c=n(4),u=n(11),f=n(15);const d={transform:!0,"transform-origin":!0},p={top:!0,bottom:!0,left:!0,right:!0};class g{constructor(t,e,n){this.target=t,this.name=e,this.value=n}}const m={show:function(t){t.style.visibility="visible"},hide:function(t){t.style.visibility="hidden"},play:function(t){t.currentTime=0,t.play()},pause:function(t){t.pause()},resume:function(t){t.play()},mute:function(t){t.muted=!0},unmute:function(t){t.muted=!1}};function b(t,e){const n=m[e];return n?()=>{for(let e=0;e<t.length;e++)try{n(t[e])}catch(t){}}:null}class E extends s.c{constructor(t,e){super(),this.container=t,this.Xi=e,this.Wi=null,this.Hi=[],this.Gi={},this.dimensions={width:0,height:0},this.Yi=!1,this.qi=!1,this.Ki=!0,this.Zi=!0,this.Qi=0,this.position=null,this.offset=-1,this.side=null,this.fetchers=[],this.Ji={top:{},bottom:{},left:{},right:{}};const n=this;this.tn=(t=>{const e=t.currentTarget,i=e.getAttribute("href")||e.getAttributeNS(s.a.XLINK,"href");if(i){const s={type:"hyperlink",target:null,currentTarget:null,en:e,href:i,preventDefault(){t.preventDefault()}};n.dispatchEvent(s)}})}sn(t){this.Ki=t,t?this.container.setAttribute(E.AUTO_PAGE_WIDTH_ATTRIBUTE,"true"):this.container.removeAttribute(E.AUTO_PAGE_WIDTH_ATTRIBUTE)}nn(t){this.Zi=t,t?this.container.setAttribute(E.AUTO_PAGE_HEIGHT_ATTRIBUTE,"true"):this.container.removeAttribute(E.AUTO_PAGE_HEIGHT_ATTRIBUTE)}rn(t,e){const n=this.Gi[e];n?n.push(t):this.Gi[e]=[t]}finish(t,e){Object.keys(this.Gi).forEach(t=>{const e=this.Gi[t];for(let t=0;t<e.length;)this.container.contains(e[t])?t++:e.splice(t,1);0===e.length&&delete this.Gi[t]});const n=this.Hi;for(let t=0;t<n.length;t++){const e=n[t];(e.target!==this.container||"transform"!==e.name||this.Ki||this.Zi)&&s.F(e.target,e.name,e.value.toString())}const i=e.on(this.container);this.dimensions.width=i.width,this.dimensions.height=i.height;for(let e=0;e<t.length;e++){const n=t[e],i=this.Gi[n.ref],s=this.Gi[n.observer];if(i&&s){const t=b(i,n.action);if(t)for(let e=0;e<s.length;e++)s[e].addEventListener(n.event,t,!1)}}}zoom(t){s.F(this.container,"transform",`scale(${t})`)}hn(){return this.Wi||this.container}}E.AUTO_PAGE_WIDTH_ATTRIBUTE="data-vivliostyle-auto-page-width",E.AUTO_PAGE_HEIGHT_ATTRIBUTE="data-vivliostyle-auto-page-height";const w="data-adapt-spec",v=f.f.Whitespace;function y(t){switch(t){case"normal":case"nowrap":return v.IGNORE;case"pre-line":return v.NEWLINE;case"pre":case"pre-wrap":return v.PRESERVE;default:return null}}function T(t,e){if(1==t.nodeType)return!1;const n=t.textContent;switch(e){case v.IGNORE:return!!n.match(/^\s*$/);case v.NEWLINE:return!!n.match(/^[ \t\f]*$/);case v.PRESERVE:return 0==n.length}throw new Error(`Unexpected whitespace: ${e}`)}class N{constructor(t,e){this.cn=t,this.ln=e,this.un=[],this.an=null}}class S{constructor(t,e,n,i,s,r,o,a,h){this.cn=t,this.element=e,this.startOffset=n,this.priority=i,this.linger=s,this.exclusive=r,this.repeated=o,this.last=a,this.breakBefore=h,this.startPage=-1}dn(t){return!!this.exclusive&&(!t.exclusive||this.priority>t.priority||this.last)}}function x(t,e){return t.top-e.top}function C(t,e){return e.right-t.right}function _(t,e){return t===e||!(!t||!e)&&t.node===e.node&&t.pn===e.pn&&R(t.wn,e.wn)&&R(t.gn,e.gn)&&_(t.mn,e.mn)}function I(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.bn!==e.bn||t.after!==e.after||t.steps.length!==e.steps.length)return!1;for(let n=0;n<t.steps.length;n++)if(!_(t.steps[n],e.steps[n]))return!1;return!0}function A(t){return{steps:[{node:t,pn:D.NONE,wn:null,gn:null,mn:null,an:null,En:0}],bn:0,after:!1,xn:null}}function O(t,e){return{steps:[{node:t.yn,pn:D.NONE,wn:t.wn,gn:null,mn:null,an:null,En:null!=e?e:t.En}],bn:0,after:!1,xn:t.xn}}function k(t,e){const n=new M(t.node,e,0);return n.pn=t.pn,n.wn=t.wn,n.gn=t.gn,n.mn=t.mn?k(t.mn,e.copy()):null,n.an=t.an,n.En=t.En+1,n}const D=f.f.ShadowType;class L{constructor(t,e,n,i,s,r,o){this.owner=t,this.root=e,this.xmldoc=n,this.vn=i,this.type=r,this.styler=o,this.kn=null,s&&(s.kn=this)}equals(t){return!!t&&this.owner===t.owner&&this.xmldoc===t.xmldoc&&this.type===t.type&&R(this.vn,t.vn)}}function R(t,e){return t===e||!!t&&!!e&&t.equals(e)}class P{constructor(t,e){this.outer=t,this.count=e}}class M{constructor(t,e,n){this.yn=t,this.parent=e,this.Sn=n,this.bn=0,this.after=!1,this.gn=null,this.mn=null,this.shared=!1,this.inline=!0,this.overflow=!1,this.display=null,this.Cn=null,this.Pn=null,this.Tn=null,this.columnSpan=null,this.verticalAlign="baseline",this.captionSide="top",this._n=0,this.Rn=0,this.Nn=!1,this.In=!1,this.Fn=!1,this.breakBefore=null,this.breakAfter=null,this.An=null,this.On=null,this.lang=null,this.xn=null,this.Ln=null,this.$n={},this.En=1,this.Mn=null,this.Dn=null,this.pn=D.NONE,this.wn=e?e.wn:null,this.Bn=e?e.Bn:0,this.Un=f.b.FloatReference.INLINE,this.whitespace=e?e.whitespace:v.IGNORE,this.zn=e?e.zn:null,this.Vn=!!e&&e.Vn,this.jn=e?e.jn:{},this.vertical=!!e&&e.vertical,this.direction=e?e.direction:"ltr",this.Xn=e?e.Xn:null,this.an=e?e.an:null}Wn(){this.inline=!0,this.Bn=this.parent?this.parent.Bn:0,this.An=null,this.On=null,this.bn=0,this.after=!1,this.display=null,this.Un=f.b.FloatReference.INLINE,this.Cn=null,this.Pn=null,this.Tn=null,this.columnSpan=null,this.verticalAlign="baseline",this.Nn=!1,this.whitespace=this.parent?this.parent.whitespace:v.IGNORE,this.zn=this.parent?this.parent.zn:null,this.Vn=!!this.parent&&this.parent.Vn,this.breakBefore=null,this.breakAfter=null,this.gn=null,this.In=!1,this.Fn=!1,this.vertical=!!this.parent&&this.parent.vertical,this.gn=null,this.xn=null,this.an=this.parent?this.parent.an:null,this.Ln=null,this.$n={},this.En=1,this.Mn=null,this.Dn=null}Hn(){const t=new M(this.yn,this.parent,this.Sn);return t.bn=this.bn,t.after=this.after,t.gn=this.gn,t.pn=this.pn,t.wn=this.wn,t.mn=this.mn,t.inline=this.inline,t.Bn=this.Bn,t.display=this.display,t.Un=this.Un,t.Cn=this.Cn,t.Pn=this.Pn,t.Tn=this.Tn,t.columnSpan=this.columnSpan,t.verticalAlign=this.verticalAlign,t.captionSide=this.captionSide,t._n=this._n,t.Rn=this.Rn,t.In=this.In,t.Fn=this.Fn,t.Nn=this.Nn,t.whitespace=this.whitespace,t.zn=this.zn,t.Vn=this.Vn,t.breakBefore=this.breakBefore,t.breakAfter=this.breakAfter,t.An=this.An,t.On=this.On,t.Xn=this.Xn,t.vertical=this.vertical,t.overflow=this.overflow,t.xn=this.xn,t.an=this.an,t.Ln=this.Ln,t.$n=Object.create(this.$n),t.En=this.En,t.Mn=this.Mn,t.Dn=this.Dn,t}modify(){return this.shared?this.Hn():this}copy(){let t=this;do{if(t.shared)break;t.shared=!0,t=t.parent}while(t);return this}clone(){const t=this.Hn();let e,n=t;for(;null!=(e=n.parent);)e=e.Hn(),n.parent=e,n=e;return t}Gn(){return{node:this.yn,pn:this.pn,wn:this.wn,gn:this.gn,mn:this.mn?this.mn.Gn():null,an:this.an,En:this.En}}Yn(){let t=this;const e=[];do{t.Xn&&t.parent&&t.parent.Xn!==t.Xn||e.push(t.Gn()),t=t.parent}while(t);return{steps:e,bn:this.xn?l.c(this.xn,this.bn):this.bn,after:this.after,xn:this.xn}}qn(){let t=this.parent;for(;t;){if(t.In)return!0;t=t.parent}return!1}Kn(){let t=this.parent;for(;t;){if(t.Fn)return t;t=t.parent}return null}Zn(t){let e=this;for(;e;)e.inline||t(e),e=e.parent}Qn(t){return this.an===t&&!!this.parent&&this.parent.an===t}}class F{constructor(t){this.primary=t,this.floats=null}clone(){const t=new F(this.primary);if(this.floats){t.floats=[];for(let e=0;e<this.floats.length;++e)t.floats[e]=this.floats[e]}return t}Jn(t){if(!t)return!1;if(this===t)return!0;if(!I(this.primary,t.primary))return!1;if(this.floats){if(!t.floats||this.floats.length!==t.floats.length)return!1;for(let e=0;e<this.floats.length;e++)if(!I(this.floats[e],t.floats[e]))return!1}else if(t.floats)return!1;return!0}}class U{constructor(t,e){this.er=t,this.sr=e}clone(){return new U(this.er.clone(),this.sr)}Jn(t){return!!t&&(this===t||this.er.Jn(t.er))}}class z{constructor(){this.positions=[],this.ir="any",this.breakAfter=null}clone(){const t=new z,e=this.positions,n=t.positions;for(let t=0;t<e.length;t++)n[t]=e[t].clone();return t.ir=this.ir,t.breakAfter=this.breakAfter,t}Jn(t){if(this===t)return!0;if(!t||this.positions.length!==t.positions.length)return!1;for(let e=0;e<this.positions.length;e++)if(!this.positions[e].Jn(t.positions[e]))return!1;return!0}nr(t){return this.positions.length>0&&this.positions[0].sr.startOffset<=t}}class B{constructor(){this.page=0,this.flows={},this.rr={},this.or=0}clone(){const t=new B;t.page=this.page,t.hr=this.hr,t.or=this.or,t.cr=this.cr,t.flows=this.flows;for(const e in this.rr)t.rr[e]=this.rr[e].clone();return t}Jn(t){if(this===t)return!0;if(!t||this.page!==t.page||this.or!==t.or)return!1;const e=Object.keys(this.rr),n=Object.keys(t.rr);if(e.length!==n.length)return!1;for(const n of e)if(!this.rr[n].Jn(t.rr[n]))return!1;return!0}nr(t,e){const n=this.rr[t];return!!n&&n.nr(e)}lr(t){const e=this.rr[t];return e?e.ir:"any"}ur(t){const e=this.rr[t];if(!e)return null;const n=e.positions[0];return n?n.sr:null}}class V{constructor(t){this.element=t,this.left=0,this.top=0,this.marginLeft=0,this.marginRight=0,this.marginTop=0,this.marginBottom=0,this.borderLeft=0,this.borderRight=0,this.borderTop=0,this.borderBottom=0,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.width=0,this.height=0,this.ar=0,this.dr=0,this.exclusions=null,this.pr=null,this.wr=0,this.gr=0,this.mr=0,this.br=0,this.Er=0,this.vertical=!1}xr(){return this.marginTop+this.borderTop+this.paddingTop}yr(){return this.marginBottom+this.borderBottom+this.paddingBottom}vr(){return this.marginLeft+this.borderLeft+this.paddingLeft}kr(){return this.marginRight+this.borderRight+this.paddingRight}Sr(){return this.vertical?this.kr():this.xr()}Cr(){return this.vertical?this.vr():this.yr()}Pr(){return this.vertical?this.xr():this.vr()}Tr(){return this.vertical?this.yr():this.kr()}_r(t){return this.vertical?t.right:t.top}Rr(t){return this.vertical?t.left:t.bottom}Nr(t){return this.vertical?t.top:t.left}Ir(t){return this.vertical?t.bottom:t.right}Fr(t){return this.vertical?t.bottom-t.top:t.right-t.left}Ar(t){return this.vertical?t.right-t.left:t.bottom-t.top}Or(){return this.vertical?-1:1}Lr(){return 1}$r(t){this.element=t.element,this.left=t.left,this.top=t.top,this.marginLeft=t.marginLeft,this.marginRight=t.marginRight,this.marginTop=t.marginTop,this.marginBottom=t.marginBottom,this.borderLeft=t.borderLeft,this.borderRight=t.borderRight,this.borderTop=t.borderTop,this.borderBottom=t.borderBottom,this.paddingLeft=t.paddingLeft,this.paddingRight=t.paddingRight,this.paddingTop=t.paddingTop,this.paddingBottom=t.paddingBottom,this.width=t.width,this.height=t.height,this.ar=t.ar,this.dr=t.dr,this.pr=t.pr,this.exclusions=t.exclusions,this.wr=t.wr,this.gr=t.gr,this.mr=t.mr,this.vertical=t.vertical}Mr(t,e){this.top=t,this.height=e,s.F(this.element,"top",`${t}px`),s.F(this.element,"height",`${e}px`)}Dr(t,e){this.left=t,this.width=e,s.F(this.element,"left",`${t}px`),s.F(this.element,"width",`${e}px`)}Br(t,e){this.vertical?this.Dr(t+e*this.Or(),e):this.Mr(t,e)}Ur(t,e){this.vertical?this.Mr(t,e):this.Dr(t,e)}clear(){const t=this.element;let e;for(;e=t.lastChild;)t.removeChild(e)}zr(){const t=this.Vr();return this.pr?this.pr.jr(t.x1,t.y1):u.k(t.x1,t.y1,t.x2,t.y2)}Vr(){const t=this.ar+this.left+this.vr(),e=this.dr+this.top+this.xr();return new u.c(t,e,t+this.width,e+this.height)}Xr(){const t=this.ar+this.left+this.marginLeft+this.borderLeft,e=this.dr+this.top+this.marginTop+this.borderTop,n=this.paddingLeft+this.width+this.paddingRight,i=this.paddingTop+this.height+this.paddingBottom;return new u.c(t,e,t+n,e+i)}Wr(t,e){const n=this.Hr();return a.e(t,n.x1,n.y1,n.x2-n.x1,n.y2-n.y1,e)}Hr(){const t=this.ar+this.left,e=this.dr+this.top,n=this.vr()+this.width+this.kr(),i=this.xr()+this.height+this.yr();return new u.c(t,e,t+n,e+i)}}class $ extends r.m{constructor(t,e,n,i){super(),this.elem=t,this.context=e,this.Gr=n,this.Yr=i}qr(t,e){e||(e=this.elem.ownerDocument.createTextNode(t)),this.elem.appendChild(e)}R(t){return this.qr(t.str),null}Y(t){if(this.Gr.url)this.elem.setAttribute("src",t.url);else{const e=this.elem.ownerDocument.createElementNS(s.a.XHTML,"img");e.setAttribute("src",t.url),this.elem.appendChild(e)}return null}Z(t){return this.S(t.values),null}st(t){const e=t.nt();let n=e.evaluate(this.context);if("string"==typeof n){e instanceof c.s&&(n=o.m(e.scope,new h.b(n,null),"").stringValue()),i.a(this.elem.ownerDocument);const t=this.Yr(e,n,this.elem.ownerDocument);this.qr(n,t)}return null}}function H(t){return null!=t&&t!==r.t.normal&&t!==r.t.none&&t!==r.t.inherit}},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return h});var i,s=n(6);!function(t){t.SIMPLE_PROPERTY="SIMPLE_PROPERTY",t.PREPROCESS_SINGLE_DOCUMENT="PREPROCESS_SINGLE_DOCUMENT",t.PREPROCESS_TEXT_CONTENT="PREPROCESS_TEXT_CONTENT",t.PREPROCESS_ELEMENT_STYLE="PREPROCESS_ELEMENT_STYLE",t.POLYFILLED_INHERITED_PROPS="POLYFILLED_INHERITED_PROPS",t.CONFIGURATION="CONFIGURATION",t.RESOLVE_TEXT_NODE_BREAKER="RESOLVE_TEXT_NODE_BREAKER",t.RESOLVE_FORMATTING_CONTEXT="RESOLVE_FORMATTING_CONTEXT",t.RESOLVE_LAYOUT_PROCESSOR="RESOLVE_LAYOUT_PROCESSOR",t.POST_LAYOUT_BLOCK="POST_LAYOUT_BLOCK"}(i||(i={}));const r={};function o(t,e){if(i[t]){let n=r[t];n||(n=r[t]=[]),n.push(e)}else s.b.warn(new Error(`Skipping unknown plugin hook '${t}'.`))}function a(t){return r[t]||[]}const h={Kr:o,Zr:function(t,e){if(i[t]){const n=r[t];if(n){const t=n.indexOf(e);t>=0&&n.splice(t,1)}}else s.b.warn(new Error(`Ignoring unknown plugin hook '${t}'.`))}}},function(t,e,n){"use strict";n.d(e,"c",function(){return f}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return p}),n.d(e,"g",function(){return b}),n.d(e,"h",function(){return E}),n.d(e,"a",function(){return v}),n.d(e,"f",function(){return T}),n.d(e,"b",function(){return B}),n.d(e,"k",function(){return $}),n.d(e,"l",function(){return H}),n.d(e,"m",function(){return j}),n.d(e,"j",function(){return X}),n.d(e,"i",function(){return W});var i=n(1),s=n(0),r=n(2),o=n(4),a=n(6),h=n(16),l=n(3);const c=0,u=16777216,f=33554432,d=50331648,p=67108864,g=83886080,m=100663296;var b;function E(t){let e=parseInt(t,16);if(isNaN(e))throw new Error("E_CSS_COLOR");if(6==t.length)return new s.a(e);if(3==t.length)return e=15&e|(15&e)<<4|(240&e)<<4|(240&e)<<8|(3840&e)<<8|(3840&e)<<12,new s.a(e);throw new Error("E_CSS_COLOR")}!function(t){t.USER_AGENT="UA",t.USER="User",t.AUTHOR="Author"}(b||(b={}));class w{constructor(t){this.scope=t,this.flavor=b.AUTHOR}Di(){return null}Qr(){return this.scope}error(t,e){}yi(t){this.flavor=t}ci(t,e){}li(t){}ui(t,e){}ai(t,e){}fi(t){}di(t,e,n,i){}pi(){}wi(){}gi(){}mi(){}bi(){}xi(){}Jr(){}eo(t){}so(){}io(){}no(){}ro(){}oo(t){}ho(t){}co(t){this.ho(t)}lo(t){}uo(){}ao(t,e,n){}fo(t,e,n){}do(t,e,n){}ki(){}property(t,e,n){}Si(){}Ai(t){}$i(){}Ii(){switch(this.flavor){case b.USER_AGENT:return c;case b.USER:return m;default:return g}}Fi(){switch(this.flavor){case b.USER_AGENT:return c;case b.USER:return u;default:return f}}}class v extends w{constructor(){super(null),this.stack=[],this.tokenizer=null,this.slave=null}Oi(t){this.stack.push(this.slave),this.slave=t}Mi(){this.slave=this.stack.pop()}Di(){return this.tokenizer?this.tokenizer.token():null}Qr(){return this.slave.Qr()}error(t,e){this.slave.error(t,e)}po(t,e){a.b.warn(t)}yi(t){super.yi(t),this.stack.length>0&&(this.slave=this.stack[0],this.stack=[]),this.slave.yi(t)}ci(t,e){this.slave.ci(t,e)}li(t){this.slave.li(t)}ui(t,e){this.slave.ui(t,e)}ai(t,e){this.slave.ai(t,e)}fi(t){this.slave.fi(t)}di(t,e,n,i){this.slave.di(t,e,n,i)}pi(){this.slave.pi()}wi(){this.slave.wi()}gi(){this.slave.gi()}mi(){this.slave.mi()}bi(){this.slave.bi()}xi(){this.slave.xi()}Jr(){this.slave.Jr()}eo(t){this.slave.eo(t)}so(){this.slave.so()}io(){this.slave.io()}no(){this.slave.no()}ro(){this.slave.ro()}oo(t){this.slave.oo(t)}ho(t){this.slave.ho(t)}lo(t){this.slave.lo(t)}uo(){this.slave.uo()}ao(t,e,n){this.slave.ao(t,e,n)}fo(t,e,n){this.slave.fo(t,e,n)}do(t,e,n){this.slave.do(t,e,n)}ki(){this.slave.ki()}property(t,e,n){this.slave.property(t,e,n)}Si(){this.slave.Si()}Ai(t){this.slave.Ai(t)}$i(){this.slave.$i()}}class y extends w{constructor(t,e,n){super(t),this.owner=e,this.wo=n,this.depth=0,e&&(this.flavor=e.flavor)}Di(){return this.owner.Di()}error(t,e){this.owner.po(t,e)}ki(){this.depth++}Si(){0!=--this.depth||this.wo||this.owner.Mi()}}class T extends y{constructor(t,e,n){super(t,e,n)}report(t){this.error(t,this.Di())}hi(t){this.report(t),this.owner.Oi(new y(this.scope,this.owner,!1))}xi(){this.hi("E_CSS_UNEXPECTED_SELECTOR")}Jr(){this.hi("E_CSS_UNEXPECTED_FONT_FACE")}eo(t){this.hi("E_CSS_UNEXPECTED_FOOTNOTE")}so(){this.hi("E_CSS_UNEXPECTED_VIEWPORT")}io(){this.hi("E_CSS_UNEXPECTED_DEFINE")}no(){this.hi("E_CSS_UNEXPECTED_REGION")}ro(){this.hi("E_CSS_UNEXPECTED_PAGE")}ho(t){this.hi("E_CSS_UNEXPECTED_WHEN")}lo(t){this.hi("E_CSS_UNEXPECTED_FLOW")}uo(){this.hi("E_CSS_UNEXPECTED_PAGE_TEMPLATE")}ao(t,e,n){this.hi("E_CSS_UNEXPECTED_PAGE_MASTER")}fo(t,e,n){this.hi("E_CSS_UNEXPECTED_PARTITION")}do(t,e,n){this.hi("E_CSS_UNEXPECTED_PARTITION_GROUP")}Ai(t){this.hi("E_CSS_UNEXPECTED_SELECTOR_FUNC")}$i(){this.hi("E_CSS_UNEXPECTED_END_SELECTOR_FUNC")}property(t,e,n){this.error("E_CSS_UNEXPECTED_PROPERTY",this.Di())}}const N=[],S=[],x=[],C=[],_=[],I=[],A=[],O=[],k=[],D=[],L=[],R=[],P=[];var M;!function(t){t[t.SELECTOR_NAME_1=1]="SELECTOR_NAME_1",t[t.SELECTOR_NAME=2]="SELECTOR_NAME",t[t.SELECTOR_ANY_1=3]="SELECTOR_ANY_1",t[t.SELECTOR_ANY=4]="SELECTOR_ANY",t[t.SELECTOR_ID_1=5]="SELECTOR_ID_1",t[t.SELECTOR_ID=6]="SELECTOR_ID",t[t.SELECTOR_CLASS_1=7]="SELECTOR_CLASS_1",t[t.SELECTOR_CLASS=8]="SELECTOR_CLASS",t[t.SELECTOR_ATTR_1=9]="SELECTOR_ATTR_1",t[t.SELECTOR_ATTR=10]="SELECTOR_ATTR",t[t.SELECTOR_CHILD=11]="SELECTOR_CHILD",t[t.SELECTOR_SIBLING=12]="SELECTOR_SIBLING",t[t.SELECTOR_BODY=13]="SELECTOR_BODY",t[t.SELECTOR_PSEUDOCLASS=14]="SELECTOR_PSEUDOCLASS",t[t.VAL_IDENT=15]="VAL_IDENT",t[t.VAL_HASH=16]="VAL_HASH",t[t.VAL_NUM=17]="VAL_NUM",t[t.VAL_INT=18]="VAL_INT",t[t.VAL_NUMERIC=19]="VAL_NUMERIC",t[t.VAL_STR=20]="VAL_STR",t[t.VAL_URL=21]="VAL_URL",t[t.VAL_COMMA=22]="VAL_COMMA",t[t.VAL_SLASH=23]="VAL_SLASH",t[t.VAL_FUNC=24]="VAL_FUNC",t[t.VAL_C_PAR=25]="VAL_C_PAR",t[t.VAL_END=26]="VAL_END",t[t.RULE_END=27]="RULE_END",t[t.IDENT=28]="IDENT",t[t.SELECTOR_START=29]="SELECTOR_START",t[t.AT=30]="AT",t[t.EXPR_IDENT=31]="EXPR_IDENT",t[t.EXPR_NUM=32]="EXPR_NUM",t[t.EXPR_NUMERIC=33]="EXPR_NUMERIC",t[t.EXPR_STR=34]="EXPR_STR",t[t.EXPR_PARAM=35]="EXPR_PARAM",t[t.EXPR_PREFIX=36]="EXPR_PREFIX",t[t.EXPR_INFIX=37]="EXPR_INFIX",t[t.EXPR_FUNC=38]="EXPR_FUNC",t[t.EXPR_C_PAR=39]="EXPR_C_PAR",t[t.EXPR_O_PAR=40]="EXPR_O_PAR",t[t.SELECTOR_NEXT=41]="SELECTOR_NEXT",t[t.SELECTOR_PSEUDOELEM=42]="SELECTOR_PSEUDOELEM",t[t.EXPR_O_BRC=43]="EXPR_O_BRC",t[t.VAL_FINISH=44]="VAL_FINISH",t[t.EXPR_INFIX_NAME=45]="EXPR_INFIX_NAME",t[t.PROP=46]="PROP",t[t.VAL_BANG=47]="VAL_BANG",t[t.VAL_BRC=48]="VAL_BRC",t[t.EXPR_SEMICOL=49]="EXPR_SEMICOL",t[t.ERROR_PUSH=50]="ERROR_PUSH",t[t.ERROR_POP=51]="ERROR_POP",t[t.ERROR_POP_DECL=52]="ERROR_POP_DECL",t[t.ERROR_SEMICOL=53]="ERROR_SEMICOL",t[t.VAL_PLUS=54]="VAL_PLUS",t[t.SELECTOR_PSEUDOCLASS_1=55]="SELECTOR_PSEUDOCLASS_1",t[t.SELECTOR_FOLLOWING_SIBLING=56]="SELECTOR_FOLLOWING_SIBLING",t[t.DONE=200]="DONE"}(M||(M={}));const F=r.a.LAST+1;var U;N[r.a.IDENT]=M.IDENT,N[r.a.STAR]=M.SELECTOR_START,N[r.a.HASH]=M.SELECTOR_START,N[r.a.CLASS]=M.SELECTOR_START,N[r.a.O_BRK]=M.SELECTOR_START,N[r.a.COLON]=M.SELECTOR_START,N[r.a.AT]=M.AT,N[r.a.C_BRC]=M.RULE_END,N[r.a.EOF]=M.DONE,S[r.a.IDENT]=M.PROP,S[r.a.EOF]=M.DONE,I[r.a.IDENT]=M.SELECTOR_NAME,I[r.a.STAR]=M.SELECTOR_ANY,I[r.a.HASH]=M.SELECTOR_ID,I[r.a.CLASS]=M.SELECTOR_CLASS,I[r.a.O_BRK]=M.SELECTOR_ATTR,I[r.a.COLON]=M.SELECTOR_PSEUDOCLASS,x[r.a.GT]=M.SELECTOR_CHILD,x[r.a.PLUS]=M.SELECTOR_SIBLING,x[r.a.TILDE]=M.SELECTOR_FOLLOWING_SIBLING,x[r.a.IDENT]=M.SELECTOR_NAME_1,x[r.a.STAR]=M.SELECTOR_ANY_1,x[r.a.HASH]=M.SELECTOR_ID_1,x[r.a.CLASS]=M.SELECTOR_CLASS_1,x[r.a.O_BRK]=M.SELECTOR_ATTR_1,x[r.a.O_BRC]=M.SELECTOR_BODY,x[r.a.COLON]=M.SELECTOR_PSEUDOCLASS_1,x[r.a.COL_COL]=M.SELECTOR_PSEUDOELEM,x[r.a.COMMA]=M.SELECTOR_NEXT,C[r.a.IDENT]=M.SELECTOR_NAME_1,C[r.a.STAR]=M.SELECTOR_ANY_1,C[r.a.HASH]=M.SELECTOR_ID_1,C[r.a.CLASS]=M.SELECTOR_CLASS_1,C[r.a.O_BRK]=M.SELECTOR_ATTR_1,C[r.a.C_PAR]=M.DONE,C[r.a.COLON]=M.SELECTOR_PSEUDOCLASS_1,_[r.a.IDENT]=M.SELECTOR_NAME,_[r.a.STAR]=M.SELECTOR_ANY,_[r.a.HASH]=M.SELECTOR_ID,_[r.a.CLASS]=M.SELECTOR_CLASS,_[r.a.COLON]=M.SELECTOR_PSEUDOCLASS,_[r.a.COL_COL]=M.SELECTOR_PSEUDOELEM,_[r.a.O_BRK]=M.SELECTOR_ATTR,_[r.a.O_BRC]=M.SELECTOR_BODY,A[r.a.IDENT]=M.VAL_IDENT,A[r.a.HASH]=M.VAL_HASH,A[r.a.NUM]=M.VAL_NUM,A[r.a.INT]=M.VAL_INT,A[r.a.NUMERIC]=M.VAL_NUMERIC,A[r.a.STR]=M.VAL_STR,A[r.a.URL]=M.VAL_URL,A[r.a.COMMA]=M.VAL_COMMA,A[r.a.SLASH]=M.VAL_SLASH,A[r.a.FUNC]=M.VAL_FUNC,A[r.a.C_PAR]=M.VAL_C_PAR,A[r.a.SEMICOL]=M.VAL_END,A[r.a.C_BRC]=M.VAL_BRC,A[r.a.BANG]=M.VAL_BANG,A[r.a.PLUS]=M.VAL_PLUS,A[r.a.EOF]=M.VAL_FINISH,O[r.a.IDENT]=M.EXPR_IDENT,O[r.a.NUM]=M.EXPR_NUM,O[r.a.INT]=M.EXPR_NUM,O[r.a.NUMERIC]=M.EXPR_NUMERIC,O[r.a.STR]=M.EXPR_STR,O[r.a.O_PAR]=M.EXPR_O_PAR,O[r.a.FUNC]=M.EXPR_FUNC,O[r.a.BANG]=M.EXPR_PREFIX,O[r.a.MINUS]=M.EXPR_PREFIX,O[r.a.DOLLAR]=M.EXPR_PARAM,k[r.a.IDENT]=M.EXPR_INFIX_NAME,k[r.a.COMMA]=M.EXPR_INFIX,k[r.a.GT]=M.EXPR_INFIX,k[r.a.LT]=M.EXPR_INFIX,k[r.a.GT_EQ]=M.EXPR_INFIX,k[r.a.LT_EQ]=M.EXPR_INFIX,k[r.a.EQ]=M.EXPR_INFIX,k[r.a.EQ_EQ]=M.EXPR_INFIX,k[r.a.BANG_EQ]=M.EXPR_INFIX,k[r.a.AMP_AMP]=M.EXPR_INFIX,k[r.a.BAR_BAR]=M.EXPR_INFIX,k[r.a.PLUS]=M.EXPR_INFIX,k[r.a.MINUS]=M.EXPR_INFIX,k[r.a.SLASH]=M.EXPR_INFIX,k[r.a.PERCENT]=M.EXPR_INFIX,k[r.a.STAR]=M.EXPR_INFIX,k[r.a.COLON]=M.EXPR_INFIX,k[r.a.QMARK]=M.EXPR_INFIX,k[r.a.C_PAR]=M.EXPR_C_PAR,k[r.a.O_BRC]=M.EXPR_O_BRC,k[r.a.SEMICOL]=M.EXPR_SEMICOL,D[r.a.EOF]=M.DONE,D[r.a.O_BRC]=M.ERROR_PUSH,D[r.a.C_BRC]=M.ERROR_POP,D[r.a.O_BRK]=M.ERROR_PUSH,D[r.a.C_BRK]=M.ERROR_POP,D[r.a.O_PAR]=M.ERROR_PUSH,D[r.a.C_PAR]=M.ERROR_POP,D[r.a.SEMICOL]=M.ERROR_SEMICOL,L[r.a.EOF]=M.DONE,L[r.a.O_BRC]=M.ERROR_PUSH,L[r.a.C_BRC]=M.ERROR_POP_DECL,L[r.a.O_BRK]=M.ERROR_PUSH,L[r.a.C_BRK]=M.ERROR_POP,L[r.a.O_PAR]=M.ERROR_PUSH,L[r.a.C_PAR]=M.ERROR_POP,L[r.a.SEMICOL]=M.ERROR_SEMICOL,R[r.a.EOF]=M.DONE,R[r.a.O_BRC]=M.ERROR_PUSH,R[r.a.C_BRC]=M.ERROR_POP,R[r.a.O_BRK]=M.ERROR_PUSH,R[r.a.C_BRK]=M.ERROR_POP,R[r.a.O_PAR]=M.ERROR_PUSH,R[r.a.C_PAR]=M.ERROR_POP,P[r.a.C_PAR]=0,P[r.a.COMMA]=0,P[r.a.QMARK]=1,P[r.a.COLON]=1,P[r.a.AMP_AMP]=2,P[r.a.BAR_BAR]=2,P[r.a.LT]=3,P[r.a.GT]=3,P[r.a.LT_EQ]=3,P[r.a.GT_EQ]=3,P[r.a.EQ]=3,P[r.a.EQ_EQ]=3,P[r.a.BANG_EQ]=3,P[r.a.PLUS]=4,P[r.a.MINUS]=4,P[r.a.STAR]=5,P[r.a.SLASH]=5,P[r.a.PERCENT]=5,P[r.a.EOF]=6,P[F]=2,function(t){t[t.PROP=0]="PROP",t[t.WHEN=1]="WHEN",t[t.MEDIA=2]="MEDIA",t[t.IMPORT=3]="IMPORT"}(U||(U={}));class z{constructor(t,e,n,i){this.actions=t,this.tokenizer=e,this.handler=n,this.mo=i,this.bo=[],this.Eo={},this.xo=null,this.Ae=null,this.yo=!1,this.result=null,this.vo=!1,this.ko=null,this.So=null,this.Co=[],this.Po=[],this.To=!1,this._o=!1,this.Ro=U.MEDIA}No(t,e){const n=[],i=this.bo;for(;n.push(i[e++]),e!=i.length;)if(i[e++]!=t)throw new Error("Unexpected state");return n}Io(t,e){const n=this.bo;let i,r=n.length;do{i=n[--r]}while(void 0!==i&&"string"!=typeof i);let o=n.length-(r+1);if(o>1&&n.splice(r+1,o,new s.j(n.slice(r+1,n.length))),","==t)return null;r++;do{i=n[--r]}while(void 0!==i&&("string"!=typeof i||","==i));if(o=n.length-(r+1),"("==i){if(")"!=t)return this.handler.error("E_CSS_MISMATCHED_C_PAR",e),this.actions=L,null;const i=new s.e(n[r-1],this.No(",",r+1));return n.splice(r-1,o+2,i),null}return";"!=t||r>=0?(this.handler.error("E_CSS_UNEXPECTED_VAL_END",e),this.actions=L,null):o>1?new s.b(this.No(",",r+1)):n[0]}Fo(t,e){this.actions=this.Ae?L:D,this.handler.error(t,e)}Ao(t,e){const n=this.bo,i=this.handler;let a,h=n.pop();for(;;){let l=n.pop();if(t==r.a.C_PAR){const e=[h];for(;l==r.a.COMMA;)e.unshift(n.pop()),l=n.pop();if("string"==typeof l){if("{"==l){for(;e.length>=2;){const t=e.shift(),n=e.shift(),s=new o.z(i.Qr(),t,n);e.unshift(s)}return n.push(new s.c(e[0])),!0}if("("==l){const s=n.pop(),a=n.pop();h=new o.d(i.Qr(),o.M(a,s),e),t=r.a.EOF;continue}}if(l==r.a.O_PAR){h.ye()&&(h=new o.p(i.Qr(),h,null)),t=r.a.EOF;continue}}else if("string"==typeof l){n.push(l);break}if(l<0)if(l==-r.a.BANG)h=new o.w(i.Qr(),h);else{if(l!=-r.a.MINUS)return this.Fo("F_UNEXPECTED_STATE",e),!1;h=new o.v(i.Qr(),h)}else{if(P[t]>P[l]){n.push(l);break}switch(a=n.pop(),l){case r.a.AMP_AMP:h=new o.b(i.Qr(),a,h);break;case F:h=new o.c(i.Qr(),a,h);break;case r.a.BAR_BAR:h=new o.y(i.Qr(),a,h);break;case r.a.LT:h=new o.n(i.Qr(),a,h);break;case r.a.GT:h=new o.k(i.Qr(),a,h);break;case r.a.LT_EQ:h=new o.l(i.Qr(),a,h);break;case r.a.GT_EQ:h=new o.j(i.Qr(),a,h);break;case r.a.EQ:case r.a.EQ_EQ:h=new o.i(i.Qr(),a,h);break;case r.a.BANG_EQ:h=new o.u(i.Qr(),a,h);break;case r.a.PLUS:h=new o.a(i.Qr(),a,h);break;case r.a.MINUS:h=new o.B(i.Qr(),a,h);break;case r.a.STAR:h=new o.r(i.Qr(),a,h);break;case r.a.SLASH:h=new o.h(i.Qr(),a,h);break;case r.a.PERCENT:h=new o.q(i.Qr(),a,h);break;case r.a.COLON:if(!(n.length>1))return this.Fo("E_CSS_EXPR_COND",e),!1;switch(n[n.length-1]){case r.a.QMARK:n.pop(),h=new o.e(i.Qr(),n.pop(),a,h);break;case r.a.O_PAR:if(!a.ye())return this.Fo("E_CSS_MEDIA_TEST",e),!1;h=new o.p(i.Qr(),a,h)}break;case r.a.QMARK:if(t!=r.a.COLON)return this.Fo("E_CSS_EXPR_COND",e),!1;case r.a.O_PAR:return n.push(a),n.push(l),n.push(h),!1;default:return this.Fo("F_UNEXPECTED_STATE",e),!1}}}return n.push(h),!1}Oo(){const t=[];for(;;){const e=this.tokenizer.token();switch(e.type){case r.a.IDENT:t.push(e.text);break;case r.a.PLUS:t.push("+");break;case r.a.NUM:case r.a.INT:t.push(e.num);break;default:return t}this.tokenizer.consume()}}Lo(){let t=!1,e=this.tokenizer.token();if(e.type===r.a.PLUS)t=!0,this.tokenizer.consume(),e=this.tokenizer.token();else if(e.type===r.a.IDENT&&("even"===e.text||"odd"===e.text))return this.tokenizer.consume(),[2,"odd"===e.text?1:0];switch(e.type){case r.a.NUMERIC:if(t&&e.num<0)return null;case r.a.IDENT:if(t&&"-"===e.text.charAt(0))return null;if("n"===e.text||"-n"===e.text){if(t&&e.at)return null;let n="-n"===e.text?-1:1;e.type===r.a.NUMERIC&&(n=e.num);let i=0;this.tokenizer.consume();const s=(e=this.tokenizer.token()).type===r.a.MINUS,o=e.type===r.a.PLUS||s;if(o&&(this.tokenizer.consume(),e=this.tokenizer.token()),e.type===r.a.INT){if(1/(i=e.num)==-1/0){if(i=0,o)return null}else if(i<0){if(o)return null}else if(i>=0&&!o)return null;this.tokenizer.consume()}else if(o)return null;return[n,s&&i>0?-i:i]}if("n-"===e.text||"-n-"===e.text){if(t&&e.at)return null;let n="-n-"===e.text?-1:1;if(e.type===r.a.NUMERIC&&(n=e.num),this.tokenizer.consume(),(e=this.tokenizer.token()).type===r.a.INT)return e.num<0||1/e.num==-1/0?null:(this.tokenizer.consume(),[n,e.num])}else{let n=e.text.match(/^n(-[0-9]+)$/);if(n)return t&&e.at?null:(this.tokenizer.consume(),[e.type===r.a.NUMERIC?e.num:1,parseInt(n[1],10)]);if(n=e.text.match(/^-n(-[0-9]+)$/))return this.tokenizer.consume(),[-1,parseInt(n[1],10)]}return null;case r.a.INT:return t&&(e.at||e.num<0)?null:(this.tokenizer.consume(),[0,e.num])}return null}$o(t,e){const n=this.handler.Qr();if(!n)return null;if(e=e||n._true,t){const i=t.split(/\s+/);for(const t of i)switch(t){case"vertical":e=o.D(n,e,new o.w(n,new o.s(n,"pref-horizontal")));break;case"horizontal":e=o.D(n,e,new o.s(n,"pref-horizontal"));break;case"day":e=o.D(n,e,new o.w(n,new o.s(n,"pref-night-mode")));break;case"night":e=o.D(n,e,new o.s(n,"pref-night-mode"));break;default:e=n._false}}return e===n._true?null:new s.c(e)}Mo(){switch(this.Po[this.Po.length-1]){case"[selector]":case"font-face":case"-epubx-flow":case"-epubx-viewport":case"-epubx-define":case"-adapt-footnote-area":return!0}return!1}Do(t,e,n,a,h){const l=this.handler,c=this.tokenizer,u=this.bo;let f,d,p,g,m,b,w;a&&(this.Ro=U.MEDIA,this.bo.push("{"));t:for(;t>0;--t)switch(f=c.token(),this.actions[f.type]){case M.IDENT:if(c.wt(1).type!=r.a.COLON){this.Mo()?(l.error("E_CSS_COLON_EXPECTED",c.wt(1)),this.actions=L):(this.actions=I,l.xi());continue}(d=c.wt(2)).at||d.type!=r.a.IDENT&&d.type!=r.a.FUNC||c.mark(),this.Ae=f.text,this.yo=!1,c.consume(),c.consume(),this.actions=A,u.splice(0,u.length);continue;case M.PROP:if(c.wt(1).type!=r.a.COLON){this.actions=L,l.error("E_CSS_COLON_EXPECTED",c.wt(1));continue}this.Ae=f.text,this.yo=!1,c.consume(),c.consume(),this.actions=A,u.splice(0,u.length);continue;case M.SELECTOR_START:this.actions=I,l.xi();continue;case M.SELECTOR_NAME_1:if(!f.at){this.actions=R,l.error("E_CSS_SPACE_EXPECTED",f);continue}l.pi();case M.SELECTOR_NAME:if(c.wt(1).type==r.a.BAR)if(c.consume(),c.consume(),null!=(p=this.Eo[f.text]))switch((f=c.token()).type){case r.a.IDENT:l.ci(p,f.text),this.actions=h?C:x,c.consume();break;case r.a.STAR:l.ci(p,null),this.actions=h?C:x,c.consume();break;default:this.actions=D,l.error("E_CSS_NAMESPACE",f)}else this.actions=D,l.error("E_CSS_UNDECLARED_PREFIX",f);else l.ci(this.xo,f.text),this.actions=h?C:x,c.consume();continue;case M.SELECTOR_ANY_1:if(!f.at){this.actions=R,l.error("E_CSS_SPACE_EXPECTED",f);continue}l.pi();case M.SELECTOR_ANY:if(c.wt(1).type==r.a.BAR)switch(c.consume(),c.consume(),(f=c.token()).type){case r.a.IDENT:l.ci(null,f.text),this.actions=h?C:x,c.consume();break;case r.a.STAR:l.ci(null,null),this.actions=h?C:x,c.consume();break;default:this.actions=D,l.error("E_CSS_NAMESPACE",f)}else l.ci(this.xo,null),this.actions=h?C:x,c.consume();continue;case M.SELECTOR_ID_1:f.at&&l.pi();case M.SELECTOR_ID:l.fi(f.text),this.actions=h?C:x,c.consume();continue;case M.SELECTOR_CLASS_1:f.at&&l.pi();case M.SELECTOR_CLASS:l.li(f.text),this.actions=h?C:x,c.consume();continue;case M.SELECTOR_PSEUDOCLASS_1:f.at&&l.pi();case M.SELECTOR_PSEUDOCLASS:c.consume();e:switch((f=c.token()).type){case r.a.IDENT:l.ui(f.text,null),c.consume(),this.actions=h?C:x;continue;case r.a.FUNC:switch(g=f.text,c.consume(),g){case"not":this.actions=I,l.Ai("not"),this.Do(Number.POSITIVE_INFINITY,!1,!1,!1,!0)?this.actions=x:this.actions=R;break t;case"lang":case"href-epub-type":if((f=c.token()).type===r.a.IDENT){w=[f.text],c.consume();break}break e;case"nth-child":case"nth-of-type":case"nth-last-child":case"nth-last-of-type":if(w=this.Lo())break;break e;default:w=this.Oo()}if((f=c.token()).type==r.a.C_PAR){l.ui(g,w),c.consume(),this.actions=h?C:x;continue}}l.error("E_CSS_PSEUDOCLASS_SYNTAX",f),this.actions=D;continue;case M.SELECTOR_PSEUDOELEM:switch(c.consume(),(f=c.token()).type){case r.a.IDENT:l.ai(f.text,null),this.actions=h?C:x,c.consume();continue;case r.a.FUNC:if(g=f.text,c.consume(),"nth-fragment"==g){if(null===(w=this.Lo()))break}else w=this.Oo();if((f=c.token()).type==r.a.C_PAR){l.ai(g,w),this.actions=h?C:x,c.consume();continue}}l.error("E_CSS_PSEUDOELEM_SYNTAX",f),this.actions=D;continue;case M.SELECTOR_ATTR_1:f.at&&l.pi();case M.SELECTOR_ATTR:if(c.consume(),(f=c.token()).type==r.a.IDENT)g=f.text,c.consume();else if(f.type==r.a.STAR)g=null,c.consume();else{if(f.type!=r.a.BAR){this.actions=R,l.error("E_CSS_ATTR",f),c.consume();continue}g=""}if((f=c.token()).type==r.a.BAR){if(null==(p=g?this.Eo[g]:g)){this.actions=R,l.error("E_CSS_UNDECLARED_PREFIX",f),c.consume();continue}if(c.consume(),(f=c.token()).type!=r.a.IDENT){this.actions=R,l.error("E_CSS_ATTR_NAME_EXPECTED",f);continue}g=f.text,c.consume(),f=c.token()}else p="";switch(f.type){case r.a.EQ:case r.a.TILDE_EQ:case r.a.BAR_EQ:case r.a.HAT_EQ:case r.a.DOLLAR_EQ:case r.a.STAR_EQ:case r.a.COL_COL:m=f.type,c.consume(),f=c.token();break;case r.a.C_BRK:l.di(p,g,r.a.EOF,null),this.actions=h?C:x,c.consume();continue;default:this.actions=R,l.error("E_CSS_ATTR_OP_EXPECTED",f);continue}switch(f.type){case r.a.IDENT:case r.a.STR:l.di(p,g,m,f.text),c.consume(),f=c.token();break;default:this.actions=R,l.error("E_CSS_ATTR_VAL_EXPECTED",f);continue}if(f.type!=r.a.C_BRK){this.actions=R,l.error("E_CSS_ATTR",f);continue}this.actions=h?C:x,c.consume();continue;case M.SELECTOR_CHILD:l.wi(),this.actions=_,c.consume();continue;case M.SELECTOR_SIBLING:l.gi(),this.actions=_,c.consume();continue;case M.SELECTOR_FOLLOWING_SIBLING:l.mi(),this.actions=_,c.consume();continue;case M.SELECTOR_BODY:this.To?(this.Po.push("-epubx-region"),this.To=!1):this._o?(this.Po.push("page"),this._o=!1):this.Po.push("[selector]"),l.ki(),this.actions=N,c.consume();continue;case M.SELECTOR_NEXT:l.bi(),this.actions=I,c.consume();continue;case M.VAL_IDENT:u.push(s.r(f.text)),c.consume();continue;case M.VAL_HASH:m=parseInt(f.text,16);try{u.push(E(f.text))}catch(t){l.error("E_CSS_COLOR",f),this.actions=D}c.consume();continue;case M.VAL_NUM:u.push(new s.h(f.num)),c.consume();continue;case M.VAL_INT:u.push(new s.g(f.num)),c.consume();continue;case M.VAL_NUMERIC:o.K(f.text)?u.push(new s.c(new o.x(l.Qr(),f.num,f.text))):u.push(new s.i(f.num,f.text)),c.consume();continue;case M.VAL_STR:u.push(new s.k(f.text)),c.consume();continue;case M.VAL_URL:u.push(new s.l(i.C(f.text,this.mo))),c.consume();continue;case M.VAL_COMMA:this.Io(",",f),u.push(","),c.consume();continue;case M.VAL_SLASH:u.push(s.w),c.consume();continue;case M.VAL_FUNC:"-epubx-expr"==(g=f.text.toLowerCase())||"calc"==g||"env"==g?(this.actions=O,this.Ro=U.PROP,u.push("{")):(u.push(g),u.push("(")),c.consume();continue;case M.VAL_C_PAR:this.Io(")",f),c.consume();continue;case M.VAL_BANG:if(c.consume(),f=c.token(),d=c.wt(1),f.type==r.a.IDENT&&"important"==f.text.toLowerCase()&&(d.type==r.a.SEMICOL||d.type==r.a.EOF||d.type==r.a.C_BRC)){c.consume(),this.yo=!0;continue}this.Fo("E_CSS_SYNTAX",f);continue;case M.VAL_PLUS:switch((d=c.wt(1)).type){case r.a.NUM:case r.a.NUMERIC:case r.a.INT:if(!d.at){c.consume();continue}}if(this.actions===A&&c.gt()){c.reset(),this.actions=I,l.xi();continue}this.Fo("E_CSS_UNEXPECTED_PLUS",f);continue;case M.VAL_END:c.consume();case M.VAL_BRC:c.unmark(),(b=this.Io(";",f))&&this.Ae&&l.property(this.Ae,b,this.yo),this.actions=n?S:N;continue;case M.VAL_FINISH:if(c.consume(),c.unmark(),b=this.Io(";",f),e)return this.result=b,!0;if(this.Ae&&b&&l.property(this.Ae,b,this.yo),n)return!0;this.Fo("E_CSS_SYNTAX",f);continue;case M.EXPR_IDENT:(d=c.wt(1)).type==r.a.CLASS?(c.wt(2).type!=r.a.O_PAR||c.wt(2).at?(u.push(new o.s(l.Qr(),o.M(f.text,d.text))),this.actions=k):(u.push(f.text,d.text,"("),c.consume()),c.consume()):(this.Ro==U.MEDIA||this.Ro==U.IMPORT?"not"==f.text.toLowerCase()?(c.consume(),u.push(new o.o(l.Qr(),!0,d.text))):("only"==f.text.toLowerCase()&&(c.consume(),f=d),u.push(new o.o(l.Qr(),!1,f.text))):u.push(new o.s(l.Qr(),f.text)),this.actions=k),c.consume();continue;case M.EXPR_FUNC:u.push(null,f.text,"("),c.consume();continue;case M.EXPR_NUM:u.push(new o.f(l.Qr(),f.num)),c.consume(),this.actions=k;continue;case M.EXPR_NUMERIC:"%"==(g=f.text)&&(g=this.Ae&&this.Ae.match(/height|^(top|bottom)$/)?"vh":"vw"),u.push(new o.x(l.Qr(),f.num,g)),c.consume(),this.actions=k;continue;case M.EXPR_STR:u.push(new o.f(l.Qr(),f.text)),c.consume(),this.actions=k;continue;case M.EXPR_PARAM:c.consume(),(f=c.token()).type!=r.a.INT||f.at?this.Fo("E_CSS_SYNTAX",f):(u.push(new o.A(l.Qr(),f.num)),c.consume(),this.actions=k);continue;case M.EXPR_PREFIX:u.push(-f.type),c.consume();continue;case M.EXPR_INFIX:this.actions=O,this.Ao(f.type,f),u.push(f.type),c.consume();continue;case M.EXPR_INFIX_NAME:"and"==f.text.toLowerCase()?(this.actions=O,this.Ao(F,f),u.push(F),c.consume()):this.Fo("E_CSS_SYNTAX",f);continue;case M.EXPR_C_PAR:this.Ao(f.type,f)&&(this.Ae?this.actions=A:this.Fo("E_CSS_UNBALANCED_PAR",f)),c.consume();continue;case M.EXPR_O_BRC:this.Ao(r.a.C_PAR,f)&&(this.Ae||this.Ro==U.IMPORT?this.Fo("E_CSS_UNEXPECTED_BRC",f):(this.Ro==U.WHEN?l.ho(u.pop()):l.co(u.pop()),this.Po.push("media"),l.ki(),this.actions=N)),c.consume();continue;case M.EXPR_SEMICOL:if(this.Ao(r.a.C_PAR,f)){if(!this.Ae&&this.Ro==U.IMPORT)return this.So=u.pop(),this.vo=!0,this.actions=N,c.consume(),!1;this.Fo("E_CSS_UNEXPECTED_SEMICOL",f)}c.consume();continue;case M.EXPR_O_PAR:u.push(f.type),c.consume();continue;case M.RULE_END:this.actions=N,c.consume(),l.Si(),this.Po.length&&this.Po.pop();continue;case M.AT:switch(g=f.text.toLowerCase()){case"import":if(c.consume(),(f=c.token()).type==r.a.STR||f.type==r.a.URL){if(this.ko=f.text,c.consume(),(f=c.token()).type==r.a.SEMICOL||f.type==r.a.EOF)return this.vo=!0,c.consume(),!1;this.Ae=null,this.Ro=U.IMPORT,this.actions=O,u.push("{");continue}l.error("E_CSS_IMPORT_SYNTAX",f),this.actions=D;continue;case"namespace":switch(c.consume(),(f=c.token()).type){case r.a.IDENT:if(g=f.text,c.consume(),((f=c.token()).type==r.a.STR||f.type==r.a.URL)&&c.wt(1).type==r.a.SEMICOL){this.Eo[g]=f.text,c.consume(),c.consume();continue}break;case r.a.STR:case r.a.URL:if(c.wt(1).type==r.a.SEMICOL){this.xo=f.text,c.consume(),c.consume();continue}}l.error("E_CSS_NAMESPACE_SYNTAX",f),this.actions=D;continue;case"charset":if(c.consume(),(f=c.token()).type==r.a.STR&&c.wt(1).type==r.a.SEMICOL){"utf-8"!=(g=f.text.toLowerCase())&&"utf-16"!=g&&l.error(`E_CSS_UNEXPECTED_CHARSET ${g}`,f),c.consume(),c.consume();continue}l.error("E_CSS_CHARSET_SYNTAX",f),this.actions=D;continue;case"font-face":case"-epubx-page-template":case"-epubx-define":case"-epubx-viewport":if(c.wt(1).type==r.a.O_BRC){switch(c.consume(),c.consume(),g){case"font-face":l.Jr();break;case"-epubx-page-template":l.uo();break;case"-epubx-define":l.io();break;case"-epubx-viewport":l.so()}this.Po.push(g),l.ki();continue}break;case"-adapt-footnote-area":switch(c.consume(),(f=c.token()).type){case r.a.O_BRC:c.consume(),l.eo(null),this.Po.push(g),l.ki();continue;case r.a.COL_COL:if(c.consume(),(f=c.token()).type==r.a.IDENT&&c.wt(1).type==r.a.O_BRC){g=f.text,c.consume(),c.consume(),l.eo(g),this.Po.push("-adapt-footnote-area"),l.ki();continue}}break;case"-epubx-region":c.consume(),l.no(),this.To=!0,this.actions=I;continue;case"page":c.consume(),l.ro(),this._o=!0,this.actions=_;continue;case"top-left-corner":case"top-left":case"top-center":case"top-right":case"top-right-corner":case"right-top":case"right-middle":case"right-bottom":case"bottom-right-corner":case"bottom-right":case"bottom-center":case"bottom-left":case"bottom-left-corner":case"left-bottom":case"left-middle":case"left-top":if(c.consume(),(f=c.token()).type==r.a.O_BRC){c.consume(),l.oo(g),this.Po.push(g),l.ki();continue}break;case"-epubx-when":c.consume(),this.Ae=null,this.Ro=U.WHEN,this.actions=O,u.push("{");continue;case"media":c.consume(),this.Ae=null,this.Ro=U.MEDIA,this.actions=O,u.push("{");continue;case"-epubx-flow":if(c.wt(1).type==r.a.IDENT&&c.wt(2).type==r.a.O_BRC){l.lo(c.wt(1).text),c.consume(),c.consume(),c.consume(),this.Po.push(g),l.ki();continue}break;case"-epubx-page-master":case"-epubx-partition":case"-epubx-partition-group":{c.consume();let t=null,e=null;const n=[];for((f=c.token()).type==r.a.IDENT&&(t=f.text,c.consume(),f=c.token()),f.type==r.a.COLON&&c.wt(1).type==r.a.IDENT&&(e=c.wt(1).text,c.consume(),c.consume(),f=c.token());f.type==r.a.FUNC&&"class"==f.text.toLowerCase()&&c.wt(1).type==r.a.IDENT&&c.wt(2).type==r.a.C_PAR;)n.push(c.wt(1).text),c.consume(),c.consume(),c.consume(),f=c.token();if(f.type==r.a.O_BRC){switch(c.consume(),g){case"-epubx-page-master":l.ao(t,e,n);break;case"-epubx-partition":l.fo(t,e,n);break;case"-epubx-partition-group":l.do(t,e,n)}this.Po.push(g),l.ki();continue}break}case"":l.error(`E_CSS_UNEXPECTED_AT${g}`,f),this.actions=R;continue;default:l.error(`E_CSS_AT_UNKNOWN ${g}`,f),this.actions=D;continue}l.error(`E_CSS_AT_SYNTAX ${g}`,f),this.actions=D;continue;case M.ERROR_PUSH:if(e||n)return!0;this.Co.push(f.type+1),c.consume();continue;case M.ERROR_POP_DECL:if(e||n)return!0;if(0==this.Co.length){this.actions=N;continue}case M.ERROR_POP:this.Co.length>0&&this.Co[this.Co.length-1]==f.type&&this.Co.pop(),0==this.Co.length&&f.type==r.a.C_BRC&&(this.actions=N),c.consume();continue;case M.ERROR_SEMICOL:if(e||n)return!0;0==this.Co.length&&(this.actions=N),c.consume();continue;case M.DONE:return h&&(c.consume(),l.$i()),!0;default:if(e||n)return!0;if(a)return!!this.Ao(r.a.C_PAR,f)&&(this.result=u.pop(),!0);if(h)return f.type==r.a.INVALID?l.error(f.text,f):l.error("E_CSS_SYNTAX",f),!1;if(this.actions===A&&c.gt()){c.reset(),this.actions=I,l.xi();continue}if(this.actions!==D&&this.actions!==R&&this.actions!==L){f.type==r.a.INVALID?l.error(f.text,f):l.error("E_CSS_SYNTAX",f),this.Mo()?this.actions=L:this.actions=R;continue}c.consume();continue}return!1}}class B extends w{constructor(t){super(null),this.scope=t}error(t,e){throw new Error(t)}Qr(){return this.scope}}function V(t,e,n,s,o){const a=l.c("parseStylesheet"),h=new z(N,t,e,n);let c=null;return o&&(c=function(t,e,n){const i=new z(O,t,e,n);return i.Do(Number.POSITIVE_INFINITY,!1,!1,!0,!1),i.result}(new r.b(o,e),e,n)),(c=h.$o(s,c&&c.nt()))&&(e.co(c),e.ki()),a.loop(()=>{for(;!h.Do(100,!1,!1,!1,!1);){if(h.vo){const t=i.C(h.ko,n);h.So&&(e.co(h.So),e.ki());const s=l.c("parseStylesheet.import");return H(t,e,null,null).then(()=>{h.So&&e.Si(),h.vo=!1,h.ko=null,h.So=null,s.finish(!0)}),s.result()}const t=a.Bt();if(t.Mt)return t}return l.d(!1)}).then(()=>{c&&e.Si(),a.finish(!0)}),a.result()}function $(t,e,n,i,s){return l.b("parseStylesheetFromText",o=>{V(new r.b(t,e),e,n,i,s).$t(o)},(e,n)=>{a.b.warn(n,`Failed to parse stylesheet text: ${t}`),e.finish(!1)})}function H(t,e,n,i){return l.b("parseStylesheetFromURL",s=>{h.c(t).then(r=>{r.responseText?$(r.responseText,e,t,n,i).then(e=>{e||a.b.warn(`Failed to parse stylesheet from ${t}`),s.finish(!0)}):s.finish(!0)})},(e,n)=>{a.b.warn(n,"Exception while fetching and parsing:",t),e.finish(!0)})}function j(t,e,n){const i=new z(A,e,new B(t),n);return i.Do(Number.POSITIVE_INFINITY,!0,!1,!1,!1),i.result}function X(t,e,n){new z(S,t,e,n).Do(Number.POSITIVE_INFINITY,!1,!0,!1,!1)}const G={"z-index":!0,"column-count":!0,"flow-linger":!0,opacity:!0,page:!0,"flow-priority":!0,utilization:!0};function W(t,e,n){return e.rt()?function(t,e,n){const i=e.evaluate(t);switch(typeof i){case"number":return G[n]?i==Math.round(i)?new s.g(i):new s.h(i):new s.i(i,"px");case"string":return i?j(e.scope,new r.b(i,null),""):s.o;case"boolean":return i?s.t._true:s.t._false;case"undefined":return s.o}throw new Error("E_UNEXPECTED")}(t,e.expr,n):e}},function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"d",function(){return c}),n.d(e,"j",function(){return u}),n.d(e,"k",function(){return f}),n.d(e,"i",function(){return E}),n.d(e,"m",function(){return w}),n.d(e,"l",function(){return y}),n.d(e,"g",function(){return S}),n.d(e,"f",function(){return x}),n.d(e,"h",function(){return C}),n.d(e,"e",function(){return _});var i=n(6);class s{constructor(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i}}class r{constructor(t,e){this.x=t,this.y=e}}class o{constructor(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i}}class a{constructor(t,e,n,i){this.low=t,this.high=e,this.winding=n,this.Bo=i}}class h{constructor(t,e,n,i){this.y1=t,this.y2=e,this.x1=n,this.x2=i,this.left=null,this.right=null}}function l(t,e){return t.low.y-e.low.y||t.low.x-e.low.x}class c{constructor(t){this.points=t}Uo(t,e){const n=this.points,i=n.length;let s=n[i-1];for(let r=0;r<i;r++){const i=n[r];let o;o=s.y<i.y?new a(s,i,1,e):new a(i,s,-1,e),t.push(o),s=i}}jr(t,e){const n=[];for(const i of this.points)n.push(new r(i.x+t,i.y+e));return new c(n)}}function u(t,e,n,i){const s=[];for(let o=0;o<20;o++){const a=2*o*Math.PI/20;s.push(new r(t+n*Math.sin(a),e+i*Math.cos(a)))}return new c(s)}function f(t,e,n,i){return new c([new r(t,e),new r(n,e),new r(n,i),new r(t,i)])}class d{constructor(t,e,n,i){this.x=t,this.winding=e,this.Bo=n,this.zo=i}}function p(t,e){const n=t.low.x+(t.high.x-t.low.x)*(e-t.low.y)/(t.high.y-t.low.y);if(isNaN(n))throw new Error("Bad intersection");return n}function g(t,e,n,s){let r,o,a,h;e.high.y<n&&i.b.warn("Error: inconsistent segment (1)"),e.low.y<=n?(r=p(e,n),o=e.winding):(r=e.low.x,o=0),e.high.y>=s?(a=p(e,s),h=e.winding):(a=e.high.x,h=0),r<a?(t.push(new d(r,o,e.Bo,-1)),t.push(new d(a,h,e.Bo,1))):(t.push(new d(a,h,e.Bo,-1)),t.push(new d(r,o,e.Bo,1)))}function m(t,e,n){const i=e+n,s=Array(i),r=Array(i);let o;for(o=0;o<=i;o++)s[o]=0,r[o]=0;const a=[];let h=!1;const l=t.length;for(let n=0;n<l;n++){const l=t[n];s[l.Bo]+=l.winding,r[l.Bo]+=l.zo;let c=!1;for(o=0;o<e;o++)if(s[o]&&!r[o]){c=!0;break}if(c)for(o=e;o<=i;o++)if(s[o]||r[o]){c=!1;break}h!=c&&(a.push(l.x),h=c)}return a}function b(t,e){return e?Math.floor(t/e)*e:t}function E(t){return new s(t.y1,-t.x2,t.y2,-t.x1)}function w(t){return new s(-t.y2,t.x1,-t.y1,t.x2)}function v(t){return new c(t.points.map(t=>(function(t){return new r(t.y,-t.x)})(t)))}function y(t,e,n,i,s,r){r&&(t=E(t),e=e.map(t=>v(t)),n=n.map(t=>v(t)));const o=e.length,a=n?n.length:0,c=[],u=[];let f,d,p;for(f=0;f<o;f++)e[f].Uo(u,f);for(f=0;f<a;f++)n[f].Uo(u,f+o);const w=u.length;u.sort(l);let y=0;for(;u[y].Bo>=o;)y++;let N=u[y].low.y;N>t.y1&&c.push(new h(t.y1,N,t.x2,t.x2));let S=0;const x=[];for(;S<w&&(p=u[S]).low.y<N;)p.high.y>N&&x.push(p),S++;for(;S<w||x.length>0;){let e=t.y2;const n=Math.min((C=Math.ceil(N+i),(_=s)?Math.ceil(C/_)*_:C),t.y2);for(d=0;d<x.length&&e>n;d++)(p=x[d]).low.x==p.high.x?p.high.y<e&&(e=Math.max(b(p.high.y,s),n)):p.low.x!=p.high.x&&(e=n);for(e>t.y2&&(e=t.y2);S<w&&(p=u[S]).low.y<e;)if(p.high.y<N)S++;else{if(!(p.low.y<n)){const t=b(p.low.y,s);t<e&&(e=t);break}p.low.y==p.high.y&&p.low.y==N||(x.push(p),e=n),S++}const r=[];for(d=0;d<x.length;d++)g(r,x[d],N,e);r.sort((t,e)=>t.x-e.x||t.zo-e.zo);const l=m(r,o,a);if(0==l.length)c.push(new h(N,e,t.x2,t.x2));else{let n=0,i=t.x1;for(d=0;d<l.length;d+=2){const e=Math.max(t.x1,l[d]),s=Math.min(t.x2,l[d+1])-e;s>n&&(n=s,i=e)}0==n?c.push(new h(N,e,t.x2,t.x2)):c.push(new h(N,e,Math.max(i,t.x1),Math.min(i+n,t.x2)))}if(e==t.y2)break;for(N=e,d=x.length-1;d>=0;d--)x[d].high.y<=e&&x.splice(d,1)}var C,_;return T(t,c),c}function T(t,e){let n=e.length-1,i=new h(t.y2,t.y2,t.x1,t.x2);for(;n>=0;){const t=i;((i=e[n]).y2-i.y1<1||i.x1==t.x1&&i.x2==t.x2)&&(t.y1=i.y1,e.splice(n,1),i=t),n--}}function N(t,e){let n=0,i=t.length;for(;n<i;){const s=Math.floor((n+i)/2);e>=t[s].y2?n=s+1:i=s}return n}function S(t,e){if(!t.length)return e;let n,i,r=e.y1;for(i=0;i<t.length&&!((n=t[i]).y2>e.y1&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i++)r=Math.max(r,n.y2);let o=r;for(;i<t.length&&!((n=t[i]).y1>=e.y2||n.x1-.1>e.x1||n.x2+.1<e.x2);i++)o=n.y2;return(o=i===t.length?e.y2:Math.min(o,e.y2))<=r?null:new s(e.x1,r,e.x2,o)}function x(t,e){if(!t.length)return e;let n,i,r=e.y2;for(i=t.length-1;i>=0&&(n=t[i],!(i===t.length-1&&n.y2<e.y2))&&!(n.y1<e.y2&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i--)r=Math.min(r,n.y1);let o=Math.min(r,n.y2);for(;i>=0&&!((n=t[i]).y2<=e.y1||n.x1-.1>e.x1||n.x2+.1<e.x2);i--)o=n.y1;return r<=(o=Math.max(o,e.y1))?null:new s(e.x1,o,e.x2,r)}function C(t,e,n,i){let s=n.y1;const r=n.x2-n.x1,o=n.y2-n.y1;let a=N(e,s);for(;;){const h=s+o;if(h>t.y2)return!1;let l=t.x1,c=t.x2;for(let t=a;t<e.length&&e[t].y1<h;t++){const n=e[t];n.x1>l&&(l=n.x1),n.x2<c&&(c=n.x2)}if(l+r<=c||a>=e.length)return"left"==i?(n.x1=l,n.x2=l+r):(n.x1=c-r,n.x2=c),n.y2+=s-n.y1,n.y1=s,!0;s=e[a].y2,a++}}function _(t,e,n,i,s){for(i||(i=[new h(n.y1,n.y2,n.x1,n.x2)]);i.length>0&&i[0].y2<=t.y1;)i.shift();if(0==i.length)return;let r;i[0].y1<t.y1&&(i[0].y1=t.y1);const o=0==e.length?t.y1:e[e.length-1].y2;o<t.y2&&e.push(new h(o,t.y2,t.x1,t.x2));let a=N(e,i[0].y1);for(const n of i){if(a==e.length)break;for(e[a].y1<n.y1&&(r=e[a],a++,e.splice(a,0,new h(n.y1,r.y2,r.x1,r.x2)),r.y2=n.y1);a<e.length&&((r=e[a++]).y2>n.y2&&(e.splice(a,0,new h(n.y2,r.y2,r.x1,r.x2)),r.y2=n.y2),n.x1!=n.x2&&("left"==s?r.x1=Math.min(n.x2,t.x2):r.x2=Math.max(n.x1,t.x1)),r.y2!=n.y2););}T(t,e)}},function(t,e,n){"use strict";var i=n(7),s=n(0),r=n(11);function o(t,e){const n={};return Object.keys(t).forEach(i=>{const s=n[i]={},r=t[i];Object.keys(r).forEach(t=>{s[t]=r[t].map(t=>{const n=e?t.logical:t.physical,i=e?t.physical:t.logical;return{regexp:new RegExp(`(-?)${n}(-?)`),to:`$1${i}$2`}})})}),n}function a(t,e,n,i){const s=i[e];if(!s)throw new Error(`unknown writing-mode: ${e}`);const r=s[n||"ltr"];if(!r)throw new Error(`unknown direction: ${n}`);for(const e of r){const n=t.replace(e.regexp,e.to);if(n!==t)return n}return t}n(6);const h={"horizontal-tb":{ltr:[{logical:"inline-start",physical:"left"},{logical:"inline-end",physical:"right"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}],rtl:[{logical:"inline-start",physical:"right"},{logical:"inline-end",physical:"left"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}]},"vertical-rl":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]},"vertical-lr":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]}},l=o(h,!0);const c=o(h,!1);var u=n(19),f=n(3),d=n(8),p=n(15);n.d(e,"a",function(){return g}),n.d(e,"g",function(){return m}),n.d(e,"h",function(){return b}),n.d(e,"b",function(){return E}),n.d(e,"d",function(){return v}),n.d(e,"c",function(){return y}),n.d(e,"e",function(){return T}),n.d(e,"f",function(){return S});const g=p.b.FloatReference;function m(t){switch(t){case"inline":return g.INLINE;case"column":return g.COLUMN;case"region":return g.REGION;case"page":return g.PAGE;default:throw new Error(`Unknown float-reference: ${t}`)}}function b(t){switch(t){case g.INLINE:return!1;case g.COLUMN:case g.REGION:case g.PAGE:return!0;default:throw new Error(`Unknown float-reference: ${t}`)}}class E{constructor(t,e,n,i,s,r){this.Vo=t,this.Un=e,this.Cn=n,this.Pn=i,this.cn=s,this.Tn=r,this.order=null,this.id=null}jo(){if(null===this.order)throw new Error("The page float is not yet added");return this.order}Xo(){if(!this.id)throw new Error("The page float is not yet added");return this.id}Wo(t){return t.Ho(this.Xo())}Go(t){return!1}}class w{constructor(){this.floats=[],this.Yo=0}Ts(){return this.Yo++}qo(t){return`pf${t}`}Ko(t){if(this.floats.findIndex(e=>d.u(e.Vo,t.Vo))>=0)throw new Error("A page float with the same source node is already registered");{const e=t.order=this.Ts();t.id=this.qo(e),this.floats.push(t)}}Zo(t){const e=this.floats.findIndex(e=>d.u(e.Vo,t));return e>=0?this.floats[e]:null}Qo(t){const e=this.floats.findIndex(e=>e.id===t);return e>=0?this.floats[e]:null}}class v{constructor(t,e,n,i,s){this.Un=t,this.Cn=e,this.continuations=n,this.area=i,this.continues=s}Jo(t){return this.continuations.some(e=>e.float===t)}eh(t){for(let e=this.continuations.length-1;e>=0;e--){const n=this.continuations[e].float;if(!n.Wo(t))return n}return null}Wr(){return this.area.Wr(null,null)}Hr(){return this.area.Hr()}jo(){const t=this.continuations.map(t=>t.float);return Math.min.apply(null,t.map(t=>t.jo()))}sh(t){return this.jo()<t.jo()}ih(t){t.forEach(t=>{this.continuations.push(t)})}nh(){const t=this.continuations[0].float.cn;return i.a(this.continuations.every(e=>e.float.cn===t)),t}}class y{constructor(t,e){this.float=t,this.Vo=e}equals(t){return!!t&&(this===t||this.float===t.float&&d.u(this.Vo,t.Vo))}}class T{constructor(t,e,n,i,r,o,a){this.parent=t,this.Un=e,this.container=n,this.cn=i,this.rh=r,this.children=[],this.invalidated=!1,this.oh=[],this.hh=[],this.lh=[],this.uh={},this.ah=[],this.fh=[],this.locked=!1,t&&t.children.push(this),this.writingMode=o||t&&t.writingMode||s.t.horizontal_tb,this.direction=a||t&&t.direction||s.t.ltr,this.dh=t?t.dh:new w;const h=this.ph();this.wh=h?[].concat(h.ah):[]}gh(t){if(!this.parent)throw new Error(`No PageFloatLayoutContext for ${t}`);return this.parent}mh(t,e,n,i){let s=this.children.indexOf(t);s<0&&(s=this.children.length);for(let t=s-1;t>=0;t--){let s=this.children[t];if(s.Un===e&&s.cn===n&&d.u(s.rh,i))return s;if(s=s.mh(null,e,n,i))return s}return null}ph(){let t,e=this,n=this.parent;for(;n;){if(t=n.mh(e,this.Un,this.cn,this.rh))return t;e=n,n=n.parent}return null}bh(t){return t&&t!==this.Un?this.gh(t).bh(t):this.container}Eh(t){this.container=t,this.xh()}Ko(t){this.dh.Ko(t)}yh(t){return t===this.Un?this:this.gh(t).yh(t)}Zo(t){return this.dh.Zo(t)}forbid(t){const e=t.Xo(),n=t.Un;n===this.Un?this.oh.includes(e)||(this.oh.push(e),(new S).kh(t).forbid(t,this)):this.gh(n).forbid(t)}Sh(t){const e=t.Xo(),n=t.Un;return n===this.Un?this.oh.includes(e):this.gh(n).Sh(t)}Ch(t,e){const n=t.Un;n!==this.Un?this.gh(n).Ch(t,e):this.hh.includes(t)||(this.hh.push(t),this.hh.sort((t,e)=>t.jo()-e.jo())),e||this.invalidate()}Ph(t,e){const n=t.Un;if(n!==this.Un)this.gh(n).Ph(t,e);else{const n=this.hh.indexOf(t);if(n>=0){const t=this.hh.splice(n,1)[0],i=t.area&&t.area.element;i&&i.parentNode&&i.parentNode.removeChild(i),e||this.invalidate()}}}Th(t){if(t.Un!==this.Un)return this.gh(t.Un).Th(t);const e=this.hh.findIndex(e=>e.Jo(t));return e>=0?this.hh[e]:null}_h(t){return!(!(this.hh.length>0)||t&&!this.hh.some(t))||!!this.parent&&this.parent._h(t)}Rh(t){return this._h(e=>e.continues&&e.nh()===t)}Nh(t,e){this.uh[t.Xo()]=e}Ih(){const t=Object.assign({},this.uh);return this.children.reduce((t,e)=>Object.assign(t,e.Ih()),t)}Ho(t){if(this.Fh().some(e=>e.float.Xo()===t))return!0;const e=this.Ih()[t];return!!e&&!(!this.container||!this.container.element)&&this.container.element.contains(e)}Ah(t){const e=t.float;if(e.Un===this.Un){const n=this.ah.findIndex(t=>t.float===e);n>=0?this.ah.splice(n,1,t):this.ah.push(t)}else this.gh(e.Un).Ah(t)}Oh(t,e){if(!e&&t.Un!==this.Un)return this.gh(t.Un).Oh(t,!1);const n=t.jo();return!!this.ah.some(e=>e.float.jo()<n&&!t.Go(e.float))||!!this.parent&&this.parent.Oh(t,!0)}Lh(t){const e=t.jo();let n=null;if(this.hh.forEach(t=>{t.continuations.forEach(t=>{const i=t.float,s=i.jo();s>e&&(!n||s>n.jo())&&(n=i)})}),this.parent){const e=this.parent.Lh(t);e&&(!n||e.jo()>n.jo())&&(n=e)}return n}Fh(t){t=t||this.cn;let e=this.wh.filter(e=>!t||e.float.cn===t);return this.parent&&(e=this.parent.Fh(t).concat(e)),e.sort((t,e)=>t.float.jo()-e.float.jo())}$h(t){t=t||this.cn;const e=this.ah.filter(e=>!t||e.float.cn===t);return this.parent?this.parent.$h(t).concat(e):e}Mh(){let t=[];const e=[];for(let n=this.children.length-1;n>=0;n--){const i=this.children[n];e.includes(i.cn)||(e.push(i.cn),t=(t=t.concat(i.ah.map(t=>t.float))).concat(i.Mh()))}return t}Dh(){if(this.Bh())return!0;for(let t=this.hh.length-1;t>=0;t--){const e=this.hh[t],n=e.eh(this);if(n)return this.locked?this.invalidate():(this.Ph(e),this.forbid(n),this.Uh(e.Cn)),!0}return!(this.Un!==g.REGION||!this.parent.locked)&&this.parent.Dh()}Bh(){const t=this.Mh(),e=this.hh.reduce((t,e)=>t.concat(e.continuations.map(t=>t.float)),[]);e.sort((t,e)=>e.jo()-t.jo());for(const n of e){const e=n.jo();if(t.some(t=>!n.Go(t)&&e>t.jo())){if(this.locked)this.invalidate();else{this.forbid(n);const t=this.Th(n);i.a(t),this.Ph(t)}return!0}}return!1}finish(){if(!this.Dh()){for(let t=this.ah.length-1;t>=0;t--)if(!this.ah[t].float.Wo(this)){if(this.locked)return void this.invalidate();this.ah.splice(t,1)}this.wh.forEach(t=>{this.ah.findIndex(e=>t.equals(e))>=0||this.hh.some(e=>e.Jo(t.float))||this.ah.push(t)})}}zh(t){return!!this.container&&!!t.container&&this.container.element===t.container.element}invalidate(){this.invalidated=!0,this.locked||(this.container&&(this.children.forEach(t=>{this.zh(t)&&t.hh.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),this.container.clear()),this.children.forEach(t=>{t.fh.splice(0)}),this.children.splice(0),Object.keys(this.uh).forEach(t=>{delete this.uh[t]}))}Vh(){const t=this.children.splice(0);return t.forEach(t=>{t.hh.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),t}jh(t){t.forEach(t=>{this.children.push(t),t.xh()})}Xh(){return this.invalidated||!!this.parent&&this.parent.Xh()}validate(){this.invalidated=!1}Wh(t){return function(t,e,n){return a(t,e,n||null,c)}(t,this.writingMode.toString(),this.direction.toString())}Hh(t){return function(t,e,n){return a(t,e,n||null,l)}(t,this.writingMode.toString(),this.direction.toString())}Uh(t){const e=this.Wh(t);if("block-end"===e||"inline-end"===e){let t=0;for(;t<this.hh.length;){const n=this.hh[t];this.Wh(n.Cn)===e?this.Ph(n):t++}}}Gh(t){const e=t.Un;if(e!==this.Un)return void this.gh(e).Gh(t);const n=this.Wh(t.Cn);if("block-end"===n||"snap-block"===n||"inline-end"===n){let e=0;for(;e<this.hh.length;){const i=this.hh[e],s=this.Wh(i.Cn);(s===n||"snap-block"===n&&"block-end"===s)&&i.sh(t)?(this.lh.push(i),this.hh.splice(e,1)):e++}}}Yh(t){t===this.Un?(this.lh.forEach(t=>{this.Ch(t,!0)}),this.lh.splice(0)):this.gh(t).Yh(t)}qh(t){t===this.Un?this.lh.splice(0):this.gh(t).qh(t)}Kh(t){return t===this.Un?this.lh.concat().sort((t,e)=>e.jo()-t.jo()):this.gh(t).Kh(t)}Zh(t,e,n,s){i.a(this.container);const r=this.Wh(t),o=this.Hh(t),a=this.Qh(r,e,n,s);if(this.parent&&this.parent.container){const t=this.parent.Zh(o,e,n,s);switch(o){case"top":case"left":return Math.max(a,t);case"bottom":case"right":return Math.min(a,t);default:i.b("Should be unreachable")}}return a}Qh(t,e,n,s){i.a(this.container);const r=this.Jh(e,n,s);switch(t){case"block-start":return this.container.vertical?r.right:r.top;case"block-end":return this.container.vertical?r.left:r.bottom;case"inline-start":return this.container.vertical?r.top:r.left;case"inline-end":return this.container.vertical?r.bottom:r.right;default:throw new Error(`Unknown logical side: ${t}`)}}Jh(t,e,n){i.a(this.container);const s=this.container.ar,r=this.container.dr,o=this.container.Xr();let a={top:o.y1-r,left:o.x1-s,bottom:o.y2-r,right:o.x2-s,tc:0,ec:0};function h(n,i,s){return"%"===n.unit?s*n.num/100:t.sc(n,i,e)}const l=this.hh;return l.length>0&&(a=l.reduce((t,e)=>{if(n&&!n(e,this))return t;const i=this.Wh(e.Cn),s=e.area,r=e.continuations[0].float.Tn;let a=t.top,l=t.left,c=t.bottom,u=t.right,f=t.tc,d=t.ec;switch(i){case"inline-start":s.vertical?a=Math.max(a,s.top+s.height):l=Math.max(l,s.left+s.width);break;case"block-start":s.vertical?(r&&s.left<u&&(f=h(r,s.ic[0],o.x2-o.x1)),u=Math.min(u,s.left)):(r&&s.top+s.height>a&&(f=h(r,s.ic[0],o.y2-o.y1)),a=Math.max(a,s.top+s.height));break;case"inline-end":s.vertical?c=Math.min(c,s.top):u=Math.min(u,s.left);break;case"block-end":s.vertical?(r&&s.left+s.width>l&&(d=h(r,s.ic[0],o.x2-o.x1)),l=Math.max(l,s.left+s.width)):(r&&s.top<c&&(d=h(r,s.ic[0],o.y2-o.y1)),c=Math.min(c,s.top));break;default:throw new Error(`Unknown logical float side: ${i}`)}return{top:a,left:l,bottom:c,right:u,tc:f,ec:d}},a)),a.left+=s,a.right+=s,a.top+=r,a.bottom+=r,a}nc(t,e,n,s,o,a,h){if(e!==this.Un)return this.gh(e).nc(t,e,n,s,o,a,h);let l=this.Wh(n);if("snap-block"===l){if(!h["block-start"]&&!h["block-end"])return null}else if(!h[l])return null;i.a(t.rc);let c=this.Zh("block-start",t.oc,t.rc),f=this.Zh("block-end",t.oc,t.rc),d=this.Zh("inline-start",t.oc,t.rc),p=this.Zh("inline-end",t.oc,t.rc);const g=t.vertical?t.ar:t.dr,m=t.vertical?t.dr:t.ar;function b(e,n){let i=e(t.bands,n);return i?(t.vertical&&(i=r.m(i)),c=t.vertical?Math.min(c,i.x2):Math.max(c,i.y1),f=t.vertical?Math.max(f,i.x1):Math.min(f,i.y2),!0):a}let E,w,v,y;if(c=t.vertical?Math.min(c,t.left+t.vr()+t.width+t.kr()+g):Math.max(c,t.top+g),f=t.vertical?Math.max(f,t.left+g):Math.min(f,t.top+t.xr()+t.height+t.yr()+g),o){const e=t.vertical?r.i(new r.c(f,d,c,p)):new r.c(d,c,p,f);if(("block-start"===l||"snap-block"===l||"inline-start"===l)&&!b(r.g,e))return null;if(("block-end"===l||"snap-block"===l||"inline-end"===l)&&!b(r.f,e))return null;if(E=(v=(f-c)*t.Or())-t.Sr()-t.Cr(),w=(y=p-d)-t.Pr()-t.Tr(),!a&&(E<=0||w<=0))return null}else{v=(E=t.wr)+t.Sr()+t.Cr();const e=(f-c)*t.Or();if("snap-block"===l){if(null===s)l="block-start";else{const t=this.container.Xr();l=this.container.Or()*(s-(this.container.vertical?t.x2:t.y1))<=this.container.Or()*((this.container.vertical?t.x1:t.y2)-s-v)?"block-start":"block-end"}if(!h[l]){if(!h["block-end"])return null;l="block-end"}}if(!a&&e<v)return null;y=(w="inline-start"===l||"inline-end"===l?u.b(t.rc,t.element,[u.a.FIT_CONTENT_INLINE_SIZE])[u.a.FIT_CONTENT_INLINE_SIZE]:t.hc?t.cc():t.vertical?t.height:t.width)+t.Pr()+t.Tr();const n=p-d;if(!a&&n<y)return null}switch(c-=g,f-=g,d-=m,p-=m,l){case"inline-start":case"block-start":case"snap-block":t.Ur(d,w),t.Br(c,E);break;case"inline-end":case"block-end":t.Ur(p-y,w),t.Br(f-v*t.Or(),E);break;default:throw new Error(`unknown float direction: ${n}`)}return l}lc(){const t=this.hh.map(t=>t.Wr());return this.parent?this.parent.lc().concat(t):t}xh(){const t=this.container.element&&this.container.element.parentNode;t&&this.hh.forEach(e=>{t.appendChild(e.area.element)})}uc(){const t=this.bh().vertical;return this.hh.reduce((e,n)=>{const i=n.Hr();return t?Math.min(e,i.x1):Math.max(e,i.y2)},t?1/0:0)}ac(){const t=this.bh().vertical;return this.hh.filter(t=>"block-end"===t.Cn).reduce((e,n)=>{const i=n.Hr();return t?Math.max(e,i.x2):Math.min(e,i.y1)},t?0:1/0)}fc(t,e){function n(t){return e=>t.Ho(e.float.Xo())}function s(t,e){return t.continuations.some(n(e))}const r=e.Xr(),o=e.vertical?r.x1:r.y2;let a=this;for(;a;){if(a.ah.some(n(a)))return o;a=a.parent}i.a(e.rc);const h=this.Zh("block-start",e.oc,e.rc,s);return this.Zh("block-end",e.oc,e.rc,s)*e.Or()<o*e.Or()?o:h}dc(t,e,n){if(t.Un!==this.Un)return this.gh(t.Un).dc(t,e,n);const i={"block-start":!0,"block-end":!0,"inline-start":!0,"inline-end":!0};if(!n)return i;const s=this.Wh(e),r=this.Wh(n);let o;o="all"===r?["block-start","block-end","inline-start","inline-end"]:"both"===r?["inline-start","inline-end"]:"same"===r?"snap-block"===s?["block-start","block-end"]:[s]:[r];const a=t.jo();function h(t){return e=>e.Cn===t&&e.jo()<a}return o.forEach(t=>{switch(t){case"block-start":case"inline-start":i[t]=!function t(e,n){return e.children.some(e=>e.hh.some(h(n))||t(e,n))}(this,t);break;case"block-end":case"inline-end":i[t]=!function t(e,n){const i=e.parent;return!!i&&(i.hh.some(h(n))||t(i,n))}(this,t);break;default:throw new Error(`Unexpected side: ${t}`)}}),i}wc(){return(this.parent?this.parent.wc():[]).concat(this.fh)}gc(t,e){e===this.Un?this.fh.push(t):this.gh(e).gc(t,e)}mc(t){const e=t.oc,n=t.rc;i.a(n);let s=this,r=null;for(;s&&s.container;){const i=s.Jh(e,n);r?t.vertical?(i.right<r.right&&(r.right=i.right,r.tc=i.tc),i.left>r.left&&(r.left=i.left,r.ec=i.ec)):(i.top>r.top&&(r.top=i.top,r.tc=i.tc),i.bottom<r.bottom&&(r.bottom=i.bottom,r.ec=i.ec)):r=i,s=s.parent}const o=Math.max(r.tc,r.ec);return(t.vertical?r.right-r.left:r.bottom-r.top)<=o}bc(){const t=this.bh().vertical;return this.hh.length?Math.max.apply(null,this.hh.map(e=>{const n=e.area;return t?n.width:n.height})):0}lock(){this.locked=!0}unlock(){this.locked=!1}Ec(){return this.locked}}const N=[];class S{static register(t){N.push(t)}xc(t){for(let e=N.length-1;e>=0;e--){const n=N[e];if(n.yc(t))return n}throw new Error(`No PageFloatLayoutStrategy found for ${t}`)}kh(t){for(let e=N.length-1;e>=0;e--){const n=N[e];if(n.vc(t))return n}throw new Error(`No PageFloatLayoutStrategy found for ${t}`)}}S.register(new class{yc(t){return b(t.Un)}vc(t){return!0}kc(t,e,n){let s=t.Un;i.a(t.Cn);const r=t.Cn,o=t.Yn();return n.Sc(s,t.columnSpan,t).Ot(n=>{s=n,i.a(e.cn);const a=new E(o,s,r,t.Pn,e.cn,t.Tn);return e.Ko(a),f.d(a)})}Cc(t,e,n,i){const s=t[0].float;return new v(s.Un,e,t,n,i)}Th(t,e){return e.Th(t)}Pc(t,e,n){}forbid(t,e){}})},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return h}),n.d(e,"d",function(){return l}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return u});var i=n(0),s=n(9);const r={page:!0,left:!0,right:!0,recto:!0,verso:!0,column:!0,region:!0};function o(t){return!!r[t]}const a={avoid:!0,"avoid-page":!0,"avoid-column":!0,"avoid-region":!0};function h(t){return!!a[t]}function l(t,e){if(!t)return e;if(!e)return t;{const n=o(t),i=o(e);if(!n||!i)return i?e:n?t:h(e)?e:h(t)?t:e;switch(e){case"column":return t;case"region":return"column"===t?e:t;default:return e}}}function c(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return"any"}}function u(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return null}}s.c.Kr("SIMPLE_PROPERTY",function(t){const e=t.name,n=t.value;switch(e){case"page-break-before":case"page-break-after":case"page-break-inside":return{name:e.replace(/^page-/,""),value:n===i.t.always?i.t.page:n,important:t.important};default:return t}})},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return h}),n.d(e,"f",function(){return l}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return u});var i=n(1),s=n(6),r=n(8);function o(t,e,n,r){const o=t.An;if(!o)return NaN;if(1==o.nodeType){if(t.after||!t.inline){const n=e.on(o);if(n.right>=n.left&&n.bottom>=n.top)return t.after?r?n.left:n.bottom:r?n.right:n.top}return NaN}{let a=NaN;const h=o.ownerDocument.createRange(),l=o.textContent.length;if(!l)return NaN;t.after&&(n+=l),n>=l&&(n=l-1),h.setStart(o,n),h.setEnd(o,n+1);let c=e.Tc(h);r&&i.m(document.body)&&(c=function(t,e,n){const i=n.ownerDocument.createRange();i.setStart(n,0),i.setEnd(n,n.textContent.length);const r=t.Tc(i),o=[];for(const t of e){let e;for(e=0;e<r.length;e++){const n=r[e];if(t.top>=n.top&&t.bottom<=n.bottom&&Math.abs(t.left-n.left)<1){o.push({top:t.top,left:n.left,bottom:t.bottom,right:n.right});break}}e==r.length&&(s.b.warn("Could not fix character box"),o.push(t))}return o}(e,c,o));let u=0;for(const t of c){const e=r?t.bottom-t.top:t.right-t.left;t.right>t.left&&t.bottom>t.top&&(isNaN(a)||e>u)&&(a=r?t.left:t.bottom,u=e)}return a}}function a(t,e,n){const i=e.rc.on(t),s=e._c(t);return n?i.width+s.left+s.right:i.height+s.top+s.bottom}function h(t){for(;t;){if(t.parentNode===t.ownerDocument)return!1;t=t.parentNode}return!0}function l(t,e){if(!t)return;let n;for(;(n=t.lastChild)!=e;)t.removeChild(n)}function c(t){return!!t.getAttribute(r.m)}function u(t){if(!t)return!1;const e=t.An;return!(!e||1!==e.nodeType)&&c(e)}},function(t,e,n){"use strict";var i,s,r,o,a,h;n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s}),n.d(e,"d",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return a}),n.d(e,"f",function(){return h}),(i||(i={})).Rc=function(t){return t&&"Block"===t.Nc},function(t){let e;!function(t){t.INLINE="inline",t.COLUMN="column",t.REGION="region",t.PAGE="page"}(e=t.FloatReference||(t.FloatReference={}))}(s||(s={})),(r||(r={})).Ic=function(t){return t&&"AfterIfContinue"==t.Fc},function(t){t.Ac=function(t){return!!t&&("RepetitiveElementsOwner"===t.Nc||a.Oc(t))},t.Lc=function(t){return!!t&&("RepetitiveElementsOwner"===t.Fc||a.$c(t))}}(o||(o={})),function(t){t.Oc=function(t){return t&&"Table"===t.Nc},t.$c=function(t){return t&&"TableRow"===t.Fc}}(a||(a={})),function(t){let e,n;!function(t){t[t.IGNORE=0]="IGNORE",t[t.NEWLINE=1]="NEWLINE",t[t.PRESERVE=2]="PRESERVE"}(e=t.Whitespace||(t.Whitespace={})),function(t){t[t.NONE=0]="NONE",t[t.CONTENT=1]="CONTENT",t[t.ROOTLESS=2]="ROOTLESS",t[t.ROOTED=3]="ROOTED"}(n=t.ShadowType||(t.ShadowType={}))}(h||(h={}))},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"c",function(){return h}),n.d(e,"e",function(){return l}),n.d(e,"g",function(){return c}),n.d(e,"d",function(){return u}),n.d(e,"a",function(){return f}),n.d(e,"f",function(){return p});var i,s=n(1),r=n(6),o=n(3),a=n(17);function h(t,e,n,s,a){const h=o.c("ajax"),c=new XMLHttpRequest,u=h.suspend(c),f={status:0,statusText:"",url:t,contentType:null,responseText:null,responseXML:null,Mc:null};c.open(n||"GET",t,!0),e&&(c.responseType=e),c.onreadystatechange=(()=>{if(4===c.readyState){if(f.status=c.status,f.statusText=c.statusText||404==c.status&&"Not Found"||"",200==f.status||0==f.status)if(e&&e!==i.DOCUMENT||!c.responseXML||"parsererror"==c.responseXML.documentElement.localName)if((!e||e===i.DOCUMENT)&&c.response instanceof HTMLDocument)f.responseXML=c.response,f.contentType=c.response.contentType;else{const n=c.response;e&&e!==i.TEXT||"string"!=typeof n?n?f.Mc="string"==typeof n?l([n]):n:r.b.warn("Unexpected empty success response for",t):f.responseText=n;const s=c.getResponseHeader("Content-Type");s&&(f.contentType=s.replace(/(.*);.*$/,"$1"))}else f.responseXML=c.responseXML,f.contentType=c.responseXML.contentType;u.schedule(f)}});try{s?(c.setRequestHeader("Content-Type",a||"text/plain; charset=UTF-8"),c.send(s)):(/^file:|^https?:\/\/[^\/]+\.githubusercontent\.com|\.opf$/.test(t)?/\/aozorabunko\/[^\/]+\/cards\/[^\/]+\/files\/[^\/.]+\.html$/.test(t)?c.overrideMimeType("text/html; charset=Shift_JIS"):/\.(html|htm)$/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/\.(xhtml|xht|xml|opf)$/.test(t)?c.overrideMimeType("application/xml; charset=UTF-8"):/\.(txt|css)$/.test(t)?c.overrideMimeType("text/plain; charset=UTF-8"):c.overrideMimeType("text/html; charset=UTF-8"):/^data:,(<|%3C|%3c)/.test(t)?c.overrideMimeType("text/html; charset=UTF-8"):/^data:,/.test(t)&&c.overrideMimeType("text/plain; charset=UTF-8"),c.send(null))}catch(e){r.b.warn(e,`Error fetching ${t}`),u.schedule(f)}return h.result()}function l(t,e){const n=e||"application/octet-stream",i=window.WebKitBlobBuilder||window.MSBlobBuilder;if(i){const e=new i;for(let n=0;n<t.length;n++)e.append(t[n]);return e.getBlob(n)}return new Blob(t,{type:n})}function c(t){const e=o.c("readBlob"),n=new FileReader,i=e.suspend(n);return n.addEventListener("load",()=>{i.schedule(n.result)},!1),n.readAsArrayBuffer(t),e.result()}function u(t){return(window.URL||window.webkitURL).createObjectURL(t)}!function(t){t.DEFAULT="",t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(i||(i={}));class f{constructor(t,e){this.parser=t,this.type=e,this.resources={},this.fetchers={}}load(t,e,n){t=s.I(t);const i=this.resources[t];return void 0!==i?o.d(i):this.fetch(t,e,n).get()}Dc(t,e,n){const i=this,s=o.c("fetch"),r=t.endsWith("?viv-toc-box");return r&&(t=t.replace("?viv-toc-box","")),h(t,i.type).then(o=>{if(o.status>=400&&e)throw new Error((n||`Failed to fetch required resource: ${t}`)+` (${o.status}${o.statusText?" "+o.statusText:""})`);r&&(t+="?viv-toc-box",o.url+="?viv-toc-box"),i.parser(o,i).then(e=>{delete i.fetchers[t],i.resources[t]=e,s.finish(e)})}),s.result()}fetch(t,e,n){if(t=s.I(t),this.resources[t])return null;let i=this.fetchers[t];if(!i){const s=this;i=new a.a(()=>s.Dc(t,e,n),`Fetch ${t}`),s.fetchers[t]=i,i.start()}return i}get(t){return this.resources[s.I(t)]}delete(t){delete this.resources[s.I(t)]}}function d(t,e){const n=t.responseText;return o.d(n?s.H(n):null)}function p(){return new f(d,i.TEXT)}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"b",function(){return h});var i=n(1),s=n(6),r=n(3);class o{constructor(t,e){this.fetch=t,this.arrived=!1,this.resource=null,this.task=null,this.piggybacks=[],this.name=e}start(){if(!this.task){const t=this;this.task=r.a().bt().run(()=>{const e=r.c("Fetcher.run");return t.fetch().then(n=>{const i=t.piggybacks;if(t.arrived=!0,t.resource=n,t.task=null,t.piggybacks=[],i)for(let t=0;t<i.length;t++)try{i[t](n)}catch(t){s.b.error(t,"Error:")}e.finish(n)}),e.result()},this.name)}}piggyback(t){this.arrived?t(this.resource):this.piggybacks.push(t)}get(){return this.arrived?r.d(this.resource):(this.start(),this.task.join())}Bc(){return this.arrived}}const a=t=>{if(0==t.length)return r.d(!0);if(1==t.length)return t[0].get().Lt(!0);const e=r.c("waitForFetches");let n=0;return e.loop(()=>{for(;n<t.length;){const e=t[n++];if(!e.Bc())return e.get().Lt(!0)}return r.d(!1)}).then(()=>{e.finish(!0)}),e.result()};function h(t,e){let n=null,s=null;"img"==t.localName&&(n=t.getAttribute("width"),s=t.getAttribute("height"));const a=new o(()=>{const o=r.c("loadImage"),a=o.suspend(t);let h=!1;const l=e=>{h||(h=!0,"img"==t.localName&&(n||t.removeAttribute("width"),s||t.removeAttribute("height")),a.schedule(e?e.type:"timeout"))};return t.addEventListener("load",l,!1),t.addEventListener("error",l,!1),t.addEventListener("abort",l,!1),t.namespaceURI==i.a.SVG?(t.setAttributeNS(i.a.XLINK,"xlink:href",e),setTimeout(l,300)):t.src=e,o.result()},`loadElement ${e}`);return a.start(),a}},function(t,e,n){"use strict";n.d(e,"c",function(){return l}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return f}),n.d(e,"e",function(){return d});var i=n(22),s=n(24),r=n(14),o=n(9),a=n(3),h=n(15);class l{find(t){const e=o.b(o.a.RESOLVE_LAYOUT_PROCESSOR);for(let n=0;n<e.length;n++){const i=e[n](t);if(i)return i}throw new Error(`No processor found for a formatting context: ${t.Nt()}`)}}class c{layout(t,e,n){return e.Uc(t)?e.zc(t):e.Vc(t)?e.jc(t):e.Xc(t)}Wc(t,e,n,s){return new i.b(t.copy(),e,n,s)}Hc(t){return!1}Gc(t,e){return!1}Yc(t,e,n,i){if(!n.An)return;if(!n.An.parentNode)return;const s=n.An.parentNode;r.f(s,n.An),i&&s.removeChild(n.An)}qc(t,e,n,i){const s=n||null!=e.An&&1==e.An.nodeType&&!e.after;return t.Yc(e,s),i&&(t.Kc(e,!0),t.oc.Zc(s?e:e.parent)),a.d(!0)}}class u{constructor(t){this.parent=t,this.Nc="Block"}Nt(){return"Block formatting context (BlockFormattingContext)"}Qc(t,e){return e}gh(){return this.parent}Jc(){}tl(t){}}const f=new c,d=h.a.Rc;o.d(o.a.RESOLVE_FORMATTING_CONTEXT,(t,e,n,i,r,o)=>{const a=t.parent;return!a&&t.an?null:a&&t.an!==a.an?null:t.In||!t.an&&s.d(n,i,r,o)?new u(a?a.an:null):null}),o.d(o.a.RESOLVE_LAYOUT_PROCESSOR,t=>t instanceof u?f:null)},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var i,s=n(1);function r(t,e,n){const r={display:e.style.display,position:e.style.position,width:e.style.width,maxWidth:e.style.maxWidth,minWidth:e.style.minWidth,height:e.style.height,maxHeight:e.style.maxHeight,minHeight:e.style.minHeight},o=e.ownerDocument,a=e.parentNode,h=o.createElement("div");function l(n){return t.el(e).getPropertyValue(n)}s.F(h,"position",r.position),a.insertBefore(h,e),h.appendChild(e),s.F(e,"width","auto"),s.F(e,"max-width","none"),s.F(e,"min-width","0"),s.F(e,"height","auto"),s.F(e,"max-height","none"),s.F(e,"min-height","0");const c=s.v("writing-mode"),u=(c?l(c[0]):null)||l("writing-mode"),f="vertical-rl"===u||"tb-rl"===u||"vertical-lr"===u||"tb-lr"===u,d=f?"height":"width",p=f?"width":"height";function g(){return s.F(e,"display","block"),s.F(e,"position","static"),l(d)}function m(){s.F(e,"display","inline-block"),s.F(h,d,"99999999px");const t=l(d);return s.F(h,d,""),t}function b(){s.F(e,"display","inline-block"),s.F(h,d,"0");const t=l(d);return s.F(h,d,""),t}function E(){const t=g(),e=b(),n=parseFloat(t);if(n<=parseFloat(e))return e;{const e=m();return n<=parseFloat(e)?t:e}}function w(){return l(p)}function v(){throw new Error("Getting fill-available block size is not implemented")}const y={};return n.forEach(t=>{let n;switch(t){case i.FILL_AVAILABLE_INLINE_SIZE:n=g();break;case i.MAX_CONTENT_INLINE_SIZE:n=m();break;case i.MIN_CONTENT_INLINE_SIZE:n=b();break;case i.FIT_CONTENT_INLINE_SIZE:n=E();break;case i.FILL_AVAILABLE_BLOCK_SIZE:n=v();break;case i.MAX_CONTENT_BLOCK_SIZE:case i.MIN_CONTENT_BLOCK_SIZE:case i.FIT_CONTENT_BLOCK_SIZE:n=w();break;case i.FILL_AVAILABLE_WIDTH:n=f?v():g();break;case i.FILL_AVAILABLE_HEIGHT:n=f?g():v();break;case i.MAX_CONTENT_WIDTH:n=f?w():m();break;case i.MAX_CONTENT_HEIGHT:n=f?m():w();break;case i.MIN_CONTENT_WIDTH:n=f?w():b();break;case i.MIN_CONTENT_HEIGHT:n=f?b():w();break;case i.FIT_CONTENT_WIDTH:n=f?w():E();break;case i.FIT_CONTENT_HEIGHT:n=f?E():w()}y[t]=parseFloat(n),s.F(e,"position",r.position),s.F(e,"display",r.display)}),s.F(e,"width",r.width),s.F(e,"max-width",r.maxWidth),s.F(e,"min-width",r.minWidth),s.F(e,"height",r.height),s.F(e,"max-height",r.maxHeight),s.F(e,"min-height",r.minHeight),a.insertBefore(e,h),a.removeChild(h),y}!function(t){t.FILL_AVAILABLE_INLINE_SIZE="fill-available inline size",t.FILL_AVAILABLE_BLOCK_SIZE="fill-available block size",t.FILL_AVAILABLE_WIDTH="fill-available width",t.FILL_AVAILABLE_HEIGHT="fill-available height",t.MAX_CONTENT_INLINE_SIZE="max-content inline size",t.MAX_CONTENT_BLOCK_SIZE="max-content block size",t.MAX_CONTENT_WIDTH="max-content width",t.MAX_CONTENT_HEIGHT="max-content height",t.MIN_CONTENT_INLINE_SIZE="min-content inline size",t.MIN_CONTENT_BLOCK_SIZE="min-content block size",t.MIN_CONTENT_WIDTH="min-content width",t.MIN_CONTENT_HEIGHT="min-content height",t.FIT_CONTENT_INLINE_SIZE="fit-content inline size",t.FIT_CONTENT_BLOCK_SIZE="fit-content block size",t.FIT_CONTENT_WIDTH="fit-content width",t.FIT_CONTENT_HEIGHT="fit-content height"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"c",function(){return l}),n.d(e,"e",function(){return u}),n.d(e,"b",function(){return d}),n.d(e,"a",function(){return p});var i=n(0),s=n(11),r=n(6);class o extends i.m{constructor(){super(),this.sl={}}$(t){return this.sl[t.name]=!0,t}Z(t){return this.S(t.values),t}}function a(t){if(t){const e=new o;try{return t.visit(e),e.sl}catch(t){r.b.warn(t,"toSet:")}}return{}}class h extends i.m{constructor(t){super(),this.value=t}X(t){return this.value=t.num,t}}function l(t,e){if(t){const n=new h(e);try{return t.visit(n),n.value}catch(t){r.b.warn(t,"toInt: ")}}return e}class c extends i.m{constructor(){super(),this.collect=!1,this.coords=[],this.name=null}U(t){return this.collect&&this.coords.push(t),null}V(t){return this.collect&&0==t.num&&this.coords.push(new i.i(0,"px")),null}Z(t){return this.S(t.values),null}et(t){return this.collect||(this.collect=!0,this.S(t.values),this.collect=!1,this.name=t.name.toLowerCase()),null}il(t,e,n,i,r){if(this.coords.length>0){const o=[];switch(this.coords.forEach((t,e)=>{if("%"==t.unit){let s=e%2==0?n:i;3==e&&"circle"==this.name&&(s=Math.sqrt((n*n+i*i)/2)),o.push(t.num*s/100)}else o.push(t.num*r.ut(t.unit,!1))}),this.name){case"polygon":if(o.length%2==0){const n=[];for(let i=0;i<o.length;i+=2)n.push(new s.b(t+o[i],e+o[i+1]));return new s.d(n)}break;case"rectangle":if(4==o.length)return s.k(t+o[0],e+o[1],t+o[0]+o[2],e+o[1]+o[3]);break;case"ellipse":if(4==o.length)return s.j(t+o[0],e+o[1],o[2],o[3]);break;case"circle":if(3==o.length)return s.j(t+o[0],e+o[1],o[2],o[2])}}return null}}function u(t,e,n,i,o,a){if(t){const s=new c;try{return t.visit(s),s.il(e,n,i,o,a)}catch(t){r.b.warn(t,"toShape:")}}return s.k(e,n,e+i,n+o)}class f extends i.m{constructor(t){super(),this.reset=t,this.counters={},this.name=null}$(t){return this.name=t.toString(),this.reset?this.counters[this.name]=0:this.counters[this.name]=(this.counters[this.name]||0)+1,t}X(t){return this.name&&(this.counters[this.name]+=t.num-(this.reset?0:1)),t}Z(t){return this.S(t.values),t}}function d(t,e){const n=new f(e);try{t.visit(n)}catch(t){r.b.warn(t,"toCounters:")}return n.counters}class p extends i.d{constructor(t,e){super(),this.nl=t,this.transformer=e}Y(t){return new i.l(this.transformer.rl(t.url,this.nl))}}},function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"e",function(){return h}),n.d(e,"a",function(){return l}),n.d(e,"d",function(){return c}),n.d(e,"f",function(){return u}),n.d(e,"b",function(){return f});var i=n(1),s=n(0),r=n(5),o=n(8);const a=(new DOMParser).parseFromString(`<root xmlns="${i.a.SHADOW}"/>`,"text/xml"),h=["footnote-marker","first-5-lines","first-4-lines","first-3-lines","first-2-lines","first-line","first-letter","before","","after"],l="data-adapt-pseudo";function c(t){return t.getAttribute(l)||""}function u(t,e){t.setAttribute(l,e)}class f{constructor(t,e,n,i,s){this.element=t,this.style=e,this.styler=n,this.context=i,this.Yr=s,this.ol={}}hl(t,e){const n=c(t);this.styler&&n&&n.match(/after$/)&&(this.style=this.styler.hl(this.element,!0),this.styler=null);const i=r.u(this.style,"_pseudos")[n]||{};if(n.match(/^first-/)&&!i["x-first-pseudo"]){let t,e=1;"first-letter"==n?e=0:null!=(t=n.match(/^first-([0-9]+)-lines$/))&&(e=t[1]-0),i["x-first-pseudo"]=new r.c(new s.g(e),0)}return i}cl(t,e){const n=c(t);if(!this.ol[n]){this.ol[n]=!0;const i=e.content;i&&o.y(i)&&i.visit(new o.c(t,this.context,i,this.Yr))}}}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"b",function(){return h});var i=n(13),s=n(14),r=n(15);class o{ll(t){return a(this.ul(),t.al())}fl(t){}ul(){return null}}function a(t,e){return{current:e.reduce((e,n)=>e+n.ll(t),0),minimum:e.reduce((e,n)=>e+n.dl(t),0)}}class h extends o{constructor(t,e,n,i){super(),this.position=t,this.pl=e,this.overflows=n,this.wr=i,this.wl=!1,this.edge=0,this.gl=n}ml(t,e){return this.bl(t),e<this.El()?null:t.xl(this)}El(){if(!this.wl)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");const t=this.yl()&&!this.gl;return(i.b(this.pl)?1:0)+(this.overflows&&!t?3:0)+(this.position.parent?this.position.parent.Bn:0)}vl(t){const e=t.kl(this.position);this.edge=s.a(this.position,t.rc,0,t.vertical)+e,this.wl=!0}bl(t){this.wl||this.vl(t);const e=this.edge,n=this.ll(t);this.gl=t.Sl(e+(t.vertical?-1:1)*n.minimum),this.overflows=this.position.overflow=t.Sl(e+(t.vertical?-1:1)*n.current)}ul(){return this.position}yl(){const t=this.ul();if(!t||!t.parent)return!1;const{an:e}=t.parent;if(!r.c.Ac(e))return!1;const n=e.Cl();return!!n&&n.Pl(t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"LayoutIteratorStrategy",function(){return h}),n.d(e,"LayoutIterator",function(){return l}),n.d(e,"EdgeSkipper",function(){return c}),n.d(e,"PseudoColumn",function(){return u});var i=n(13),s=n(22),r=n(30),o=n(3),a=n(8);class h{Tl(t){return{_l:t,Rl:!1,break:!1}}Nl(t){}Il(t){}Fl(t){}Al(t){}Ol(t){}Ll(t){}$l(t){}Ml(t){}Hc(t){}Gc(t){}finish(t){}}class l{constructor(t,e){this.strategy=t,this.oc=e}iterate(t){const e=this.strategy,n=e.Tl(t),i=o.c("LayoutIterator");return i.Ut(t=>{let i;for(;n._l;){const s=((i=n._l.An?1!==n._l.An.nodeType?a.p(n._l.An,n._l.whitespace)?n._l.after?e.Al(n):e.Fl(n):n._l.after?e.Ll(n):e.Ol(n):n._l.inline?n._l.after?e.Ml(n):e.$l(n):n._l.after?e.Gc(n):e.Hc(n):n._l.after?e.Il(n):e.Nl(n))&&i.Mt()?i:o.d(!0)).Ot(()=>n.break?o.d(null):this.oc.Dl(n._l,n.Rl));if(s.Mt())return void s.then(e=>{n.break?t.Vt():(n._l=e,t.zt())});if(n.break)return void t.Vt();n._l=s.get()}e.finish(n),t.Vt()}).then(()=>{i.finish(n._l)}),i.result()}}class c extends h{constructor(t){super(),this.Bl=t}Ul(t){}zl(t){}Vl(t){}Tl(t){return{_l:t,Rl:!!this.Bl&&t.after,break:!1,Bl:this.Bl,jl:null,Xl:!1,Wl:[],Hl:null}}Gl(t,e){const n=!t.Bl&&i.c(t.jl);if(n){const n=t._l=t.Wl[0]||t._l;n.An.parentNode.removeChild(n.An),e.Yl=t.jl}return n}ql(t,e){const n=e.Kl(t.Hl,null,!0,t.jl);return n&&(t._l=(t.Hl||t._l).modify(),t._l.overflow=!0),n}Zl(t,e,n){let i=t._l;const s=!e.Ql(i);return s&&(n.Kl(t.Hl,null,!1,t.jl),(i=t._l=i.modify()).overflow=!0),s}Ol(t){t.Xl=!1}Hc(t){return t.Wl.push(t._l.copy()),t.jl=i.d(t.jl,t._l.breakBefore),t.Xl=!0,this.Ul(t)}Gc(t){let e,n;return(n=t.Xl?(n=(e=this.zl(t))&&e.Mt()?e:o.d(!0)).Ot(()=>(t.break||(t.Wl=[],t.Bl=!1,t.Rl=!1,t.jl=null),o.d(!0))):(e=this.Vl(t))&&e.Mt()?e:o.d(!0)).Ot(()=>(t.break||(t.Xl=!1,t.Hl=t._l.copy(),t.jl=i.d(t.jl,t._l.breakAfter)),o.d(!0)))}}class u{constructor(t,e,n){this.Jl=[],this.column=Object.create(t),this.column.element=e,this.column.oc=t.oc.clone(),this.column.tu=!1,this.column.eu=n.an,this.column.su=t;const i=this.column.kl(n);this.column.iu=this.column.iu-i;const s=this;this.column.nu=function(t){return r.b.prototype.nu.call(this,t).Ot(t=>(s.Jl.push(t.copy()),o.d(t)))}}layout(t,e){return this.column.layout(t,e)}ru(t){const e=this.column.ru();if(t){const t=this.Jl[0].copy(),n=new s.b(t,null,t.overflow,0);if(n.ml(this.column,0),!e._l)return{ou:n,_l:t}}return e}qc(t,e,n){return this.column.qc(t,e,n)}hu(t){this.column.hu(t)}cu(t){const e=this.Jl[0];return e.An===t.An&&e.after===t.after&&e.bn===t.bn}lu(t){return a.u(t.Yn(),this.column.uu)}au(){return this.column.element}fu(){return this.column}}},function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"c",function(){return h}),n.d(e,"d",function(){return l}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return u}),n.d(e,"a",function(){return f}),n.d(e,"b",function(){return d});var i=n(0);const s="data-vivliostyle-flow-root";function r(t){return"true"===t.getAttribute(s)}function o(t){const e=t.toString();let n;switch(e){case"inline-flex":n="flex";break;case"inline-grid":n="grid";break;case"inline-table":n="table";break;case"inline":case"table-row-group":case"table-column":case"table-column-group":case"table-header-group":case"table-footer-group":case"table-row":case"table-cell":case"table-caption":case"inline-block":n="block";break;default:n=e}return i.r(n)}function a(t){return t===i.t.absolute||t===i.t.fixed}function h(t,e,n,s){return t===i.t.none||(a(e)?(n=i.t.none,t=o(t)):(n&&n!==i.t.none||s)&&(t=o(t))),{display:t,position:e,float:n}}function l(t,e,n,s){return h(t,e,n,s).display===i.t.block}function c(t){switch(t.toString()){case"inline":case"inline-block":case"inline-list-item":case"inline-flex":case"inline-grid":case"ruby":case"inline-table":return!0;default:return!1}}function u(t){switch(t.toString()){case"ruby-base":case"ruby-text":case"ruby-base-container":case"ruby-text-container":return!0;default:return!1}}function f(t,e,n,s,r,o,h){return r=r||o||i.t.horizontal_tb,!!h||!!n&&n!==i.t.none||a(e)||t===i.t.inline_block||t===i.t.table_cell||t===i.t.table_caption||t==i.t.flex||(t===i.t.block||t===i.t.list_item)&&!!s&&s!==i.t.visible||!!o&&r!==o}function d(t){return t===i.t.relative||t===i.t.absolute||t===i.t.fixed}},function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return h});var i=n(7);function s(t,e,n){return t-=n,0===e?0===t:t%e==0&&t/e>=0}class r{constructor(t){this.matchers=t}matches(){return this.matchers.some(t=>t.matches())}}class o{constructor(t){this.matchers=t}matches(){return this.matchers.every(t=>t.matches())}}class a{constructor(t,e,n){this.du=t,this.a=e,this.b=n}static pu(t,e,n){const i=a.wu;(!i[t]||i[t].priority<=n)&&(i[t]={En:e,priority:n})}static gu(){a.wu={}}matches(){const t=a.wu[this.du];return null!=t&&null!=t.En&&s(t.En,this.a,this.b)}}a.wu={};class h{static Ue(t,e){const n=e.split("_");return"NFS"==n[0]?new a(t,parseInt(n[1],10),parseInt(n[2],10)):(i.b(`unknown view condition. condition=${e}`),null)}static Us(t){return new o(t)}static Bs(t){return new r(t)}}},function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"e",function(){return f}),n.d(e,"a",function(){return p}),n.d(e,"c",function(){return E}),n.d(e,"d",function(){return w});var i=n(7),s=n(1),r=n(14),o=n(25),a=n(21),h=n(3),l=n(8),c=n(15);const u=c.d.Ic,f=o.b.pu;let d;o.b.gu,Promise.resolve().then(n.bind(null,23)).then(t=>{d=t});class p{constructor(t,e){this.yn=t,this.styler=e}createElement(t,e){if(!d)throw new Error("layoututil module is required but not be imported.");const n=e.An.ownerDocument.createElement("div"),i=new d.PseudoColumn(t,n,e),r=i.fu().Yl;return i.fu().Yl=null,i.layout(this.mu(),!0).Ot(()=>{this.styler.ol["after-if-continues"]=!1,i.fu().Yl=r;const t=n.firstChild;return s.F(t,"display","block"),h.d(t)})}mu(){const t=a.c.createElementNS(s.a.XHTML,"div");a.f(t,"after-if-continues");const e=this.bu(t),n={steps:[{node:t,pn:e.type,wn:e,gn:null,mn:null}],bn:0,after:!1,xn:null};return new l.a(n)}bu(t){return new l.n(this.yn,t,null,null,null,c.f.ShadowType.ROOTED,this.styler)}}class g{constructor(t,e,n){this._l=t,this.Mn=e,this.Eu=n,this.Fc="AfterIfContinue"}Ql(t,e,n){return!(e&&!t||t&&t.overflow)}xu(t){return!1}yu(t,e,n,i){}qc(t,e){return this.Cl().vu(t)?this.Mn.createElement(e,this._l).Ot(t=>(this._l.An.appendChild(t),h.d(!0))):h.d(!0)}Cl(){return new m(this._l,this.Eu)}ku(t){return t instanceof g&&this.Mn==t.Mn}Su(){return 9}}class m{constructor(t,e){this._l=t,this.Eu=e}ll(t){return this.vu(t)?this.Eu:0}dl(t){return this.ll(t)}vu(t){if(!t)return!1;const e=t.wn?t.wn.owner:t.yn;if(e===this._l.yn)return!!t.after;for(let t=e.parentNode;t;t=t.parentNode)if(t===this._l.yn)return!0;return!1}}function b(t,e){if(!t||!t.Mn||t.after||e.Uc(t))return h.d(t);const n=t.Mn;return n.createElement(e,t).Ot(s=>{i.a(null!==t);const o=function(t,e,n){const i=t.An;i.appendChild(n);const s=r.b(n,e,t.vertical);return i.removeChild(n),s}(t,e,s);return e.Cu.push(new g(t,n,o)),h.d(t)})}function E(t,e){return t.Ot(t=>b(t,e))}function w(t,e){const n=h.c("processAfterIfContinuesOfAncestors");let i=t;return n.loop(()=>{if(null!==i){const t=b(i,e);return i=i.parent,t.Lt(!0)}return h.d(!1)}).then(()=>{n.finish(!0)}),n.result()}},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return h});var i=n(28),s=n.n(i);function r(t,e){return s()(t,e,0)}function o(t){return t.reduce((t,e)=>e[0]===s.a.DELETE?t:t+e[1],"")}function a(t,e){return l(t,e,1)}function h(t,e){return l(t,e,-1)}function l(t,e,n){let i=0,r=0;return t.some(t=>{for(let o=0;o<t[1].length;o++){switch(t[0]*n){case s.a.INSERT:i++;break;case s.a.DELETE:i--,r++;break;case s.a.EQUAL:r++}if(r>e)return!0}return!1}),Math.max(Math.min(e,r-1)+i,0)}},function(t,e){var n=-1,i=1,s=0;function r(t,e,l,c){if(t===e)return t?[[s,t]]:[];if(null!=l){var p=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.Pu,s="number"==typeof n?null:n.Tu,r=t.length,o=e.length;if(0===i.length&&(null===s||0===s.length)){var a=i.index,h=t.slice(0,a),l=t.slice(a),c=s?s.index:null,u=a+o-r;if((null===c||c===u)&&!(u<0||u>o)){var f=e.slice(0,u);if((v=e.slice(u))===l){var p=Math.min(a,u),g=h.slice(0,p),m=f.slice(0,p);if(g===m){var b=h.slice(p),E=f.slice(p);return d(g,b,E,l)}}}if(null===c||c===a){var w=a,v=(f=e.slice(0,w),e.slice(w));if(f===h){var y=Math.min(r-w,o-w),T=l.slice(l.length-y),N=v.slice(v.length-y);if(T===N)return d(h,b=l.slice(0,l.length-y),E=v.slice(0,v.length-y),T)}}}return i.length>0&&s&&0===s.length&&(g=t.slice(0,i.index),T=t.slice(i.index+i.length),!(o<(p=g.length)+(y=T.length))&&(m=e.slice(0,p),N=e.slice(o-y),g===m&&T===N))?d(g,b=t.slice(p,r-y),E=e.slice(p,o-y),T):null}(t,e,l);if(p)return p}var g=a(t,e),m=t.substring(0,g);g=h(t=t.substring(g),e=e.substring(g));var b=t.substring(t.length-g),E=function(t,e){var l;if(!t)return[[i,e]];if(!e)return[[n,t]];var c=t.length>e.length?t:e,u=t.length>e.length?e:t,f=c.indexOf(u);if(-1!==f)return l=[[i,c.substring(0,f)],[s,u],[i,c.substring(f+u.length)]],t.length>e.length&&(l[0][0]=l[2][0]=n),l;if(1===u.length)return[[n,t],[i,e]];var d=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function s(t,e,n){for(var i,s,r,o,l=t.substring(n,n+Math.floor(t.length/4)),c=-1,u="";-1!==(c=e.indexOf(l,c+1));){var f=a(t.substring(n),e.substring(c)),d=h(t.substring(0,n),e.substring(0,c));u.length<d+f&&(u=e.substring(c-d,c)+e.substring(c,c+f),i=t.substring(0,n-d),s=t.substring(n+f),r=e.substring(0,c-d),o=e.substring(c+f))}return 2*u.length>=t.length?[i,s,r,o,u]:null}var r,o,l,c,u,f=s(n,i,Math.ceil(n.length/4)),d=s(n,i,Math.ceil(n.length/2));return f||d?(r=d?f&&f[4].length>d[4].length?f:d:f,t.length>e.length?(o=r[0],l=r[1],c=r[2],u=r[3]):(c=r[0],u=r[1],o=r[2],l=r[3]),[o,l,c,u,r[4]]):null}(t,e);if(d){var p=d[0],g=d[1],m=d[2],b=d[3],E=d[4],w=r(p,m),v=r(g,b);return w.concat([[s,E]],v)}return function(t,e){for(var s=t.length,r=e.length,a=Math.ceil((s+r)/2),h=a,l=2*a,c=new Array(l),u=new Array(l),f=0;f<l;f++)c[f]=-1,u[f]=-1;c[h+1]=0,u[h+1]=0;for(var d=s-r,p=d%2!=0,g=0,m=0,b=0,E=0,w=0;w<a;w++){for(var v=-w+g;v<=w-m;v+=2){for(var y=h+v,T=(_=v===-w||v!==w&&c[y-1]<c[y+1]?c[y+1]:c[y-1]+1)-v;_<s&&T<r&&t.charAt(_)===e.charAt(T);)_++,T++;if(c[y]=_,_>s)m+=2;else if(T>r)g+=2;else if(p&&(x=h+d-v)>=0&&x<l&&-1!==u[x]){var N=s-u[x];if(_>=N)return o(t,e,_,T)}}for(var S=-w+b;S<=w-E;S+=2){for(var x=h+S,C=(N=S===-w||S!==w&&u[x-1]<u[x+1]?u[x+1]:u[x-1]+1)-S;N<s&&C<r&&t.charAt(s-N-1)===e.charAt(r-C-1);)N++,C++;if(u[x]=N,N>s)E+=2;else if(C>r)b+=2;else if(!p&&(y=h+d-S)>=0&&y<l&&-1!==c[y]){var _=c[y];if(T=h+_-y,_>=(N=s-N))return o(t,e,_,T)}}}return[[n,t],[i,e]]}(t,e)}(t=t.substring(0,t.length-g),e=e.substring(0,e.length-g));return m&&E.unshift([s,m]),b&&E.push([s,b]),function t(e,r){e.push([s,""]);for(var o,l=0,c=0,d=0,p="",g="";l<e.length;)if(l<e.length-1&&!e[l][1])e.splice(l,1);else switch(e[l][0]){case i:d++,g+=e[l][1],l++;break;case n:c++,p+=e[l][1],l++;break;case s:var m=l-d-c-1;if(r){if(m>=0&&f(e[m][1])){var b=e[m][1].slice(-1);if(e[m][1]=e[m][1].slice(0,-1),p=b+p,g=b+g,!e[m][1]){e.splice(m,1),l--;var E=m-1;e[E]&&e[E][0]===i&&(d++,g=e[E][1]+g,E--),e[E]&&e[E][0]===n&&(c++,p=e[E][1]+p,E--),m=E}}if(u(e[l][1])){b=e[l][1].charAt(0);e[l][1]=e[l][1].slice(1),p+=b,g+=b}}if(l<e.length-1&&!e[l][1]){e.splice(l,1);break}if(p.length>0||g.length>0){p.length>0&&g.length>0&&(0!==(o=a(g,p))&&(m>=0?e[m][1]+=g.substring(0,o):(e.splice(0,0,[s,g.substring(0,o)]),l++),g=g.substring(o),p=p.substring(o)),0!==(o=h(g,p))&&(e[l][1]=g.substring(g.length-o)+e[l][1],g=g.substring(0,g.length-o),p=p.substring(0,p.length-o)));var w=d+c;0===p.length&&0===g.length?(e.splice(l-w,w),l-=w):0===p.length?(e.splice(l-w,w,[i,g]),l=l-w+1):0===g.length?(e.splice(l-w,w,[n,p]),l=l-w+1):(e.splice(l-w,w,[n,p],[i,g]),l=l-w+2)}0!==l&&e[l-1][0]===s?(e[l-1][1]+=e[l][1],e.splice(l,1)):l++,d=0,c=0,p="",g=""}""===e[e.length-1][1]&&e.pop();var v=!1;for(l=1;l<e.length-1;)e[l-1][0]===s&&e[l+1][0]===s&&(e[l][1].substring(e[l][1].length-e[l-1][1].length)===e[l-1][1]?(e[l][1]=e[l-1][1]+e[l][1].substring(0,e[l][1].length-e[l-1][1].length),e[l+1][1]=e[l-1][1]+e[l+1][1],e.splice(l-1,1),v=!0):e[l][1].substring(0,e[l+1][1].length)==e[l+1][1]&&(e[l-1][1]+=e[l+1][1],e[l][1]=e[l][1].substring(e[l+1][1].length)+e[l+1][1],e.splice(l+1,1),v=!0)),l++;v&&t(e,r)}(E,c),E}function o(t,e,n,i){var s=t.substring(0,n),o=e.substring(0,i),a=t.substring(n),h=e.substring(i),l=r(s,o),c=r(a,h);return l.concat(c)}function a(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),s=i,r=0;n<s;)t.substring(r,s)==e.substring(r,s)?r=n=s:i=s,s=Math.floor((i-n)/2+n);return l(t.charCodeAt(s-1))&&s--,s}function h(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),s=i,r=0;n<s;)t.substring(t.length-s,t.length-r)==e.substring(e.length-s,e.length-r)?r=n=s:i=s,s=Math.floor((i-n)/2+n);return c(t.charCodeAt(t.length-s))&&s--,s}function l(t){return t>=55296&&t<=56319}function c(t){return t>=56320&&t<=57343}function u(t){return c(t.charCodeAt(0))}function f(t){return l(t.charCodeAt(t.length-1))}function d(t,e,r,o){return f(t)||u(o)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[s,t],[n,e],[i,r],[s,o]])}function p(t,e,n){return r(t,e,n,!0)}p.INSERT=i,p.DELETE=n,p.EQUAL=s,t.exports=p},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(7),s=n(3);class r{constructor(){this._u=null,this.Ru=null}layout(t,e){return this.Nu(t,e),this.Iu(t,e)}Iu(t,e){const n=s.c("AbstractLayoutRetryer.tryLayout");this.Jc(t,e);const r=this.Fu(t);return r.Au(t,e).then(s=>{let o=r.accept(s,e);(o=r.yu(s,this.Ou,e,o))?n.finish(s):(i.a(this.Ou),this.Lu(this.Ou),this.tl(t,e),this.Iu(this.Ou,e).$t(n))}),n.result()}Nu(t,e){}Lu(t){const e=t.An||t.parent.An;let n,i;for(;n=e.lastChild;)e.removeChild(n);for(;i=e.nextSibling;)i.parentNode.removeChild(i)}Jc(t,e){this.Ou=t.copy(),this._u=[].concat(e.$u),this.Mu=[].concat(e.Cu),t.an&&(this.Ru=t.an.Jc())}tl(t,e){e.$u=this._u,e.Cu=this.Mu,t.an&&t.an.tl(this.Ru)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return N}),n.d(e,"b",function(){return C});var i=n(7),s=n(1),r=n(13),o=n(22),a=n(0),h=n(27),l=n(11),c=n(14),u=n(18),f=n(29),d=n(6),p=n(12),g=n(9),m=n(26),b=n(31),E=n(19),w=n(3),v=n(8),y=n(15);const T={img:!0,svg:!0,audio:!0,video:!0};class N{constructor(t){this.constraints=t}Ql(t){return this.constraints.every(e=>e.Ql(t))}}class S extends o.a{constructor(t,e){super(),this.Du=t,this.penalty=e,this.Bu=!1,this.Uu=null}ml(t,e){return e<this.El()?null:(this.Bu||(this.Uu=t.zu(this,e>0),this.Bu=!0),this.Uu)}El(){return this.penalty}ul(){return this.Bu?this.Uu:this.Du[this.Du.length-1]}}function x(t){switch(t){case"ruby":case"inline-block":case"inline-flex":case"inline-grid":case"inline-list-item":case"inline-table":return!0}return!1}class C extends v.b{constructor(t,e,n,i,s){super(t),this.oc=e,this.rc=n,this.Vu=i,this.ju=s,this.eu=null,this.Xu=!1,this.Wu=!1,this.Hu=0,this.Gu=0,this.Yu=0,this.qu=0,this.iu=0,this.box=null,this.Ku=null,this.bands=null,this.overflown=!1,this.$u=null,this.Yl=null,this.Zu=!0,this.Qu=0,this.Ju=0,this.ta=0,this.tu=!0,this.uu=null,this.Cu=[],this.su=null,this.ea=null,this.sa=NaN,this.last=t.lastChild,this.ia=t.ownerDocument,s.Eh(this)}na(){return this.vertical?this.Hu:this.Yu}ra(){return this.vertical?this.Gu:this.qu}oa(){return this.vertical?this.qu:this.Hu}ha(){return this.vertical?this.Yu:this.Gu}Uc(t){return!(!t.Cn||this.Xu&&!t.parent)}ca(t){return this.tu&&!!t&&t.overflow}Sl(t){return this.vertical?t<this.iu:t>this.iu}la(){const t=this.ju.lc();return this.exclusions.concat(t)}nu(t){const e=this,n=w.c("openAllViews"),s=t.steps;e.oc.ua(e.element,e.Wu);let r=s.length-1,o=null;return n.loop(()=>{for(;r>=0;){const n=o,i=s[r];if(o=v.v(i,n),r!==s.length-1||o.an||(o.an=e.eu),0==r&&(o.bn=e.aa(t),o.after=t.after,o.xn=t.xn,o.after))break;const a=e.oc.fa(o,0==r&&0==o.bn);if(r--,a.Mt())return a}return w.d(!1)}).then(()=>{i.a(o),n.finish(o)}),n.result()}aa(t){return t.xn?h.b(t.xn,t.bn):t.bn}da(t,e){if(t.Xn&&t.inline&&!t.after&&0==t.Xn.count&&1!=t.An.nodeType){const e=t.An.textContent.match(_);return this.oc.pa(t,e[0].length)}return w.d(t)}wa(t,e){const n=this;let i=!1;const s=w.c("buildViewToNextBlockEdge");return s.Ut(s=>{t.An&&!c.e(t)&&e.push(t.copy()),n.da(t,0).then(r=>{r!==t&&(t=r,c.e(t)||e.push(t.copy())),n.Dl(t).then(e=>{(t=e)?(!i&&n.Vu.Ql(t)||(i=!0,(t=t.modify()).overflow=!0),n.Uc(t)&&!n.vertical?n.zc(t).then(e=>{t=e,n.ju.Xh()&&(t=null),t?s.zt():s.Vt()}):t.inline?s.zt():s.Vt()):s.Vt()})})}).then(()=>{s.finish(t)}),s.result()}Dl(t,e){const n=this.oc.Dl(t,e);return m.c(n,this)}ga(t){if(!t.An)return w.d(t);let e=[];const n=t.yn,i=this,s=w.c("buildDeepElementView");return s.Ut(s=>{t.An&&t.inline&&!c.e(t)?e.push(t.copy()):(e.length>0&&i.ma(t,e),e=[]),i.da(t,0).then(r=>{const o=r;if(o!==t){let i=o;for(;i&&i.yn!=n;)i=i.parent;if(null==i)return t=o,void s.Vt();c.e(o)||e.push(o.copy())}i.Dl(o).then(e=>{(t=e)&&t.yn!=n?i.Vu.Ql(t)?s.zt():((t=t.modify()).overflow=!0,i.tu?s.Vt():s.zt()):s.Vt()})})}).then(()=>{e.length>0&&i.ma(t,e),s.finish(t)}),s.result()}ba(t,e,n,i){const r=this.ia.createElement("div");return this.vertical?(i>=this.height&&(i-=.1),s.F(r,"height",`${n}px`),s.F(r,"width",`${i}px`)):(n>=this.width&&(n-=.1),s.F(r,"width",`${n}px`),s.F(r,"height",`${i}px`)),s.F(r,"float",e),s.F(r,"clear",e),this.element.insertBefore(r,t),r}Ea(){let t=this.element.firstChild;for(;t;){const e=t.nextSibling;if(1==t.nodeType){const e=t,n=e.style.cssFloat;if("left"!=n&&"right"!=n)break;this.element.removeChild(e)}t=e}}xa(){const t=this.element.firstChild,e=this.bands,n=this.vertical?this.na():this.oa(),i=this.vertical?this.ra():this.ha();for(const s of e){const e=s.y2-s.y1;s.left=this.ba(t,"left",s.x1-n,e),s.right=this.ba(t,"right",i-s.x2,e)}}ya(t,e,n,i){let s;if(t&&c.c(t.An))return NaN;if(t&&t.after&&!t.inline&&(s=c.a(t,this.rc,0,this.vertical),!isNaN(s)))return s;let r=i-(t=e[n]).Sn;for(;;){if(s=c.a(t,this.rc,r,this.vertical),!isNaN(s))return s;if(r>0)r--;else{if(--n<0)return this.Yu;1!=(t=e[n]).An.nodeType&&(r=t.An.textContent.length)}}}va(t){if("number"==typeof t)return t;const e=t.match(/^(-?[0-9]*(\.[0-9]*)?)px$/);return e?parseFloat(e[0]):0}_c(t){const e=this.rc.el(t),n=new l.a(0,0,0,0);return e&&(n.left=this.va(e.marginLeft),n.top=this.va(e.marginTop),n.right=this.va(e.marginRight),n.bottom=this.va(e.marginBottom)),n}ka(t){const e=this.rc.el(t),n=new l.a(0,0,0,0);return e&&(n.left=this.va(e.borderLeftWidth)+this.va(e.paddingLeft),n.top=this.va(e.borderTopWidth)+this.va(e.paddingTop),n.right=this.va(e.borderRightWidth)+this.va(e.paddingRight),n.bottom=this.va(e.borderBottomWidth)+this.va(e.paddingBottom)),n}Sa(t){const e=this.rc.el(t),n=new l.a(0,0,0,0);if(e){if("border-box"==e.boxSizing)return this._c(t);n.left=this.va(e.marginLeft)+this.va(e.borderLeftWidth)+this.va(e.paddingLeft),n.top=this.va(e.marginTop)+this.va(e.borderTopWidth)+this.va(e.paddingTop),n.right=this.va(e.marginRight)+this.va(e.borderRightWidth)+this.va(e.paddingRight),n.bottom=this.va(e.marginBottom)+this.va(e.borderBottomWidth)+this.va(e.paddingBottom)}return n}Ca(t,e){const n=this.rc.el(t);n&&(e.marginLeft=this.va(n.marginLeft),e.borderLeft=this.va(n.borderLeftWidth),e.paddingLeft=this.va(n.paddingLeft),e.marginTop=this.va(n.marginTop),e.borderTop=this.va(n.borderTopWidth),e.paddingTop=this.va(n.paddingTop),e.marginRight=this.va(n.marginRight),e.borderRight=this.va(n.borderRightWidth),e.paddingRight=this.va(n.paddingRight),e.marginBottom=this.va(n.marginBottom),e.borderBottom=this.va(n.borderBottomWidth),e.paddingBottom=this.va(n.paddingBottom))}Pa(t,e){const n=this.rc.el(t);n&&(e.width=this.va(n.width),e.height=this.va(n.height))}Xc(t){return this.ga(t)}Ta(t){const e=this,n=w.c("layoutFloat"),r=t.An,o=t.Cn;return s.F(r,"float","none"),s.F(r,"display","inline-block"),s.F(r,"vertical-align","top"),e.ga(t).then(a=>{const h=e.rc.on(r),c=e._c(r);let u=new l.c(h.left-c.left,h.top-c.top,h.right+c.right,h.bottom+c.bottom),f=e.Hu,d=e.Gu,p=t.parent;for(;p&&p.inline;)p=p.parent;if(p){const n=p.An.ownerDocument.createElement("div");n.style.left="0px",n.style.top="0px",e.vertical?(n.style.bottom="0px",n.style.width="1px"):(n.style.right="0px",n.style.height="1px"),p.An.appendChild(n);const i=e.rc.on(n);f=Math.max(e.Nr(i),f),d=Math.min(e.Ir(i),d),p.An.removeChild(n);const s=e.vertical?u.y2-u.y1:u.x2-u.x1;"left"==o?d=Math.max(d,f+s):f=Math.min(f,d-s),p.An.appendChild(t.An)}let g=new l.c(f,e.Or()*e.Yu,d,e.Or()*e.qu),m=u;e.vertical&&(m=l.i(u));const b=e.Or();if(m.y1<e.ta*b){const t=m.y2-m.y1;m.y1=e.ta*b,m.y2=m.y1+t}l.h(g,e.bands,m,o),e.vertical&&(u=l.m(m));const E=e.Sa(r);let w;s.F(r,"width",`${u.x2-u.x1-E.left-E.right}px`),s.F(r,"height",`${u.y2-u.y1-E.top-E.bottom}px`),s.F(r,"position","absolute"),i.a(t.display),s.F(r,"display",t.display);let v=null;if(p&&(v=p.Fn?p:p.Kn()),v){const t=v.An.ownerDocument.createElement("div");t.style.position="absolute",v.vertical?t.style.right="0":t.style.left="0",t.style.top="0",v.An.appendChild(t),w=e.rc.on(t),v.An.removeChild(t)}else w={left:e.oa()-e.paddingLeft,right:e.ha()+e.paddingRight,top:e.na()-e.paddingTop};(v?v.vertical:e.vertical)?s.F(r,"right",`${w.right-u.x2}px`):s.F(r,"left",`${u.x1-w.left}px`),s.F(r,"top",`${u.y1-w.top}px`),t.On&&(t.On.parentNode.removeChild(t.On),t.On=null);const y=e.vertical?u.x1:u.y2,T=e.vertical?u.x2:u.y1;e.Sl(y)&&0!=e.$u.length?((t=t.modify()).overflow=!0,n.finish(t)):(e.Ea(),g=new l.c(e.oa(),e.na(),e.ha(),e.ra()),e.vertical&&(g=l.i(g)),l.e(g,e.bands,m,null,o),e.xa(),"left"==o?e.Qu=y:e.Ju=y,e.ta=T,e._a(y),n.finish(a))}),n.result()}Ra(t,e,n,i,s,r){const o=this.ju,a=o.bh(e),h=t.element;a.element.parentNode.appendChild(h),t.Xu=!0,t.ar=a.ar,t.dr=a.dr,t.vertical=a.vertical,t.marginLeft=t.marginRight=t.marginTop=t.marginBottom=0,t.borderLeft=t.borderRight=t.borderTop=t.borderBottom=0,t.paddingLeft=t.paddingRight=t.paddingTop=t.paddingBottom=0,t.exclusions=(a.exclusions||[]).concat(),t.Zu=!o._h(),t.pr=null;const l=a.Xr();t.Dr(l.x1-a.ar,l.x2-l.x1),t.Mr(l.y1-a.dr,l.y2-l.y1),s.Pc(t,a,this),t.init();const c=!!o.nc(t,e,n,i,!0,!o._h(),r);return c?(t.Ea(),t.init()):a.element.parentNode.removeChild(h),c}Na(t,e,n,i,r){const o=this.element.ownerDocument.createElement("div");s.F(o,"position","absolute");const a=this.ju.yh(t.Un),h=new p.e(null,p.a.COLUMN,null,this.ju.cn,t.Vo,null,null),l=a.bh(),c=new D(e,o,this.oc.clone(),this.rc,this.Vu,h,l);return h.Eh(c),this.Ra(c,t.Un,e,n,i,r)?c:null}Ia(t,e,n,s,r,o,a){const h=this.ju,l=a?a.continuations:[],c=(t=l.concat(t))[0].float,u=h.dc(c,e,n),f=this.Na(c,e,o,r,u),d={Fa:f,Aa:null,Oa:null};if(!f)return w.d(d);const p=w.c("layoutSinglePageFloatFragment");let g=!1,m=0;return p.Ut(e=>{if(m>=t.length)return void e.Vt();const n=t[m],i=new v.a(n.Vo);f.layout(i,!0).then(t=>{d.Oa=t,!t||s?(m++,e.zt()):(g=!0,e.Vt())})}).then(()=>{if(!g){i.a(f);const n=h.nc(f,c.Un,e,o,!1,s,u);if(n){const e=r.Cc(t,n,f,!!d.Oa);h.Ch(e,!0),d.Aa=e}else g=!0}p.finish(d)}),p.result()}La(t,e,n,s){const r=this.ju,o=t.float;function a(e,n){n?r.Ph(n,!0):e&&e.element.parentNode.removeChild(e.element),r.Yh(o.Un),r.Ah(t)}r.Gh(o);const h=w.c("layoutPageFloatInner"),l=this;return this.Ia([t],o.Cn,o.Pn,!r._h(),e,n,s).then(t=>{const e=t.Fa,n=t.Aa,c=t.Oa;n?l.$a(o.Un,[s]).then(t=>{if(t){if(i.a(n),r.Ch(n),r.qh(o.Un),c){const t=new p.c(o,c.primary);r.Ah(t)}h.finish(!0)}else a(e,n),h.finish(!1)}):(a(e,n),h.finish(!1))}),h.result()}$a(t,e){const n=this.ju,i=n.Kh(t),s=[],r=[];let o=!1;const a=w.c("layoutStashedPageFloats"),h=this;let l=0;return a.Ut(t=>{if(l>=i.length)return void t.Vt();const n=i[l];if(e.includes(n))return l++,void t.zt();const a=(new p.f).kh(n.continuations[0].float);h.Ia(n.continuations,n.Cn,null,!1,a,null).then(e=>{const n=e.Fa;n&&s.push(n);const i=e.Aa;i?(r.push(i),l++,t.zt()):(o=!0,t.Vt())})}).then(()=>{o?(r.forEach(t=>{n.Ph(t,!0)}),s.forEach(t=>{const e=t.element;e&&e.parentNode&&e.parentNode.removeChild(e)})):i.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)}),a.finish(!o)}),a.result()}Ma(t){const e=t.An.parentNode,n=e.ownerDocument.createElement("span");n.setAttribute(v.m,"1"),"footnote"===t.Cn&&this.oc.Da(t,"footnote-call",n),e.appendChild(n),e.removeChild(t.An);const i=t.modify();return i.after=!0,i.An=n,i}Sc(t,e,n){const i=this,s=w.c("resolveFloatReferenceFromColumnSpan"),r=this.ju,o=r.yh(p.a.REGION);return r.bh().width<o.bh().width&&t===p.a.COLUMN?e===a.t.auto?this.ga(n.copy()).then(e=>{const n=e.An;let r=E.b(i.rc,n,[E.a.MIN_CONTENT_INLINE_SIZE])[E.a.MIN_CONTENT_INLINE_SIZE];const o=i._c(n);i.vertical?r+=o.top+o.bottom:r+=o.left+o.right,r>i.width?s.finish(p.a.REGION):s.finish(t)}):e===a.t.all?s.finish(p.a.REGION):s.finish(t):s.finish(t),s.result()}Ba(t){const e=this,n=this.ju,s=(new p.f).xc(t);let r;const o=n.Zo(t.Yn());return(r=o?w.d(o):s.kc(t,n,this)).Ot(r=>{const o=v.x(t,0),a=e.Ma(t),h=s.Th(r,n),l=new p.c(r,o);if(h&&h.Jo(r))return n.Nh(r,a.An),w.d(a);if(n.Sh(r)||n.Oh(r))return n.Ah(l),n.Nh(r,a.An),w.d(a);if(e.ea)return w.d(null);{const t=c.a(a,e.rc,0,e.vertical);return e.Sl(t)?w.d(a):e.La(l,s,t,h).Ot(t=>(i.a(r),t?w.d(null):(n.Nh(r,a.An),w.d(a))))}})}Ua(t,e,n,i){const r=e.createElement("span");r.style.visibility="hidden",r.style.verticalAlign="top",r.setAttribute(v.m,"1");const o=e.createElement("span");o.style.fontSize="0",o.style.lineHeight="0",o.textContent=" #",r.appendChild(o),r.style.display="block",r.style.textIndent="0",r.style.textAlign="left",n.insertBefore(r,t);const a=this.rc.on(o);r.style.textAlign="right";const h=this.rc.on(o);r.style.textAlign="",s.j(document.body)?r.style.display="inline":r.style.display="inline-block";const l=i?h.top-a.top:h.left-a.left,c=l>=1?`${l-1}px`:"100%";return i?r.style.paddingTop=c:r.style.paddingLeft=c,r}za(t,e,n,i,r,o){return function(t,e,n,i){if(s.k(document.body)){const r=A(t),o=e?n:n.previousSibling,a=o?o.textContent:"";if(a.charAt(a.length-1)===r){const t=n.ownerDocument,e=n.parentNode;s.l(document.body)?e.insertBefore(t.createTextNode(" "),i):e.insertBefore(t.createElement("wbr"),i)}}}(t,e,n,i),this.Ua(i,r,o,t.vertical)}Va(t,e,n){const i=this.rc.on(t),s=this.rc.on(e);n.vertical?(e.style.marginRight=`${s.right-i.right}px`,e.style.width="0px"):(e.style.marginTop=`${i.top-s.top}px`,e.style.height="0px"),e.setAttribute(v.m,"1")}Kc(t,e){if(t.after&&!t.inline)return;if(e){let e="";for(let n=t.parent;n&&!e;n=n.parent)!n.inline&&n.An&&(e=n.An.style.textAlign);if("justify"!==e)return}const n=t.An,i=n.ownerDocument,s=e&&(t.after||1!=n.nodeType);let r=s?n.nextSibling:n;r&&!r.parentNode&&(r=null);const o=n.parentNode||t.parent&&t.parent.An;if(!o)return;const a=this.za(t,s,n,r,i,o);if(!e){const e=i.createElement("div");o.insertBefore(e,r),this.Va(a,e,t)}}ja(t,e,n){const i=this,s=w.c("processLineStyling");let r=n.concat([]);n.splice(0,n.length);let o=0,a=t.Xn;return 0==a.count&&(a=a.outer),s.Ut(n=>{if(!a)return void n.Vt();const s=i.Xa(r),h=a.count-o;if(s.length<=h)return void n.Vt();const l=i.Wa(r,s[h-1],!0);null!=l?i.qc(l,!1,!1).then(()=>{o+=h,i.oc.pa(l,0).then(s=>{t=s,i.Kc(t,!1),a=t.Xn,r=[],i.wa(t,r).then(t=>{e=t,n.zt()})})}):n.Vt()}).then(()=>{Array.prototype.push.apply(n,r),s.finish(e)}),s.result()}Ha(t){return!(2!=t.length&&this.$u.length>0)&&t[0].yn==t[1].yn&&T[t[0].yn.localName]}Ga(t){let e=0,n=0;for(let i=t.length-1;i>=0;i--){const s=t[i];if(!s.after||!s.An||1!=s.An.nodeType)break;const r=this._c(s.An),o=this.vertical?-r.left:r.bottom;o>0?e=Math.max(e,o):n=Math.min(n,o)}return e-n}jc(t){const e=this,n=w.c("layoutBreakableBlock"),i=[];return e.wa(t,i).then(s=>{const r=i.length-1;if(r<0)return void n.finish(s);let a,h=e.ya(s,i,r,i[r].Sn),l=!1;if(!s||!c.c(s.An)){const t=o.c(s,e.al());l=e.Sl(h+(e.vertical?-1:1)*t.minimum),e.Sl(h+(e.vertical?-1:1)*t.current)&&!e.ea&&(e.ea=s)}null==s&&(h+=e.Ga(i)),e._a(h),(a=t.Xn?e.ja(t,s,i):w.d(s)).then(t=>{e.ma(t,i),i.length>0&&(e.Ya(i),l&&!e.Ha(i)&&t&&((t=t.modify()).overflow=!0)),n.finish(t)})}),n.result()}ma(t,e){g.b(g.a.POST_LAYOUT_BLOCK).forEach(n=>{n(t,e,this)})}qa(t,e,n){const i=this.vertical?t-1:t+1;let s,r=0,o=e[0].Sn,a=r,h=e.length-1,l=e[h].Sn;for(;o<l;){s=o+Math.ceil((l-o)/2),a=r;let t=h;for(;a<t;){const n=a+Math.ceil((t-a)/2);e[n].Sn>s?t=n-1:a=n}const c=this.ya(null,e,a,s);if(this.vertical?c<=i:c>=i){for(l=s-1;e[a].Sn==s;)a--;h=a}else n&&this._a(c),o=s,r=a}return{_l:e[a],index:o,Ka:a}}Wa(t,e,n){const i=this.qa(e,t,!0);let s=i._l;const r=s.An;if(1!=r.nodeType){const e=r;s=this.Qa(s).Za(e,s,i.index,t,i.Ka,n)}return this.Yc(s,!1),s}Qa(t){return g.b(g.a.RESOLVE_TEXT_NODE_BREAKER).reduce((e,n)=>n(t)||e,I.instance)}Ja(t,e){const n=[],i=t.ownerDocument.createRange();let s=!1,r=t,o=null,a=!1,h=!0;for(;h;){let t=!0;do{let n=null;r==e&&(h=1===e.nodeType&&!(!e.firstChild||s)),1!=r.nodeType?(a||(i.setStartBefore(r),a=!0),o=r):s?s=!1:c.d(r)?t=!a:"ruby"==r.localName||x(this.rc.el(r).display)?((t=!a)&&(i.setStartBefore(r),a=!0,o=r),r.contains(e)&&(h=!1)):n=r.firstChild,n||(n=r.nextSibling)||(s=!0,n=r.parentNode),r=n}while(t&&h);if(a){i.setEndAfter(o);const t=this.rc.Tc(i);for(let e=0;e<t.length;e++)n.push(t[e]);a=!1}}return n}Xa(t){const e=[],n=this.Ja(t[0].An,t[t.length-1].An);n.sort(this.vertical?v.q:v.r);let i=0,r=0,o=0,a=0,h=0;const l=this.Or();for(;;){if(h<n.length){const t=n[h];let e=1;if(a>0){const n=Math.max(this.Ar(t),1);e=l*this._r(t)<l*i?l*(this.Rr(t)-i)/n:l*this.Rr(t)>l*r?l*(r-this._r(t))/n:1}if(0==a||e>=.6||e>=.2&&this.Nr(t)>=o-1){o=this.Ir(t),this.vertical?(i=0==a?t.right:Math.max(i,t.right),r=0==a?t.left:Math.min(r,t.left)):(i=0==a?t.top:Math.min(i,t.top),r=0==a?t.bottom:Math.max(r,t.bottom)),a++,h++;continue}}if(a>0&&(e.push(r),a=0),h>=n.length)break}return e.sort(s.B),this.vertical&&e.reverse(),e}kl(t){let e=0;return t.Zn(t=>{if("clone"===t.jn["box-decoration-break"]){i.a(t.An instanceof Element);const n=this.ka(t.An);e+=t.vertical?-n.left:n.bottom,"table"===t.display&&(e+=t.Rn)}}),e}tf(t){let e;return(e=t?t.ll(this):o.c(null,this.al())).current}zu(t,e){const n=this,i=t.Du;let r,o,a=i[0];for(;a.parent&&a.inline;)a=a.parent;e?(r=1,o=1):(r=Math.max((a.jn.widows||2)-0,1),o=Math.max((a.jn.orphans||2)-0,1));const h=n.kl(a),l=this.Xa(i);let c=this.iu-h;const u=this.Or(),f=this.tf(t);c-=u*f;const d=this.ef(i);isNaN(d.edge)&&(d.edge=u*(1/0));let p=s.i(l.length,t=>{const e=l[t];return n.vertical?e<c||e<=d.edge:e>c||e>=d.edge});const g=p<=0;if(g&&(p=s.i(l.length,t=>n.vertical?l[t]<c:l[t]>c)),(p=Math.min(l.length-r,p))<o)return null;let m;if(c=l[p-1],m=g?d.sf:this.Wa(t.Du,c,e)){const t=this.if(m);!isNaN(t)&&t<c&&(c=t),this.wr=u*(c-this.Yu)+f}return m}if(t){let e=t;do{e=e.parent}while(e&&e.inline);return e?((e=e.copy().modify()).after=!0,c.a(e,this.rc,0,this.vertical)):NaN}ef(t){const e=t.findIndex(t=>t.overflow);if(e<0)return{edge:NaN,sf:null};const n=t[e];return{edge:this.ya(null,t,e,n.Sn),sf:n}}xl(t){return this.wr=t.wr+this.tf(t),t.position}qc(t,e,n){i.a(t.an);let s=(new u.c).find(t.an).qc(this,t,e,n);return s||(s=u.d.qc(this,t,e,n)),s}ru(){let t=null,e=null,n=0,i=0;do{n=i,i=Number.MAX_VALUE;for(let s=this.$u.length-1;s>=0&&!e;--s){e=(t=this.$u[s]).ml(this,n);const r=t.El();r>n&&(i=Math.min(i,r))}}while(i>n&&!e&&this.Zu);return{ou:e?t:null,_l:e}}nf(t,e,n,i){if(this.ju.Xh()||this.Yl||!e)return w.d(t);const s=this,r=w.c("doFinishBreak");let o=!1;if(!t){if(this.Zu)return d.b.warn("Could not find any page breaks?!!"),s.rf(e).then(t=>{t?((t=t.modify()).overflow=!1,s.qc(t,o,!0).then(()=>{r.finish(t)})):r.finish(t)}),r.result();t=n,o=!0,s.wr=i}return this.qc(t,o,!0).then(()=>{r.finish(t)}),r.result()}Vc(t){if(t.after)return!0;switch(t.yn.namespaceURI){case s.a.SVG:return!1}return!t.Nn}hf(t){const e=t.toString();return""==e||"auto"==e||!!e.match(/^0+(.0*)?[^0-9]/)}cf(t,e){if(!t)return!1;if(c.c(t.An))return!1;let n=c.a(t,this.rc,0,this.vertical);const i=o.c(t,this.al()),s=this.Sl(n+(this.vertical?-1:1)*i.minimum);if(this.Sl(n+(this.vertical?-1:1)*i.current)&&!this.ea)this.ea=t;else if(e){const t=n+this.Ga(e),s=this.iu-this.Or()*i.current;n=this.vertical?Math.min(n,Math.max(t,s)):Math.max(n,Math.min(t,s))}return this._a(n),s}Kl(t,e,n,i){if(!t)return!1;if(c.c(t.An))return!1;const s=this.cf(t,e);return!n&&s||this.lf(t,i,s),s}uf(t){if(!t.An.parentNode)return!1;const e=this._c(t.An),n=t.An.ownerDocument.createElement("div");this.vertical?(n.style.bottom="0px",n.style.width="1px",n.style.marginRight=`${e.right}px`):(n.style.right="0px",n.style.height="1px",n.style.marginTop=`${e.top}px`),t.An.parentNode.insertBefore(n,t.An);let i=this.rc.on(n);const s=this._r(i),r=this.Or(),o=t.Pn;let a=-this.Or()*(1/0);switch("all"===o&&(a=this.ju.fc(o,this)),o){case"left":a=r*Math.max(a*r,this.Qu*r);break;case"right":a=r*Math.max(a*r,this.Ju*r);break;default:a=r*Math.max(a*r,Math.max(this.Ju*r,this.Qu*r))}if(s*r>=a*r)return t.An.parentNode.removeChild(n),!1;{const o=Math.max(1,(a-s)*r);this.vertical?n.style.width=`${o}px`:n.style.height=`${o}px`,i=this.rc.on(n);const h=this.Rr(i);if(this.vertical){let t=h+e.right-a;t>0==e.right>=0&&(t+=e.right),n.style.marginLeft=`${t}px`}else{let t=a-(h+e.top);t>0==e.top>=0&&(t+=e.top),n.style.marginBottom=`${t}px`}return t.On=n,!0}}af(t){return!!u.e(t)||!!y.c.Ac(t)}ff(t,e,n){const s=t.after?t.parent&&t.parent.an:t.an;if(s&&!this.af(s))return w.d(t);const o=this,a=w.c("skipEdges");let h=!n&&e&&t&&t.after,l=n,c=null,f=[],d=[],p=!1;function g(){return!!n||!e&&r.c(l)}function m(){(t=f[0]||t).An.parentNode.removeChild(t.An),o.Yl=l}return a.Ut(n=>{for(;t;){i.a(t.an);const s=(new u.c).find(t.an);do{if(!t.An)break;if(t.inline&&1!=t.An.nodeType){if(v.p(t.An,t.whitespace))break;if(!t.after)return g()?m():o.Kl(c,null,!0,l)?(t=(o.tu&&c||t).modify()).overflow=!0:(t=t.modify()).breakBefore=l,void n.Vt()}if(!t.after){if(s&&s.Hc(t))break;if(t.Pn&&o.uf(t)&&e&&0===o.$u.length&&o.lf(t.copy(),l,!1),!o.af(t.an)||y.c.Ac(t.an)||o.Uc(t)||t.Nn)return f.push(t.copy()),l=r.d(l,t.breakBefore),g()?m():!o.Kl(c,null,!0,l)&&o.Vu.Ql(t)||((t=(o.tu&&c||t).modify()).overflow=!0),void n.Vt()}if(1!=t.An.nodeType)break;const i=t.An.style;if(t.after){if(t.inline)break;if(s&&s.Gc(t,o.tu))break;if(p){if(g())return m(),void n.Vt();f=[],e=!1,h=!1,l=null}p=!1,c=t.copy(),d.push(c),l=r.d(l,t.breakAfter),!i||o.hf(i.paddingBottom)&&o.hf(i.borderBottomWidth)||(d=[c])}else{if(f.push(t.copy()),l=r.d(l,t.breakBefore),!o.Vu.Ql(t)&&(o.Kl(c,null,!o.tu,l),(t=t.modify()).overflow=!0,o.tu))return void n.Vt();const e=t.An.localName;if(T[e])return g()?m():o.Kl(c,null,!0,l)&&((t=(o.tu&&c||t).modify()).overflow=!0),void n.Vt();!i||o.hf(i.paddingTop)&&o.hf(i.borderTopWidth)||(h=!1,d=[]),p=!0}}while(0);const a=o.Dl(t,h);if(a.Mt())return void a.then(e=>{t=e,n.zt()});t=a.get()}o.Kl(c,d,!o.tu,l)?c&&o.tu&&((t=c.modify()).overflow=!0):r.c(l)&&(o.Yl=l),n.Vt()}).then(()=>{c&&(o.uu=c.Yn()),a.finish(t)}),a.result()}rf(t){let e=t.copy();const n=this,i=w.c("skipEdges");let s=null,o=!1;return i.Ut(i=>{for(;t;){do{if(!t.An)break;if(t.inline&&1!=t.An.nodeType){if(v.p(t.An,t.whitespace))break;if(!t.after)return r.c(s)&&(n.Yl=s),void i.Vt()}if(!t.after&&(n.Uc(t)||t.Nn))return s=r.d(s,t.breakBefore),r.c(s)&&(n.Yl=s),void i.Vt();if(1!=t.An.nodeType)break;const e=t.An.style;if(t.after){if(o){if(r.c(s))return n.Yl=s,void i.Vt();s=null}o=!1,s=r.d(s,t.breakAfter)}else{s=r.d(s,t.breakBefore);const o=t.An.localName;if(T[o])return r.c(s)&&(n.Yl=s),void i.Vt();if(e&&(!n.hf(e.paddingTop)||!n.hf(e.borderTopWidth)))return void i.Vt()}o=!0}while(0);const e=n.oc.Dl(t);if(e.Mt())return void e.then(e=>{t=e,i.zt()});t=e.get()}e=null,i.Vt()}).then(()=>{i.finish(e)}),i.result()}zc(t){return p.h(t.Un)||"footnote"===t.Cn?this.Ba(t):this.Ta(t)}df(t,e,n){const s=this,r=w.c("layoutNext");return this.ff(t,e,n||null).then(n=>{if(!(t=n)||s.Yl||s.ca(t))r.finish(t);else{const n=t.an;i.a(n),(new u.c).find(n).layout(t,s,e).$t(r)}}),r.result()}Yc(t,e){if(t)for(let n=t.parent;t;t=n,n=n?n.parent:null){const s=(n||t).an;i.a(s),(new u.c).find(s).Yc(this,n,t,e),e=!1}}pf(){const t=this.element.ownerDocument.createElement("div");t.style.position="absolute",t.style.top=`${this.paddingTop}px`,t.style.right=`${this.paddingRight}px`,t.style.bottom=`${this.paddingBottom}px`,t.style.left=`${this.paddingLeft}px`,this.element.appendChild(t);const e=this.rc.on(t);this.element.removeChild(t);const n=this.ar+this.left+this.vr(),i=this.dr+this.top+this.xr();this.box=new l.c(n,i,n+this.width,i+this.height),this.Hu=e?this.vertical?e.top:e.left:0,this.Gu=e?this.vertical?e.bottom:e.right:0,this.Yu=e?this.vertical?e.right:e.top:0,this.qu=e?this.vertical?e.left:e.bottom:0,this.Qu=this.Yu,this.Ju=this.Yu,this.ta=this.Yu,this.iu=this.qu,this.bands=l.l(this.box,[this.zr()],this.la(),8,this.mr,this.vertical),this.xa()}init(){this.Ku=[],s.F(this.element,"width",`${this.width}px`),s.F(this.element,"height",`${this.height}px`),this.pf(),this.wr=0,this.overflown=!1,this.Yl=null,this.uu=null}lf(t,e,n){i.a(t.an);const s=t.copy(),r=(new u.c).find(t.an),o=this.kl(s),a=r.Wc(s,e,n,this.wr+o);this.$u.push(a)}Ya(t){const e=t[0].Bn,n=new S(t,e);this.$u.push(n)}_a(t){if(!isNaN(t)){const e=this.Or()*(t-this.Yu);this.wr=Math.max(e,this.wr)}}layout(t,e,n){if(this.Ku.push(t),t.primary.after&&(this.uu=t.primary),this.tu&&this.overflown)return w.d(t);if(this.wf())return t.primary.after&&1===t.primary.steps.length?w.d(null):w.d(t);const i=this,s=w.c("layout");return i.nu(t.primary).then(t=>{let r=null;if(t.An)r=t.copy();else{const t=e=>{e._l.An&&(r=e._l,i.oc.removeEventListener("nextInTree",t))};i.oc.addEventListener("nextInTree",t)}const o=new O(e,n);o.layout(t,i).then(t=>{i.nf(t,o.context.gf,r,o.mf).then(t=>{let e=null;(i.su?w.d(null):i.hu(t)).then(()=>{if(i.ju.Xh())s.finish(null);else if(t){i.overflown=!0;const e=new v.a(t.Yn());s.finish(e)}else s.finish(null)})})})}),s.result()}wf(){return this.ju.mc(this)}bc(){return this.ju.bc()}hu(t){const e=w.c("doFinishBreakOfFragmentLayoutConstraints"),n=[].concat(this.Cu);n.sort((t,e)=>t.Su()-e.Su());let i=0;return e.loop(()=>i<n.length?n[i++].qc(t,this).Lt(!0):w.d(!1)).then(()=>{e.finish(!0)}),e.result()}Au(t,e,n){const i=this,s=w.c("doLayout");let r=null;return i.$u=[],i.ea=null,s.Ut(s=>{for(;t;){let o=!0;if(i.df(t,e,n||null).then(a=>{if(e=!1,n=null,i.ea&&i.tu?(i.Yl=null,(t=i.ea).overflow=!0):t=a,i.ju.Xh())s.Vt();else if(i.Yl)s.Vt();else if(t&&i.ca(t)){r=t;const e=i.ru();t=e._l,e.ou&&e.ou.fl(i),s.Vt()}else o?o=!1:s.zt()}),o)return void(o=!1)}i.wr+=i.tf(),s.Vt()}).then(()=>{s.finish({_l:t,gf:r})}),s.result()}bf(){const t=this.Ku;let e=this.element.lastChild;for(;e!=this.last;){const t=e.previousSibling;this.element===e.parentNode&&this.oc.Ef(e)||this.element.removeChild(e),e=t}this.Ea(),this.init();const n=this,i=w.c("redoLayout");let s=0,r=null,o=!0;return i.Ut(e=>{if(s<t.length){const i=t[s++];n.layout(i,o).then(t=>{o=!1,t?(r=t,e.Vt()):e.zt()})}else e.Vt()}).then(()=>{i.finish(r)}),i.result()}xf(){const t=this.ju.ac();t>0&&isFinite(t)&&(this.sa=this.Or()*(t-this.Yu-this.wr))}al(){const t=[];for(let e=this;e;e=e.su)e.Cu.forEach(e=>{if(y.c.Lc(e)){const n=e.Cl();t.push(n)}if(m.b(e)){const n=e.Cl();t.push(n)}y.e.$c(e)&&e.yf(this).forEach(e=>{t.push(e)})});return t}}const _=/^[^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527][^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*)?/;class I{Za(t,e,n,i,s,r){if(e.after)e.bn=t.length;else{let i=n-e.Sn;const s=t.data;(i=173==s.charCodeAt(i)?this.vf(t,s,i,e):this.kf(t,s,i,e))>0&&(e=this.Sf(e,i,t))}return e}vf(t,e,n,i){return t.replaceData(n,e.length-n,i.Vn?"":A(i)),n+1}kf(t,e,n,i){const r=e.charAt(n);n++;const o=e.charAt(n);return t.replaceData(n,e.length-n,!i.Vn&&s.x(r)&&s.x(o)?A(i):""),n}Sf(t,e,n){return(t=t.modify()).bn+=e,t.breakBefore=null,t}}function A(t){return t.zn||t.parent&&t.parent.zn||"-"}I.instance=new I;class O extends f.a{constructor(t,e){super(),this.Bl=t,this.Cf=null,this.mf=0,this.Pf=!1,this.context={gf:null},this.breakAfter=e||null}Fu(t){return new k(this.Bl,this.breakAfter,this.context)}Nu(t,e){e.Cu=[],e.su||b.a()}Lu(t){super.Lu(t);let e=t;for(;e;){const t=e.An;t&&c.f(t.parentNode,t),e=e.parent}}Jc(t,e){super.Jc(t,e),this.Cf=e.Yl,this.mf=e.wr,this.Pf=e.overflown}tl(t,e){super.tl(t,e),e.Yl=this.Cf,e.wr=this.mf,e.overflown=this.Pf}}class k{constructor(t,e,n){this.Bl=t,this.breakAfter=e,this.context=n}Au(t,e){const n=w.c("DefaultLayoutMode.doLayout");return m.d(t,e).then(()=>{e.Au(t,this.Bl,this.breakAfter).then(t=>{this.context.gf=t.gf,n.finish(t._l)})}),n.result()}accept(t,e){return!(!e.ju.Xh()&&!e.Yl)||e.Cu.length<=0||e.Cu.every(n=>n.Ql(t,this.context.gf,e))}yu(t,e,n,i){if(!i){const e=n.Cu.some(e=>e.xu(t));i=!e}return n.Cu.forEach(s=>{s.yu(i,t,e,n)}),i}}class D extends C{constructor(t,e,n,i,s,r,o){super(e,n,i,s,r),this.Cn=t,this.Tf=o,this.ic=[],this._f=[],this.hc=!0}nu(t){return super.nu(t).Ot(t=>(t&&this.Rf(t),w.d(t)))}Nf(t){const e=this.Tf.Xr(),n=e.x2-e.x1,i=e.y2-e.y1;function r(e,n){e.forEach(e=>{const i=s.t(t,e);if(i&&"%"===i.charAt(i.length-1)){const r=parseFloat(i),o=n*r/100;s.F(t,e,`${o}px`)}})}r(["width","max-width","min-width"],n),r(["height","max-height","min-height"],i),r(["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left"],this.vertical?i:n),["margin-top","margin-right","margin-bottom","margin-left"].forEach(e=>{"auto"===s.t(t,e)&&s.F(t,e,"0")})}Rf(t){for(;t.parent;)t=t.parent;i.a(1===t.An.nodeType);const e=t.An;if(this.ic.push(e),this.hc&&this.Nf(e),this._f.push(this._c(e)),this.hc){const t=this.Cn;if(this.Tf.vertical){if("block-end"===t||"left"===t){const t=s.t(e,"height");""!==t&&"auto"!==t&&s.F(e,"margin-top","auto")}}else if("block-end"===t||"bottom"===t){const t=s.t(e,"width");""!==t&&"auto"!==t&&s.F(e,"margin-left","auto")}}}cc(){return Math.max.apply(null,this.ic.map((t,e)=>{const n=this.rc.on(t),i=this._f[e];return this.vertical?i.top+n.height+i.bottom:i.left+n.width+i.right}))}}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return s});let i=[];function s(){i=[]}},function(t,e,n){"use strict";n.r(e);let i=!1;var s,r,o;!function(t){t.LTR="ltr",t.RTL="rtl"}(s||(s={})),function(t){t.LEFT="left",t.RIGHT="right"}(r||(r={})),function(t){t.LOADING="loading",t.INTERACTIVE="interactive",t.COMPLETE="complete"}(o||(o={}));const a={PageProgression:s,PageSide:r,ReadyState:o};var h=n(9),l=n(6);function c(){}function u(t,e,n){n||(n=this.If.now());let i,s=this.timestamps[t];s||(s=this.timestamps[t]=[]);for(let t=s.length-1;t>=0&&(!(i=s[t])||i[e]);t--)i=null;i||(i={},s.push(i)),i[e]=n}function f(t,e){this.Ff(t,"start",e)}function d(t,e){this.Ff(t,"end",e)}const p={now:Date.now},g=new class{constructor(t){this.If=t,this.timestamps={},this.Ff=c,this.registerStartTiming=this.registerStartTiming=c,this.registerEndTiming=this.registerEndTiming=c}Af(t,e){u.call(this,t,"start",e)}Of(t,e){u.call(this,t,"end",e)}printTimings(){const t=this.timestamps;let e="";Object.keys(t).forEach(n=>{const i=t[n],s=i.length;for(let t=0;t<s;t++){const r=i[t];e+=n,s>1&&(e+=`(${t})`),e+=` => start: ${r.start}, end: ${r.end}, duration: ${r.end-r.start}\n`}}),l.b.info(e)}disable(){this.Ff=c,this.registerStartTiming=this.registerStartTiming=c,this.registerEndTiming=this.registerEndTiming=c}enable(){this.Ff=u,this.registerStartTiming=this.registerStartTiming=f,this.registerEndTiming=this.registerEndTiming=d}isEnabled(){return this.registerStartTiming===f}}(window&&window.performance||p);g.Af("load_vivliostyle");const m={profiler:{registerStartTiming:g.registerStartTiming,registerEndTiming:g.registerEndTiming,printTimings:g.printTimings,disable:g.disable,enable:g.enable}};var b=n(7),E=n(1);function w(t){if(1==t.nodeType){const e=t.getAttribute("id");if(e&&e.match(/^[-a-zA-Z_0-9.\u007F-\uFFFF]+$/))return e}return null}function v(t){return`^${t}`}function y(t){return t.replace(/[\[\]\(\),=;^]/g,v)}function T(t){return t.substr(1)}function N(t){return t?t.replace(/\^[\[\]\(\),=;^]/g,T):t}function S(t){const e=[];do{const n=t.match(/^(\^,|[^,])*/),i=N(n[0]);if(!(t=t.substr(n[0].length+1))&&!e.length)return i;e.push(i)}while(t);return e}function x(t){const e={};for(;t;){const n=t.match(/^;([^;=]+)=(([^;]|\^;)*)/);if(!n)return e;e[n[1]]=S(n[2]),t=t.substr(n[0].length)}return e}class C{it(t){t.append("!")}Lf(t){return!1}}class _{constructor(t,e,n){this.index=t,this.id=e,this.$f=n}it(t){t.append("/"),t.append(this.index.toString()),(this.id||this.$f)&&(t.append("["),this.id&&t.append(this.id),this.$f&&(t.append(";s="),t.append(this.$f)),t.append("]"))}Lf(t){if(1!=t.node.nodeType)throw new Error("E_CFI_NOT_ELEMENT");const e=t.node,n=e.children,i=n.length;let s;const r=Math.floor(this.index/2)-1;if(r<0||0==i)s=e.firstChild,t.node=s||e;else{if(s=n[Math.min(r,i-1)],1&this.index){const e=s.nextSibling;e&&1!=e.nodeType?s=e:t.after=!0}t.node=s}if(this.id&&(t.after||this.id!=w(t.node)))throw new Error("E_CFI_ID_MISMATCH");return t.$f=this.$f,!0}}class I{constructor(t,e,n,i){this.offset=t,this.Mf=e,this.Df=n,this.$f=i}Lf(t){if(this.offset>0&&!t.after){let e=this.offset,n=t.node;for(;;){const t=n.nodeType;if(1==t)break;const i=n.nextSibling;if(3<=t&&t<=5){const t=n.textContent.length;if(e<=t)break;if(!i){e=t;break}e-=t}if(!i){e=0;break}n=i}t.node=n,t.offset=e}return t.$f=this.$f,!0}it(t){t.append(":"),t.append(this.offset.toString()),(this.Mf||this.Df||this.$f)&&(t.append("["),(this.Mf||this.Df)&&(this.Mf&&t.append(y(this.Mf)),t.append(","),this.Df&&t.append(y(this.Df))),this.$f&&(t.append(";s="),t.append(this.$f)),t.append("]"))}}class A{constructor(){this.steps=null}Bf(t){let e=t.match(/^#?epubcfi\((.*)\)$/);if(!e)throw new Error("E_CFI_NOT_CFI");const n=e[1];let i=0;const s=[];for(;;){let t;switch(n.charAt(i)){case"/":{if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[([-a-zA-Z_0-9.\u007F-\uFFFF]+)(;([^\]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;const r=parseInt(e[1],10),o=e[3];t=x(e[4]),s.push(new _(r,o,E.g(t.s)));break}case":":{if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[((([^\];,]|\^[\];,])*)(,(([^\];,]|\^[\];,])*))?)(;([^]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;const r=parseInt(e[1],10);let o=e[4];o&&(o=N(o));let a=e[7];a&&(a=N(a)),t=x(e[10]),s.push(new I(r,o,a,E.g(t.s)));break}case"!":i++,s.push(new C);break;case"~":case"@":case"":return void(this.steps=s);default:throw new Error("E_CFI_PARSE_ERROR")}}}navigate(t){const e={node:t.documentElement,offset:0,after:!1,$f:null,ref:null};for(let t=0;t<this.steps.length;t++)if(!this.steps[t].Lf(e)){e.ref=new A,e.ref.steps=this.steps.slice(t+1);break}return e}trim(t,e){return t.replace(/\s+/g," ").match(e?/^[ -\uD7FF\uE000-\uFFFF]{0,8}/:/[ -\uD7FF\uE000-\uFFFF]{0,8}$/)[0].replace(/^\s/,"").replace(/\s$/,"")}Uf(t,e,n,i){const s=[];let r=t.parentNode,o="",a="";for(;t;){switch(t.nodeType){case 3:case 4:case 5:{const i=t.textContent,s=i.length;n?(e+=s,o||(o=i)):(e>s&&(e=s),n=!0,o=i.substr(0,e),a=i.substr(e)),t=t.previousSibling;continue}case 8:t=t.previousSibling;continue}break}for((e>0||o||a)&&(o=this.trim(o,!1),a=this.trim(a,!0),s.push(new I(e,o,a,i)),i=null);r&&r&&9!=r.nodeType;){const e=n?null:w(t);let o=n?1:0;for(;t;)1==t.nodeType&&(o+=2),t=t.previousSibling;s.push(new _(o,e,i)),i=null,t=r,r=r.parentNode,n=!1}s.reverse(),this.steps?(s.push(new C),this.steps=s.concat(this.steps)):this.steps=s}toString(){if(!this.steps)return"";const t=new E.d;t.append("epubcfi(");for(let e=0;e<this.steps.length;e++)this.steps[e].it(t);return t.append(")"),t.toString()}}var O=n(20),k=n(4);function D(t){const e={};return Object.keys(t).forEach(n=>{e[n]=Array.from(t[n])}),e}class L{constructor(t,e){this.zf=t,this.resolved=e,this.Vf=null,this.Qi=-1,this.jf=-1}equals(t){return this===t||!!t&&this.zf===t.zf&&this.resolved===t.resolved&&this.Qi===t.Qi&&this.jf===t.jf}Xf(){return this.resolved}resolve(){this.resolved=!0}unresolve(){this.resolved=!1}}class R{constructor(t,e){this.Wf=t,this.mo=e}qs(t,e){t=this.Wf.Gf.Hf(t,this.mo),this.Wf.Yf[t]=e}qf(){return this.Wf.qf()}}class P{constructor(t,e,n,i){this.Wf=t,this.mo=e,this.te=n,this.Kf=i,this.styler=null}Zf(t){this.styler=t}Qf(t){const e=t.match(/^[^#]*#(.*)$/);return e?e[1]:null}Jf(t){let e=this.Wf.Gf.rl(E.C(t,this.mo),this.mo);return"#"===e.charAt(0)&&(e=e.substring(1)),e}Es(t,e){const n=this,i=new k.t(this.Kf,()=>e(function(){const e=n.Wf.ed[t];return e&&e.length?e[e.length-1]:null}()),`page-counter-${t}`);return this.Wf.sd(t,function(t){return e(t[0])},i),i}ys(t,e){const n=this,i=new k.t(this.Kf,()=>e(n.Wf.ed[t]||[]),`page-counters-${t}`);return this.Wf.sd(t,e,i),i}nd(t,e,n){let i=this.Wf.Yf[e];return!i&&n&&t&&(this.styler.rd(t),i=this.Wf.Yf[e]),i||null}od(t){return this.Wf.currentPage.Gi[t]?this.Wf.ed:this.Wf.hd[t]||null}ks(t,e,n){const i=this.Qf(t),s=this.Jf(t);let r=this.nd(i,s,!1);if(r&&r[e]){const t=r[e];return new k.f(this.te,n(t[t.length-1]||null))}const o=this;return new k.t(this.Kf,()=>{if(r=o.nd(i,s,!0)){if(r[e]){const t=r[e];return n(t[t.length-1]||null)}{const t=o.od(s);if(t){if(o.Wf.ld(s),t[e]){const i=t[e];return n(i[i.length-1]||null)}return n(0)}return o.Wf.ud(s,!1),"??"}}return o.Wf.ud(s,!1),"??"},`target-counter-${e}-of-${t}`)}Cs(t,e,n){const i=this.Qf(t),s=this.Jf(t),r=this;return new k.t(this.Kf,()=>{const t=r.od(s);if(t){r.Wf.ld(s);const o=t[e]||[],a=r.nd(i,s,!0)[e]||[];return n(o.concat(a))}return r.Wf.ud(s,!1),"??"},`target-counters-${e}-of-${t}`)}}class M{constructor(t){this.Gf=t,this.Yf={},this.hd={},this.ed={},this.ad={},this.fd=[],this.dd={},this.currentPage=null,this.pd=[],this.wd=[],this.gd=[],this.md={},this.bd={},this.Ed=[],this.ed.page=[0]}xd(t){return new R(this,t)}yd(t,e,n){return new P(this,t,e,n)}vd(t){this.currentPage=t}kd(t,e){this.ed[t]?this.ed[t].push(e):this.ed[t]=[e]}Sd(t){const e=this.ed.page;e&&e.length?e[e.length-1]=t:this.ed.page=[t]}Cd(t,e){let n;this.ad=D(this.ed);const i=t["counter-reset"];if(i){const t=i.evaluate(e);t&&(n=O.b(t,!0))}if(n)for(const t in n)this.kd(t,n[t]);let s;const r=t["counter-increment"];if(r){const t=r.evaluate(e);t&&(s=O.b(t,!1))}s?"page"in s||(s.page=1):(s={}).page=1;for(const t in s){this.ed[t]||this.kd(t,0);const e=this.ed[t];e[e.length-1]+=s[t]}}Pd(t){this.fd.push(this.ed),this.ed=D(t)}Td(){this.ed=this.fd.pop()}ld(t){const e=this.md[t];let n=this.bd[t];n||(n=this.bd[t]=[]);let i=!1;for(let s=0;s<this.wd.length;){const r=this.wd[s];if(r.zf===t){if(r.resolve(),this.wd.splice(s,1),e){const t=e.indexOf(r);t>=0&&e.splice(t,1)}n.push(r),i=!0}else s++}i||this.ud(t,!0)}ud(t,e){if(!this.pd.some(e=>e.zf===t)){const n=new L(t,e);this.pd.push(n)}}_d(t,e){const n=Object.keys(this.currentPage.Gi);if(n.length>0){const i=D(this.ed);n.forEach(n=>{this.hd[n]=i;const s=this.dd[n];if(s&&s.jf<e){const t=this.bd[n];if(t){let e,i=this.md[n];for(i||(i=this.md[n]=[]);e=t.shift();)e.unresolve(),i.push(e)}}this.dd[n]={Qi:t,jf:e}})}const i=this.ad;let s;for(;s=this.pd.shift();){let n;s.Vf=i,s.Qi=t,s.jf=e,s.Xf()?(n=this.bd[s.zf])||(n=this.bd[s.zf]=[]):(n=this.md[s.zf])||(n=this.md[s.zf]=[]),n.every(t=>!s.equals(t))&&n.push(s)}this.currentPage=null}Rd(t){let e=[];Object.keys(t.Gi).forEach(t=>{const n=this.md[t];n&&(e=e.concat(n))}),e.sort((t,e)=>t.Qi-e.Qi||t.jf-e.jf);const n=[];let i=null;return e.forEach(t=>{i&&i.Qi===t.Qi&&i.jf===t.jf?i.refs.push(t):(i={Qi:t.Qi,jf:t.jf,Vf:t.Vf,refs:[t]},n.push(i))}),n}Nd(t){this.gd.push(this.wd),this.wd=t}Id(){this.wd=this.gd.pop()}sd(t,e,n){"pages"===t&&this.Ed.push({expr:n,format:e})}qf(){return this.Yr.bind(this)}Yr(t,e,n){if(this.Ed.findIndex(e=>e.expr===t)>=0){const i=n.createElement("span");return i.textContent=e,i.setAttribute(F,t.key),i}return null}Fd(t){const e=t.root.querySelectorAll(`[${F}]`),n=this.ed.page[0];Array.from(e).forEach(t=>{const e=t.getAttribute(F),i=this.Ed.findIndex(t=>t.expr.key===e);b.a(i>=0),t.textContent=this.Ed[i].format([n])})}Ad(t){return new U(this,t)}}const F="data-vivliostyle-pages-counter";class U{constructor(t,e){this.Wf=t,this.jf=e}Ql(t){if(!t||t.after)return!0;const e=t.An;if(!e||1!==e.nodeType)return!0;const n=e.getAttribute("id")||e.getAttribute("name");if(!n)return!0;if(!this.Wf.bd[n]&&!this.Wf.md[n])return!0;const i=this.Wf.dd[n];return!i||this.jf>=i.jf}}var z=n(5),B=n(10),V=n(2),$=n(16),H=n(0),j=n(12),X=n(3),G=n(8);const W=j.d;class Q extends j.b{constructor(t,e,n,i,s){super(t,e,"block-end",null,n,s),this.Dn=i}Go(t){return!(t instanceof Q)}}class K extends W{constructor(t,e,n,i){super(t,"block-end",e,n,i)}jo(){return 1/0}sh(t){return t instanceof Q||this.jo()<t.jo()}}class Y{constructor(t){this.footnote=t}Ql(t){const e=t.Yn();return!G.u(e,this.footnote.Vo)}}j.f.register(new class{yc(t){return"footnote"===t.Cn}vc(t){return t instanceof Q}kc(t,e,n){let i=j.a.REGION;const s=e.yh(i);e.yh(j.a.PAGE).zh(s)&&(i=j.a.PAGE);const r=t.Yn();b.a(e.cn);const o=new Q(r,i,e.cn,t.Dn,t.Tn);return e.Ko(o),X.d(o)}Cc(t,e,n,i){const s=t[0].float;return new K(s.Un,t,n,i)}Th(t,e){const n=e.yh(t.Un).hh.filter(t=>t instanceof K);return b.a(n.length<=1),n[0]||null}Pc(t,e,n){t.Wu=!0,t.hc=!1;const i=t.element;b.a(i),t.vertical=n.oc.Od(e.vertical,n.oc._l&&"rtl"===n.oc._l.direction,i),t.Nf(i),n.Ca(i,t),n.Pa(i,t)}forbid(t,e){const n=t;switch(n.Dn){case H.t.line:{const t=new Y(n);e.gc(t,n.Un);break}}}});var q=n(22),Z=n(14),J=n(18),tt=n(29),et=n(23),nt=n(26),it=n(31),st=n(15);class rt{constructor(t,e){this.parent=t,this.Ld=e,this.Nc="RepetitiveElementsOwner",this.ts=!1,this.$d=null}Nt(){return"Repetitive elements owner formatting context (RepetitiveElementsOwnerFormattingContext)"}Qc(t,e){return e}gh(){return this.parent}Cl(){return this.$d}Md(t){const e=this.Dd(t);return e?e.An:null}Dd(t){do{if(!t.Qn(this)&&t.yn===this.Ld)return t}while(t=t.parent);return null}Bd(t){this.$d||it.b.some(t=>t.root===this.Ld&&(this.$d=t.elements,!0))||(this.$d=new ot(t,this.Ld),it.b.push({root:this.Ld,elements:this.$d}))}Jc(){}tl(t){}}class ot{constructor(t,e){this.vertical=t,this.Ud=e,this.zd=null,this.Vd=null,this.jd=null,this.Xd=null,this.Wd=null,this.Hd=null,this.Gd=0,this.Yd=0,this.qd=!1,this.Kd=!1,this.Zd=!0,this.Qd=!0,this.Jd=!1,this.tp=null,this.ep=null,this.sp=[],this.ip=[],this.np=!1}rp(t){this.Wd||(this.Wd=G.x(t,0),this.zd=t.yn,this.jd=t.An)}hp(t){this.Hd||(this.Hd=G.x(t,0),this.Vd=t.yn,this.Xd=t.An)}cp(t){this.jd&&(this.Gd=Z.b(this.jd,t,this.vertical),this.jd=null),this.Xd&&(this.Yd=Z.b(this.Xd,t,this.vertical),this.Xd=null)}lp(){this.qd=this.Kd=!1,this.Zd=!0,this.Qd=!0}up(t,e,n){return!this.Wd||this.qd?X.d(!0):this.ap(this.Wd,t,e,n)}fp(t,e,n){return!this.Hd||this.Kd?X.d(!0):this.ap(this.Hd,t,e,n)}ap(t,e,n,i){const s=e.An.ownerDocument,r=e.An,o=s.createElement("div");r.appendChild(o);const a=new et.PseudoColumn(i,o,e),h=a.fu().Yl;return a.fu().Yl=null,this.dp=!0,a.layout(new G.a(t),!0).Ot(()=>(this.dp=!1,r.removeChild(o),this.pp(o,r,n),a.fu().Yl=h,X.d(!0)))}pp(t,e,n){if(e)for(;t.firstChild;){const i=t.firstChild;t.removeChild(i),i.setAttribute(G.m,"1"),n?e.insertBefore(i,n):e.appendChild(i)}}ll(t){let e=0;return t&&!this.vu(t)?e:((!this.Kd||t&&this.wp(t))&&(e+=this.Yd),this.qd||(e+=this.Gd),e)}dl(t){let e=0;return t&&!this.vu(t)?e:(t&&this.wp(t)&&(e+=this.Yd),this.Qd||(e+=this.Gd),e)}wp(t){return this.gp(t,this.ip,e=>this.mp(this.ep,t,!1))}vu(t){return this.gp(t,this.sp,e=>this.mp(this.Ud,t,!0))}gp(t,e,n){const i=e.filter(e=>e._l.yn===t.yn&&e._l.after===t.after);if(i.length>0)return i[0].result;{const i=n(t);return e.push({_l:t,result:i}),i}}mp(t,e,n){const i=[];for(let n=t;n;n=n.parentNode){if(e.yn===n)return e.after;i.push(n)}for(let t=e.yn;t;t=t.parentNode){const e=i.indexOf(t);if(e>=0)return!!n&&0===e;for(let e=t;e;e=e.previousElementSibling)if(i.includes(e))return!0}return e.after}Pl(t){return t&&this.tp===t.yn}bp(){return!!(!this.Kd&&this.Zd&&this.Hd||!this.qd&&this.Qd&&this.Wd)}Ep(){!this.Kd&&this.Zd&&this.Hd?this.Kd=!0:!this.qd&&this.Qd&&this.Wd&&(this.qd=!0)}xp(){this.qd=!1,this.Qd=!1}yp(){this.Kd=!1,this.Zd=!1}vp(){return!!this.Wd}kp(){return!!this.Hd}Sp(t){return this.zd===t}Cp(t){return this.Vd===t}}class at{constructor(t){this.an=t}accept(t,e){return!!t}yu(t,e,n,i){const s=this.an.Cl();return s&&(b.a(n.rc),s.Jd||(s.cp(n),s.Jd=!0)),i}}class ht{constructor(t){this.an=t}accept(t,e){return!0}yu(t,e,n,i){return i}}class lt extends at{constructor(t,e){super(t),this.processor=e}Au(t,e){return this.processor.Pp(t,e)}accept(t,e){return!1}}class ct extends ht{constructor(t,e){super(t),this.processor=e}Au(t,e){return t.Qn(this.an)||t.after||e.Cu.unshift(new ut(t)),this.processor.Au(t,e)}}class ut{constructor(t){this.Fc="RepetitiveElementsOwner";const e=gt(t.an);this._l=e.Dd(t)}Ql(t,e,n){const i=this.Cl();return!(i&&!Z.c(this._l.An)&&i.bp()&&(e&&!t||t&&t.overflow))}xu(t){const e=this.Cl();return!!e&&!!e.bp()&&(e.Ep(),!0)}yu(t,e,n,i){const s=this.Cl();s&&t&&i.tu&&(null==e||s.wp(e))&&s.yp()}qc(t,e){const n=gt(this._l.an),i=this.Cl();if(!i)return X.d(!0);const s=this._l;return function(t,e,n){const i=t.Cl();if(i){const s=t.Dd(e);if(s.An){const t=s.An.firstChild;return i.up(s,t,n)}}return X.d(!0)}(n,s,e).Ot(()=>(function(t,e,n){const i=t.Cl();if(i&&!i.Kd){const s=t.Dd(e);if(s.An)return i.fp(s,null,n)}return X.d(!0)})(n,s,e).Ot(()=>(i.lp(),X.d(!0))))}Cl(){return gt(this._l.an).Cl()}ku(t){return t instanceof ut&&gt(this._l.an)===gt(t._l.an)}Su(){return 10}}class ft extends tt.a{constructor(t,e){super(),this.an=t,this.processor=e}Fu(t){const e=this.an.Cl();return t.Qn(this.an)||e.Jd?(t.Qn(this.an)||t.after||e&&e.xp(),new ct(this.an,this.processor)):new lt(this.an,this.processor)}}class dt extends et.EdgeSkipper{constructor(t,e){super(),this.an=t,this.column=e}Hc(t){const e=this.an,n=t._l,i=e.Cl();if(n.parent&&e.Ld===n.parent.yn){switch(n.Ln){case"header":if(!i.vp())return i.rp(n),X.d(!0);n.Ln="none";break;case"footer":if(!i.kp())return i.hp(n),X.d(!0);n.Ln="none"}i.tp||(i.tp=n.yn)}return et.EdgeSkipper.prototype.Hc.call(this,t)}Gc(t){const e=this.an,n=t._l;return n.yn===e.Ld&&(e.Cl().ep=t.Hl&&t.Hl.yn,t.break=!0),"header"===n.Ln||"footer"===n.Ln?X.d(!0):et.EdgeSkipper.prototype.Gc.call(this,t)}}function pt(t,e){t&&function(t,e){for(let n=t;n;n=n.parent){const t=n.an;t&&t instanceof rt&&!n.Qn(t)&&e(t,n)}}(t.after?t.parent:t,(t,n)=>{st.e.Oc(t)||e.Cu.push(new ut(n))})}function gt(t){return b.a(t instanceof rt),t}const mt=new class extends J.b{layout(t,e,n){if(e.Uc(t))return e.zc(t);const i=gt(t.an);return i.Md(t)?(n&&pt(t.parent,e),t.Qn(i)?J.b.prototype.layout.call(this,t,e,n):new ft(i,this).layout(t,e)):e.ga(t)}Hc(t){const e=function(t){const e=t.an;return e&&e instanceof rt?e:null}(t).Cl();return!!e&&(e.dp||!e.Sp(t.yn)&&!e.Cp(t.yn)||t.An.parentNode.removeChild(t.An),!1)}Pp(t,e){gt(t.an);const n=X.c("BlockLayoutProcessor.doInitialLayout");return this.Tp(t,e).$t(n),n.result()}Tp(t,e){const n=gt(t.an),i=new dt(n,e);return new et.LayoutIterator(i,e.oc).iterate(t)}Au(t,e){const n=gt(t.an),i=X.c("doLayout"),s=e.oc.Dl(t,!1);return nt.c(s,e).then(t=>{let s=t;i.Ut(t=>{for(;s;){let i=!0;if(e.df(s,!1).then(r=>{s=r,e.ju.Xh()?t.Vt():e.Yl?t.Vt():s&&e.ca(s)?t.Vt():s&&s.after&&s.yn==n.Ld?t.Vt():i?i=!1:t.zt()}),i)return void(i=!1)}t.Vt()}).then(()=>{i.finish(s)})}),i.result()}qc(t,e,n,i){return J.b.prototype.qc.call(this,t,e,n,i)}Yc(t,e,n,i){J.b.prototype.Yc(t,e,n,i)}};h.d(h.a.RESOLVE_LAYOUT_PROCESSOR,t=>t instanceof rt&&!st.e.Oc(t)?mt:null);class bt{constructor(t,e){this.rowIndex=t,this.yn=e,this.cells=[]}_p(t){this.cells.push(t)}Rp(){return Math.min.apply(null,this.cells.map(t=>t.height))}}class Et{constructor(t,e,n){this.rowIndex=t,this.Np=e,this.height=0,this.Ip=null,this.Fp=n,this.colSpan=n.colSpan||1,this.rowSpan=n.rowSpan||1}Ap(t){this.height=t}Op(t){this.Ip=t}}class wt{constructor(t,e,n){this.rowIndex=t,this.Np=e,this.cell=n}}class vt{constructor(t,e,n){this.column=t,this.Lp=n,this.empty=!1,this.$p=new et.PseudoColumn(t,e,n)}ru(){const t=this.Lp.An,e=this.Lp.verticalAlign;"middle"!==e&&"bottom"!==e||E.F(t,"vertical-align","top");const n=this.$p.ru(!0);return E.F(t,"vertical-align",e),n}}class yt{constructor(t,e){this.An=t,this.side=e}}class Tt extends q.b{constructor(t,e,n,i){super(t,e,n,i),this.Mp=null,this.rowIndex=null,this.an=t.an}ml(t,e){const n=super.ml(t,e);return e<this.El()?null:this.Dp().every(t=>!!t._l)?n:null}El(){let t=super.El();return this.Dp().forEach(e=>{t+=e.ou.El()}),t}Dp(){if(!this.Mp){this.an;const t=this.Bp();this.Mp=t.map(t=>t.ru())}return this.Mp}Up(){return null!=this.rowIndex?this.rowIndex:this.rowIndex=this.an.zp(this.position.yn)}Bp(){return this.an.Vp(this.Up()).map(this.an.jp,this.an)}}class Nt extends q.a{constructor(t,e,n){super(),this.rowIndex=t,this.Xp=e,this.an=n,this.Mp=null}ml(t,e){if(e<this.El())return null;const n=this.Bp(),i=this.Dp(),s=i.every(t=>!!t._l)&&i.some((t,e)=>{const i=n[e].$p,s=t._l;return!i.cu(s)&&!i.lu(s)});return this.Xp.overflow=i.some(t=>t._l&&t._l.overflow),s?this.Xp:null}El(){const t=this.an,e=t.Wp(this.rowIndex);let n=0;return t.Hp(e)||(n+=10),this.Dp().forEach(t=>{n+=t.ou.El()}),n}Dp(){if(!this.Mp){const t=this.Bp();this.Mp=t.map(t=>t.ru())}return this.Mp}Bp(){return this.an.Gp(this.rowIndex).map(this.an.jp,this.an)}}class St extends rt{constructor(t,e){super(t,e),this.Yp=e,this.Nc="Table",this.vertical=!1,this.columnCount=-1,this.qp=0,this.captions=[],this.Kp=null,this.Zp=null,this._n=0,this.rows=[],this.slots=[],this.Qp=[],this.Jp=null,this.tw=[],this.$d=null}Nt(){return"Table formatting context (Table.TableFormattingContext)"}Qc(t,e){if(!e)return e;switch(t.display){case"table-row":return 0===this.tw.length;case"table-cell":return!this.tw.some(e=>e.ew.steps[0].node===t.yn);default:return e}}gh(){return this.parent}sw(){this.Qp=[]}iw(t,e){this.rows[t]=e}nw(t){let e=this.slots[t];return e||(e=this.slots[t]=[]),e}_p(t,e){let n=this.rows[t];n||(this.iw(t,new bt(t,null)),n=this.rows[t]),b.a(n),n._p(e);const i=t+e.rowSpan;let s=this.nw(t),r=0;for(;s[r];)r++;for(;t<i;t++){s=this.nw(t);for(let n=r;n<r+e.colSpan;n++){const i=s[n]=new wt(t,n,e);e.Ip||e.Op(i)}}}Wp(t){const e=this.rows[t];return b.a(e),e}zp(t){return this.rows.findIndex(e=>t===e.yn)}rw(t,e,n){let i=this.Qp[t];i||(i=this.Qp[t]=[]),i[e]=n}Gp(t){return this.nw(t).reduce((t,e)=>e.cell!==t[t.length-1]?t.concat(e.cell):t,[])}Vp(t){return this.Gp(t).filter(e=>e.rowIndex+e.rowSpan-1>t)}jp(t){return this.Qp[t.rowIndex]&&this.Qp[t.rowIndex][t.Np]}Hp(t){return t.Rp()>this.qp/2}ow(){return this.columnCount<0&&(this.columnCount=Math.max.apply(null,this.rows.map(t=>t.cells.reduce((t,e)=>t+e.colSpan,0)))),this.columnCount}hw(t){this.rows.forEach(e=>{e.cells.forEach(e=>{const n=t.on(e.Fp);e.Fp=null,e.Ap(this.vertical?n.width:n.height)})})}cw(t){if(!t)return null;let e=null,n=0,i=0;t:for(n=0;n<this.Qp.length;n++)if(this.Qp[n])for(i=0;i<this.Qp[n].length;i++)if(this.Qp[n][i]&&t===this.Qp[n][i].$p.fu()){e=this.rows[n].cells[i];break t}if(!e)return null;for(;n<this.slots.length;n++)for(;i<this.slots[n].length;i++){const t=this.slots[n][i];if(t.cell===e)return{rowIndex:t.rowIndex,Np:t.Np}}return null}lw(t){const e=[];return this.slots.reduce((n,i,s)=>{if(s>=t.rowIndex)return n;const r=this.jp(i[t.Np].cell);return!r||e.includes(r)?n:(this.uw(r.$p.fu(),n),e.push(r),n)},[])}aw(){const t=[];return this.rows.forEach(e=>{e.cells.forEach((e,n)=>{t[n]||(t[n]={collected:[],elements:[]});const i=t[n],s=this.jp(e);s&&!i.collected.includes(s)&&(this.uw(s.$p.fu(),i.elements),i.collected.push(s))})}),[new xt(t.map(t=>t.elements))]}uw(t,e){t.Cu.forEach(t=>{if(st.c.Lc(t)){const n=t.Cl();e.push(n)}st.e.$c(t)&&t.yf(null).forEach(t=>{e.push(t)})})}Jc(){return[].concat(this.tw)}tl(t){this.tw=t}}class xt{constructor(t){this.fw=t}ll(t){return this.dw(t,t=>t.current)}dl(t){return this.dw(t,t=>t.minimum)}dw(t,e){let n=0;return this.fw.forEach(i=>{const s=q.c(t,i);n=Math.max(n,e(s))}),n}}function Ct(t){return b.a(t instanceof St),t}function _t(t){return function(t){return"table-row-group"===t||"table-header-group"===t||"table-footer-group"===t}(t)||function(t){return"table"===t||"inline-table"===t}(t)}function It(t,e,n){const i=t._l,s=i.display,r=i.parent?i.parent.display:null;let o=!1;if("inline-table"===r&&!(i.an instanceof St))for(let t=i.parent;t;t=t.parent)if(t.an instanceof St){o=t.an===e;break}return o||"table-row"===s&&!_t(r)||"table-cell"===s&&"table-row"!==r&&!_t(r)||i.an instanceof St&&i.an!==e?n.ga(i).Ot(e=>(t._l=e,X.d(!0))):null}class At extends et.EdgeSkipper{constructor(t,e){super(),this.an=t,this.column=e,this.rowIndex=-1,this.Np=0,this.pw=!1,this.Du=[],this.ww=!1}Hc(t){const e=this.an,n=It(t,e,this.column);if(n)return n;this.gw(t);const i=t._l,s=i.display,r=e.Cl();switch(s){case"table":e._n=i._n;break;case"table-caption":{const t=new yt(i.An,i.captionSide);e.captions.push(t);break}case"table-header-group":return r.vp()||(this.ww=!0,r.rp(i)),X.d(!0);case"table-footer-group":return r.kp()||(this.ww=!0,r.hp(i)),X.d(!0);case"table-row":this.ww||(this.pw=!0,this.rowIndex++,b.a(i.yn),this.Np=0,e.iw(this.rowIndex,new bt(this.rowIndex,i.yn)),r.tp||(r.tp=i.yn))}return super.Hc(t)}Gc(t){const e=this.an,n=t._l,i=n.display,s=this.column.rc;if(this.gw(t),n.yn===e.Yp){const i=s.el(e.Md(n));e.qp=parseFloat(i[e.vertical?"height":"width"]),e.Cl().ep=t.Hl&&t.Hl.yn,t.break=!0}else switch(i){case"table-header-group":case"table-footer-group":if(this.ww)return this.ww=!1,X.d(!0);break;case"table-row":this.ww||(e.Jp=n.An,this.pw=!1);break;case"table-cell":if(!this.ww){this.pw||(this.rowIndex++,this.Np=0,this.pw=!0);const t=n.An;e._p(this.rowIndex,new Et(this.rowIndex,this.Np,t)),this.Np++}}return super.Gc(t)}Ol(t){this.mw(t)}Ll(t){this.mw(t)}$l(t){this.mw(t)}Ml(t){this.mw(t)}mw(t){const e=t._l;e&&e.An&&!Z.e(e)&&this.Du.push(e.clone())}gw(t){this.Du.length>0&&this.column.ma(t._l,this.Du),this.Du=[]}}class Ot extends et.EdgeSkipper{constructor(t,e){super(!0),this.an=t,this.column=e,this.pw=!1,this.bw=-1,this.Ew=0,this.xw=e.tu,e.tu=!1}yw(){this.column.tu=this.xw}kw(t){const e=this.an.Zp;b.a(e);let n=0;for(let i=0;i<t.colSpan;i++)n+=e[t.Ip.Np+i];return n+this.an._n*(t.colSpan-1)}Sw(t,e,n){const i=t.rowIndex,s=t.Np,r=t.colSpan,o=e.An;e.verticalAlign,r>1&&(E.F(o,"box-sizing","border-box"),E.F(o,this.an.vertical?"height":"width",`${this.kw(t)}px`));const a=o.ownerDocument.createElement("div");o.appendChild(a);const h=new vt(this.column,a,e);return this.an.rw(i,s,h),1===n.primary.steps.length&&n.primary.after&&(h.empty=!0),h.$p.layout(n,!0).Lt(!0)}Cw(t){const e=this.an.tw[0];return!!e&&e.cell.Ip.Np===t}Pw(){const t=this.an.tw;if(0===t.length)return[];const e=[];let n=0;do{const i=t[n],s=i.cell.rowIndex;if(s<this.bw){let r=e[s];r||(r=e[s]=[]),r.push(i),t.splice(n,1)}else n++}while(n<t.length);return e}Tw(t){const e=this.an,n=this.Pw(),i=n.reduce(t=>t+1,0);if(0===i)return X.d(!0);const s=this.column.oc,r=t._l;r.An.parentNode.removeChild(r.An);const o=X.c("layoutRowSpanningCellsFromPreviousFragment");let a=X.d(!0),h=0;const l=[];return n.forEach(t=>{a=a.Ot(()=>{const n=G.v(t[0].ew.steps[1],r.parent);return s.fa(n,!1).Ot(()=>{let r=X.d(!0),o=0;function a(t){for(;o<t;){if(!l.includes(o)){const t=n.An.ownerDocument.createElement("td");E.F(t,"padding","0"),n.An.appendChild(t)}o++}}return t.forEach(t=>{r=r.Ot(()=>{const e=t.cell;a(e.Ip.Np);const r=t.ew,c=G.v(r.steps[0],n);return c.bn=r.bn,c.after=r.after,c.En=r.steps[0].En+1,s.fa(c,!1).Ot(()=>{const n=t._w;for(let t=0;t<e.colSpan;t++)l.push(o+t);return o+=e.colSpan,this.Sw(e,c,n).Ot(()=>(c.An.rowSpan=e.rowIndex+e.rowSpan-this.bw+i-h,X.d(!0)))})})}),r.Ot(()=>(a(e.ow()),h++,X.d(!0)))})})}),a.then(()=>{s.fa(r,!0,t.Rl).then(()=>{o.finish(!0)})}),o.result()}Rw(t){if(this.Nw||this.Iw)return X.d(!0);const e=t._l,n=this.an;return this.bw<0?(b.a(e.yn),this.bw=n.zp(e.yn)):this.bw++,this.Ew=0,this.pw=!0,this.Tw(t).Ot(()=>(this.Fw(),this.column.Kl(t.Hl,null,!0,t.jl)&&0===n.Vp(this.bw-1).length&&(this.yw(),e.overflow=!0,t.break=!0),X.d(!0)))}Fw(){this.an.Wp(this.bw).cells.forEach(t=>{const e=this.an.tw[t.Np];if(e&&e.cell.Ip.Np==t.Ip.Np){const t=e.ew.steps[0],n=this.column.oc.xmldoc.Aw(t.node);nt.e(n,t.En+1,1)}})}Ow(t){if(this.Nw||this.Iw)return X.d(!0);const e=t._l;this.pw||(this.bw<0?this.bw=0:this.bw++,this.Ew=0,this.pw=!0);const n=this.an.Wp(this.bw).cells[this.Ew],i=e.copy().modify();i.after=!0,t._l=i;const s=X.c("startTableCell");let r;if(this.Cw(n.Ip.Np)){const t=this.an.tw.shift();e.En=t.ew.steps[0].En+1,r=X.d(t._w)}else r=this.column.Dl(e,t.Rl).Ot(t=>{t.An&&e.An.removeChild(t.An);const n=G.x(t,0);return X.d(new G.a(n))});return r.then(i=>{b.a(e),this.Sw(n,e,i).then(()=>{this.Gc(t),this.Ew++,s.finish(!0)})}),s.result()}Ul(t){const e=It(t,Ct(this.an),this.column);if(e)return e;const n=t._l,i=this.an.Cl(),s=n.display;return"table-header-group"===s&&i&&i.Sp(n.yn)?(this.Nw=!0,X.d(!0)):"table-footer-group"===s&&i&&i.Cp(n.yn)?(this.Iw=!0,X.d(!0)):"table-row"===s?this.Rw(t):"table-cell"===s?this.Ow(t):X.d(!0)}Vl(t){const e=t._l;if("table-row"===e.display&&(this.pw=!1,!this.Nw&&!this.Iw)){const t=e.copy().modify();t.after=!1;const n=new Nt(this.bw,t,this.an);this.column.$u.push(n)}return X.d(!0)}Gc(t){const e=t._l,n=this.an.Cl(),i=e.display;if("table-header-group"===i?n&&!n.dp&&n.Sp(e.yn)?(this.Nw=!1,e.An.parentNode.removeChild(e.An)):E.F(e.An,"display","table-row-group"):"table-footer-group"===i&&(n&&!n.dp&&n.Cp(e.yn)?(this.Iw=!1,e.An.parentNode.removeChild(e.An)):E.F(e.An,"display","table-row-group")),i&&Ot.Lw[i])e.An.parentNode.removeChild(e.An);else{if(e.yn!==this.an.Yp)return super.Gc(t);e.overflow=this.column.cf(e,null),this.yw(),t.break=!0}return X.d(!0)}}Ot.Lw={"table-caption":!0,"table-column-group":!0,"table-column":!0};const kt=[];class Dt{$w(t,e){const n=Ct(t.an),i=new At(n,e);return new et.LayoutIterator(i,e.oc).iterate(t)}Mw(t,e,n,i){const s=t.ownerDocument,r=s.createElement("tr"),o=[];for(let t=0;t<e;t++){const t=s.createElement("td");r.appendChild(t),o.push(t)}t.parentNode.insertBefore(r,t.nextSibling);const a=o.map(t=>{const e=i.on(t);return n?e.height:e.width});return t.parentNode.removeChild(r),a}Dw(t){const e=[];let n=t.firstElementChild;for(;n;)"colgroup"===n.localName&&e.push(n),n=n.nextElementSibling;return e}Bw(t){const e=[];return t.forEach(t=>{let n=t.span;t.removeAttribute("span");let i=t.firstElementChild;for(;i;){if("col"===i.localName){let s=i.span;for(i.removeAttribute("span"),n-=s;s-- >1;){const n=i.cloneNode(!0);t.insertBefore(n,i),e.push(n)}e.push(i)}i=i.nextElementSibling}for(;n-- >0;)i=t.ownerDocument.createElement("col"),t.appendChild(i),e.push(i)}),e}Uw(t,e,n,i){if(t.length<n){const s=i.ownerDocument.createElement("colgroup");e.push(s);for(let e=t.length;e<n;e++){const e=i.ownerDocument.createElement("col");s.appendChild(e),t.push(e)}}}zw(t,e,n){const i=t.vertical,s=t.Jp;if(!s)return;b.a(s),t.Jp=null;const r=s.ownerDocument.createDocumentFragment(),o=t.ow();if(!(o>0))return void(t.Kp=r);const a=t.Zp=this.Mw(s,o,i,n.rc),h=this.Dw(e),l=this.Bw(h);this.Uw(l,h,o,e),l.forEach((t,e)=>{E.F(t,i?"height":"width",`${a[e]}px`)}),h.forEach(t=>{r.appendChild(t.cloneNode(!0))}),t.Kp=r}Pp(t,e){const n=Ct(t.an);n.vertical=t.vertical,n.Bd(t.vertical),b.a(t.yn);const i=function(t){const e=kt.findIndex(e=>e.root===t),n=kt[e];return n?n.Vw:null}(t.yn);!function(t){const e=kt.findIndex(e=>e.root===t);e>=0&&kt.splice(e,1)}(t.yn);const s=X.c("TableLayoutProcessor.doInitialLayout"),r=t.copy();return this.$w(t,e).then(o=>{const a=o.An,h=e.rc.on(a);let l=e.vertical?h.left:h.bottom;if(l+=(e.vertical?-1:1)*q.c(t,e.al()).current,!(e.Sl(l)||i&&i.jw))return e.$u.push(new Pt(r)),void s.finish(o);this.zw(n,a,e),n.hw(e.rc),s.finish(null)}),s.result()}Xw(t,e,n){const i=t.captions;i.forEach((t,s)=>{t&&(e.insertBefore(t.An,n),"top"===t.side&&(i[s]=null))})}Ww(t,e,n){t.Kp&&0===this.Dw(e).length&&e.insertBefore(t.Kp.cloneNode(!0),n)}Hw(t,e){if(t.Kp&&e){const t=this.Dw(e);t&&t.forEach(t=>{e.removeChild(t)})}}Au(t,e){const n=Ct(t.an),i=n.Md(t),s=i.firstChild;this.Xw(n,i,s),this.Ww(n,i,s);const r=new Ot(n,e),o=new et.LayoutIterator(r,e.oc),a=X.c("TableFormattingContext.doLayout");return o.iterate(t).$t(a),a.result()}layout(t,e,n){const i=Ct(t.an);return i.Md(t)?(n&&pt(t.parent,e),new Lt(i,this).layout(t,e)):e.ga(t)}Wc(t,e,n,i){return new Tt(t,e,n,i)}Hc(t){return!1}Gc(t,e){return!1}qc(t,e,n,i){const s=Ct(e.an);if("table-row"===e.display){b.a(e.yn);const n=s.zp(e.yn);let i;if(s.tw=[],(i=e.after?s.Vp(n):s.Gp(n)).length){const r=X.c("TableLayoutProcessor.finishBreak");let o=0;return r.Ut(t=>{if(o===i.length)return void t.Vt();const e=i[o++],r=s.jp(e),a=r.ru()._l;b.a(a);const h=r.Lp,l=h.Yn(),c=new G.a(a.Yn());s.tw.push({ew:l,_w:c,cell:e});const u=h.An;r.column.oc.Zc(r.Lp),n<e.rowIndex+e.rowSpan-1&&(u.rowSpan=n-e.rowIndex+1),r.empty?t.zt():r.$p.qc(a,!1,!0).then(()=>{b.a(r),function(t,e,n){const i=e.Cl();if(!i)return;const s=e.vertical,r=t.column,o=t.$p.au(),a=t.Lp.An,h=r.rc.on(a),l=r.ka(a);if(s){const t=h.right-r.iu-i.ll(n)-l.right;E.F(o,"max-width",`${t}px`)}else{const t=r.iu-i.ll(n)-h.top-l.top;E.F(o,"max-height",`${t}px`)}E.F(o,"overflow","hidden")}(r,s,a),t.zt()})}).then(()=>{t.Yc(e,!1),t.oc.Zc(e),s.sw(),r.finish(!0)}),r.result()}}return s.sw(),J.d.qc(t,e,n,i)}Yc(t,e,n,i){J.b.prototype.Yc(t,e,n,i)}}class Lt extends tt.a{constructor(t,e){super(),this.Gw=t,this.processor=e}Fu(t){const e=this.Gw.Cl();return e&&e.Jd?(t.yn!==this.Gw.Yp||t.after||e&&e.xp(),new Ft(this.Gw,this.processor)):new Rt(this.Gw,this.processor)}Lu(t){super.Lu(t);const e=this.Gw.Md(t);this.processor.Hw(this.Gw,e)}tl(t,e){super.tl(t,e),this.Gw.sw()}}class Rt extends at{constructor(t,e){super(t),this.processor=e}Au(t,e){return this.processor.Pp(t,e)}}class Pt extends q.b{constructor(t){super(t,null,t.overflow,0)}El(){if(!this.wl)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");return(this.overflows?3:0)+(this.position.parent?this.position.parent.Bn:0)}fl(t){t.Cu.push(new Mt(this.position.yn))}}class Mt{constructor(t){this.Yw=t,this.Fc="EntireTable"}Ql(t,e,n){return b.a(!t.overflow),!1}xu(t){return!0}yu(t,e,n,i){b.a(e.yn),kt.push({root:e.yn,Vw:{jw:!0}})}qc(t,e){return X.d(!0)}ku(t){return t instanceof Mt&&t.Yw===this.Yw}Su(){return 0}}class Ft extends ht{constructor(t,e){super(t),this.processor=e}Au(t,e){const n=this.an.Cl();if(n&&!n.wp(t)){const n=new Ut(t);e.Cu.some(t=>n.ku(t))||e.Cu.unshift(n)}return this.processor.Au(t,e)}}class Ut extends ut{constructor(t){super(t),this.Fc="TableRow",this.qw=[]}Ql(t,e,n){const i=this.Cl();return!(i&&!n.su&&!Z.c(this._l.An)&&i.bp()&&(e&&!t||t&&t.overflow))}xu(t){const e=Ct(this._l.an);return!!this.Kw(t,e).some(e=>e.constraints.some(e=>e.xu(t)))||super.xu(t)}yu(t,e,n,i){const s=Ct(this._l.an);if(this.qw=this.Kw(e,s),this.qw.forEach(e=>{e.constraints.forEach(s=>{s.yu(t,e.ou,n,i)})}),!t){const t=s.Md(this._l);(new Dt).Hw(s,t),this.Zw(n)}super.yu(t,e,n,i)}qc(t,e){Ct(this._l.an);const n=X.c("finishBreak"),i=this.qw.reduce((t,e)=>t.concat(e.constraints.map(t=>({constraint:t,ou:e.ou}))),[]);let s=0;return n.loop(()=>{if(s<i.length){const t=i[s++];return t.constraint.qc(t.ou,e).Lt(!0)}return X.d(!1)}).then(()=>{n.finish(!0)}),n.result().Ot(()=>super.qc(t,e))}Zw(t){if(t&&"table-row"===t.display&&t.An)for(;t.An.previousElementSibling;){const e=t.An.previousElementSibling;e.parentNode&&e.parentNode.removeChild(e)}}Kw(t,e){return this.Qw(t,e).map(t=>({constraints:t.fragment.$p.fu().Cu,ou:t.ou}))}Qw(t,e){let n=Number.MAX_VALUE;t&&"table-row"===t.display&&(b.a(t.yn),n=e.zp(t.yn)+1),n=Math.min(e.Qp.length,n);const i=[];for(let t=0;t<n;t++)e.Qp[t]&&e.Qp[t].forEach(t=>{t&&i.push({fragment:t,ou:t.ru()._l})});return i}yf(t){const e=Ct(this._l.an),n=e.cw(t);return n?e.lw(n):e.aw()}ku(t){return t instanceof Ut&&Ct(this._l.an)===Ct(t._l.an)}}const zt=new Dt;h.d(h.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,s,r){if(!e)return null;if(n===H.t.table){const e=t.parent;return new St(e?e.an:null,t.yn)}return null}),h.d(h.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof St?zt:null});var Bt=n(13);function Vt(t){return t.reduce((t,e)=>t+e,0)/t.length}class $t{constructor(t,e){this.Jw=t,this.penalty=e}}function Ht(t){return t.vertical?t.width:t.height}function jt(t,e){t.vertical?t.width=e:t.height=e}class Xt{constructor(t,e,n){this.tg=t,this.eg=e,this.sg=n,this.ig=Ht(t)}ng(t){const e=this,n=X.c("ColumnBalancer#balanceColumns");e.rg(t),e.og(t),e.tg.clear();const i=[e.hg(t)];return n.Ut(t=>{e.cg(i)?(e.lg(i),e.eg().then(n=>{e.og(n),e.tg.clear(),n?(i.push(e.hg(n)),t.zt()):t.Vt()})):t.Vt()}).then(()=>{const t=i.reduce((t,e)=>e.penalty<t.penalty?e:t,i[0]);e.ug(t.Jw),e.ag(),n.finish(t.Jw)}),n.result()}hg(t){const e=this.fg(t);return new $t(t,e)}rg(t){}ag(){jt(this.tg,this.ig)}og(t){const e=this.sg.Vh();t&&(t.dg=e)}ug(t){const e=this.tg.element;t.columns.forEach(t=>{e.appendChild(t.element)}),b.a(t.dg),this.sg.jh(t.dg)}}const Gt=1;function Wt(t){const e=t[t.length-1];if(0===e.penalty)return!1;const n=t[t.length-2];if(n&&e.penalty>=n.penalty)return!1;const i=e.Jw.columns;return Math.max.apply(null,i.map(t=>t.wr))>Math.max.apply(null,i.map(t=>t.bc()))+Gt}function Qt(t,e){const n=t[t.length-1].Jw.columns,i=Math.max.apply(null,n.map(t=>isNaN(t.sa)?t.wr:t.wr-t.sa+Gt))-Gt;i<Ht(e)?jt(e,i):jt(e,Ht(e)-1)}class Kt extends Xt{constructor(t,e,n,i){super(n,t,e),this.columnCount=i,this.pg=null,this.wg=!1}rg(t){const e=t.columns.reduce((t,e)=>t+e.wr,0);jt(this.tg,e/this.columnCount),this.pg=t.position}gg(t){return this.pg?this.pg.Jn(t):null===t}fg(t){if(!this.gg(t.position))return 1/0;const e=t.columns;return Yt(e)?1/0:Math.max.apply(null,e.map(t=>t.wr))}cg(t){if(1===t.length)return!0;if(this.wg)return Wt(t);{const e=t[t.length-1];return this.gg(e.Jw.position)&&!Yt(e.Jw.columns)?(this.wg=!0,!0):Ht(this.tg)<this.ig}}lg(t){if(this.wg)Qt(t,this.tg);else{const t=Math.min(this.ig,Ht(this.tg)+.1*this.ig);jt(this.tg,t)}}}function Yt(t){if(t.length<=1)return!1;const e=t[t.length-1].wr;return t.slice(0,t.length-1).every(t=>e>t.wr)}class qt extends Xt{constructor(t,e,n){super(n,t,e)}fg(t){return t.columns.every(t=>0===t.wr)?1/0:function(t){const e=Vt(t);return Vt(t.map(t=>{const n=t-e;return n*n}))}(t.columns.filter(t=>!t.Yl).map(t=>t.wr))}cg(t){return Wt(t)}lg(t){Qt(t,this.tg)}}var Zt=n(24);class Jt{constructor(t,e,n){this.mg=t,this.bg=e,this.Eg=n}}class te{constructor(){this.map=[]}xg(){return 0==this.map.length?0:this.map[this.map.length-1].bg}yg(){return 0==this.map.length?0:this.map[this.map.length-1].Eg}vg(t){if(0==this.map.length)this.map.push(new Jt(t,t,t));else{const e=this.map[this.map.length-1],n=e.Eg+t-e.bg;e.bg==e.mg?(e.bg=t,e.mg=t,e.Eg=n):this.map.push(new Jt(t,t,n))}}kg(t){0==this.map.length?this.map.push(new Jt(t,0,0)):this.map[this.map.length-1].bg=t}Sg(t){const e=this,n=E.i(this.map.length,n=>t<=e.map[n].bg),i=this.map[n];return i.Eg-Math.max(0,i.mg-t)}Cg(t){const e=this,n=E.i(this.map.length,n=>t<=e.map[n].Eg),i=this.map[n];return i.mg-(i.Eg-t)}}class ee{constructor(t,e,n,i,s,r,o,a){if(this.context=t,this.style=e,this.offset=n,this.ts=i,this.sr=s,this.Pg=r,this.Tg=o,this._g=a,this.Rg=null,this.Ng=null,this.Ig={},this.Fg=null,this.Ag=null,this.breakBefore=null,this.cn=s.cn,this.Og()){const i=e._pseudos;if(i&&i.before){const e=new ee(t,i.before,n,!1,s,this.Lg(),o,!0),r=e.$g("content");G.y(r)&&(this.Fg=e,this.breakBefore=e.breakBefore)}}this.breakBefore=Bt.d(this.Mg("before"),this.breakBefore),this.Tg&&Bt.c(this.breakBefore)&&(s.breakBefore=Bt.d(s.breakBefore,this.breakBefore))}Dg(t,e,n){if(this.Og()){const i=this.style._pseudos;if(i&&i.after){const s=new ee(this.context,i.after,t,!1,this.sr,e,n,!0),r=s.$g("content");G.y(r)&&(this.Ag=s)}}}$g(t,e){if(!(t in this.Ig)){const n=this.style[t];this.Ig[t]=n?n.evaluate(this.context,t):e||null}return this.Ig[t]}Bg(){return this.$g("display",H.t.inline)}Lg(){if(null===this.Rg){const t=this.Bg(),e=this.$g("position"),n=this.$g("float");this.Rg=Zt.d(t,e,n,this.ts)}return this.Rg}Og(){return null===this.Ng&&(this.Ng=this._g&&this.Bg()!==H.t.none),this.Ng}Mg(t){let e=null;if(this.Lg()){const n=this.$g(`break-${t}`);n&&(e=n.toString())}return e}}class ne{constructor(t){this.context=t,this.stack=[],this.Pg=!0,this.Tg=!0,this.Ug=[]}empty(){return 0===this.stack.length}zg(){return this.stack[this.stack.length-1]}Vg(){const t=this.zg();return t?t.sr.cn:null}jg(){return this.stack.every(t=>t.Bg()!==H.t.none)}push(t,e,n,i){const s=this.zg();i&&s&&i.cn!==s.cn&&this.Ug.push({Pg:this.Pg,Tg:this.Tg});const r=i||s.sr,o=this.Tg||!!i,a=this.jg(),h=new ee(this.context,t,e,n,r,o||this.Pg,o,a);return this.stack.push(h),this.Pg=h.Og()?!h.Fg&&h.Lg():this.Pg,this.Tg=h.Og()?!h.Fg&&o:this.Tg,h}Xg(t){const e=this.zg();if((this.Pg||this.Tg)&&e.Og()){const n=e.$g("white-space",H.t.normal).toString(),i=G.z(n);b.a(null!==i),G.p(t,i)||(this.Pg=!1,this.Tg=!1)}}pop(t){const e=this.stack.pop();if(e.Dg(t,this.Pg,this.Tg),this.Tg&&e.Ag){const t=e.Ag.Mg("before");e.sr.breakBefore=Bt.d(e.sr.breakBefore,t)}const n=this.zg();if(n)if(n.cn===e.cn)e.Og()&&(this.Pg=this.Tg=!1);else{const t=this.Ug.pop();this.Pg=t.Pg,this.Tg=t.Tg}return e}Wg(t){if(!t.Pg)return t.offset;let e=this.stack.length-1,n=this.stack[e];for(n===t&&(e--,n=this.stack[e]);e>=0;){if(n.cn!==t.cn)return t.offset;if(!n.Pg)return n.offset;if(n.ts)return n.offset;t=n,n=this.stack[--e]}throw new Error("No block start offset found!")}}class ie{constructor(t,e,n,i,s,r,o,a){this.xmldoc=t,this.scope=n,this.context=i,this.Hg=s,this.ti=r,this._s=o,this.Gg={},this.Yg={},this.flows={},this.qg=[],this.Kg=null,this.Zg=null,this.Qg=null,this.primary=!0,this.Jg=[],this.tm=!1,this.sm=!1,this.im={},this.nm=!0,this.root=t.root,this.rm=e,this.last=this.root,this.cascade=e.Ps(i,o,a,t.lang),this.om=new te;const h=t.Aw(this.root);this.hm=h,this.lm=new ne(i),this.om.vg(h);const l=this.um(this.root);switch(this.cascade.Gs(this.root,l,h),this.am(l,!1),this.root.namespaceURI){case E.a.XHTML:case E.a.FB2:this.nm=!1}this.Jg.push(!0),this.Yg={},this.Yg[`e${h}`]=l,this.hm++,this.fm(-1)}dm(t,e,n){const i=t[n];return i&&i.evaluate(this.context)!==e[n]}pm(t,e){for(const n in e){const i=t[n];if(i)this.Gg[n]=i,delete t[n];else{const t=e[n];t&&(this.Gg[n]=new z.c(t,B.c))}}}am(t,e){if(["writing-mode","direction"].forEach(n=>{!t[n]||e&&this.Gg[n]||(this.Gg[n]=t[n])}),!this.tm){const e=this.dm(t,this.ti.wm,"background-color")?t["background-color"].evaluate(this.context):null,n=this.dm(t,this.ti.wm,"background-image")?t["background-image"].evaluate(this.context):null;(e&&e!==H.t.inherit||n&&n!==H.t.inherit)&&(this.pm(t,this.ti.wm),this.tm=!0)}if(!this.sm)for(let e=0;e<se.length;e++)if(this.dm(t,this.ti.gm,se[e])){this.pm(t,this.ti.gm),this.sm=!0;break}if(!e){const e=t["font-size"];if(e){const t=e.evaluate(this.context);let n=t.num;switch(t.unit){case"em":case"rem":n*=this.context.le;break;case"ex":n*=this.context.le*k.G.ex/k.G.em;break;case"%":n*=this.context.le/100;break;default:{const e=k.G[t.unit];e&&(n*=e)}}this.context.re=n}}}bm(){let t=0;for(;!this.nm&&(t+=5e3,this.Em(t,0)!=Number.POSITIVE_INFINITY););return this.Gg}um(t){if(t.style instanceof CSSStyleDeclaration){const e=t.getAttribute("style");if(e)return z.E(this.scope,this.ti,this.xmldoc.url,e)}return{}}xm(){return this.hm}fm(t){if(t>=this.hm)return;const e=this.context,n=this.xmldoc.Aw(this.root);if(t<n){const t=this.hl(this.root,!1);b.a(t);const i=z.s(t,"flow-into"),s=i?i.evaluate(e,"flow-into").toString():"body",r=this.ym(s,t,this.root,n);this.lm.empty()&&this.lm.push(t,n,!0,r)}let i=this.xmldoc.vm(t),s=this.xmldoc.km(i,0,!1);if(!(s>=this.hm))for(;;){if(1!=i.nodeType)s+=i.textContent.length;else{const t=i,n=this.hl(t,!1),r=n["flow-into"];if(r){const i=r.evaluate(e,"flow-into").toString();this.ym(i,n,t,s)}s++}if(s>=this.hm)break;let t=i.firstChild;if(null==t)for(;!(t=i.nextSibling);)if((i=i.parentNode)===this.root)return;i=t}}Sm(t){this.Kg=t;for(let t=0;t<this.qg.length;t++)this.Kg.Cm(this.qg[t],this.flows[this.qg[t].cn])}Pm(t){this.Zg=t;let e=0;for(;null!=this.Zg&&(e+=5e3,this.Em(e,0)!=Number.POSITIVE_INFINITY););}rd(t){if(!t)return;this.Qg=t;let e=0;for(;this.Qg&&(e+=5e3,this.Em(e,0)!==Number.POSITIVE_INFINITY););this.Qg=null}ym(t,e,n,i){let s=0,r=Number.POSITIVE_INFINITY,o=!1,a=!1,h=!1;const l=e["flow-options"];if(l){const t=O.d(l.evaluate(this.context,"flow-options"));o=!!t.exclusive,a=!!t.static,h=!!t.last}const c=e["flow-linger"];c&&(r=O.c(c.evaluate(this.context,"flow-linger"),Number.POSITIVE_INFINITY));const u=e["flow-priority"];u&&(s=O.c(u.evaluate(this.context,"flow-priority"),0));const f=this.im[i]||null;let d=this.flows[t];if(!d){const e=this.lm.Vg();d=this.flows[t]=new G.f(t,e)}const p=new G.g(t,n,i,s,r,o,a,h,f);return this.qg.push(p),this.Zg==t&&(this.Zg=null),this.Kg&&this.Kg.Cm(p,d),p}Tm(t,e,n){if(Bt.c(t)){const t=this.flows[n].un;(0===t.length||t[t.length-1]<e)&&t.push(e)}const i=this.im[e];this.im[e]=Bt.d(i,t)}Em(t,e){let n,i=-1;if(t<=this.hm&&(i=(n=this.om.Sg(t))+e)<this.om.yg())return this.om.Cg(i);if(null==this.last)return Number.POSITIVE_INFINITY;const s=this.context;for(;;){let r=this.last.firstChild;if(null==r)for(;;){if(1==this.last.nodeType){this.cascade.Js(this.last),this.primary=this.Jg.pop();const t=this.lm.pop(this.hm);let e=null;if(t.Ag){const n=t.Ag.Mg("before");this.Tm(n,t.Ag.Pg?this.lm.Wg(t):t.Ag.offset,t.cn),e=t.Ag.Mg("after")}e=Bt.d(e,t.Mg("after")),this.Tm(e,this.hm,t.cn)}if(r=this.last.nextSibling)break;if(this.last=this.last.parentNode,this.last===this.root)return this.last=null,t<this.hm&&(i<0&&(i=(n=this.om.Sg(t))+e),i<=this.om.yg())?this.om.Cg(i):Number.POSITIVE_INFINITY}if(this.last=r,1!=this.last.nodeType)this.hm+=this.last.textContent.length,this.lm.Xg(this.last),this.primary?this.om.vg(this.hm):this.om.kg(this.hm);else{const r=this.last,o=this.um(r);this.Jg.push(this.primary),this.cascade.Gs(r,o,this.hm);const a=r.getAttribute("id")||r.getAttributeNS(E.a.XML,"id");let h;a&&a===this.Qg&&(this.Qg=null),this.nm||"body"!=r.localName||r.parentNode!=this.root||(this.am(o,!0),this.nm=!0);const l=o["flow-into"];if(l){const t=l.evaluate(s,"flow-into").toString(),e=this.ym(t,o,r,this.hm);this.primary=!!this.Hg[t],h=this.lm.push(o,this.hm,r===this.root,e)}else h=this.lm.push(o,this.hm,r===this.root);const c=this.lm.Wg(h);if(this.Tm(h.breakBefore,c,h.cn),h.Fg){const t=h.Fg.Mg("after");this.Tm(t,h.Fg.Pg?c:h.offset,h.cn)}if(this.primary&&h.Bg()===H.t.none&&(this.primary=!1),this.Yg[`e${this.hm}`]=o,this.hm++,this.primary?this.om.vg(this.hm):this.om.kg(this.hm),t<this.hm&&(i<0&&(i=(n=this.om.Sg(t))+e),i<=this.om.yg()))return this.om.Cg(i)}}}hl(t,e){let n=this.xmldoc.Aw(t);const i=`e${n}`;return e&&(n=this.xmldoc.km(t,0,!0)),this.hm<=n&&this.Em(n,0),this.Yg[i]}cl(t,e){}}const se=["column-count","column-width","column-fill"];var re,oe=n(17);class ae{constructor(t){this.validator=t,this.success=null,this.failure=null,this.code=0}_m(){return 0!=this.code}Rm(){this.code=-1}Nm(){return-1==this.code}Im(){this.code=-2}Fm(){return-2==this.code}Am(t){this.code=2*t+1}Om(){return this.code>0&&this.code%2!=0}Lm(t){this.code=2*t+2}$m(){return this.code>0&&this.code%2==0}Mm(){return Math.floor((this.code-1)/2)}}class he{constructor(t,e){this.where=t,this.success=e,this.what=-1}}!function(t){t[t.FOLLOW=1]="FOLLOW",t[t.OPTIONAL=2]="OPTIONAL",t[t.REPEATED=3]="REPEATED",t[t.ALTERNATE=4]="ALTERNATE"}(re||(re={}));class le{constructor(){this.nodes=[],this.connections=[],this.match=[],this.nomatch=[],this.error=[],this.Dm=!0}connect(t,e){for(let n=0;n<t.length;n++)this.connections[t[n]].what=e;t.splice(0,t.length)}clone(){const t=new le;for(let e=0;e<this.nodes.length;e++){const n=this.nodes[e],i=new ae(n.validator);i.code=n.code,t.nodes.push(i)}for(let e=0;e<this.connections.length;e++){const n=this.connections[e],i=new he(n.where,n.success);i.what=n.what,t.connections.push(i)}return t.match.push(...this.match),t.nomatch.push(...this.nomatch),t.error.push(...this.error),t}Bm(t,e,n){const i=this.nodes.length,s=new ae(xe);n>=0?e?s.Am(n):s.Lm(n):e?s.Rm():s.Im(),this.nodes.push(s),this.connect(t,i);const r=new he(i,!0),o=new he(i,!1);t.push(this.connections.length),this.connections.push(o),t.push(this.connections.length),this.connections.push(r)}Um(){const t=[this.match,this.nomatch,this.error];for(let e=0;e<t.length;e++)this.Bm(t[e],!1,-1)}zm(){if(this.nodes.length)throw new Error("invalid call");this.Bm(this.match,!0,-1)}Vm(t){this.Bm(this.match,!1,t)}jm(t){if(this.nodes.length)throw new Error("invalid call");const e=new ae(xe);e.Am(t),this.nodes.push(e);const n=new he(0,!0),i=new he(0,!1);this.nomatch.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)}Xm(t){const e=this.nodes.length;this.nodes.push(new ae(t));const n=new he(e,!0),i=new he(e,!1);this.connect(this.match,e),this.Dm?(this.nomatch.push(this.connections.length),this.Dm=!1):this.error.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)}Wm(){return 1==this.nodes.length&&!this.nodes[0]._m()}Hm(){return this.Wm()&&this.nodes[0].validator instanceof Ne}Gm(t,e){if(0==t.nodes.length)return;const n=this.nodes.length;if(e==re.ALTERNATE&&1==n&&t.Hm()&&this.Hm())return void(this.nodes[0].validator=this.nodes[0].validator.combine(t.nodes[0].validator));for(let e=0;e<t.nodes.length;e++)this.nodes.push(t.nodes[e]);e==re.ALTERNATE?(this.Dm=!0,this.connect(this.nomatch,n)):this.connect(this.match,n);const i=this.connections.length;for(let e=0;e<t.connections.length;e++){const i=t.connections[e];i.where+=n,i.what>=0&&(i.what+=n),this.connections.push(i)}for(let e=0;e<t.match.length;e++)this.match.push(t.match[e]+i);if(e==re.REPEATED&&this.connect(this.match,n),e==re.OPTIONAL||e==re.REPEATED)for(let e=0;e<t.nomatch.length;e++)this.match.push(t.nomatch[e]+i);else if(this.Dm){for(let e=0;e<t.nomatch.length;e++)this.nomatch.push(t.nomatch[e]+i);this.Dm=t.Dm}else for(let e=0;e<t.nomatch.length;e++)this.error.push(t.nomatch[e]+i);for(let e=0;e<t.error.length;e++)this.error.push(t.error[e]+i);t.nodes=null,t.connections=null}finish(t,e){const n=this.nodes.length;this.nodes.push(t),this.nodes.push(e),this.connect(this.match,n),this.connect(this.nomatch,n+1),this.connect(this.error,n+1);for(const t of this.connections)t.success?this.nodes[t.where].success=this.nodes[t.what]:this.nodes[t.where].failure=this.nodes[t.what];for(let t=0;t<n;t++)if(null==this.nodes[t].failure||null==this.nodes[t].success)throw new Error("Invalid validator state");return this.nodes[0]}}const ce=1,ue=2,fe=4,de=8,pe=16,ge=32,me=64,be=128,Ee=256,we=512,ve=1024,ye=2048;class Te extends H.m{constructor(){super()}Ym(t,e){const n=t[e].visit(this);return n?[n]:null}}class Ne extends Te{constructor(t,e,n){super(),this.allowed=t,this.idents=e,this.units=n}T(t){return this.allowed&ce?t:null}_(t){return this.allowed&ye?t:null}R(t){return this.allowed&ue?t:null}$(t){return this.idents[t.name.toLowerCase()]||(this.allowed&fe?t:null)}U(t){return 0!=t.num||this.allowed&we?t.num<0&&!(this.allowed&Ee)?null:this.units[t.unit]?t:null:"%"==t.unit&&this.allowed&ve?t:null}V(t){return 0==t.num?this.allowed&we?t:null:t.num<=0&&!(this.allowed&Ee)?null:this.allowed&pe?t:null}X(t){if(0==t.num)return this.allowed&we?t:null;if(t.num<=0&&!(this.allowed&Ee))return null;if(this.allowed&(ge|pe))return t;return this.idents[`${t.num}`]||null}W(t){return this.allowed&me?t:null}Y(t){return this.allowed&be?t:null}Z(t){return null}tt(t){return null}et(t){return null}st(t){return 2046&this.allowed?t:null}combine(t){const e={},n={};for(const t in this.idents)e[t]=this.idents[t];for(const n in t.idents)e[n]=t.idents[n];for(const t in this.units)n[t]=this.units[t];for(const e in t.units)n[e]=t.units[e];return new Ne(this.allowed|t.allowed,e,n)}}const Se={},xe=new Ne(0,Se,Se);class Ce extends Te{constructor(t){super(),this.qm=new ae(null),this.Km=new ae(null),this.first=t.finish(this.qm,this.Km)}Zm(t,e,n){let i=e?[]:t,s=this.first,r=n,o=null,a=null;for(;s!==this.qm&&s!==this.Km;){if(r>=t.length){s=s.failure;continue}const h=t[r];let l=h;if(s._m()){let t=!0;s.Nm()?(o?o.push(a):o=[a],a=[]):s.Fm()?a=o.length>0?o.pop():null:s.$m()?a[s.Mm()]="taken":t=null==a[s.Mm()],s=t?s.success:s.failure}else{if(0==r&&!e&&s.validator instanceof _e&&this instanceof _e){if(l=new H.j(t).visit(s.validator)){r=t.length,s=s.success;continue}}else if(0==r&&!e&&s.validator instanceof Ie&&this instanceof _e){if(l=new H.b(t).visit(s.validator)){r=t.length,s=s.success;continue}}else l=h.visit(s.validator);if(!l){s=s.failure;continue}if(l!==h&&t===i){i=[];for(let e=0;e<r;e++)i[e]=t[e]}t!==i&&(i[r-n]=l),r++,s=s.success}}return s===this.qm&&(e?i.length>0:r==t.length)?i:null}Qm(t){let e=null,n=this.first;for(;n!==this.qm&&n!==this.Km;)t?n._m()?n=n.success:(e=t.visit(n.validator))?(t=null,n=n.success):n=n.failure:n=n.failure;return n===this.qm?e:null}T(t){return this.Qm(t)}_(t){return this.Qm(t)}R(t){return this.Qm(t)}$(t){return this.Qm(t)}U(t){return this.Qm(t)}V(t){return this.Qm(t)}X(t){return this.Qm(t)}W(t){return this.Qm(t)}Y(t){return this.Qm(t)}Z(t){return null}tt(t){return null}et(t){return this.Qm(t)}st(t){return null}}class _e extends Ce{constructor(t){super(t)}Z(t){const e=this.Zm(t.values,!1,0);return e===t.values?t:e?new H.j(e):null}tt(t){let e=this.first,n=!1;for(;e;){if(e.validator instanceof Ie){n=!0;break}e=e.failure}if(n){const e=this.Zm(t.values,!1,0);return e===t.values?t:e?new H.b(e):null}return null}Ym(t,e){return this.Zm(t,!0,e)}}class Ie extends Ce{constructor(t){super(t)}Z(t){return this.Qm(t)}tt(t){const e=this.Zm(t.values,!1,0);return e===t.values?t:e?new H.b(e):null}Ym(t,e){let n,i=this.first;for(;i!==this.Km;){if(n=i.validator.Ym(t,e))return n;i=i.failure}return null}}class Ae extends Ce{constructor(t,e){super(e),this.name=t}Qm(t){return null}et(t){if(t.name.toLowerCase()!=this.name)return null;const e=this.Zm(t.values,!1,0);return e===t.values?t:e?new H.e(t.name,e):null}}class Oe{Jm(t,e,n){return e}success(t,e){}}class ke extends Oe{constructor(t,e){super(),this.name=e,this.validator=t.validators[this.name]}Jm(t,e,n){if(n.values[this.name])return e;const i=this.validator.Ym(t,e);if(i){const t=i.length,s=t>1?new H.j(i):i[0];return this.success(s,n),e+t}return e}success(t,e){e.values[this.name]=t}}class De extends ke{constructor(t,e){super(t,e[0]),this.names=e}success(t,e){for(let n=0;n<this.names.length;n++)e.values[this.names[n]]=t}}class Le extends Oe{constructor(t,e){super(),this.nodes=t,this.slash=e}Jm(t,e,n){const i=e;if(this.slash){if(t[e]!=H.w)return i;if(++e==t.length)return i}let s=this.nodes[0].Jm(t,e,n);if(s==e)return i;e=s;for(let i=1;i<this.nodes.length&&e<t.length&&(s=this.nodes[i].Jm(t,e,n))!=e;i++)e=s;return e}}class Re extends H.m{constructor(){super(...arguments),this.syntax=null,this.tb=null,this.error=!1,this.values={},this.ti=null}eb(t){this.ti=t}sb(t){return new ke(this.ti,t)}clone(){const t=new this.constructor;return t.syntax=this.syntax,t.tb=this.tb,t.ti=this.ti,t}init(t,e){this.syntax=t,this.tb=e}finish(t,e){if(!this.error){for(const n of this.tb)e.Ni(n,this.values[n]||this.ti.ib[n],t);return!0}return!1}nb(t,e){for(const n of this.tb)e.Ni(n,H.t.inherit,t)}Zm(t){return this.error=!0,0}Qm(t){return this.Zm([t]),null}T(t){return this.Qm(t)}R(t){return this.Qm(t)}$(t){return this.Qm(t)}U(t){return this.Qm(t)}V(t){return this.Qm(t)}X(t){return this.Qm(t)}W(t){return this.Qm(t)}Y(t){return this.Qm(t)}Z(t){return this.Zm(t.values),null}tt(t){return this.error=!0,null}et(t){return this.Qm(t)}st(t){return this.error=!0,null}}class Pe extends Re{constructor(){super()}Zm(t){let e=0,n=0;for(;e<t.length;){const i=this.syntax[n].Jm(t,e,this);if(i>e)e=i,n=0;else if(++n==this.syntax.length){this.error=!0;break}}return e}}class Me extends Re{constructor(){super()}Zm(t){if(t.length>this.syntax.length||0==t.length)return this.error=!0,0;for(let e=0;e<this.syntax.length;e++){let n=e;for(;n>=t.length;)n=1==n?0:n-2;if(this.syntax[e].Jm(t,n,this)!=n+1)return this.error=!0,0}return t.length}rb(){return new De(this.ti,this.tb)}}const Fe={SIMPLE:Pe,INSETS:Me,INSETS_SLASH:class extends Re{constructor(){super()}Zm(t){let e=t.length;for(let n=0;n<t.length;n++)if(t[n]===H.w){e=n;break}if(e>this.syntax.length||0==t.length)return this.error=!0,0;for(let n=0;n<this.syntax.length;n++){let i,s=n;for(;s>=e;)s=1==s?0:s-2;if(e+1<t.length)for(i=e+n+1;i>=t.length;)i-=i==e+2?1:2;else i=s;const r=[t[s],t[i]];if(2!=this.syntax[n].Jm(r,0,this))return this.error=!0,0}return t.length}},COMMA:class extends Pe{constructor(){super()}ob(t,e){for(const n of this.tb){const i=e[n]||this.ti.ib[n];let s=t[n];s||(s=[],t[n]=s),s.push(i)}}tt(t){const e={};for(let n=0;n<t.values.length;n++)if(this.values={},t.values[n]instanceof H.b?this.error=!0:(t.values[n].visit(this),this.ob(e,this.values),this.values["background-color"]&&n!=t.values.length-1&&(this.error=!0)),this.error)return null;this.values={};for(const t in e)this.values[t]="background-color"==t?e[t].pop():new H.b(e[t]);return null}},FONT:class extends Pe{constructor(){super()}init(t,e){super.init(t,e),this.tb.push("font-family","line-height","font-size")}Zm(t){let e=super.Zm(t);if(e+2>t.length)return this.error=!0,e;this.error=!1;const n=this.ti.validators;if(!t[e].visit(n["font-size"]))return this.error=!0,e;if(this.values["font-size"]=t[e++],t[e]===H.w){if(++e+2>t.length)return this.error=!0,e;if(!t[e].visit(n["line-height"]))return this.error=!0,e;this.values["line-height"]=t[e++]}const i=e==t.length-1?t[e]:new H.j(t.slice(e,t.length));return i.visit(n["font-family"])?(this.values["font-family"]=i,t.length):(this.error=!0,e)}tt(t){if(t.values[0].visit(this),this.error)return null;const e=[this.values["font-family"]];for(let n=1;n<t.values.length;n++)e.push(t.values[n]);const n=new H.b(e);return n.visit(this.ti.validators["font-family"])?this.values["font-family"]=n:this.error=!0,null}$(t){const e=this.ti.hb[t.name];if(e)for(const t in e)this.values[t]=e[t];else this.error=!0;return null}}};class Ue{constructor(){this.validators={},this.prefixes={},this.ib={},this.cb={},this.hb={},this.shorthands={},this.gm={},this.wm={}}lb(t,e){let n;if(e.type==V.a.NUMERIC)n=new H.i(e.num,e.text);else if(e.type==V.a.HASH)n=B.h(e.text);else{if(e.type!=V.a.IDENT)throw new Error("unexpected replacement");n=H.r(e.text)}if(t.Hm()){const e=t.nodes[0].validator.idents;for(const t in e)e[t]=n;return t}throw new Error("unexpected replacement")}ub(t,e){const n=new le;if("||"==t){for(let t=0;t<e.length;t++){const i=new le;i.jm(t),i.Gm(e[t],re.FOLLOW),i.Vm(t),n.Gm(i,0==t?re.FOLLOW:re.ALTERNATE)}const t=new le;return t.zm(),t.Gm(n,re.REPEATED),t.Um(),t}{let i;switch(t){case" ":i=re.FOLLOW;break;case"|":case"||":i=re.ALTERNATE;break;default:throw new Error("unexpected op")}for(let t=0;t<e.length;t++)n.Gm(e[t],0==t?re.FOLLOW:i);return n}}ab(t,e,n){const i=new le;for(let n=0;n<e;n++)i.Gm(t.clone(),re.FOLLOW);if(n==Number.POSITIVE_INFINITY)i.Gm(t,re.REPEATED);else for(let s=e;s<n;s++)i.Gm(t.clone(),re.OPTIONAL);return i}primitive(t){const e=new le;return e.Xm(t),e}fb(t,e){let n;switch(t){case"COMMA":n=new Ie(e);break;case"SPACE":n=new _e(e);break;default:n=new Ae(t.toLowerCase(),e)}return this.primitive(n)}pb(){this.cb.HASHCOLOR=this.primitive(new Ne(me,Se,Se)),this.cb.POS_INT=this.primitive(new Ne(ge,Se,Se)),this.cb.POS_NUM=this.primitive(new Ne(pe,Se,Se)),this.cb.POS_PERCENTAGE=this.primitive(new Ne(de,Se,{"%":H.o})),this.cb.NEGATIVE=this.primitive(new Ne(Ee,Se,Se)),this.cb.ZERO=this.primitive(new Ne(we,Se,Se)),this.cb.ZERO_PERCENTAGE=this.primitive(new Ne(ve,Se,Se)),this.cb.POS_LENGTH=this.primitive(new Ne(de,Se,{em:H.o,ex:H.o,ch:H.o,rem:H.o,vw:H.o,vh:H.o,vi:H.o,vb:H.o,vmin:H.o,vmax:H.o,pvw:H.o,pvh:H.o,pvi:H.o,pvb:H.o,pvmin:H.o,pvmax:H.o,cm:H.o,mm:H.o,in:H.o,px:H.o,pt:H.o,pc:H.o,q:H.o})),this.cb.POS_ANGLE=this.primitive(new Ne(de,Se,{deg:H.o,grad:H.o,rad:H.o,turn:H.o})),this.cb.POS_TIME=this.primitive(new Ne(de,Se,{s:H.o,ms:H.o})),this.cb.FREQUENCY=this.primitive(new Ne(de,Se,{Hz:H.o,kHz:H.o})),this.cb.RESOLUTION=this.primitive(new Ne(de,Se,{dpi:H.o,dpcm:H.o,dppx:H.o})),this.cb.URI=this.primitive(new Ne(be,Se,Se)),this.cb.IDENT=this.primitive(new Ne(fe,Se,Se)),this.cb.STRING=this.primitive(new Ne(ue,Se,Se)),this.cb.SLASH=this.primitive(new Ne(ye,Se,Se));const t={"font-family":H.r("sans-serif")};this.hb.caption=t,this.hb.icon=t,this.hb.menu=t,this.hb["message-box"]=t,this.hb["small-caption"]=t,this.hb["status-bar"]=t}wb(t){return!!t.match(/^[A-Z_0-9]+$/)}gb(t,e){let n=t.token();if(n.type==V.a.EOF)return null;const i={"":!0};if(n.type==V.a.O_BRK){do{if(t.consume(),(n=t.token()).type!=V.a.IDENT)throw new Error("Prefix name expected");i[n.text]=!0,t.consume(),n=t.token()}while(n.type==V.a.COMMA);if(n.type!=V.a.C_BRK)throw new Error("']' expected");t.consume(),n=t.token()}if(n.type!=V.a.IDENT)throw new Error("Property name expected");if(2==e?"SHORTHANDS"==n.text:"DEFAULTS"==n.text)return t.consume(),null;const s=n.text;if(t.consume(),2!=e){if(t.token().type!=V.a.EQ)throw new Error("'=' expected");this.wb(s)||(this.prefixes[s]=i)}else if(t.token().type!=V.a.COLON)throw new Error("':' expected");return s}mb(t){for(;;){const e=this.gb(t,1);if(!e)return;let n=[];const i=[];let s,r="",o=!0;const a=this,h=()=>{if(0==n.length)throw new Error("No values");return 1==n.length?n[0]:a.ub(r,n)},l=t=>{if(o)throw new Error(`'${t}': unexpected`);if(r&&r!=t)throw new Error(`mixed operators: '${t}' and '${r}'`);r=t,o=!0};let c=null;for(;!c;){t.consume();let e=t.token();switch(e.type){case V.a.IDENT:if(o||l(" "),this.wb(e.text)){const t=this.cb[e.text];if(!t)throw new Error(`'${e.text}' unexpected`);n.push(t.clone())}else{const t={};t[e.text.toLowerCase()]=H.r(e.text),n.push(this.primitive(new Ne(0,t,Se)))}o=!1;break;case V.a.INT:{const t={};t[`${e.num}`]=new H.g(e.num),n.push(this.primitive(new Ne(0,t,Se))),o=!1;break}case V.a.BAR:l("|");break;case V.a.BAR_BAR:l("||");break;case V.a.O_BRK:o||l(" "),i.push({vals:n,op:r,b:"["}),r="",n=[],o=!0;break;case V.a.FUNC:o||l(" "),i.push({vals:n,op:r,b:"(",fn:e.text}),r="",n=[],o=!0;break;case V.a.C_BRK:{s=h();const t=i.pop();if("["!=t.b)throw new Error("']' unexpected");(n=t.vals).push(s),r=t.op,o=!1;break}case V.a.C_PAR:{s=h();const t=i.pop();if("("!=t.b)throw new Error("')' unexpected");(n=t.vals).push(this.fb(t.fn,s)),r=t.op,o=!1;break}case V.a.COLON:if(o)throw new Error("':' unexpected");t.consume(),n.push(this.lb(n.pop(),t.token()));break;case V.a.QMARK:if(o)throw new Error("'?' unexpected");n.push(this.ab(n.pop(),0,1));break;case V.a.STAR:if(o)throw new Error("'*' unexpected");n.push(this.ab(n.pop(),0,Number.POSITIVE_INFINITY));break;case V.a.PLUS:if(o)throw new Error("'+' unexpected");n.push(this.ab(n.pop(),1,Number.POSITIVE_INFINITY));break;case V.a.O_BRC:{if(t.consume(),(e=t.token()).type!=V.a.INT)throw new Error("<int> expected");const i=e.num;let s=i;if(t.consume(),(e=t.token()).type==V.a.COMMA){if(t.consume(),(e=t.token()).type!=V.a.INT)throw new Error("<int> expected");s=e.num,t.consume(),e=t.token()}if(e.type!=V.a.C_BRC)throw new Error("'}' expected");n.push(this.ab(n.pop(),i,s));break}case V.a.SEMICOL:if(c=h(),i.length>0)throw new Error(`unclosed '${i.pop().b}'`);break;default:throw new Error("unexpected token")}}t.consume(),this.wb(e)?this.cb[e]=c:c.Wm()?this.validators[e]=c.nodes[0].validator:this.validators[e]=new _e(c)}}bb(t){for(;;){const e=this.gb(t,2);if(!e)return;const n=[];for(;;){t.consume();const e=t.token();if(e.type==V.a.SEMICOL){t.consume();break}switch(e.type){case V.a.IDENT:n.push(H.r(e.text));break;case V.a.NUM:n.push(new H.h(e.num));break;case V.a.INT:n.push(new H.g(e.num));break;case V.a.NUMERIC:n.push(new H.i(e.num,e.text));break;default:throw new Error("unexpected token")}}this.ib[e]=n.length>1?new H.j(n):n[0]}}Eb(t){for(;;){const e=this.gb(t,3);if(!e)return;let n,i=t.wt(1);i.type==V.a.IDENT&&Fe[i.text]?(n=new Fe[i.text],t.consume()):n=new Pe,n.eb(this);let s=!1,r=[],o=!1;const a=[],h=[];for(;!s;)switch(t.consume(),(i=t.token()).type){case V.a.IDENT:if(this.validators[i.text])r.push(n.sb(i.text)),h.push(i.text);else{if(!(this.shorthands[i.text]instanceof Me))throw new Error(`'${i.text}' is neither a simple property nor an inset shorthand`);{const t=this.shorthands[i.text];r.push(t.rb()),h.push(...t.tb)}}break;case V.a.SLASH:if(r.length>0||o)throw new Error("unexpected slash");o=!0;break;case V.a.O_BRK:a.push({slash:o,syntax:r}),r=[],o=!1;break;case V.a.C_BRK:{const t=new Le(r,o),e=a.pop();r=e.syntax,o=e.slash,r.push(t);break}case V.a.SEMICOL:s=!0,t.consume();break;default:throw new Error("unexpected token")}n.init(r,h),this.shorthands[e]=n}}parse(t){const e=new V.b(t,null);this.mb(e),this.bb(e),this.Eb(e),this.wm=this.xb(["background"]),this.gm=this.xb(["margin","border","padding","columns","column-gap","column-rule","column-fill"])}xb(t){const e={};for(const n of t){const t=this.shorthands[n],i=t?t.tb:[n];for(const t of i){const n=this.ib[t];n?e[t]=n:l.b.warn("Unknown property in makePropSet:",t)}}return e}Ti(t,e,n,i){let s="";const r=t,o=(t=t.toLowerCase()).match(/^-([a-z]+)-([-a-z0-9]+)$/);o&&(s=o[1],t=o[2]);const a=this.prefixes[t];if(!a||!a[s])return void i.Ri(r,e);const h=this.validators[t];if(h){const s=e===H.t.inherit||e.rt()?e:e.visit(h);s?i.Ni(t,s,n):i._i(r,e)}else{const s=this.shorthands[t].clone();e===H.t.inherit?s.nb(n,i):(e.visit(s),s.finish(n,i)||i._i(r,e))}}}const ze=new oe.a(()=>{const t=X.c("loadValidatorSet.load"),e=E.C("validation.txt",E.D),n=$.c(e),i=new Ue;return i.pb(),n.then(n=>{try{n.responseText?i.parse(n.responseText):l.b.error("Error: missing",e)}catch(t){l.b.error(t,"Error:")}t.finish(i)}),t.result()},"validatorFetcher");function Be(){return ze.get()}const Ve={"font-style":H.t.normal,"font-variant":H.t.normal,"font-weight":H.t.normal},$e=`OTTO${(new Date).valueOf()}`;let He=1;function je(t,e){const n={};for(const i in t)n[i]=z.s(t,i).evaluate(e,i);return function(t){for(const e in Ve)t[e]||(t[e]=Ve[e])}(n),n}class Xe{constructor(t){this.properties=t,this.yb=[],this.blobs=[],this.kb=function(t){const e=new E.d;for(const n in Ve)e.append(" "),e.append(t[n].toString());return e.toString()}(this.properties),this.src=this.properties.src?this.properties.src.toString():null;const e=this.properties["font-family"];this.family=e?e.stringValue():null}Sb(t){return this.kb==t.kb}Cb(t,e){const n=new E.d;n.append("@font-face {\n  font-family: "),n.append(this.family),n.append(";\n  ");for(const t in Ve)n.append(t),n.append(": "),this.properties[t].it(n,!0),n.append(";\n  ");if(e){n.append('src: url("');const t=$.d(e);n.append(t),this.yb.push(t),this.blobs.push(e),n.append('")')}else n.append("src: "),n.append(t);return n.append(";\n}\n"),n.toString()}}class Ge{constructor(t){this.deobfuscator=t,this.Pb={}}Tb(t,e){const n=t.family,i=this.Pb[n],s=e.family;if(i){if(i!=s)throw new Error(`E_FONT_FAMILY_INCONSISTENT ${t.family}`)}else this.Pb[n]=s}_b(t){if(t instanceof H.b){const e=t.values,n=[];for(const t of e){const e=this.Pb[t.stringValue()];e&&n.push(H.r(e)),n.push(t)}return new H.b(n)}{const e=this.Pb[t.stringValue()];return e?new H.b([H.r(e),t]):t}}}class We{constructor(t,e,n){this.head=t,this.body=e,this.Rb={},this.Nb=0,this.Ib=n||"Fnt_"}Fb(t,e){const n=t.family;let i=e.Pb[n];return i||(i=this.Ib+ ++this.Nb,e.Pb[n]=i,i)}Ab(t,e,n){const i=X.c("initFont"),s=this,r=t.src,o={};for(const e in Ve)o[e]=t.properties[e];const a=s.Fb(t,n);o["font-family"]=H.r(a);const h=new Xe(o),c=s.body.ownerDocument.createElement("span");c.textContent="M";const u=(new Date).valueOf()+1e3,f=s.head.ownerDocument.createElement("style"),d=$e+He++;f.textContent=h.Cb("",$.e([d])),s.head.appendChild(f),s.body.appendChild(c),c.style.visibility="hidden",c.style.fontFamily=a;for(const t in Ve)E.F(c,t,o[t].toString());const p=c.getBoundingClientRect(),g=p.right-p.left,m=p.bottom-p.top;f.textContent=h.Cb(r,e),l.b.info("Starting to load font:",r);let b=!1;return i.loop(()=>{const t=c.getBoundingClientRect(),e=t.right-t.left,n=t.bottom-t.top;return g!=e||m!=n?(b=!0,X.d(!1)):(new Date).valueOf()>u?X.d(!1):i.sleep(10)}).then(()=>{b?l.b.info("Loaded font:",r):l.b.warn("Failed to load font:",r),s.body.removeChild(c),i.finish(h)}),i.result()}Ob(t,e){const n=t.src;let i=this.Rb[n];const s=this;return i?i.piggyback(i=>{const s=i;s.Sb(t)?(e.Tb(t,s),l.b.warn("Found already-loaded font:",n)):l.b.warn("E_FONT_FACE_INCOMPATIBLE",t.src)}):(i=new oe.a(()=>{const i=X.c("loadFont"),r=e.deobfuscator?e.deobfuscator(n):null;return r?$.c(n,$.b.BLOB).then(n=>{n.Mc?r(n.Mc).then(n=>{s.Ab(t,n,e).$t(i)}):i.finish(null)}):s.Ab(t,null,e).$t(i),i.result()},`loadFont ${n}`),this.Rb[n]=i,i.start()),i}Lb(t,e){const n=[];for(const i of t)i.src&&i.family?n.push(this.Ob(i,e)):l.b.warn("E_FONT_FACE_INVALID");return oe.c(n)}}var Qe=n(30);let Ke=1;class Ye{constructor(t,e,n,i,s){this.name=e,this.$b=n,this.classes=i,this.parent=s,this.specified={},this.children=[],this.Mb=null,this.index=0,this._scope=t,this.key=`p${Ke++}`,s&&(this.index=s.children.length,s.children.push(this))}get scope(){return this._scope}Ps(t){throw new Error("E_UNEXPECTED_CALL")}clone(t){throw new Error("E_UNEXPECTED_CALL")}Db(t){const e=this.specified,n=t.specified;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}Bb(t){for(let e=0;e<this.children.length;e++)this.children[e].clone({parent:t})}}class qe extends Ye{constructor(t){super(t,null,null,[],null),this.specified.width=new z.c(H.q,0),this.specified.height=new z.c(H.p,0)}}class Ze extends k.m{constructor(t,e){super(t,function(t,e){const i=t.match(/^([^.]+)\.([^.]+)$/);if(i){const t=n.Mb.Ub[i[1]];if(t){const n=this.zb(t);if(n)return e?n.Vb(i[2]):n.jb(i[2])}}return null}),this.Mb=e;const n=this}}class Je extends Ye{constructor(t,e,n,i,s,r,o){super(t,e,n,i,s),this.condition=r,this.specificity=o,this.Ub={},t instanceof Ze||(this._scope=new Ze(t,this)),this.Mb=this,this.specified.width=new z.c(H.q,0),this.specified.height=new z.c(H.p,0),this.specified["wrap-flow"]=new z.c(H.t.auto,0),this.specified.position=new z.c(H.t.relative,0),this.specified.overflow=new z.c(H.t.visible,0)}Ps(t){return new mn(t,this)}clone(t){const e=new Je(this.scope,this.name,t.$b||this.$b,this.classes,this.parent,this.condition,this.specificity);return this.Db(e),this.Bb(e),e}Xb(){this.scope.Mb=this}}class tn extends Ye{constructor(t,e,n,i,s){super(t,e,n,i,s),this.Mb=s.Mb,e&&(this.Mb.Ub[e]=this.key),this.specified["wrap-flow"]=new z.c(H.t.auto,0)}Ps(t){return new bn(t,this)}clone(t){const e=new tn(t.parent.scope,this.name,this.$b,this.classes,t.parent);return this.Db(e),this.Bb(e),e}}class en extends Ye{constructor(t,e,n,i,s){super(t,e,n,i,s),this.Mb=s.Mb,e&&(this.Mb.Ub[e]=this.key)}Ps(t){return new En(t,this)}clone(t){const e=new en(t.parent.scope,this.name,this.$b,this.classes,t.parent);return this.Db(e),this.Bb(e),e}}function nn(t,e,n){return e&&e!==H.t.auto?e.nt(t,n):null}function sn(t,e,n){return e&&e!==H.t.auto?e.nt(t,n):t.zero}function rn(t,e,n){return e?e===H.t.auto?null:e.nt(t,n):t.zero}function on(t,e,n,i){return e&&n!==H.t.none?e.nt(t,i):t.zero}function an(t,e,n){return e?e===H.t._true?t._true:e===H.t._false?t._false:e.nt(t,t.zero):n}class hn{constructor(t,e){this.Wb=t,this.Hb=e,this.cascaded={},this.style={},this.Gb=null,this.Yb=null,this.children=[],this.qb=!1,this.Kb=!1,this.Zb=!1,this.Qb=!1,this.Jb=0,this.tE=0,this.eE=null,this.sE={},this.iE={},this.vertical=!1,this.rtl=!1,this.nE=!1,t&&t.children.push(this)}reset(){this.Jb=0,this.tE=0}rE(t,e){const n=this.jb(t),i=this.jb(e);if(!n||!i)throw new Error("E_INTERNAL");return k.C(this.Hb.scope,n,i)}jb(t){let e=this.sE[t];if(e)return e;const n=this.style[t];switch(n&&(e=n.nt(this.Hb.scope,this.Hb.scope.zero)),t){case"margin-left-edge":e=this.jb("left");break;case"margin-top-edge":e=this.jb("top");break;case"margin-right-edge":e=this.rE("border-right-edge","margin-right");break;case"margin-bottom-edge":e=this.rE("border-bottom-edge","margin-bottom");break;case"border-left-edge":e=this.rE("margin-left-edge","margin-left");break;case"border-top-edge":e=this.rE("margin-top-edge","margin-top");break;case"border-right-edge":e=this.rE("padding-right-edge","border-right-width");break;case"border-bottom-edge":e=this.rE("padding-bottom-edge","border-bottom-width");break;case"padding-left-edge":e=this.rE("border-left-edge","border-left-width");break;case"padding-top-edge":e=this.rE("border-top-edge","border-top-width");break;case"padding-right-edge":e=this.rE("right-edge","padding-right");break;case"padding-bottom-edge":e=this.rE("bottom-edge","padding-bottom");break;case"left-edge":e=this.rE("padding-left-edge","padding-left");break;case"top-edge":e=this.rE("padding-top-edge","padding-top");break;case"right-edge":e=this.rE("left-edge","width");break;case"bottom-edge":e=this.rE("top-edge","height")}if(!e){let n;if("extent"==t)n=this.vertical?"width":"height";else if("measure"==t)n=this.vertical?"height":"width";else{const e=this.vertical?z.m:z.l;n=t;for(const t in e)n=n.replace(t,e[t])}n!=t&&(e=this.jb(n))}return e&&(this.sE[t]=e),e}Vb(t){let e=this.iE[t];if(e)return e;switch(t){case"columns":{const t=this.Hb.scope,n=new k.A(t,0),i=this.jb("column-count"),s=this.jb("column-width"),r=this.jb("column-gap");e=k.P(t,k.N(t,new k.d(t,"min",[n,i]),k.C(t,s,r)),r);break}}return e&&(this.iE[t]=e),e}oE(){const t=this.Hb.scope,e=this.style;let n=an(t,e.enabled,t._true);const i=nn(t,e.page,t.zero);if(i){const e=new k.s(t,"page-number");n=k.D(t,n,new k.i(t,i,e))}const s=nn(t,e["min-page-width"],t.zero);s&&(n=k.D(t,n,new k.j(t,new k.s(t,"page-width"),s)));const r=nn(t,e["min-page-height"],t.zero);r&&(n=k.D(t,n,new k.j(t,new k.s(t,"page-height"),r))),n=this.hE(n),e.enabled=new H.c(n)}hE(t){return t}cE(){const t=this.Hb.scope,e=this.style,n=this.Wb?this.Wb.style.width.nt(t,null):null;let i=nn(t,e.left,n),s=nn(t,e["margin-left"],n);const r=on(t,e["border-left-width"],e["border-left-style"],n),o=sn(t,e["padding-left"],n);let a=nn(t,e.width,n),h=nn(t,e["max-width"],n);const l=sn(t,e["padding-right"],n),c=on(t,e["border-right-width"],e["border-right-style"],n);let u=nn(t,e["margin-right"],n),f=nn(t,e.right,n);const d=k.C(t,r,o),p=k.C(t,r,l);if(i&&f&&a){let e=k.P(t,n,k.C(t,a,k.C(t,k.C(t,i,d),p)));s?u?f=k.P(t,e,u):u=k.P(t,e,k.C(t,f,s)):(e=k.P(t,e,f),u?s=k.P(t,e,u):u=s=k.N(t,e,new k.f(t,.5)))}else{s||(s=t.zero),u||(u=t.zero),i||f||a||(i=t.zero),i||a?i||f?a||f||(a=this.Gb,this.qb=!0):i=t.zero:(a=this.Gb,this.qb=!0);const r=k.P(t,n,k.C(t,k.C(t,s,d),k.C(t,u,p)));this.qb&&(h||(h=k.P(t,r,i||f)),this.vertical||!nn(t,e["column-width"],null)&&!nn(t,e["column-count"],null)||(a=h,this.qb=!1)),i?a?f||(f=k.P(t,r,k.C(t,i,a))):a=k.P(t,r,k.C(t,i,f)):i=k.P(t,r,k.C(t,f,a))}const g=sn(t,e["snap-width"]||(this.Wb?this.Wb.style["snap-width"]:null),n);e.left=new H.c(i),e["margin-left"]=new H.c(s),e["border-left-width"]=new H.c(r),e["padding-left"]=new H.c(o),e.width=new H.c(a),e["max-width"]=new H.c(h||a),e["padding-right"]=new H.c(l),e["border-right-width"]=new H.c(c),e["margin-right"]=new H.c(u),e.right=new H.c(f),e["snap-width"]=new H.c(g)}lE(){const t=this.Hb.scope,e=this.style,n=this.Wb?this.Wb.style.width.nt(t,null):null,i=this.Wb?this.Wb.style.height.nt(t,null):null;let s=nn(t,e.top,i),r=nn(t,e["margin-top"],n);const o=on(t,e["border-top-width"],e["border-top-style"],n),a=sn(t,e["padding-top"],n);let h=nn(t,e.height,i),l=nn(t,e["max-height"],i);const c=sn(t,e["padding-bottom"],n),u=on(t,e["border-bottom-width"],e["border-bottom-style"],n);let f=nn(t,e["margin-bottom"],n),d=nn(t,e.bottom,i);const p=k.C(t,o,a),g=k.C(t,u,c);if(s&&d&&h){let e=k.P(t,i,k.C(t,h,k.C(t,k.C(t,s,p),g)));r?f?d=k.P(t,e,r):f=k.P(t,e,k.C(t,d,r)):(e=k.P(t,e,d),f?r=k.P(t,e,f):f=r=k.N(t,e,new k.f(t,.5)))}else{r||(r=t.zero),f||(f=t.zero),s||d||h||(s=t.zero),s||h?s||d?h||d||(h=this.Yb,this.Kb=!0):s=t.zero:(h=this.Yb,this.Kb=!0);const n=k.P(t,i,k.C(t,k.C(t,r,p),k.C(t,f,g)));this.Kb&&(l||(l=k.P(t,n,s||d)),this.vertical&&(nn(t,e["column-width"],null)||nn(t,e["column-count"],null))&&(h=l,this.Kb=!1)),s?h?d||(d=k.P(t,n,k.C(t,s,h))):h=k.P(t,n,k.C(t,d,s)):s=k.P(t,n,k.C(t,d,h))}const m=sn(t,e["snap-height"]||(this.Wb?this.Wb.style["snap-height"]:null),n);e.top=new H.c(s),e["margin-top"]=new H.c(r),e["border-top-width"]=new H.c(o),e["padding-top"]=new H.c(a),e.height=new H.c(h),e["max-height"]=new H.c(l||h),e["padding-bottom"]=new H.c(c),e["border-bottom-width"]=new H.c(u),e["margin-bottom"]=new H.c(f),e.bottom=new H.c(d),e["snap-height"]=new H.c(m)}uE(){const t=this.Hb.scope,e=this.style,n=nn(t,e[this.vertical?"height":"width"],null);let i=nn(t,e["column-width"],n),s=nn(t,e["column-count"],null),r=function(t,e,n){return e&&e!==H.t.normal?e.nt(t,null):null}(t,e["column-gap"]);r||(r=new k.x(t,1,"em")),i&&!s&&(s=new k.d(t,"floor",[k.H(t,k.C(t,n,r),k.C(t,i,r))]),s=new k.d(t,"max",[t.one,s])),s||(s=t.one),i=k.P(t,k.H(t,k.C(t,n,r),s),r),e["column-width"]=new H.c(i),e["column-count"]=new H.c(s),e["column-gap"]=new H.c(r)}depends(t,e,n){return this.style[t].nt(this.Hb.scope,null).depend(e,n)}init(t){t.aE(this.Hb.key,this);const e=this.Hb.scope,n=this.style,i=this,s=this.Wb?this.Wb.fE(t):null,r=z.n(this.cascaded,t,s,!1,null);this.vertical=z.z(r,t,!!this.Wb&&this.Wb.vertical),this.rtl=z.y(r,t,!!this.Wb&&this.Wb.rtl),z.k(r,n,this.vertical,this.rtl,(t,e)=>e.value),this.Gb=new k.t(e,()=>i.Jb,"autoWidth"),this.Yb=new k.t(e,()=>i.tE,"autoHeight"),this.cE(),this.lE(),this.uE(),this.oE()}dE(t,e){let n=this.style[e];return n&&(n=B.i(t,n,e)),n}pE(t,e){let n=this.style[e];return n&&(n=B.i(t,n,e)),H.x(n,t)}wE(t,e){const n=z.t(this.cascaded,e);if(n){const e=[];for(let i=0;i<n.length;i++){const s=n[i].evaluate(t,"");s&&s!==H.o&&e.push(s)}if(e.length)return e}return null}fE(t){const e=this.wE(t,"region-id");if(e){const t=[];for(let n=0;n<e.length;n++)t[n]=e[n].toString();return t}return null}gE(t,e,n,i){this.mE(t,e.element,n,i)}mE(t,e,n,i){let s=this.dE(t,n);s&&(s.ot()&&k.O(s.unit)&&(s=H.n(s,t)),"font-family"===n&&(s=i._b(s)),E.F(e,n,s.toString()))}bE(t,e,n,i){const s=this.dE(t,n);s&&i.push(new G.d(e.element,n,s))}EE(t,e){const n=this.pE(t,"left"),i=this.pE(t,"margin-left"),s=this.pE(t,"padding-left"),r=this.pE(t,"border-left-width"),o=this.pE(t,"width");e.Dr(n,o),E.F(e.element,"margin-left",`${i}px`),E.F(e.element,"padding-left",`${s}px`),E.F(e.element,"border-left-width",`${r}px`),e.marginLeft=i,e.borderLeft=r,e.paddingLeft=s}xE(t,e){const n=this.pE(t,"right"),i=this.pE(t,"snap-height"),s=this.pE(t,"margin-right");let r=this.pE(t,"padding-right");const o=this.pE(t,"border-right-width");if(E.F(e.element,"margin-right",`${s}px`),E.F(e.element,"padding-right",`${r}px`),E.F(e.element,"border-right-width",`${o}px`),e.marginRight=s,e.borderRight=o,this.vertical&&i>0){const t=n+e.kr(),s=t-Math.floor(t/i)*i;s>0&&(e.br=i-s,r+=e.br)}e.paddingRight=r,e.gr=i}yE(t,e){const n=this.pE(t,"snap-height"),i=this.pE(t,"top"),s=this.pE(t,"margin-top");let r=this.pE(t,"padding-top");const o=this.pE(t,"border-top-width");if(e.top=i,e.marginTop=s,e.borderTop=o,e.mr=n,!this.vertical&&n>0){const t=i+e.xr(),s=t-Math.floor(t/n)*n;s>0&&(e.Er=n-s,r+=e.Er)}e.paddingTop=r,E.F(e.element,"top",`${i}px`),E.F(e.element,"margin-top",`${s}px`),E.F(e.element,"padding-top",`${r}px`),E.F(e.element,"border-top-width",`${o}px`)}vE(t,e){const n=this.pE(t,"margin-bottom"),i=this.pE(t,"padding-bottom"),s=this.pE(t,"border-bottom-width"),r=this.pE(t,"height")-e.Er;E.F(e.element,"height",`${r}px`),E.F(e.element,"margin-bottom",`${n}px`),E.F(e.element,"padding-bottom",`${i}px`),E.F(e.element,"border-bottom-width",`${s}px`),e.height=r-e.Er,e.marginBottom=n,e.borderBottom=s,e.paddingBottom=i}kE(t,e){this.vertical?this.xE(t,e):this.yE(t,e)}SE(t,e){this.vertical?this.EE(t,e):this.vE(t,e)}CE(t,e){this.vertical?(this.yE(t,e),this.vE(t,e)):(this.xE(t,e),this.EE(t,e))}PE(t,e){E.F(e.element,"border-top-width","0px");let n=this.pE(t,"max-height");this.Zb?e.Mr(0,n):(this.yE(t,e),n-=e.Er,e.height=n,E.F(e.element,"height",`${n}px`))}TE(t,e){E.F(e.element,"border-left-width","0px");let n=this.pE(t,"max-width");if(this.Qb)e.Dr(0,n);else{this.xE(t,e),n-=e.br,e.width=n;const i=this.pE(t,"right");E.F(e.element,"right",`${i}px`),E.F(e.element,"width",`${n}px`)}}_E(t,e,n,i,s){this.Wb&&this.vertical==this.Wb.vertical||E.F(e.element,"writing-mode",this.vertical?"vertical-rl":"horizontal-tb"),(this.vertical?this.qb:this.Kb)?this.vertical?this.TE(t,e):this.PE(t,e):(this.kE(t,e),this.SE(t,e)),(this.vertical?this.Kb:this.qb)?this.vertical?this.PE(t,e):this.TE(t,e):this.CE(t,e);for(let n=0;n<ln.length;n++)this.gE(t,e,ln[n],i)}RE(t,e,n,i){for(let n=0;n<un.length;n++)this.gE(t,e,un[n],i)}NE(t,e,n){for(let i=0;i<fn.length;i++)this.mE(t,e,fn[i],n)}IE(t,e,n,i,s,r,o){this.vertical?this.Jb=e.wr+e.br:this.tE=e.wr+e.Er;const a=(this.vertical||!i)&&this.Kb,h=(!this.vertical||!i)&&this.qb;let l=null;if((h||a)&&(h&&E.F(e.element,"width","auto"),a&&E.F(e.element,"height","auto"),l=r.on(i?i.element:e.element),h&&(this.Jb=Math.ceil(l.right-l.left-e.paddingLeft-e.borderLeft-e.paddingRight-e.borderRight),this.vertical&&(this.Jb+=e.br)),a&&(this.tE=l.bottom-l.top-e.paddingTop-e.borderTop-e.paddingBottom-e.borderBottom,this.vertical||(this.tE+=e.Er))),(this.vertical?this.Kb:this.qb)&&this.CE(t,e),(this.vertical?this.qb:this.Kb)&&((this.vertical?this.Qb:this.Zb)&&this.kE(t,e),this.SE(t,e)),s>1){const n=this.pE(t,"column-rule-width"),i=this.dE(t,"column-rule-style"),r=this.dE(t,"column-rule-color");if(n>0&&i&&i!=H.t.none&&r!=H.t.transparent){const o=this.pE(t,"column-gap"),a=this.vertical?e.height:e.width,h=this.vertical?"border-top":"border-left";for(let t=1;t<s;t++){const l=(a+o)*t/s-o/2+e.paddingLeft-n/2,c=e.height+e.paddingTop+e.paddingBottom,u=e.element.ownerDocument.createElement("div");E.F(u,"position","absolute"),E.F(u,this.vertical?"left":"top","0px"),E.F(u,this.vertical?"top":"left",`${l}px`),E.F(u,this.vertical?"height":"width","0px"),E.F(u,this.vertical?"width":"height",`${c}px`),E.F(u,h,`${n}px ${i.toString()}${r?` ${r.toString()}`:""}`),e.element.insertBefore(u,e.element.firstChild)}}}for(let n=0;n<cn.length;n++)this.gE(t,e,cn[n],o);for(let i=0;i<dn.length;i++)this.bE(t,e,dn[i],n.Hi)}FE(t,e){const n=this.cascaded,i=this.Hb.specified;for(const t in i)z.x(t)&&z.F(n,t,z.s(i,t));if(this.Hb.$b==pn)for(const t in e)(t.match(/^background-/)||"writing-mode"==t)&&(n[t]=e[t]);if("layout-host"==this.Hb.$b)for(const t in e)t.match(/^background-/)||"writing-mode"==t||(n[t]=e[t]);t.Vs(this.Hb.classes,null,n),n.content&&(n.content=n.content.Ne(new z.e(t,null,t.ws))),this.init(t.context);for(const n of this.Hb.children)n.Ps(this).FE(t,e);t.Qs()}AE(t){this.qb&&(this.Qb=this.depends("right",this.Gb,t)||this.depends("margin-right",this.Gb,t)||this.depends("border-right-width",this.Gb,t)||this.depends("padding-right",this.Gb,t)),this.Kb&&(this.Zb=this.depends("top",this.Yb,t)||this.depends("margin-top",this.Yb,t)||this.depends("border-top-width",this.Yb,t)||this.depends("padding-top",this.Yb,t));for(const e of this.children)e.AE(t)}}const ln=["border-left-style","border-right-style","border-top-style","border-bottom-style","border-left-color","border-right-color","border-top-color","border-bottom-color","outline-style","outline-color","outline-width","overflow","visibility"],cn=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","border-image-source","border-image-slice","border-image-width","border-image-outset","border-image-repeat","background-attachment","background-color","background-image","background-repeat","background-position","background-clip","background-origin","background-size","opacity","z-index","background-blend-mode","isolation","mix-blend-mode","filter"],un=["color","font-family","font-size","font-style","font-weight","font-variant","line-height","letter-spacing","text-align","text-decoration","text-indent","text-transform","white-space","word-spacing","font-feature-settings","font-kerning","font-size-adjust","font-variant-east-asian","font-stretch","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-shadow","text-underline-position"],fn=["width","height","image-resolution","object-fit","object-position"],dn=["transform","transform-origin"],pn="background-host";class gn extends hn{constructor(t){super(null,t)}FE(t,e){super.FE(t,e),this.children.sort((t,e)=>e.Hb.specificity-t.Hb.specificity||t.Hb.index-e.Hb.index)}}class mn extends hn{constructor(t,e){super(t,e),this.eE=this}hE(t){const e=this.Hb.Mb;return e.condition&&(t=k.D(e.scope,t,e.condition)),t}OE(t,e,n){}}class bn extends hn{constructor(t,e){super(t,e),this.eE=t.eE}}class En extends hn{constructor(t,e){super(t,e),this.eE=t.eE}LE(t,e,n){let i=null;if(e instanceof H.f&&(i=[e]),e instanceof H.b&&(i=e.values),i){const e=this.Hb.scope;for(let s=0;s<i.length;s++)if(i[s]instanceof H.f){const r=k.M(i[s].name,"enabled");let o=new k.s(e,r);n&&(o=new k.w(e,o)),t=k.D(e,t,o)}}return t}hE(t){const e=this.Hb.scope,n=this.style,i=an(e,n.required,e._false)!==e._false;if(i||this.Kb){const i=function(t,e,n){return e?e.nt(t,t.zero):new k.f(t,"body")}(e,n["flow-from"]),s=new k.d(e,"has-content",[i]);t=k.D(e,t,s)}if(t=this.LE(t,n["required-partitions"],!1),t=this.LE(t,n["conflicting-partitions"],!0),i){const n=this.eE.style.enabled;let i=n?n.nt(e,null):e._true;i=k.D(e,i,t),this.eE.style.enabled=new H.c(i)}return t}_E(t,e,n,i,s){E.F(e.element,"overflow","hidden"),super._E(t,e,n,i,s)}}class wn extends B.f{constructor(t,e,n,i){super(t,e,!1),this.target=n,this.ti=i}property(t,e,n){this.ti.Ti(t,e,n,this)}Ri(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}_i(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Ni(t,e,n){this.target.specified[t]=new z.c(e,n?B.d:B.e)}}class vn extends wn{constructor(t,e,n,i){super(t,e,n,i)}}class yn extends wn{constructor(t,e,n,i){super(t,e,n,i),n.specified.width=new z.c(H.s,0),n.specified.height=new z.c(H.s,0)}fo(t,e,n){const i=new en(this.scope,t,e,n,this.target),s=new vn(this.scope,this.owner,i,this.ti);this.owner.Oi(s)}do(t,e,n){const i=new tn(this.scope,t,e,n,this.target),s=new yn(this.scope,this.owner,i,this.ti);this.owner.Oi(s)}}class Tn extends wn{constructor(t,e,n,i){super(t,e,n,i)}fo(t,e,n){const i=new en(this.scope,t,e,n,this.target),s=new vn(this.scope,this.owner,i,this.ti);this.owner.Oi(s)}do(t,e,n){const i=new tn(this.scope,t,e,n,this.target),s=new yn(this.scope,this.owner,i,this.ti);this.owner.Oi(s)}}var Nn=n(19);function Sn(t){let e=t["writing-mode"];e=e&&e.value;let n=t.direction;return n=n&&n.value,e===H.t.vertical_lr||e!==H.t.vertical_rl&&n!==H.t.rtl?s.LTR:s.RTL}const xn={a5:{width:new H.i(148,"mm"),height:new H.i(210,"mm")},a4:{width:new H.i(210,"mm"),height:new H.i(297,"mm")},a3:{width:new H.i(297,"mm"),height:new H.i(420,"mm")},b5:{width:new H.i(176,"mm"),height:new H.i(250,"mm")},b4:{width:new H.i(250,"mm"),height:new H.i(353,"mm")},"jis-b5":{width:new H.i(182,"mm"),height:new H.i(257,"mm")},"jis-b4":{width:new H.i(257,"mm"),height:new H.i(364,"mm")},letter:{width:new H.i(8.5,"in"),height:new H.i(11,"in")},legal:{width:new H.i(8.5,"in"),height:new H.i(14,"in")},ledger:{width:new H.i(11,"in"),height:new H.i(17,"in")}},Cn=new H.i(.24,"pt"),_n=new H.i(3,"mm"),In=new H.i(10,"mm"),An=new H.i(13,"mm");function On(t){const e={width:H.q,height:H.p,bleed:H.u,$E:H.u},n=t.size;if(n&&n.value!==H.t.auto){const t=n.value;let i,s;if(t.lt()?(i=t.values[0],s=t.values[1]):(i=t,s=null),i.ot())e.width=i,e.height=s||i;else{const t=i.name&&xn[i.name.toLowerCase()];t&&(s&&s===H.t.landscape?(e.width=t.height,e.height=t.width):(e.width=t.width,e.height=t.height))}}const i=t.marks;i&&i.value!==H.t.none&&(e.$E=An);const s=t.bleed;if(s&&s.value!==H.t.auto)s.value&&s.value.ot()&&(e.bleed=s.value);else if(i){let t=!1;(t=i.value.lt()?i.value.values.some(t=>t===H.t.crop):i.value===H.t.crop)&&(e.bleed=new H.i(6,"pt"))}return e}function kn(t,e){const n={},i=t.bleed.num*e.ut(t.bleed.unit,!1),s=t.$E.num*e.ut(t.$E.unit,!1),r=i+s,o=t.width;o===H.q?e.pref.defaultPaperSize?n.Yt=e.pref.defaultPaperSize.width*e.ut("px",!1):n.Yt=(e.pref.jt?Math.floor(e.ee/2)-e.pref.pageBorder:e.ee)-2*r:n.Yt=o.num*e.ut(o.unit,!1);const a=t.height;return a===H.p?e.pref.defaultPaperSize?n.qt=e.pref.defaultPaperSize.height*e.ut("px",!1):n.qt=e.se-2*r:n.qt=a.num*e.ut(a.unit,!1),n.bleed=i,n.$E=s,n.ME=r,n}function Dn(t,e,n){const i=t.createElementNS(E.a.SVG,"svg");return i.setAttribute("width",e),i.setAttribute("height",n),i.style.position="absolute",i}function Ln(t,e,n){n=n||"polyline";const i=t.createElementNS(E.a.SVG,n);return i.setAttribute("stroke","black"),i.setAttribute("stroke-width",e),i.setAttribute("fill","none"),i}var Rn,Pn;!function(t){t.TOP_LEFT="top left",t.TOP_RIGHT="top right",t.BOTTOM_LEFT="bottom left",t.BOTTOM_RIGHT="bottom right"}(Rn||(Rn={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right"}(Pn||(Pn={}));const Mn=(()=>{const t={width:!0,height:!0,"block-size":!0,"inline-size":!0,margin:!0,padding:!0,border:!0,outline:!0,"outline-width":!0,"outline-style":!0,"outline-color":!0};return["left","right","top","bottom","before","after","start","end","block-start","block-end","inline-start","inline-end"].forEach(e=>{t[`margin-${e}`]=!0,t[`padding-${e}`]=!0,t[`border-${e}-width`]=!0,t[`border-${e}-style`]=!0,t[`border-${e}-color`]=!0}),t})();var Fn;!function(t){t.START="start",t.CENTER="center",t.END="end"}(Fn||(Fn={}));const Un={"top-left-corner":{order:1,DE:!0,BE:!1,UE:!0,zE:!0,VE:null},"top-left":{order:2,DE:!0,BE:!1,UE:!1,zE:!1,VE:Fn.START},"top-center":{order:3,DE:!0,BE:!1,UE:!1,zE:!1,VE:Fn.CENTER},"top-right":{order:4,DE:!0,BE:!1,UE:!1,zE:!1,VE:Fn.END},"top-right-corner":{order:5,DE:!0,BE:!1,UE:!1,zE:!0,VE:null},"right-top":{order:6,DE:!1,BE:!1,UE:!1,zE:!0,VE:Fn.START},"right-middle":{order:7,DE:!1,BE:!1,UE:!1,zE:!0,VE:Fn.CENTER},"right-bottom":{order:8,DE:!1,BE:!1,UE:!1,zE:!0,VE:Fn.END},"bottom-right-corner":{order:9,DE:!1,BE:!0,UE:!1,zE:!0,VE:null},"bottom-right":{order:10,DE:!1,BE:!0,UE:!1,zE:!1,VE:Fn.END},"bottom-center":{order:11,DE:!1,BE:!0,UE:!1,zE:!1,VE:Fn.CENTER},"bottom-left":{order:12,DE:!1,BE:!0,UE:!1,zE:!1,VE:Fn.START},"bottom-left-corner":{order:13,DE:!1,BE:!0,UE:!0,zE:!1,VE:null},"left-bottom":{order:14,DE:!1,BE:!1,UE:!0,zE:!1,VE:Fn.END},"left-middle":{order:15,DE:!1,BE:!1,UE:!0,zE:!1,VE:Fn.CENTER},"left-top":{order:16,DE:!1,BE:!1,UE:!0,zE:!1,VE:Fn.START}},zn=(()=>{const t=Un;return Object.keys(t).sort((e,n)=>t[e].order-t[n].order)})(),Bn="vivliostyle-page-rule-master",Vn="_marginBoxes";class $n extends Je{constructor(t,e,n){super(t,null,Bn,[],e,null,0),this.jE={};const i=On(n),s=new Hn(this.scope,this,n,i);this.XE=s.key,this.WE(n),this.HE(n,i)}WE(t){const e=t[Vn];if(e){const n=this;zn.forEach(i=>{e[i]&&(n.jE[i]=new jn(n.scope,n,i,t))})}}HE(t,e){this.specified.position=new z.c(H.t.relative,0),this.specified.width=new z.c(e.width,0),this.specified.height=new z.c(e.height,0);for(const e in t)Mn[e]||"background-clip"===e||(this.specified[e]=t[e])}Ps(t){return new Xn(t,this)}}class Hn extends en{constructor(t,e,n,i){super(t,null,null,[],e),this.GE=i,this.specified["z-index"]=new z.c(new H.g(0),0),this.HE(n)}HE(t){this.specified["flow-from"]=new z.c(H.r("body"),0),this.specified.position=new z.c(H.t.absolute,0),this.specified.overflow=new z.c(H.t.visible,0);for(const e in Mn)Mn.hasOwnProperty(e)&&(this.specified[e]=t[e])}Ps(t){return new Kn(t,this)}}class jn extends en{constructor(t,e,n,i){super(t,null,null,[],e),this.YE=n,this.HE(i)}HE(t){const e=t[Vn][this.YE];for(const n in t){const i=t[n],s=e[n];(z.v[n]||s&&s.value===H.t.inherit)&&(this.specified[n]=i)}for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];n&&n.value!==H.t.inherit&&(this.specified[t]=n)}}Ps(t){return new Yn(t,this)}}class Xn extends mn{constructor(t,e){super(t,e),this.qE=null,this.KE={}}FE(t,e){const n=this.cascaded;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(t){case"writing-mode":case"direction":n[t]=e[t]}super.FE(t,e)}cE(){const t=this.style;t.left=H.u,t["margin-left"]=H.u,t["border-left-width"]=H.u,t["padding-left"]=H.u,t["padding-right"]=H.u,t["border-right-width"]=H.u,t["margin-right"]=H.u,t.right=H.u}lE(){const t=this.style;t.top=H.u,t["margin-top"]=H.u,t["border-top-width"]=H.u,t["padding-top"]=H.u,t["padding-bottom"]=H.u,t["border-bottom-width"]=H.u,t["margin-bottom"]=H.u,t.bottom=H.u}ZE(t){this.qE=t;const e=this.style;e.width=new H.c(t.QE),e.height=new H.c(t.JE),e["padding-left"]=new H.c(t.marginLeft),e["padding-right"]=new H.c(t.marginRight),e["padding-top"]=new H.c(t.marginTop),e["padding-bottom"]=new H.c(t.marginBottom)}OE(t,e,n){const i=e.Ji,s={start:this.qE.marginLeft,end:this.qE.marginRight,extent:this.qE.QE},r={start:this.qE.marginTop,end:this.qE.marginBottom,extent:this.qE.JE};this.tx(i.top,!0,s,t,n),this.tx(i.bottom,!0,s,t,n),this.tx(i.left,!1,r,t,n),this.tx(i.right,!1,r,t,n)}tx(t,e,n,i,s){const r=Fn.START,o=Fn.CENTER,a=Fn.END,h=this.Hb.scope,l={},c={},u={};for(const n in t){const i=Un[n];if(i){const r=t[n],o=this.KE[n],a=new Gn(r,o.style,e,h,s);l[i.VE]=r,c[i.VE]=o,u[i.VE]=a}}const f={start:n.start.evaluate(i),end:n.end.evaluate(i),extent:n.extent.evaluate(i)};let d=this.sx(u,f.extent),p=!1;const g={};Object.keys(l).forEach(t=>{const r=t,o=nn(h,c[r].style[e?"max-width":"max-height"],n.extent);if(o){const t=o.evaluate(i);if(d[r]>t){const n=u[r]=new Qn(l[r],c[r].style,e,h,s,t);g[r]=n.ix(),p=!0}}}),p&&(d=this.sx(u,f.extent),p=!1,[r,o,a].forEach(t=>{d[t]=g[t]||d[t]}));const m={};Object.keys(l).forEach(t=>{const r=t,o=nn(h,c[r].style[e?"min-width":"min-height"],n.extent);if(o){const t=o.evaluate(i);if(d[r]<t){const n=u[r]=new Qn(l[r],c[r].style,e,h,s,t);m[r]=n.ix(),p=!0}}}),p&&(d=this.sx(u,f.extent),[r,o,a].forEach(t=>{d[t]=m[t]||d[t]}));const b=f.start+f.extent,E=f.start+(f.start+f.extent);[r,o,a].forEach(t=>{const n=d[t];if(n){const i=l[t];let s=0;switch(t){case r:s=e?i.left:i.top;break;case o:s=(E-n)/2;break;case a:s=b-n}e?i.Dr(s,n-i.vr()-i.kr()):i.Mr(s,n-i.xr()-i.yr())}})}sx(t,e){const n=t[Fn.START],i=t[Fn.CENTER],s=t[Fn.END],r={};if(i){const t=[n,s].filter(t=>t),o=t.length?new Wn(t):null,a=this.nx(i,o,e);a.xSize&&(r[Fn.CENTER]=a.xSize);const h=(e-(a.xSize||i.ix()))/2;n&&n.ox()&&(r[Fn.START]=h),s&&s.ox()&&(r[Fn.END]=h)}else{const t=this.nx(n,s,e);t.xSize&&(r[Fn.START]=t.xSize),t.ySize&&(r[Fn.END]=t.ySize)}return r}nx(t,e,n){const i={xSize:null,ySize:null};if(t&&e)if(t.ox()&&e.ox()){const s=t.hx(),r=e.hx();if(s>0&&r>0){const o=s+r;if(o<n)i.xSize=n*s/o;else{const r=t.lx(),a=r+e.lx();a<n?i.xSize=r+(n-a)*(s-r)/(o-a):a>0&&(i.xSize=n*r/a)}i.xSize>0&&(i.ySize=n-i.xSize)}else s>0?i.xSize=n:r>0&&(i.ySize=n)}else t.ox()?i.xSize=Math.max(n-e.ix(),0):e.ox()&&(i.ySize=Math.max(n-t.ix(),0));else t?t.ox()&&(i.xSize=n):e&&e.ox()&&(i.ySize=n);return i}_E(t,e,n,i,s){super._E(t,e,n,i,s),e.element.setAttribute("data-vivliostyle-page-box",!0)}}class Gn{constructor(t,e,n,i,s){this.container=t,this.ux=n,this.rc=s,this.size=null,this.ax=!nn(i,e[n?"width":"height"],new k.x(i,0,"px"))}ox(){return this.ax}wx(){if(!this.size){const t=this.ux?[Nn.a.MAX_CONTENT_WIDTH,Nn.a.MIN_CONTENT_WIDTH]:[Nn.a.MAX_CONTENT_HEIGHT,Nn.a.MIN_CONTENT_HEIGHT];this.size=Nn.b(this.rc,this.container.element,t)}return this.size}hx(){const t=this.wx();return this.ux?this.container.vr()+t[Nn.a.MAX_CONTENT_WIDTH]+this.container.kr():this.container.xr()+t[Nn.a.MAX_CONTENT_HEIGHT]+this.container.yr()}lx(){const t=this.wx();return this.ux?this.container.vr()+t[Nn.a.MIN_CONTENT_WIDTH]+this.container.kr():this.container.xr()+t[Nn.a.MIN_CONTENT_HEIGHT]+this.container.yr()}ix(){return this.ux?this.container.vr()+this.container.width+this.container.kr():this.container.xr()+this.container.height+this.container.yr()}}class Wn{constructor(t){this.params=t}ox(){return this.params.some(t=>t.ox())}hx(){const t=this.params.map(t=>t.hx());return Math.max.apply(null,t)*t.length}lx(){const t=this.params.map(t=>t.lx());return Math.max.apply(null,t)*t.length}ix(){const t=this.params.map(t=>t.ix());return Math.max.apply(null,t)*t.length}}class Qn extends Gn{constructor(t,e,n,i,s,r){super(t,e,n,i,s),this.gx=r}ox(){return!1}hx(){return this.ix()}lx(){return this.ix()}ix(){return this.ux?this.container.vr()+this.gx+this.container.kr():this.container.xr()+this.gx+this.container.yr()}}class Kn extends En{constructor(t,e){super(t,e),this.QE=null,this.JE=null,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null}FE(t,e){const n=this.cascaded;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(t.match(/^column.*$/)||t.match(/^background-/))&&(n[t]=e[t]);super.FE(t,e),this.Wb.ZE({QE:this.QE,JE:this.JE,marginTop:this.marginTop,marginRight:this.marginRight,marginBottom:this.marginBottom,marginLeft:this.marginLeft})}cE(){const t=this.mx({start:"left",end:"right",extent:"width"});this.QE=t.bx,this.marginLeft=t.Ex,this.marginRight=t.xx}lE(){const t=this.mx({start:"top",end:"bottom",extent:"height"});this.JE=t.bx,this.marginTop=t.Ex,this.marginBottom=t.xx}mx(t){const e=this.style,n=this.Hb.GE,i=this.Hb.scope,s=t.start,r=t.end,o=t.extent,a=n[o].nt(i,null);let h=nn(i,e[o],a),l=nn(i,e[`margin-${s}`],a),c=nn(i,e[`margin-${r}`],a);const u=sn(i,e[`padding-${s}`],a),f=sn(i,e[`padding-${r}`],a),d=on(i,e[`border-${s}-width`],e[`border-${s}-style`],a),p=on(i,e[`border-${r}-width`],e[`border-${r}-style`],a);let g=k.P(i,a,k.C(i,k.C(i,d,u),k.C(i,p,f)));return h?(g=k.P(i,g,h),l||c?l?c=k.P(i,g,l):l=k.P(i,g,c):c=l=k.N(i,g,new k.f(i,.5))):(l||(l=i.zero),c||(c=i.zero),h=k.P(i,g,k.C(i,l,c))),e[s]=new H.c(l),e[r]=new H.c(c),e[`margin-${s}`]=H.u,e[`margin-${r}`]=H.u,e[`padding-${s}`]=new H.c(u),e[`padding-${r}`]=new H.c(f),e[`border-${s}-width`]=new H.c(d),e[`border-${r}-width`]=new H.c(p),e[o]=new H.c(h),e[`max-${o}`]=new H.c(h),{bx:k.P(i,a,k.C(i,l,c)),Ex:l,xx:c}}_E(t,e,n,i,s){super._E(t,e,n,i,s),n.Wi=e.element,t.oe=parseFloat(n.Wi.style.width),t.he=parseFloat(n.Wi.style.height)}}class Yn extends En{constructor(t,e){super(t,e),this.nE=!0;const n=e.YE;this.yx=Un[n],t.KE[n]=this}_E(t,e,n,i,s){this.vx(t,e.element),super._E(t,e,n,i,s)}vx(t,e){E.F(e,"display","flex");const n=this.dE(t,"vertical-align");let i=null;n===H.r("middle")?i="center":n===H.r("top")?i="flex-start":n===H.r("bottom")&&(i="flex-end"),i&&(E.F(e,"flex-flow",this.vertical?"row":"column"),E.F(e,"justify-content",i))}VE(t,e){const n=this.style,i=this.Hb.scope,s=t.start,r=t.end,o=t.extent,a="left"===s,h=a?e.QE:e.JE,l=nn(i,n[o],h),c=a?e.marginLeft:e.marginTop;if(this.yx.VE===Fn.START)n[s]=new H.c(c);else if(l){const t=sn(i,n[`margin-${s}`],h),e=sn(i,n[`margin-${r}`],h),o=sn(i,n[`padding-${s}`],h),a=sn(i,n[`padding-${r}`],h),u=on(i,n[`border-${s}-width`],n[`border-${s}-style`],h),f=on(i,n[`border-${r}-width`],n[`border-${r}-style`],h),d=k.C(i,l,k.C(i,k.C(i,o,a),k.C(i,k.C(i,u,f),k.C(i,t,e))));switch(this.yx.VE){case Fn.CENTER:n[s]=new H.c(k.C(i,c,k.H(i,k.P(i,h,d),new k.f(i,2))));break;case Fn.END:n[s]=new H.c(k.P(i,k.C(i,c,h),d))}}}kx(t,e){const n=this.style,i=this.Hb.scope,s=t.inside,r=t.outside,o=t.extent,a=e[`margin${r.charAt(0).toUpperCase()}${r.substring(1)}`],h=rn(i,n[`margin-${s}`],a),l=rn(i,n[`margin-${r}`],a),c=sn(i,n[`padding-${s}`],a),u=sn(i,n[`padding-${r}`],a),f=on(i,n[`border-${s}-width`],n[`border-${s}-style`],a),d=on(i,n[`border-${r}-width`],n[`border-${r}-style`],a),p=nn(i,n[o],a);let g=null;function m(t){if(g)return g;g={extent:p?p.evaluate(t):null,Sx:h?h.evaluate(t):null,Cx:l?l.evaluate(t):null};const e=a.evaluate(t);let n=0;return[f,c,u,d].forEach(e=>{e&&(n+=e.evaluate(t))}),(null===g.Sx||null===g.Cx)&&n+g.extent+g.Sx+g.Cx>e&&(null===g.Sx&&(g.Sx=0),null===g.Cx&&(g.Cx=0)),null!==g.extent&&null!==g.Sx&&null!==g.Cx&&(g.Cx=null),null===g.extent&&null!==g.Sx&&null!==g.Cx?g.extent=e-n-g.Sx-g.Cx:null!==g.extent&&null===g.Sx&&null!==g.Cx?g.Sx=e-n-g.extent-g.Cx:null!==g.extent&&null!==g.Sx&&null===g.Cx?g.Cx=e-n-g.extent-g.Sx:null===g.extent?(g.Sx=g.Cx=0,g.extent=e-n):g.Sx=g.Cx=(e-n-g.extent)/2,g}n[o]=new H.c(new k.t(i,function(){const t=m(this).extent;return null===t?0:t},o)),n[`margin-${s}`]=new H.c(new k.t(i,function(){const t=m(this).Sx;return null===t?0:t},`margin-${s}`)),n[`margin-${r}`]=new H.c(new k.t(i,function(){const t=m(this).Cx;return null===t?0:t},`margin-${r}`)),"left"===s?n.left=new H.c(k.C(i,e.marginLeft,e.QE)):"top"===s&&(n.top=new H.c(k.C(i,e.marginTop,e.JE)))}cE(){const t=this.Wb.qE;this.yx.UE?this.kx({inside:"right",outside:"left",extent:"width"},t):this.yx.zE?this.kx({inside:"left",outside:"right",extent:"width"},t):this.VE({start:"left",end:"right",extent:"width"},t)}lE(){const t=this.Wb.qE;this.yx.DE?this.kx({inside:"bottom",outside:"top",extent:"height"},t):this.yx.BE?this.kx({inside:"top",outside:"bottom",extent:"height"},t):this.VE({start:"top",end:"bottom",extent:"height"},t)}IE(t,e,n,i,s,r,o){super.IE(t,e,n,i,s,r,o);const a=n.Ji,h=this.Hb.YE,l=this.yx;l.UE||l.zE?l.DE||l.BE||(l.UE?a.left[h]=e:l.zE&&(a.right[h]=e)):l.DE?a.top[h]=e:l.BE&&(a.bottom[h]=e)}}class qn{constructor(t,e,n,i,s){this.Px=t,this.Kf=e,this.Tx=n,this.context=i,this._x=s,this.Rx={},this.Nx()}Nx(){const t=this.Kf,e=new k.s(t,"page-number"),n=new k.i(t,new k.q(t,e,new k.f(t,2)),t.zero);t.Zt("recto-page",new k.w(t,n)),t.Zt("verso-page",n),(this.context.Ix||Sn(this._x))===s.LTR?(t.Zt("left-page",n),t.Zt("right-page",new k.w(t,n))):(t.Zt("left-page",new k.w(t,n)),t.Zt("right-page",n))}Fx(){const t={};return this.Px.Vs([],"",t),this.Px.Qs(),t}Ax(t,e){const n=t.Hb;if(0===Object.keys(e).length)return n.Xb(),t;const i=this.Ox(e,n);let s=this.Rx[i];return s||(s=n.$b===pn?this.Lx(e):this.$x(e,n),this.Rx[i]=s),s.Hb.Xb(),s}Ox(t,e){const n=this.Mx(t);return`${e.key}^${n}`}Mx(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];let s;s=i instanceof z.c?`${i.value}`:this.Mx(i),e.push(n+s+(i.priority||""))}return e.sort().join("^")}Lx(t){const e=new $n(this.Kf,this.Tx.Hb,t).Ps(this.Tx);return e.FE(this.Px,this._x),e.AE(this.context),e}$x(t,e){const n=e.clone({$b:Bn}),i=n.specified,s=t.size;if(s){const e=On(t),n=s.priority;i.width=z.i(this.context,i.width,new z.c(e.width,n)),i.height=z.i(this.context,i.height,new z.c(e.height,n))}["counter-reset","counter-increment"].forEach(e=>{i[e]&&(t[e]=i[e])});const r=n.Ps(this.Tx);return r.FE(this.Px,this._x),r.AE(this.context),r}}class Zn extends z.d{constructor(t){super(),this.Dx=t}apply(t){t.Fs===this.Dx&&this.chained.apply(t)}Se(){return 3}ze(t){return this.chained&&t.je(t.pagetypes,this.Dx,this.chained),!0}}class Jn extends z.d{constructor(t){super(),this.scope=t}apply(t){1===new k.s(this.scope,"page-number").evaluate(t.context)&&this.chained.apply(t)}Se(){return 2}}class ti extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"left-page").evaluate(t.context)&&this.chained.apply(t)}Se(){return 1}}class ei extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"right-page").evaluate(t.context)&&this.chained.apply(t)}Se(){return 1}}class ni extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"recto-page").evaluate(t.context)&&this.chained.apply(t)}Se(){return 1}}class ii extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"verso-page").evaluate(t.context)&&this.chained.apply(t)}Se(){return 1}}class si extends z.a{constructor(t,e){super(t,e,null,null,null)}apply(t){!function(t,e,n,i,s){z.B(t,e,n,i,null,null,null);const r=n[Vn];if(r){const n=z.q(e,Vn);for(const e in r)if(r.hasOwnProperty(e)){let s=n[e];s||(s={},n[e]=s),z.B(t,s,r[e],i,null,null,null)}}}(t.context,t.currentStyle,this.style,this.specificity)}}class ri extends z.b{constructor(t,e,n,i,s){super(t,e,null,n,null,i,!1),this.Bx=s,this.Ux=[],this.zx="",this.Vx=[]}ro(){this.xi()}ci(t,e){b.a(e),this.zx=e,e&&(this.chain.push(new Zn(e)),this.specificity+=65536)}ui(t,e){switch(e&&this.hi(`E_INVALID_PAGE_SELECTOR :${t}(${e.join("")})`),this.Vx.push(`:${t}`),t.toLowerCase()){case"first":this.chain.push(new Jn(this.scope)),this.specificity+=256;break;case"left":this.chain.push(new ti(this.scope)),this.specificity+=1;break;case"right":this.chain.push(new ei(this.scope)),this.specificity+=1;break;case"recto":this.chain.push(new ni(this.scope)),this.specificity+=1;break;case"verso":this.chain.push(new ii(this.scope)),this.specificity+=1;break;default:this.hi(`E_INVALID_PAGE_SELECTOR :${t}`)}}jx(){let t;t=this.zx||this.Vx.length?[this.zx].concat(this.Vx.sort()):null,this.Ux.push({selectors:t,specificity:this.specificity}),this.zx="",this.Vx=[]}bi(){this.jx(),super.bi()}ki(){this.jx(),super.ki()}Ni(t,e,n){if(("bleed"===t||"marks"===t)&&!this.Ux.some(t=>null===t.selectors))return;super.Ni(t,e,n);const i=z.s(this.ei,t),s=this.Bx;if("bleed"===t||"marks"===t)s[""]||(s[""]={}),Object.keys(s).forEach(e=>{z.F(s[e],t,i)});else if("size"===t){const e=s[""];this.Ux.forEach(n=>{let r=new z.c(i.value,i.priority+n.specificity);const o=n.selectors?n.selectors.join(""):"";let a=s[o];if(a){const e=z.s(a,t);r=e?z.i(null,r,e):r,z.F(a,t,r)}else a=s[o]={},z.F(a,t,r),e&&["bleed","marks"].forEach(t=>{e[t]&&z.F(a,t,e[t])},this)})}}ni(t){this.cascade.je(this.cascade.pagetypes,"*",t)}Pi(t){return new si(this.ei,t)}oo(t){const e=z.q(this.ei,Vn);let n=e[t];n||(n={},e[t]=n);const i=new oi(this.scope,this.owner,this.ti,n);this.owner.Oi(i)}}class oi extends B.f{constructor(t,e,n,i){super(t,e,!1),this.ti=n,this.Xx=i}property(t,e,n){this.ti.Ti(t,e,n,this)}_i(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Ri(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}Ni(t,e,n){const i=n?this.Ii():this.Fi(),s=new z.c(e,i);z.F(this.Xx,t,s)}}var ai=n(27),hi=n(25),li=n(21);const ci=(t,e,n)=>t.replace(/[uU][rR][lL]\(\s*"((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"\r\n])+)"/gm,(t,i)=>`url("${n.rl(i,e)}"`).replace(/[uU][rR][lL]\(\s*'((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^'\r\n])+)'/gm,(t,i)=>`url('${n.rl(i,e)}'`).replace(/[uU][rR][lL]\(\s*((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"'\r\n\)\s])+)/gm,(t,i)=>`url(${n.rl(i,e)}`),ui={},fi={"text-indent":"0px","margin-top":"0px","padding-top":"0px","border-top-width":"0px","border-top-style":"none","border-top-color":"transparent","border-top-left-radius":"0px","border-top-right-radius":"0px"},di={"text-indent":"0px","margin-right":"0px","padding-right":"0px","border-right-width":"0px","border-right-style":"none","border-right-color":"transparent","border-top-right-radius":"0px","border-bottom-right-radius":"0px"},pi={"margin-top":"0px"},gi={"margin-right":"0px"};class mi extends E.c{constructor(t,e,n,i,s,r,o,a,h,l,c,u,f){super(),this.cn=t,this.context=e,this.viewport=n,this.styler=i,this.Wx=s,this.xmldoc=r,this.Hx=o,this.Gx=a,this.Yx=h,this.page=l,this.qx=c,this.Kx=u,this.Gf=f,this._l=null,this.Zx=null,this.Wu=!1,this.yn=null,this.bn=0,this.An=null,this.document=n.document,this.Yr=i._s.qf()}clone(){return new mi(this.cn,this.context,this.viewport,this.styler,this.Wx,this.xmldoc,this.Hx,this.Gx,this.Yx,this.page,this.qx,this.Kx,this.Gf)}Qx(t,e,n,i,s,r,o,a){const h=this.Jx(n,this.Wx,this.Wu,this._l,r);if(!h)return a;const l=[],c=li.c.createElementNS(E.a.SHADOW,"root");let u=c;for(const t of li.e){let n;if(t){if(!h[t])continue;if(!("footnote-marker"!=t||e&&this.Wu))continue;if(t.match(/^first-/)){const t=i.display;if(!t||t===H.t.inline)continue}if("before"===t||"after"===t){const e=h[t].content;if(!e||e===H.t.normal||e===H.t.none)continue}l.push(t),n=li.c.createElementNS(E.a.XHTML,"span"),li.f(n,t)}else n=li.c.createElementNS(E.a.SHADOW,"content");u.appendChild(n),t.match(/^first-/)&&(u=n)}if(!l.length)return a;const f=new li.b(t,n,s,r,this.Yr);return new G.n(t,c,null,o,a,G.o.ROOTLESS,f)}Jx(t,e,n,i,s){const r=z.u(t,"_pseudos");if(!r)return null;const o={};for(const t in r){const i=o[t]={};z.C(i,r[t],s),z.D(i,s,r[t]),z.o(r[t],e,n,(t,e)=>{z.C(i,e,s),z.p(e,t=>{z.C(i,t,s)})})}return o}ty(t,e,n,i,s){const r=this,o=X.c("createRefShadow");return r.xmldoc.store.load(t).then(a=>{const h=a;if(h){const o=h.ey(t);if(o){const t=r.Yx.sy(h);s=new G.n(n,o,h,i,s,e,t)}}o.finish(s)}),o.result()}iy(t,e,n,i,s,r,o){const a=this,h=X.c("createShadows"),l=i.template;let c;if(l instanceof H.l){const e=l.url;c=a.ty(e,G.o.ROOTLESS,t,o,null)}else c=X.d(null);return c.then(l=>{let c=null;if(t.namespaceURI==E.a.SHADOW&&"include"==t.localName){let e=t.getAttribute("href"),n=null;e?n=o?o.xmldoc:a.xmldoc:o&&(e=o.owner.namespaceURI==E.a.XHTML?o.owner.getAttribute("href"):o.owner.getAttributeNS(E.a.XLINK,"href"),n=o.vn?o.vn.xmldoc:a.xmldoc),e&&(e=E.C(e,n.url),c=a.ty(e,G.o.ROOTED,t,o,l))}null==c&&(c=X.d(l));let u=null;c.then(e=>{if(i.display===H.t.table_cell){const n=E.C("user-agent.xml#table-cell",E.D);u=a.ty(n,G.o.ROOTLESS,t,o,e)}else u=X.d(e)}),u.then(l=>{l=a.Qx(t,e,n,i,s,r,o,l),h.finish(l)})}),h.result()}ua(t,e){this.Zx=t,this.Wu=e}ny(t,e,n,i){const s=this.context,r=z.n(n,s,this.Wx,this.Wu,this._l);t=z.z(r,s,t),e=z.y(r,s,e);const o=this;z.k(r,i,t,e,(t,e)=>{let n=e.evaluate(s,t);return"font-family"==t&&(n=o.Hx._b(n)),n});const a=i.position,h=i.float,l=Zt.c(i.display||H.t.inline,a,h,this.yn===this.xmldoc.root);return["display","position","float"].forEach(t=>{l[t]&&(i[t]=l[t])}),t}oy(t){let e=this._l.yn;const n=[];let i=null,s=this._l.wn,r=-1;for(;e&&1==e.nodeType;){const t=s&&s.root==e;if(!t||s.type==G.o.ROOTLESS){const t=(s?s.styler:this.styler).hl(e,!1);n.push(t),i=i||E.u(e)}t?(e=s.owner,s=s.vn):(e=e.parentNode,r++)}const o=0===r,a=this.context.ut("em",o),h={"font-size":new z.c(new H.i(a,"px"),0)},l=new z.g(h,this.context);for(let t=n.length-1;t>=0;--t){const e=n[t],i=[];for(const t in e)z.w(t)&&i.push(t);i.sort(H.v);for(const t of i){l.Oe(t);const n=z.s(e,t);n.value!==H.t.inherit&&(h[t]=n.Ne(l))}}for(const e in t)z.w(e)||(h[e]=t[e]);return{lang:i,ei:h}}hy(t){return t=E.C(t,this.xmldoc.url),this.Kx[t]||t}ly(){this._l.lang=E.u(this._l.yn)||this._l.parent&&this._l.parent.lang||this._l.lang}uy(t){const e=z.r().filter(e=>t[e]);if(e.length){let n=this._l.jn;if(this._l.parent){n=this._l.jn={};for(const t in this._l.parent.jn)n[t]=this._l.parent.jn[t]}e.forEach(e=>{const i=t[e];if(i){if(i instanceof H.g)n[e]=i.num;else if(i instanceof H.f)n[e]=i.name;else if(i instanceof H.i){const t=i;switch(t.unit){case"dpi":case"dpcm":case"dppx":n[e]=t.num*k.G[t.unit]}}else n[e]=i;delete t[e]}})}}ay(t,e,n,i,s,r){const o=h.b(h.a.RESOLVE_FORMATTING_CONTEXT);for(let a=0;a<o.length;a++){const h=o[a](t,e,n,i,s,r);if(h)return void(t.an=h)}}py(t,e){const n=this;let i=!0;const s=X.c("createElementView");let r=n.yn;const o=n._l.wn?n._l.wn.styler:n.styler;let a=o.hl(r,!1);if(!n._l.wn){const t=this.xmldoc.Aw(r);hi.b.pu(t,n._l.En,0)}const h={};if(!n._l.parent){const t=n.oy(a);a=t.ei,n._l.lang=t.lang}const l=a["float-reference"]&&j.g(a["float-reference"].value.toString());if(n._l.parent&&l&&j.h(l)){const t=n.oy(a);a=t.ei,n._l.lang=t.lang}n._l.vertical=n.ny(n._l.vertical,"rtl"===n._l.direction,a,h),o.cl(r,h),this.uy(h),this.ly(),h.direction&&(n._l.direction=h.direction.toString());const c=h["flow-into"];if(c&&c.toString()!=n.cn)return s.finish(!1),s.result();let u=h.display;if(u===H.t.none)return s.finish(!1),s.result();const f=null==n._l.parent;return n._l.Nn=u===H.t.flex,n.iy(r,f,a,h,o,n.context,n._l.wn).then(c=>{n._l.gn=c;const d=h.position;let p=h.float,g=h.clear;const m=n._l.vertical?H.t.vertical_rl:H.t.horizontal_tb,b=n._l.parent?n._l.parent.vertical?H.t.vertical_rl:H.t.horizontal_tb:m,w=Zt.e(r);n._l.In=Zt.a(u,d,p,h.overflow,m,b,w),n._l.Fn=Zt.b(d),!n._l.qn()||p===H.t.footnote||l&&j.h(l)||(p=null,g=null);let v=p===H.t.left||p===H.t.right||p===H.t.top||p===H.t.bottom||p===H.t.inline_start||p===H.t.inline_end||p===H.t.block_start||p===H.t.block_end||p===H.t.snap_block||p===H.t.footnote;p&&(delete h.float,p===H.t.footnote&&(n.Wu?(v=!1,h.display=H.t.block):h.display=H.t.inline)),g&&(g===H.t.inherit&&n._l.parent&&n._l.parent.Pn&&(g=H.r(n._l.parent.Pn)),g!==H.t.left&&g!==H.t.right&&g!==H.t.top&&g!==H.t.bottom&&g!==H.t.both&&g!==H.t.all&&g!==H.t.same||(delete h.clear,h.display&&h.display!=H.t.inline&&(n._l.Pn=g.toString())));const y=u===H.t.list_item&&h["ua-list-item-count"];if((v||h["break-inside"]&&h["break-inside"]!==H.t.auto)&&n._l.Bn++,u&&u!==H.t.inline&&Zt.f(u)&&n._l.Bn++,n._l.inline=!v&&!u||Zt.f(u)||Zt.g(u),n._l.display=u?u.toString():"inline",n._l.Cn=v?p.toString():null,n._l.Un=l||j.a.INLINE,n._l.Tn=h["float-min-wrap-block"]||null,n._l.columnSpan=h["column-span"],!n._l.inline){const t=h["break-after"];t&&(n._l.breakAfter=t.toString());const e=h["break-before"];e&&(n._l.breakBefore=e.toString())}n._l.verticalAlign=h["vertical-align"]&&h["vertical-align"].toString()||"baseline",n._l.captionSide=h["caption-side"]&&h["caption-side"].toString()||"top";const T=h["border-collapse"];if(!T||T===H.r("separate")){const t=h["border-spacing"];let e,i;t&&(t.lt()?(e=t.values[0],i=t.values[1]):e=i=t,e.ot()&&(n._l._n=H.x(e,n.context)),i.ot()&&(n._l.Rn=H.x(i,n.context)))}n._l.Dn=h["footnote-policy"];const N=h["x-first-pseudo"];if(N){const t=n._l.parent?n._l.parent.Xn:null;n._l.Xn=new G.e(t,N.num)}n._l.inline||n.wy(r,a,o,n.context);const S=h["white-space"];if(S){const t=G.z(S.toString());null!==t&&(n._l.whitespace=t)}const x=h["hyphenate-character"];x&&x!==H.t.auto&&(n._l.zn=x.str);const C=h["word-break"],_=h["overflow-wrap"]||["word-wrap"];n._l.Vn=C===H.t.break_all||_===H.t.break_word,n.ay(n._l,t,u,d,p,f),n._l.parent&&n._l.parent.an&&(t=n._l.parent.an.Qc(n._l,t)),n._l.inline||(n._l.Ln=n.gy(h),n.my(r,o));let I=!1,A=null;const O=[];let k,D=r.namespaceURI,L=r.localName;if(D==E.a.XHTML)"html"==L||"body"==L||"script"==L||"link"==L||"meta"==L?L="div":"vide_"==L?L="video":"audi_"==L?L="audio":"object"==L&&(I=!!n.qx),r.getAttribute(li.a)&&a.content&&a.content.value&&a.content.value.url&&(L="img");else if(D==E.a.epub)L="span",D=E.a.XHTML;else if(D==E.a.FB2){if(D=E.a.XHTML,"image"==L){L="div";const t=r.getAttributeNS(E.a.XLINK,"href");if(t&&"#"==t.charAt(0)){const e=n.xmldoc.ey(t);if(e){A=n.createElement(D,"img");const t=`data:${e.getAttribute("content-type")||"image/jpeg"};base64,${e.textContent.replace(/[ \t\n\t]/g,"")}`;O.push(oe.b(A,t))}}}else L=bi[L];L||(L=n._l.inline?"span":"div")}else if(D==E.a.NCX)if(D=E.a.XHTML,"ncx"==L||"navPoint"==L)L="div";else if("navLabel"==L){L="span";const t=r.parentNode;if(t){let e=null;for(let n=t.firstChild;n;n=n.nextSibling){if(1!=n.nodeType)continue;const t=n;if(t.namespaceURI==E.a.NCX&&"content"==t.localName){e=t.getAttribute("src");break}}e&&(L="a",(r=r.ownerDocument.createElementNS(D,"a")).setAttribute("href",e))}}else L="span";else D==E.a.SHADOW?(D=E.a.XHTML,L=n._l.inline?"span":"div"):I=!!n.qx;if(y)t?L="li":(L="div",u=H.t.block,h.display=u);else if("body"==L||"li"==L)L="div";else if("q"==L)L="span";else if("a"==L){const t=h["hyperlink-processing"];t&&"normal"!=t.toString()&&(L="span")}if(h.behavior&&"none"!=h.behavior.toString()&&n.qx&&(I=!0),r.dataset&&"true"===r.getAttribute("data-math-typeset")&&(I=!0),I){const t=n._l.parent?n._l.parent.An:null;k=n.qx(r,t,h)}else k=X.d(null);k.then(o=>{o?I&&(i="true"==o.getAttribute("data-adapt-process-children")):o=n.createElement(D,L),"a"==L&&o.addEventListener("click",n.page.tn,!1),A&&(n.Da(n._l,"inner",A),o.appendChild(A)),"iframe"==o.localName&&o.namespaceURI==E.a.XHTML&&function(t){t.addEventListener("load",()=>{t.contentWindow.navigator.epubReadingSystem={name:"adapt",version:"0.1",layoutStyle:"paginated",hasFeature:function(t,e){switch(t){case"mouse-events":return!0}return!1}}},!1)}(o);const a=n._l.jn["image-resolution"],l=[],c=h.width,u=h.height,f=r.getAttribute("width"),d=r.getAttribute("height"),p=c===H.t.auto||!c&&!f,g=u===H.t.auto||!u&&!d;if(r.namespaceURI!=E.a.FB2||"td"==L){const e=r.attributes,i=e.length;let s=null;for(let r=0;r<i;r++){const i=e[r],a=i.namespaceURI;let h=i.localName,c=i.nodeValue;if(a){if("http://www.w3.org/2000/xmlns/"==a)continue;a==E.a.XLINK&&"href"==h&&(c=n.hy(c))}else{if(h.match(/^on/))continue;if("style"==h)continue;if(("id"==h||"name"==h)&&t){c=n.Gf.Hf(c,n.xmldoc.url),o.setAttribute(h,c),n.page.rn(o,c);continue}if("src"==h||"href"==h||"poster"==h?(c=n.hy(c),"href"===h&&(c=n.Gf.rl(c,n.xmldoc.url))):"srcset"==h&&(c=c.split(",").map(t=>n.hy(t.trim())).join(",")),"poster"===h&&"video"===L&&D===E.a.XHTML&&p&&g){const t=new Image,e=oe.b(t,c);O.push(e),l.push({image:t,element:o,fetcher:e})}}if(D==E.a.SVG&&/^[A-Z\-]+$/.test(h)&&(h=h.toLowerCase()),n.by(h)&&(c=ci(c,n.xmldoc.url,n.Gf)),a){const t=ui[a];t&&(h=`${t}:${h}`)}"src"!=h||a||"img"!=L&&"input"!=L||D!=E.a.XHTML?"href"==h&&"image"==L&&D==E.a.SVG&&a==E.a.XLINK?n.page.fetchers.push(oe.b(o,c)):a?o.setAttributeNS(a,h,c):o.setAttribute(h,c):s=c}if(s){const t="input"===L?new Image:o,e=oe.b(t,s);t!==o&&(o.src=s),p||g?(p&&g&&a&&1!==a&&l.push({image:t,element:o,fetcher:e}),O.push(e)):n.page.fetchers.push(e)}}delete h.content;const m=h["list-style-image"];if(m&&m instanceof H.l){const t=m.url;O.push(oe.b(new Image,t))}if(n.Ey(h),n.xy(o,h),!n._l.inline){let i=null;if(t?e&&(i=n._l.vertical?gi:pi):i="clone"!==n._l.jn["box-decoration-break"]?n._l.vertical?di:fi:n._l.vertical?gi:pi,i)for(const t in i)E.F(o,t,i[t])}y&&o.setAttribute("value",h["ua-list-item-count"].stringValue()),n.An=o,O.length?oe.c(O).then(()=>{a>0&&n.yy(l,a,h,n._l.vertical),s.finish(i)}):s.Bt().then(()=>{s.finish(i)})})}),s.result()}wy(t,e,n,i){const s=this.Jx(e,this.Wx,this.Wu,this._l,i);if(s&&s["after-if-continues"]&&s["after-if-continues"].content){const s=new li.b(t,e,n,i,this.Yr);this._l.Mn=new nt.a(t,s)}}by(t){return mi.SVG_URL_ATTRIBUTES.includes(t.toLowerCase())}yy(t,e,n,i){const s=this;t.forEach(t=>{if("load"===t.fetcher.get().get()){const r=t.image;let o=r.width/e,a=r.height/e;const h=t.element;if(o>0&&a>0)if(n["box-sizing"]===H.t.border_box&&(n["border-left-style"]!==H.t.none&&(o+=H.x(n["border-left-width"],s.context)),n["border-right-style"]!==H.t.none&&(o+=H.x(n["border-right-width"],s.context)),n["border-top-style"]!==H.t.none&&(a+=H.x(n["border-top-width"],s.context)),n["border-bottom-style"]!==H.t.none&&(a+=H.x(n["border-bottom-width"],s.context))),e>1){const t=n["max-width"]||H.t.none,e=n["max-height"]||H.t.none;if(t===H.t.none&&e===H.t.none)E.F(h,"max-width",`${o}px`);else if(t!==H.t.none&&e===H.t.none)E.F(h,"width",`${o}px`);else if(t===H.t.none&&e!==H.t.none)E.F(h,"height",`${a}px`);else{b.a(t.ot()),b.a(e.ot());const n=t,r=e;"%"!==n.unit?E.F(h,"max-width",`${Math.min(o,H.x(n,s.context))}px`):"%"!==r.unit?E.F(h,"max-height",`${Math.min(a,H.x(r,s.context))}px`):i?E.F(h,"height",`${a}px`):E.F(h,"width",`${o}px`)}}else if(e<1){const t=n["min-width"]||H.u,e=n["min-height"]||H.u;b.a(t.ot()),b.a(t.ot());const r=t,l=e;0===r.num&&0===l.num?E.F(h,"min-width",`${o}px`):0!==r.num&&0===l.num?E.F(h,"width",`${o}px`):0===r.num&&0!==l.num?E.F(h,"height",`${a}px`):"%"!==r.unit?E.F(h,"min-width",`${Math.max(o,H.x(r,s.context))}px`):"%"!==l.unit?E.F(h,"min-height",`${Math.max(a,H.x(l,s.context))}px`):i?E.F(h,"height",`${a}px`):E.F(h,"width",`${o}px`)}}})}Ey(t){const e=this;h.b(h.a.PREPROCESS_ELEMENT_STYLE).forEach(n=>{n(e._l,t)})}my(t,e){for(let n=t.firstChild;n;n=n.nextSibling){if(1!==n.nodeType)continue;const t={},i=e.hl(n,!1);if(this.ny(this._l.vertical,"rtl"===this._l.direction,i,t),!this.gy(t))continue;if(this._l.an instanceof rt&&!this._l.Qn(this._l.an))return;const s=this._l.parent,r=s&&s.an;return this._l.an=new rt(r,this._l.yn),void this._l.an.Bd(this._l.vertical)}}gy(t){let e=t["repeat-on-break"];return e!==H.t.none&&(e===H.t.auto&&(e=t.display===H.t.table_header_group?H.t.header:t.display===H.t.table_footer_group?H.t.footer:H.t.none),e&&e!==H.t.none)?e.toString():null}vy(){const t=this,e=X.c("createTextNodeView");return this.ky().then(()=>{const n=t.bn||0,i=ai.d(t._l.xn).substr(n);t.An=document.createTextNode(i),e.finish(!0)}),e.result()}ky(){if(null!=this._l.xn)return X.d(!0);const t=this;let e,n=e=t.yn.textContent;const i=X.c("preprocessTextContent"),s=h.b(h.a.PREPROCESS_TEXT_CONTENT);let r=0;return i.loop(()=>r>=s.length?X.d(!1):s[r++](t._l,n).Ot(t=>(n=t,X.d(!0)))).then(()=>{t._l.xn=ai.a(e,n),i.finish(!0)}),i.result()}Sy(t,e){const n=this,i=X.c("createNodeView");let s,r=!0;return 1==n.yn.nodeType?s=n.py(t,e):8==n.yn.nodeType?(n.An=null,s=X.d(!0)):s=n.vy(),s.then(t=>{if(r=t,n._l.An=n.An,n.An){const t=n._l.parent?n._l.parent.An:n.Zx;t&&t.appendChild(n.An)}i.finish(r)}),i.result()}fa(t,e,n){return this._l=t,t?(this.yn=t.yn,this.bn=t.bn):(this.yn=null,this.bn=-1),this.An=null,this._l?this.Sy(e,!!n):X.d(!0)}Cy(t){if(null==t.wn||"content"!=t.yn.localName||t.yn.namespaceURI!=E.a.SHADOW)return t;const e=t.Sn,n=t.wn,i=t.parent;let s,r,o;n.kn?(o=n.kn,s=n.root,(r=n.type)==G.o.ROOTLESS&&(s=s.firstChild)):(o=n.vn,s=n.owner.firstChild,r=G.o.ROOTLESS);const a=t.yn.nextSibling;if(a?(t.yn=a,t.Wn()):t.mn?t=t.mn:s?t=null:(t=t.parent.modify()).after=!0,s){const n=new G.k(s,i,e);return n.wn=o,n.pn=r,n.mn=t,n}return t.Sn=e,t}Py(t){let e=t.Sn+1;if(t.after){if(!t.parent)return null;if(t.pn!=G.o.ROOTED){const n=t.yn.nextSibling;if(n)return(t=t.modify()).Sn=e,t.yn=n,t.Wn(),this.Cy(t)}return t.mn?((t=t.mn.modify()).Sn=e,t):((t=t.parent.modify()).Sn=e,t.after=!0,t)}{if(t.gn){let n=t.gn.root;if(t.gn.type==G.o.ROOTLESS&&(n=n.firstChild),n){const i=new G.k(n,t,e);return i.wn=t.gn,i.pn=t.gn.type,this.Cy(i)}}const n=t.yn.firstChild;return n?this.Cy(new G.k(n,t,e)):(1!=t.yn.nodeType&&(e+=ai.d(t.xn).length-1-t.bn),(t=t.modify()).Sn=e,t.after=!0,t)}}Ty(t,e,n){const i=z.s(e,"hyperlink-processing");if(!i)return!1;const s=i.evaluate(this.context,"hyperlink-processing");return!!s&&s.toString()==n}Dl(t,e){let n=this.Py(t);if(!n||n.after)return X.d(n);const i=X.c("nextInTree");return this.fa(n,!0,e).then(t=>{n.An&&t||((n=n.modify()).after=!0,n.An||(n.inline=!0)),this.dispatchEvent({type:"nextInTree",_l:n}),i.finish(n)}),i.result()}_y(t){if(t instanceof H.b){const e=t.values;for(let t=0;t<e.length;t++)this._y(e[t])}else if(t instanceof H.l){const e=t.url;this.page.fetchers.push(oe.b(new Image,e))}}xy(t,e){const n=e["background-image"];n&&this._y(n);const i=e.position===H.t.relative;for(const n in e){if(Ei[n])continue;let s=e[n];(s=s.visit(new O.a(this.xmldoc.url,this.Gf))).ot()&&k.O(s.unit)&&(s=H.n(s,this.context)),G.s[n]||i&&G.t[n]?this.page.Hi.push(new G.d(t,n,s)):E.F(t,n,s.toString())}}Da(t,e,n){if(t.after)return;const i=this.yn;let s=(t.wn?t.wn.styler:this.styler).hl(i,!1);const r=z.u(s,"_pseudos");if(!r)return;if(!(s=r[e]))return;const o={};t.vertical=this.ny(t.vertical,"rtl"===t.direction,s,o);const a=o.content;G.y(a)&&(a.visit(new G.c(n,this.context,a,this.Yr)),delete o.content),this.xy(n,o)}pa(t,e){const n=X.c("peelOff"),i=t.Xn;let s=t.bn;const r=t.after;if(e>0){const n=t.An.textContent;t.An.textContent=n.substr(0,e),s+=e}else if(!r&&t.An&&0==s){const e=t.An.parentNode;e&&e.removeChild(t.An)}const o=t.Sn+e,a=[];for(;t.Xn===i;)a.push(t),t=t.parent;let h=a.pop(),l=h.mn;const c=this;return n.loop(()=>{for(;a.length>0;){h=a.pop(),t=new G.k(h.yn,t,o),0==a.length&&(t.bn=s,t.after=r),t.pn=h.pn,t.wn=h.wn,t.gn=h.gn,t.mn=h.mn?h.mn:l,l=null;const e=c.fa(t,!1);if(e.Mt())return e}return X.d(!1)}).then(()=>{n.finish(t)}),n.result()}createElement(t,e){return t==E.a.XHTML?this.document.createElement(e):this.document.createElementNS(t,e)}Od(t,e,n){const i={},s=z.u(this.Gx,"_pseudos");if(t=this.ny(t,e,this.Gx,i),s&&s.before){const i={},r=this.createElement(E.a.XHTML,"span");li.f(r,"before"),n.appendChild(r),this.ny(t,e,s.before,i),delete i.content,this.xy(r,i)}return delete i.content,this.xy(n,i),t}Zc(t){t&&t.Zn(t=>{const e=t.jn["box-decoration-break"];if(!e||"slice"===e){const e=t.An;b.a(e instanceof Element),t.vertical?(E.F(e,"padding-left","0"),E.F(e,"border-left","none"),E.F(e,"border-top-left-radius","0"),E.F(e,"border-bottom-left-radius","0")):(E.F(e,"padding-bottom","0"),E.F(e,"border-bottom","none"),E.F(e,"border-bottom-left-radius","0"),E.F(e,"border-bottom-right-radius","0"))}})}sc(t,e,n){const i=t.num,s=t.unit;if(k.J(s)){let i=e;for(;i&&1!==i.nodeType;)i=i.parentNode;b.a(i);const s=parseFloat(n.el(i)["font-size"]);return b.a(this.context),z.j(t,s,this.context).num}{const e=this.context.ut(s,!1);return e?i*e:t}}Ry(t,e){if(t.wn){if(!e.wn)return!1;const n=1===t.node.nodeType?t.node:t.node.parentElement,i=1===e.node.nodeType?e.node:e.node.parentElement;return t.wn.owner===e.wn.owner&&li.d(n)===li.d(i)}return t.node===e.node}Ny(t,e){return t.bn===e.bn&&t.after==e.after&&t.steps.length===e.steps.length&&t.steps.every((t,n)=>{const i=e.steps[n];return this.Ry(t,i)})}Ef(t){return!!li.d(t)}}mi.SVG_URL_ATTRIBUTES=["color-profile","clip-path","cursor","filter","marker","marker-start","marker-end","marker-mid","fill","stroke","mask"];const bi={a:"a",sub:"sub",sup:"sup",table:"table",tr:"tr",td:"td",th:"th",code:"code",body:"div",p:"p",v:"p",date:"p",emphasis:"em",strong:"strong",style:"span",strikethrough:"del"},Ei={"box-decoration-break":!0,"float-min-wrap-block":!0,"float-reference":!0,"flow-into":!0,"flow-linger":!0,"flow-options":!0,"flow-priority":!0,"footnote-policy":!0,page:!0};class wi{constructor(t){this.Iy=t.Iy,this.window=t.window}Fy(t,e){const n=e.left,i=e.top;return{left:t.left-n,top:t.top-i,right:t.right-n,bottom:t.bottom-i,width:t.width,height:t.height}}Tc(t){const e=t.getClientRects(),n=this.Iy.getBoundingClientRect();return Array.from(e).map(t=>this.Fy(t,n))}on(t){const e=t.getBoundingClientRect(),n=this.Iy.getBoundingClientRect();return this.Fy(e,n)}el(t){return this.window.getComputedStyle(t,null)}}class vi{constructor(t,e,n,i,s){this.window=t,this.fontSize=e,this.document=t.document,this.root=n||this.document.body;let r=this.root.firstElementChild;r||((r=this.document.createElement("div")).setAttribute("data-vivliostyle-outer-zoom-box","true"),this.root.appendChild(r));let o=r.firstElementChild;o||((o=this.document.createElement("div")).setAttribute("data-vivliostyle-spread-container","true"),r.appendChild(o));let a=r.nextElementSibling;a||((a=this.document.createElement("div")).setAttribute("data-vivliostyle-layout-box","true"),this.root.appendChild(a)),this.Ay=r,this.Oy=o,this.Iy=a;const h=new wi(this).el(this.root);this.width=i||parseFloat(h.width)||t.innerWidth,this.height=s||parseFloat(h.height)||t.innerHeight}Ly(){E.F(this.Ay,"width",""),E.F(this.Ay,"height",""),E.F(this.Oy,"width",""),E.F(this.Oy,"height",""),E.F(this.Oy,"transform","")}zoom(t,e,n){E.F(this.Ay,"width",`${t*n}px`),E.F(this.Ay,"height",`${e*n}px`),E.F(this.Oy,"width",`${t}px`),E.F(this.Oy,"height",`${e}px`),E.F(this.Oy,"transform",`scale(${n})`)}clear(){const t=this.root;for(;t.lastChild;)t.removeChild(t.lastChild)}}const yi="data-adapt-eloff";class Ti{constructor(t,e,n){this.store=t,this.url=e,this.document=n,this.lang=null,this.$y=-1,this.hm=1,this.root=n.documentElement;let i=null,s=null;if(this.root.namespaceURI==E.a.XHTML){for(let t=this.root.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t;if(e.namespaceURI==E.a.XHTML)switch(e.localName){case"head":s=e;break;case"body":i=e}}this.lang=this.root.getAttribute("lang")}else if(this.root.namespaceURI==E.a.FB2){s=this.root;for(let t=this.root.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t;e.namespaceURI==E.a.FB2&&"body"==e.localName&&(i=e)}const t=this.doc().child("FictionBook").child("description").child("title-info").child("lang").textContent();t.length>0&&(this.lang=t[0])}else if(this.root.namespaceURI==E.a.SSE)for(let t=this.root.firstElementChild;t;t=t.nextElementSibling){const e=t.localName;"meta"===e?s=t:"body"===e&&(i=t)}this.body=i,this.head=s,this.last=this.root,this.last.setAttribute(yi,"0")}doc(){return new Ii([this.document])}Aw(t){const e=t.getAttribute(yi);if(e)return parseInt(e,10);let n=this.hm,i=this.last;for(;i!=t;){let t=i.firstChild;if(!t)for(;!(t=i.nextSibling);)if(null==(i=i.parentNode))throw new Error("Internal error");i=t,1==t.nodeType?(t.setAttribute(yi,n.toString()),++n):n+=t.textContent.length}return this.hm=n,this.last=t,n-1}km(t,e,n){let i=0,s=t,r=null;if(1==s.nodeType){if(!n)return this.Aw(s)}else{if(i=e,!(r=s.previousSibling))return s=s.parentNode,i+=1,this.Aw(s)+i;s=r}for(;;){for(;s.lastChild;)s=s.lastChild;if(1==s.nodeType)break;if(i+=s.textContent.length,!(r=s.previousSibling)){s=s.parentNode;break}s=r}return i+=1,this.Aw(s)+i}My(){return this.$y<0&&(this.$y=this.km(this.root,0,!0)),this.$y}vm(t){let e;const n=this;let i=this.root;for(;;){if((e=this.Aw(i))>=t)return i;const s=i.children;if(!s)break;const r=E.i(s.length,e=>{const i=s[e];return n.Aw(i)>t});if(0==r)break;i=s[r-1]}let s=e+1,r=i,o=r.firstChild||r.nextSibling,a=null;for(;;){if(o){if(1==o.nodeType)break;if(a=r=o,(s+=o.textContent.length)>t)break}else if(!(r=r.parentNode))break;o=r.nextSibling}return a||i}Dy(t){const e=t.getAttribute("id");e&&!this.By[e]&&(this.By[e]=t);const n=t.getAttributeNS(E.a.XML,"id");n&&!this.By[n]&&(this.By[n]=t);for(let e=t.firstElementChild;e;e=e.nextElementSibling)this.Dy(e)}ey(t){const e=t.match(/([^#]*)#(.+)$/);if(!e||e[1]&&e[1]!=this.url)return null;const n=e[2];let i=this.document.getElementById(n);return!i&&this.document.getElementsByName&&(i=this.document.getElementsByName(n)[0]),i||(this.By||(this.By={},this.Dy(this.document.documentElement)),i=this.By[n]),i}}var Ni;function Si(t,e,n){const i=n||new DOMParser;let s;try{s=i.parseFromString(t,e)}catch(t){}if(!s)return null;{const t=s.documentElement,e="parsererror";if(t.localName===e)return null;for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(n.localName===e)return null}return s}function xi(t,e){let n=t.responseXML;if(!n){const e=new DOMParser,i=t.responseText;if(i){const s=function(t){const e=t.contentType;if(e){const t=Object.keys(Ni);for(let n=0;n<t.length;n++)if(Ni[t[n]]===e)return e;if(e.match(/\+xml$/))return Ni.APPLICATION_XML}const n=t.url.match(/\.([^.\/]+)$/);if(n)switch(n[1]){case"html":case"htm":return Ni.TEXT_HTML;case"xhtml":case"xht":return Ni.APPLICATION_XHTML_XML;case"svg":case"svgz":return Ni.IMAGE_SVG_XML;case"opf":case"xml":return Ni.APPLICATION_XML}return null}(t);if((n=Si(i,s||Ni.APPLICATION_XML,e))&&!s){const t=n.documentElement;"html"!==t.localName.toLowerCase()||t.namespaceURI?"svg"===t.localName.toLowerCase()&&n.contentType!==Ni.IMAGE_SVG_XML&&(n=Si(i,Ni.IMAGE_SVG_XML,e)):n=Si(i,Ni.TEXT_HTML,e)}n||(n=Si(i,Ni.TEXT_HTML,e))}}const i=n?new Ti(e,t.url,n):null;return X.d(i)}!function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML_XML="application/xhtml_xml",t.IMAGE_SVG_XML="image/svg+xml"}(Ni||(Ni={}));class Ci{constructor(t){this.fn=t}check(t){return this.fn(t)}Uy(t,e){const n=this;return new Ci(i=>n.check(i)&&1==i.nodeType&&i.getAttribute(t)==e)}zy(t,e){const n=this;return new Ci(i=>{if(!n.check(i))return!1;let s=new Ii([i]);return s=s.child(t),e&&(s=s.predicate(e)),s.size()>0})}}const _i=new Ci(t=>!0);class Ii{constructor(t){this.nodes=t}Vy(){return this.nodes}size(){return this.nodes.length}predicate(t){const e=[];for(const n of this.nodes)t.check(n)&&e.push(n);return new Ii(e)}jy(t){const e=[],n=t=>{e.push(t)};for(let e=0;e<this.nodes.length;e++)t(this.nodes[e],n);return new Ii(e)}forEach(t){const e=[];for(let n=0;n<this.nodes.length;n++)e.push(t(this.nodes[n]));return e}Xy(t){const e=[];for(let n=0;n<this.nodes.length;n++){const i=t(this.nodes[n]);null!=i&&e.push(i)}return e}child(t){return this.jy((e,n)=>{for(let i=e.firstChild;i;i=i.nextSibling)1==i.nodeType&&i.localName==t&&n(i)})}Wy(){return this.jy((t,e)=>{for(let n=t.firstChild;n;n=n.nextSibling)1==n.nodeType&&e(n)})}attribute(t){return this.Xy(e=>1==e.nodeType?e.getAttribute(t):null)}textContent(){return this.forEach(t=>t.textContent)}}const Ai=new oe.a(()=>{const t=X.c("uaStylesheetBase");return Be().then(e=>{const n=E.C("user-agent-base.css",E.D),i=new z.b(null,null,null,null,null,e,!0);i.yi(B.g.USER_AGENT),z.G(i.cascade),B.l(n,i,null,null).$t(t)}),t.result()},"uaStylesheetBaseFetcher");class Oi{constructor(t,e,n,i,s,r,o,a,h,l){this.store=t,this.te=e,this.Kf=n,this.cascade=i,this.Hy=s,this.Gy=r,this.Yy=o,this.qy=a,this.Ky=h,this.Bx=l,this.Zy=t.Zy,this.ti=t.ti,this.Kf.Jt("has-content",function(t){t=t;const e=this.Qy,n=e.ur(t);return this.Jy(e.lr(t))&&e.nr(t,this.tv)&&!!n&&!this.ev(n)}),this.Kf.Zt("page-number",new k.t(this.Kf,function(){return this.sv+this.Qy.page},"page-number"))}iv(t,e,n,i){if(this.Ky.length){const s=new k.g(this.te,t,e,n),r=z.A(s,this.Ky),o=r.width,a=r.height,h=r["text-zoom"];let l=1;if(o&&a||h){const r=k.G.em;if((h?h.evaluate(s,"text-zoom"):null)===H.t.scale&&(l=r/n,n=r,t*=l,e*=l),o&&a){const t=H.x(o.evaluate(s,"width"),s),e=H.x(a.evaluate(s,"height"),s);if(t>0&&e>0)return{width:i&&i.jt?2*(t+i.pageBorder):t,height:e,fontSize:n}}}}return{width:t,height:e,fontSize:n}}}class ki extends k.g{constructor(t,e,n,i,s,r,o,a,h,l,c,u){super(t.te,i.width,i.height,i.fontSize),this.style=t,this.xmldoc=e,this.viewport=i,this.rc=s,this.nv=r,this.qx=o,this.Kx=a,this.sv=h,this.Gf=l,this.Wf=c,this.Hg={body:!0},this.Tx=null,this.styler=null,this.rv=null,this.Qy=null,this.ov=null,this.tv=0,this.hv={},this.cv=null,this.lv={},this.Ix=null,this.uv={},this.av=0,this.fv=0,this.lang=e.lang||n,this.faces=new Ge(this.style.Zy),this.dv=new j.e(null,null,null,null,null,null,null),this.Ix=u||null;for(const e in t.qy){const n=t.qy[e],i=z.s(n,"flow-consume");i&&(i.evaluate(this,"flow-consume")==H.t.all?this.Hg[e]=!0:delete this.Hg[e])}}init(){const t=this,e=X.c("StyleInstance.init"),n=t.Wf.xd(t.xmldoc.url),i=t.Wf.yd(t.xmldoc.url,t.style.te,t.style.Kf);t.styler=new ie(t.xmldoc,t.style.cascade,t.style.te,t,this.Hg,t.style.ti,n,i),i.Zf(t.styler),t.styler.Sm(t),t.rv={},t.rv[t.xmldoc.url]=t.styler;const s=t.styler.bm();t.Ix||(t.Ix=Sn(s));const r=this.style.Hy;this.Tx=new gn(r);const o=this.style.cascade.Ps(t,n,i,this.lang);this.Tx.FE(o,s),this.Tx.AE(t),this.cv=new qn(o,this.style.Kf,this.Tx,t,s);const a=[];for(const e of t.style.Gy){if(e.condition&&!e.condition.evaluate(t))continue;const n=je(e.properties,t),i=new Xe(n);a.push(i)}t.nv.Lb(a,t.faces).$t(e);const h=t.style.Bx;return Object.keys(h).forEach(t=>{const e=kn(On(h[t]),this);this.uv[t]={width:e.Yt+2*e.ME,height:e.qt+2*e.ME}}),e.result()}sy(t){let e=this.rv[t.url];if(!e){const n=this.style.store.pv(t),i=new k.g(n.te,this.Yt(),this.qt(),this.le),s=this.Wf.xd(t.url),r=this.Wf.yd(t.url,n.te,n.Kf);e=new ie(t,n.cascade,n.te,i,this.Hg,n.ti,s,r),this.rv[t.url]=e}return e}aE(t,e){this.hv[t]=e}zb(t){return this.hv[t]}Cm(t,e){const n=this.Qy;if(n){n.flows[t.cn]?e=n.flows[t.cn]:n.flows[t.cn]=e;let i=n.rr[t.cn];i||(i=new G.i,n.rr[t.cn]=i);const s=G.w(t.element),r=new G.a(s),o=new G.h(r,t);i.positions.push(o)}}wv(t){let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.positions.length;n++){const i=t.positions[n].er.primary;let s=i.steps[0].node,r=i.bn,o=i.after,a=0;for(;s.ownerDocument!=this.xmldoc.document;)a++,s=i.steps[a].node,o=!1,r=0;const h=this.xmldoc.km(s,r,o);h<e&&(e=h)}return e}gv(t,e){if(!t)return 0;let n=Number.POSITIVE_INFINITY;for(const i in this.Hg){let s=t.rr[i];if(e||s&&0!=s.positions.length||!this.Qy||(this.styler.Pm(i),s=this.Qy.rr[i],t!=this.Qy&&s&&(s=s.clone(),t.rr[i]=s)),s){const t=this.wv(s);t<n&&(n=t)}}return n}mv(t){l.b.debug("Location - page",this.Qy.page),l.b.debug("  current:",t),l.b.debug("  lookup:",this.tv);for(const t in this.Qy.rr){const e=this.Qy.rr[t];for(const n of e.positions)l.b.debug("  Chunk",`${t}:`,n.sr.startOffset)}}Jy(t){switch(t){case"left":case"right":case"recto":case"verso":return new k.s(this.style.Kf,`${t}-page`).evaluate(this);default:return!0}}bv(t){for(const e in t.rr){const n=t.rr[e];if(n&&n.positions.length>0){const t=n.positions[0].sr;if(this.wv(n)===t.startOffset){const t=n.positions[0].sr.breakBefore,e=Bt.e(n.ir);n.ir=Bt.a(Bt.d(e,t))}}}}Ev(t){const e=this,n=this.Qy,i=this.gv(n);if(i==Number.POSITIVE_INFINITY)return null;const s=this.Tx.children;let r;for(let o=0;o<s.length;o++){if((r=s[o]).Hb.$b===Bn)continue;let a=1;const h=r.dE(e,"utilization");h&&h.ht()&&(a=h.num);const l=e.ut("em",!1),c=e.Yt()*e.qt(),u=Math.ceil(a*c/(l*l));this.tv=this.styler.Em(i,u),b.a(n),this.bv(n),this.ov=n.clone(),this.xv(),e.ae(this.style.Kf);const f=r.dE(e,"enabled");if(!f||f===H.t._true)return this.cv.Ax(r,t)}throw new Error("No enabled page masters")}ev(t){const e=this.ov.flows,n=e[t.cn].ln;if(n){const i=t.startOffset,s=e[n].un;if(!s.length||i<s[0])return!1;const r=E.i(s.length,t=>s[t]>i)-1,o=s[r],a=this.ov.rr[n],h=this.wv(a);return!(o<h)&&(h<o||!this.Jy(a.ir))}return!1}yv(t,e){const n=this.Qy.flows[e];n.an||(n.an=new J.a(null)),t.eu=n.an}vv(t){const e=t.ju,n=e.Fh(),i=X.c("layoutDeferredPageFloats");let s=!1,r=0;return i.Ut(i=>{if(r===n.length)return void i.Vt();const o=n[r++],a=o.float,h=(new j.f).kh(a),l=h.Th(a,e);if(!l||!l.Jo(a))return e.Sh(a)||e.Oh(a)?(e.Ah(o),void i.Vt()):void t.La(o,h,null,l).then(t=>{if(!t)return void i.Vt();const n=e.parent.Xh();n?i.Vt():(e.Xh()&&!n&&(s=!0,e.validate()),i.zt())});i.zt()}).then(()=>{s&&e.invalidate(),i.finish(!0)}),i.result()}kv(t,e){if(t.ju.$h().length>0){if(t.uu){let n;return e?(n=e.clone()).primary=t.uu:n=new G.a(t.uu),n}return b.a("column.lastAfterPosition === null"),null}return null}Sv(t,e){const n=this.Qy.rr[e];if(!n||!this.Jy(n.ir))return X.d(!0);n.ir="any",this.yv(t,e),t.init(),this.Hg[e]&&t.bands.length>0&&(t.Zu=!1);const i=this,s=X.c("layoutColumn");return this.vv(t).then(()=>{if(t.ju.Xh())return void s.finish(!0);const r=[],o=[];let a=!0;s.Ut(s=>{if(t.ju.Rh(e))s.Vt();else{for(;n.positions.length-o.length>0;){let e=0;for(;o.includes(e);)e++;let h=n.positions[e];if(h.sr.startOffset>i.tv||i.ev(h.sr))break;for(let t=e+1;t<n.positions.length;t++){if(o.includes(t))continue;const s=n.positions[t];if(s.sr.startOffset>i.tv||i.ev(s.sr))break;s.sr.dn(h.sr)&&(h=s,e=t)}const l=h.sr;let c=!0;if(t.layout(h.er,a,n.breakAfter).then(u=>{if(t.ju.Xh())s.Vt();else{if(a=!1,h.sr.repeated&&(null===u||l.exclusive)&&r.push(e),l.exclusive)return o.push(e),void s.Vt();{const a=!!u||!!t.Yl,l=i.kv(t,u);if(t.Yl&&l?(h.er=l,n.breakAfter=t.Yl,t.Yl=null):(o.push(e),(u||l)&&(h.er=u||l,r.push(e)),t.Yl&&(n.ir=Bt.a(t.Yl))),a)return void s.Vt()}t.Zu=!1,c?c=!1:s.zt()}}),c)return void(c=!1)}s.Vt()}}).then(()=>{if(!t.ju.Xh()){n.positions=n.positions.filter((t,e)=>r.includes(e)||!o.includes(e)),"column"===n.breakAfter&&(n.breakAfter=null),t.xf();const e=t.ju.uc();t._a(e)}s.finish(!0)})}),s.result()}Ad(t){const e=this.Qy.page-1,n=this.Wf.Ad(e);return new Qe.a([n].concat(t.wc()))}Cv(t,e,n,i,s,r,o,a,h,l,c,u,f,d){const p=this,g=t.vertical?t.qb&&t.Qb:t.Kb&&t.Zb,m=s.element,b=new j.e(a,j.a.COLUMN,null,o,null,null,null),w=p.Qy.clone(),v=X.c("createAndLayoutColumn");let y;return v.Ut(t=>{const v=p.Ad(b);if(h>1){const t=p.viewport.document.createElement("div");if(E.F(t,"position","absolute"),m.appendChild(t),(y=new Qe.b(t,f,p.rc,v,b)).Zu=d,y.vertical=s.vertical,y.mr=s.mr,y.gr=s.gr,s.vertical){const t=r*(c+l)+s.paddingTop;y.Dr(s.paddingLeft,s.width),y.Mr(t,c)}else{const t=r*(c+l)+s.paddingLeft;y.Mr(s.paddingTop,s.height),y.Dr(t,c)}y.ar=e,y.dr=n}else(y=new Qe.b(m,f,p.rc,v,b)).$r(s);y.exclusions=g?[]:i.concat(),y.pr=u,b.Eh(y),y.width>=0?p.Sv(y,o).then(()=>{b.Xh()||b.finish(),y.ju.Xh()&&!a.Xh()?(y.ju.validate(),p.Qy=w.clone(),y.element!==m&&m.removeChild(y.element),t.zt()):t.Vt()}):(b.finish(),t.Vt())}).then(()=>{v.finish(y)}),v.result()}Pv(t,e,n){(e instanceof Kn||e instanceof mn&&!(e instanceof Xn))&&t.Eh(n)}Tv(t,e,n,i){b.a(e instanceof En);const s=e.dE(this,"writing-mode")||null,r=e.dE(this,"direction")||null;return new j.e(t,j.a.REGION,n,i,null,s,r)}_v(t,e,n,i,s,r,o,a,h){const l=this,c=l.Qy.clone(),u=l.Tv(r,e,o,a);let f=!0;function d(){return l.Qy=c.clone(),l.Rv(t,e,n,i,s,r,u,o,a,h,f).Ot(t=>t?X.d({columns:t,position:l.Qy}):X.d(null))}return d().Ot(t=>{if(!t)return X.d(null);if(h<=1)return X.d(t.columns);const n=e.dE(l,"column-fill")||H.t.balance,i=l.Qy.rr[a];b.a(i);const s=function(t,e,n,i,s,r,o){if(e===H.t.auto)return null;{const a=0===o.positions.length,h=r[r.length-1],l=!(!h||!h.Yl);return a||l?new Kt(n,i,s,t):e===H.t.balance_all?new qt(n,i,s):(b.a(e===H.t.balance),null)}}(h,n,d,u,o,t.columns,i);return s?(f=!1,r.lock(),u.lock(),s.ng(t).Ot(t=>(r.unlock(),r.validate(),u.unlock(),l.Qy=t.position,X.d(t.columns)))):X.d(t.columns)})}Rv(t,e,n,i,s,r,o,a,h,l,c){const u=this,f=X.c("layoutFlowColumns"),d=u.Qy.clone(),p=e.pE(u,"column-gap"),g=l>1?e.pE(u,"column-width"):a.width,m=e.fE(u),b=e.dE(u,"shape-inside"),E=O.e(b,0,0,a.width,a.height,u),w=new mi(h,u,u.viewport,u.styler,m,u.xmldoc,u.faces,u.style.Yy,u,t,u.qx,u.Kx,this.Gf);let v=0,y=null,T=[];return f.Ut(t=>{u.Cv(e,n,i,s,a,v++,h,o,l,p,g,E,w,c).then(e=>r.Xh()?(T=null,void t.Vt()):(!(e.Yl&&"column"!==e.Yl)&&v!==l||o.Xh()||o.finish(),o.Xh()?(v=0,u.Qy=d.clone(),o.validate(),void(o.Ec()?(T=null,t.Vt()):t.zt())):(y=e,T[v-1]=y,y.Yl&&"column"!=y.Yl&&(v=l,"region"!=y.Yl&&(u.lv[h]=!0)),void(v<l?t.zt():t.Vt()))))}).then(()=>{f.finish(T)}),f.result()}tg(t,e,n,i,s,r,o){const a=this;e.reset();const h=e.dE(a,"enabled");if(h&&h!==H.t._true)return X.d(!0);const l=X.c("layoutContainer"),c=e.dE(a,"wrap-flow")===H.t.auto,u=e.dE(a,"flow-from"),f=a.viewport.document.createElement("div"),d=e.dE(a,"position");E.F(f,"position",d?d.name:"absolute"),n.insertBefore(f,n.firstChild);let p,g=new G.b(f);g.vertical=e.vertical,g.exclusions=r,e._E(a,g,t,a.faces,a.rc),g.ar=i,g.dr=s,i+=g.left+g.marginLeft+g.borderLeft,s+=g.top+g.marginTop+g.borderTop,this.Pv(o,e,g);let m=!1;if(u&&u.ct())if(a.lv[u.toString()])o.Xh()||e.IE(a,g,t,null,1,a.rc,a.faces),p=X.d(!0);else{const n=X.c("layoutContainer.inner"),h=u.toString(),l=e.pE(a,"column-count");a._v(t,e,i,s,r,o,g,h,l).then(i=>{if(!o.Xh()){const n=i[0];b.a(n),n.element===f&&(g=n),g.wr=Math.max.apply(null,i.map(t=>t.wr)),e.IE(a,g,t,n,l,a.rc,a.faces);const s=a.Qy.rr[h];s&&"region"===s.breakAfter&&(s.breakAfter=null)}n.finish(!0)}),p=n.result()}else{const i=e.dE(a,"content");if(i&&G.y(i)){let n="span";i.url&&(n="img");const s=a.viewport.document.createElement(n);i.visit(new G.c(s,a,i,a.Wf.qf())),f.appendChild(s),"img"==n&&e.NE(a,s,a.faces),e.RE(a,g,t,a.faces)}else e.nE&&(n.removeChild(f),m=!0);m||e.IE(a,g,t,null,1,a.rc,a.faces),p=X.d(!0)}return p.then(()=>{if(o.Xh())return void l.finish(!0);if(!e.Kb||Math.floor(g.wr)>0){if(!m&&!c){const t=e.dE(a,"shape-outside"),n=g.Wr(t,a);r.push(n)}}else if(0==e.children.length)return n.removeChild(f),void l.finish(!0);let h=e.children.length-1;l.loop(()=>{for(;h>=0;){const n=e.children[h--],l=a.tg(t,n,f,i,s,r,o);if(l.Mt())return l.Ot(()=>X.d(!o.Xh()));if(o.Xh())break}return X.d(!1)}).then(()=>{l.finish(!0)})}),l.result()}Nv(){const t=this.Qy.page;for(const e in this.Qy.rr){const n=this.Qy.rr[e];for(let e=n.positions.length-1;e>=0;e--){const i=n.positions[e];i.sr.startPage>=0&&i.sr.startPage+i.sr.linger-1<=t&&n.positions.splice(e,1)}}}xv(){const t=this.Qy.page;for(const e in this.Qy.rr){const n=this.Qy.rr[e];for(let e=n.positions.length-1;e>=0;e--){const i=n.positions[e];i.sr.startPage<0&&i.sr.startOffset<this.tv&&(i.sr.startPage=t)}}}Iv(t){for(const e in this.Hg){const n=t.rr[e];if(n&&n.positions.length>0)return!1}return!0}Fv(t,e){const n=this,i=t.container===t.Xi;n.lv={},e?(n.Qy=e.clone(),n.styler.fm(e.or)):(n.Qy=new G.j,n.styler.fm(-1)),this.lang&&t.Xi.setAttribute("lang",this.lang),(e=n.Qy).page++,n.ae(n.style.Kf),n.ov=e.clone();const s=i?{}:n.cv.Fx(),o=n.Ev(s);if(!o)return X.d(null);let a=0;if(!i){t.sn(o.Hb.specified.width.value===H.q),t.nn(o.Hb.specified.height.value===H.p),n.Wf.vd(t),n.Wf.Cd(s,n);const e=kn(On(s),this);n.Av(e,t),function(t,e,n,i){let s=!1,r=!1;const o=t.marks;if(o){const t=o.value;t.lt()?t.values.forEach(t=>{t===H.t.crop?s=!0:t===H.t.cross&&(r=!0)}):t===H.t.crop?s=!0:t===H.t.cross&&(r=!0)}if(!s&&!r)return;const a=n.container,h=a.ownerDocument;b.a(h);const l=e.bleed,c=H.x(Cn,i),u=H.x(_n,i),f=H.x(In,i);if(l){const e=t["background-color"];e&&e.value&&(n.Xi.style.backgroundColor=e.value.stringValue())}s&&Object.keys(Rn).forEach(t=>{const e=Rn[t],n=function(t,e,n,i,s,r){let o=i;o<=s+2*k.G.mm&&(o=s+i/2);const a=Math.max(i,o),h=s+a+n/2,l=Dn(t,h,h);let c=[[0,s+i],[i,s+i],[i,s+i-o]],u=c.map(t=>[t[1],t[0]]);e!==Rn.TOP_RIGHT&&e!==Rn.BOTTOM_RIGHT||(c=c.map(t=>[s+a-t[0],t[1]]),u=u.map(t=>[s+a-t[0],t[1]])),e!==Rn.BOTTOM_LEFT&&e!==Rn.BOTTOM_RIGHT||(c=c.map(t=>[t[0],s+a-t[1]]),u=u.map(t=>[t[0],s+a-t[1]]));const f=Ln(t,n);f.setAttribute("points",c.map(t=>t.join(",")).join(" ")),l.appendChild(f);const d=Ln(t,n);return d.setAttribute("points",u.map(t=>t.join(",")).join(" ")),l.appendChild(d),e.split(" ").forEach(t=>{l.style[t]=`${r}px`}),l}(h,e,c,f,l,u);a.appendChild(n)}),r&&Object.keys(Pn).forEach(t=>{const e=Pn[t],n=function(t,e,n,i,s){const r=2*i;let o,a;e===Pn.TOP||e===Pn.BOTTOM?(o=r,a=i):(o=i,a=r);const h=Dn(t,o,a),l=Ln(t,n);l.setAttribute("points",`0,${a/2} ${o},${a/2}`),h.appendChild(l);const c=Ln(t,n);c.setAttribute("points",`${o/2},0 ${o/2},${a}`),h.appendChild(c);const u=Ln(t,n,"circle");let f;switch(u.setAttribute("cx",o/2),u.setAttribute("cy",a/2),u.setAttribute("r",i/4),h.appendChild(u),e){case Pn.TOP:f=Pn.BOTTOM;break;case Pn.BOTTOM:f=Pn.TOP;break;case Pn.LEFT:f=Pn.RIGHT;break;case Pn.RIGHT:f=Pn.LEFT}return Object.keys(Pn).forEach(t=>{const n=Pn[t];n===e?h.style[n]=`${s}px`:n!==f&&(h.style[n]="0",h.style[`margin-${n}`]="auto")}),h}(h,e,c,f,u);a.appendChild(n)})}(s,e,t,this),a=e.$E+e.bleed}const h=!i&&o.dE(n,"writing-mode")||H.t.horizontal_tb;this.ce=h!=H.t.horizontal_tb;const l=o.dE(n,"direction")||H.t.ltr,c=new j.e(n.dv,j.a.PAGE,null,null,null,h,l),u=X.c("layoutNextPage");return u.Ut(e=>{n.tg(t,o,t.Xi,a,a,[],c).then(()=>{c.Xh()||c.finish(),c.Xh()?(n.Qy=n.ov.clone(),c.validate(),e.zt()):e.Vt()})}).then(()=>{if(o.OE(n,t,n.rc),!i){const i=new k.s(o.Hb.scope,"left-page");t.side=i.evaluate(n)?r.LEFT:r.RIGHT,n.Nv(),e=n.Qy,Object.keys(e.rr).forEach(t=>{const i=e.rr[t],s=i.breakAfter;!s||"page"!==s&&n.Jy(s)||(i.breakAfter=null)})}n.Qy=n.ov=null,e.or=n.styler.xm();const s=n.style.store.Ov(n.xmldoc);t.finish(s,n.rc),n.Iv(e)&&(e=null),u.finish(e)}),u.result()}Av(t,e){this.ie=t.Yt,this.ne=t.qt,this.fv=t.Yt+2*t.ME,this.av=t.qt+2*t.ME,e.container.style.width=`${this.fv}px`,e.container.style.height=`${this.av}px`,e.Xi.style.left=`${t.$E}px`,e.Xi.style.right=`${t.$E}px`,e.Xi.style.top=`${t.$E}px`,e.Xi.style.bottom=`${t.$E}px`,e.Xi.style.padding=`${t.bleed}px`,e.Xi.style.paddingTop=`${t.bleed+.01}px`}}class Di extends z.b{constructor(t,e,n,i){super(t.te,t,e,n,i,t.ti,!n),this.Lv=t,this.$v=!1}uo(){}ao(t,e,n){const i=new Je(this.Lv.Kf,t,e,n,this.Lv.Hy,this.condition,this.owner.Fi());this.Lv.Oi(new Tn(i.scope,this.Lv,i,this.ti))}ho(t){let e=t.expr;null!=this.condition&&(e=k.D(this.scope,this.condition,e)),this.Lv.Oi(new Di(this.Lv,e,this,this.regionId))}io(){this.Lv.Oi(new z.f(this.scope,this.owner))}Jr(){const t={};this.Lv.Gy.push({properties:t,condition:this.condition}),this.Lv.Oi(new z.h(this.scope,this.owner,null,t,this.Lv.ti))}lo(t){let e=this.Lv.qy[t];e||(e={},this.Lv.qy[t]=e),this.Lv.Oi(new z.h(this.scope,this.owner,null,e,this.Lv.ti))}so(){const t={};this.Lv.Ky.push(t),this.Lv.Oi(new z.h(this.scope,this.owner,this.condition,t,this.Lv.ti))}eo(t){let e=this.Lv.Yy;if(t){const n=z.q(e,"_pseudos");(e=n[t])||(e={},n[t]=e)}this.Lv.Oi(new z.h(this.scope,this.owner,null,e,this.Lv.ti))}no(){this.$v=!0,this.xi()}ro(){const t=new ri(this.Lv.Kf,this.Lv,this,this.ti,this.Lv.Bx);this.Lv.Oi(t),t.ro()}ki(){if(z.b.prototype.ki.call(this),this.$v){this.$v=!1;const t=`R${this.Lv.Mv++}`;this.special("region-id",H.r(t)),this.Si();const e=new Di(this.Lv,this.condition,this,t);this.Lv.Oi(e),e.ki()}}}function Li(t){let e=t.getAttribute("content");if(!e)return"";const n={};let i;for(;null!=(i=e.match(/^,?\s*([-A-Za-z_.][-A-Za-z_0-9.]*)\s*=\s*([-+A-Za-z_0-9.]*)\s*/));)e=e.substr(i[0].length),n[i[1]]=i[2];const s=n.width-0,r=n.height-0;return s&&r?`@-epubx-viewport{width:${s}px;height:${r}px;}`:""}class Ri extends B.a{constructor(t){super(),this.ti=t,this.Mv=0,this.Gy=[],this.Yy={},this.qy={},this.Ky=[],this.Bx={},this.te=new k.m(null),this.Kf=new k.m(this.te),this.Hy=new qe(this.te),this.Dv=new Di(this,null,null,null),this.slave=this.Dv}error(t,e){l.b.warn("CSS parser:",t)}}function Pi(t,e){return e.Bv(t)}class Mi extends $.a{constructor(t){super(Pi,$.b.DOCUMENT),this.Zy=t,this.Uv={},this.zv={},this.Vv={},this.jv={},this.ti=null,this.styleSheets=[],this.Xv=!1}init(t,e){this.Wv(t,e);const n=E.C("user-agent.xml",E.D),i=X.c("OPSDocStore.init"),s=this;return Be().then(t=>{s.ti=t,Ai.get().then(()=>{s.load(n).then(()=>{s.Xv=!0,i.finish(!0)})})}),i.result()}pv(t){return this.Vv[t.url]}Ov(t){return this.jv[t.url]}Wv(t,e){this.Hv(),t&&t.forEach(this.Gv,this),e&&e.forEach(this.Yv,this)}Hv(){this.styleSheets.splice(0)}Gv(t){let e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:B.g.AUTHOR,classes:null,media:null})}Yv(t){let e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:B.g.USER,classes:null,media:null})}Bv(t){const e=X.c("OPSDocStore.load"),n=this,i=t.url,s=i.endsWith("?viv-toc-box");return xi(t,n).then(t=>{if(!t)return void e.finish(null);if(n.Xv){const e=h.b(h.a.PREPROCESS_SINGLE_DOCUMENT);for(let n=0;n<e.length;n++)try{e[n](t.document)}catch(t){l.b.warn("Error during single document preprocessing:",t)}}const r=[],o=t.document.getElementsByTagNameNS(E.a.epub,"trigger");for(let t=0;t<o.length;t++){const e=o[t],n=e.getAttributeNS(E.a.EV,"observer"),i=e.getAttributeNS(E.a.EV,"event"),s=e.getAttribute("action"),a=e.getAttribute("ref");n&&i&&s&&a&&r.push({observer:n,event:i,action:s,ref:a})}n.jv[i]=r;const a=[],c=E.C("user-agent-page.css",E.D);a.push({url:c,text:null,flavor:B.g.USER_AGENT,classes:null,media:null});const u=t.head;if(!s&&u)for(let t=u.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t,n=e.namespaceURI,s=e.localName;if(n==E.a.XHTML)if("style"==s){const t=e.getAttribute("class"),n=e.getAttribute("media"),s=e.getAttribute("title");a.push({url:i,text:e.textContent,flavor:B.g.AUTHOR,classes:s?t:null,media:n})}else if("link"==s){const t=e.getAttribute("rel"),n=e.getAttribute("class"),s=e.getAttribute("media");if("stylesheet"==t||"alternate stylesheet"==t&&n){let t=e.getAttribute("href");t=E.C(t,i);const r=e.getAttribute("title");a.push({url:t,text:null,classes:r?n:null,media:s,flavor:B.g.AUTHOR})}}else"meta"==s&&"viewport"==e.getAttribute("name")&&a.push({url:i,text:Li(e),flavor:B.g.AUTHOR,classes:null,media:null});else if(n==E.a.FB2)"stylesheet"==s&&"text/css"==e.getAttribute("type")&&a.push({url:i,text:e.textContent,flavor:B.g.AUTHOR,classes:null,media:null});else if(n==E.a.SSE&&"property"===s){const t=e.getElementsByTagName("name")[0];if(t&&"stylesheet"===t.textContent){const t=e.getElementsByTagName("value")[0];if(t){const e=E.C(t.textContent,i);a.push({url:e,text:null,classes:null,media:null,flavor:B.g.AUTHOR})}}}}if(!s)for(let t=0;t<n.styleSheets.length;t++)a.push(n.styleSheets[t]);let f="";for(let t=0;t<a.length;t++)f+=a[t].url,f+="^",a[t].text&&(f+=a[t].text),f+="^";let d=n.Uv[f];if(d)return n.Vv[i]=d,void e.finish(t);let p=n.zv[f];p||(p=new oe.a(()=>{const t=X.c("fetchStylesheet");let e=0;const i=new Ri(n.ti);return t.loop(()=>{if(e<a.length){const t=a[e++];return i.yi(t.flavor),null!==t.text?B.k(t.text,i,t.url,t.classes,t.media).Lt(!0):B.l(t.url,i,t.classes,t.media)}return X.d(!1)}).then(()=>{const e=i.Dv.finish();d=new Oi(n,i.te,i.Kf,e,i.Hy,i.Gy,i.Yy,i.qy,i.Ky,i.Bx),n.Uv[f]=d,delete n.zv[f],t.finish(d)}),t.result()},`FetchStylesheet ${i}`),n.zv[f]=p,p.start()),p.get().then(s=>{n.Vv[i]=s,e.finish(t)})}),e.result()}}function Fi(t){return String.fromCharCode(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}function Ui(t){return(255&t.charCodeAt(0))<<24|(255&t.charCodeAt(1))<<16|(255&t.charCodeAt(2))<<8|255&t.charCodeAt(3)}function zi(t){const e=new E.d;e.append(t);let n=55-t.length&63;for(e.append("");n>0;)n--,e.append("\0");e.append("\0\0\0\0"),e.append(Fi(8*t.length)),t=e.toString();const i=[1732584193,4023233417,2562383102,271733878,3285377520],s=[];let r;for(let e=0;e<t.length;e+=64){for(r=0;r<16;r++)s[r]=Ui(t.substr(e+4*r,4));for(;r<80;r++){const t=s[r-3]^s[r-8]^s[r-14]^s[r-16];s[r]=t<<1|t>>>31}let n,o=i[0],a=i[1],h=i[2],l=i[3],c=i[4];for(r=0;r<80;r++)n=r<20?1518500249+(a&h|~a&l):r<40?1859775393+(a^h^l):r<60?2400959708+(a&h|a&l|h&l):3395469782+(a^h^l),n+=(o<<5|o>>>27)+c+s[r],c=l,l=h,h=a<<30|a>>>2,a=o,o=n;i[0]=i[0]+o|0,i[1]=i[1]+a|0,i[2]=i[2]+h|0,i[3]=i[3]+l|0,i[4]=i[4]+c|0}return i}const Bi="▸",Vi="▾",$i="▹";class Hi{constructor(t,e,n,i,s,r,o,a,h,l){this.store=t,this.url=e,this.lang=n,this.rc=i,this.nv=s,this.qv=o,this.Kx=a,this.Gf=h,this.Wf=l,this.page=null,this.instance=null,this.pref=k.E(r),this.pref.jt=!1}Kv(t,e){if(0!=e--)for(let n=t.firstChild;n;n=n.nextSibling)if(1==n.nodeType){const t=n;"auto"!=E.t(t,"height","auto")&&(E.F(t,"height","auto"),this.Kv(t,e)),"absolute"==E.t(t,"position","static")&&(E.F(t,"position","relative"),this.Kv(t,e))}}Zv(t){const e=this.qv.Zv(t);return(t,n,i)=>{const s=i.behavior;if(s)switch(s.toString()){case"body-child":t.parentElement.getAttribute("data-vivliostyle-primary-entry")&&(t.querySelector("[role=doc-toc], [role=directory], nav li a, .toc, #toc")||(i.display=H.t.none));break;case"toc-node-anchor":i.color=H.t.inherit,i["text-decoration"]=H.t.none;break;case"toc-node":i.display=H.t.block,i.margin=H.u,i.padding=H.u,i["padding-inline-start"]=new H.i(1.25,"em");break;case"toc-node-first-child":i.display=H.t.inline_block,i.margin=new H.i(.2,"em"),i["vertical-align"]=H.t.top,i.color=H.t.inherit,i["text-decoration"]=H.t.none}if(!s||"toc-node"!=s.toString()&&"toc-container"!=s.toString())return e(t,n,i);const r=t.firstChild;r&&1!==r.nodeType&&""===r.textContent.trim()&&t.replaceChild(t.ownerDocument.createComment(r.textContent),r);const o=n.getAttribute("data-adapt-class");if("toc-node"==o){const t=n.firstChild;t.textContent!=Bi&&(t.textContent=Bi,E.F(t,"cursor","pointer"),t.addEventListener("click",ji,!1),t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),n.setAttribute("aria-expanded","false"),"0px"!==n.style.height&&(t.tabIndex=0))}const a=n.ownerDocument.createElement("div");if(a.setAttribute("data-adapt-process-children","true"),"toc-node"==s.toString()){const e=n.ownerDocument.createElement("div");if(e.textContent=$i,E.F(e,"margin","0.2em 0 0 -1em"),E.F(e,"margin-inline-start","-1em"),E.F(e,"margin-inline-end","0"),E.F(e,"display","inline-block"),E.F(e,"width","1em"),E.F(e,"text-align","center"),E.F(e,"vertical-align","top"),E.F(e,"cursor","default"),E.F(e,"font-family","Menlo,sans-serif"),a.appendChild(e),E.F(a,"overflow","hidden"),a.setAttribute("data-adapt-class","toc-node"),a.setAttribute("role","treeitem"),"toc-node"==o||"toc-container"==o){E.F(a,"height","0px");const e=t.firstElementChild;e&&"a"===e.localName&&(e.tabIndex=-1)}else n.setAttribute("role","tree")}else"toc-node"==o&&(a.setAttribute("data-adapt-class","toc-container"),a.setAttribute("role","group"),a.setAttribute("aria-hidden","true"));return X.d(a)}}showTOC(t,e,n,i,s){if(this.page)return X.d(this.page);const r=this,o=X.c("showTOC"),a=new G.l(t,t);this.page=a;const h=this.url+"?viv-toc-box";return this.store.load(h).then(i=>{const h=this.store.resources[this.url];h&&h.body&&h.body.getAttribute("data-vivliostyle-primary-entry")&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);const l=r.store.pv(i),c=l.iv(n,1e5,s);e=new vi(e.window,c.fontSize,e.root,c.width,c.height);const u=r.Zv(i),f=new ki(l,i,r.lang,e,r.rc,r.nv,u,r.Kx,0,r.Gf,r.Wf);r.instance=f,f.pref=r.pref,f.init().then(()=>{f.Fv(a,null).then(()=>{Array.from(a.container.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*[style*='display: none']")).forEach(t=>{t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","hidden")}),r.Kv(t,2),o.finish(a)})})}),o.result()}Qv(){this.page&&(this.page.container.style.visibility="hidden",this.page.container.setAttribute("aria-hidden","true"))}isTOCVisible(){return!!this.page&&"visible"===this.page.container.style.visibility}}function ji(t){const e=t.target,n=e.textContent==Bi;e.textContent=n?Vi:Bi;const i=e.parentNode;e.setAttribute("aria-expanded",n?"true":"false"),i.setAttribute("aria-expanded",n?"true":"false");let s=i.firstChild;for(;s;){if(1===s.nodeType){const t=s,e=t.getAttribute("data-adapt-class");if("toc-container"===e){if(t.setAttribute("aria-hidden",n?"false":"true"),t.firstChild){s=t.firstChild;continue}}else if("toc-node"===e&&(t.style.height=n?"auto":"0px",t.children.length>=2&&(t.children[1].tabIndex=n?0:-1),t.children.length>=3&&(t.children[0].tabIndex=n?0:-1,!n))){const e=t.children[0];if(e.textContent==Vi){e.textContent=Bi,e.setAttribute("aria-expanded","false"),t.setAttribute("aria-expanded","false"),s=t.children[2];continue}}}for(;!s.nextSibling&&s.parentNode!==i;)s=s.parentNode;s=s.nextSibling}t.stopPropagation()}class Xi extends Mi{constructor(){super(null),this.Jv={},this.tk={},this.deobfuscators={},this.documents={},this.Zy=this.ek(),this.sk=new $.a(xi,$.b.DOCUMENT),this.ik=$.f()}ek(){const t=this;return e=>t.deobfuscators[e]}nk(t,e,n){return this.sk.load(t,e,n)}rk(t){this.sk.fetch(t)}hk(t,e,n){return this.ik.load(t,e,n)}ck(t){this.ik.fetch(t)}lk(t,e){const n=X.c("loadPubDoc");return $.c(t,null,"HEAD").then(i=>{if(i.status>=400)this.uk(t,e).then(e=>{e?n.finish(e):(l.b.error(`Failed to fetch a source document from ${t} (${i.status}${i.statusText?" "+i.statusText:""})`),n.finish(null))});else if(i.status||i.responseXML||i.responseText||i.Mc||i.contentType||/\/[^\/.]+(?:[#?]|$)/.test(t)&&(t=t.replace(/([#?]|$)/,"/$1")),"application/oebps-package+xml"==i.contentType||/\.opf(?:[#?]|$)/.test(t)){const[,i,s]=t.match(/^((?:.*\/)?)([^\/]*)$/);this.ak(i,s,e).$t(n)}else"application/ld+json"==i.contentType||"application/webpub+json"==i.contentType||"application/audiobook+json"==i.contentType||"application/json"==i.contentType||/\.json(?:ld)?(?:[#?]|$)/.test(t)?this.hk(t,!0).then(e=>{if(!e)return l.b.error(`Received an empty response for ${t}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`),void n.finish(null);const i=new ns(this,t);i.fk(e).then(()=>{n.finish(i)})}):this.dk(t).then(i=>{i?n.finish(i):this.uk(t,e).then(e=>{e?n.finish(e):(l.b.error(`Failed to load ${t}.`),n.finish(null))})})}),n.result()}uk(t,e){const n=X.c("loadEPUBDoc");t.endsWith("/")||(t+="/"),e&&this.ck(t+"?r=list"),this.rk(t+"META-INF/encryption.xml");const i=t+"META-INF/container.xml";return this.nk(i).then(i=>{if(i){const s=i.doc().child("container").child("rootfiles").child("rootfile").attribute("full-path");for(const i of s)if(i)return void this.ak(t,i,e).$t(n);n.finish(null)}}),n.result()}ak(t,e,n){const i=this,s=t+e;let r=i.Jv[s];if(r)return X.d(r);const o=X.c("loadOPF");return i.nk(s,!0,`Failed to fetch EPUB OPF ${s}`).then(e=>{e?i.nk(`${t}META-INF/encryption.xml`).then(a=>{(n?i.hk(`${t}?r=list`):X.d(null)).then(n=>{(r=new ns(i,t)).pk(e,a,n,`${t}?r=manifest`).then(()=>{i.Jv[s]=r,i.tk[t]=r,o.finish(r)})})}):l.b.error(`Received an empty response for EPUB OPF ${s}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),o.result()}dk(t){const e=X.c("loadWebPub");return this.load(t).then(n=>{if(n)if(n.document.querySelector("a[href='META-INF/'],a[href$='/META-INF/']"))e.finish(null);else{const i=n.document,s=new ns(this,t);i.body&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);const r=i.querySelector("link[rel='publication'],link[rel='manifest'][type='application/webpub+json']");if(r){const n=r.getAttribute("href");if(/^#/.test(n)){const t=E.H(i.getElementById(n.substr(1)).textContent);s.fk(t,i).then(()=>{e.finish(s)})}else this.hk(E.C(r.getAttribute("href"),t)).then(t=>{s.fk(t,i).then(()=>{e.finish(s)})})}else s.fk({},i).then(()=>{s.wk&&s.wk.src===n.url&&(i.querySelector("[role=doc-toc], [role=directory], nav, .toc, #toc")||(s.wk=null)),e.finish(s)})}else l.b.error(`Received an empty response for ${t}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),e.result()}gk(t,e){const n=X.c("EPUBDocStore.load"),i=E.I(t);return(this.documents[i]=this.Bv({status:200,statusText:"",url:i,contentType:e.contentType,responseText:null,responseXML:e,Mc:null})).$t(n),n.result()}load(t){const e=E.I(t);let n=this.documents[e];if(n)return n.Mt()?n:X.d(n.get());{const t=X.c("EPUBDocStore.load");return(n=super.load(e,!0,`Failed to fetch a source document from ${e}`)).then(n=>{n?t.finish(n):e.startsWith("data:")?l.b.error(`Failed to load ${e}. Invalid data.`):e.startsWith("http:")&&E.h.startsWith("https:")?l.b.error(`Failed to load ${e}. Mixed Content ("http:" content on "https:" context) is not allowed.`):l.b.error(`Received an empty response for ${e}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),t.result()}}}class Gi{constructor(){this.id=null,this.src="",this.mk=null,this.title=null,this.bk=null,this.Qi=-1,this.Ek=0,this.compressed=null,this.epage=0,this.epageCount=0,this.startPage=null,this.skipPagesBefore=null,this.xk=E.o}yk(t,e){this.id=t.getAttribute("id"),this.src=E.C(t.getAttribute("href"),e),this.mk=t.getAttribute("media-type");const n=t.getAttribute("properties");n&&(this.xk=E.f(n.split(/\s+/)))}vk(t){this.Qi=t.index,this.id=`item${t.index+1}`,this.src=t.url,this.startPage=t.startPage,this.skipPagesBefore=t.skipPagesBefore}}function Wi(t){return t.id}function Qi(t){return`1040:${function(t){const e=function(t){const e=zi(t),n=new E.d;for(let t=0;t<e.length;t++)n.append(Fi(e[t]));return n.toString()}(t),n=new E.d;for(let t=0;t<e.length;t++)n.append((256|e.charCodeAt(t)).toString(16).substr(1));return n.toString()}(t)}`}const Ki={dcterms:"http://purl.org/dc/terms/",marc:"http://id.loc.gov/vocabulary/",media:"http://www.idpf.org/epub/vocab/overlays/#",rendition:"http://www.idpf.org/vocab/rendition/#",onix:"http://www.editeur.org/ONIX/book/codelists/current.html#",xsd:"http://www.w3.org/2001/XMLSchema#"},Yi="http://idpf.org/epub/vocab/package/#",qi={language:`${Ki.dcterms}language`,title:`${Ki.dcterms}title`,creator:`${Ki.dcterms}creator`,layout:`${Ki.rendition}layout`,kk:`${Yi}title-type`,Sk:`${Yi}display-seq`,Ck:`${Yi}alternate-script`};function Zi(t,e){const n={};return(i,s)=>{let r,o;const a=i.r||n,h=s.r||n;if(t==qi.title&&(r="main"==a[qi.kk])!=(o="main"==h[qi.kk]))return r?-1:1;let l=parseInt(a[qi.Sk],10);isNaN(l)&&(l=Number.MAX_VALUE);let c=parseInt(h[qi.Sk],10);return isNaN(c)&&(c=Number.MAX_VALUE),l!=c?l-c:t!=qi.language&&e&&(r=(a[qi.language]||a[qi.Ck])==e)!=(o=(h[qi.language]||h[qi.Ck])==e)?r?-1:1:i.o-s.o}}function Ji(){const t=window.MathJax;return t?t.Hub:null}const ts={"application/xhtml+xml":!0,"image/jpeg":!0,"image/png":!0,"image/svg+xml":!0,"image/gif":!0,"audio/mp3":!0},es="viv-id-";class ns{constructor(t,e){this.store=t,this.Pk=e,this.Tk=null,this._k=null,this.items=null,this.spine=null,this.Rk=null,this.Nk=null,this.uid=null,this.bindings={},this.lang=null,this.epageCount=0,this.Ik=!1,this.Fk=!0,this.Ak=null,this.metadata={},this.Ok=null,this.wk=null,this.cover=null,this.Kx={},this.Ix=null,this.Gf=this.Lk(),Ji()&&(z.H[E.a.MATHML]=!0)}Lk(){const t=this;return new class{Hf(t,e){const n=e+(t?`#${t}`:"");return es+E.r(n,":")}rl(e,n){const i=e.match(/^([^#]*)#?(.*)$/);if(i){const e=i[1]||n,s=i[2];if(e&&t.items.some(t=>t.src===e))return`#${this.Hf(s,e)}`}return e}$k(t){"#"===t.charAt(0)&&(t=t.substring(1)),0===t.indexOf(es)&&(t=t.substring(es.length));const e=E.J(t,":").match(/^([^#]*)#?(.*)$/);return e?[e[1],e[2]]:[]}}}getMetadata(){return this.metadata}Mk(t){if(t.startsWith("data:"))return t===this.Pk?"":t;if(this.Pk){let e=E.C("",this.Pk);return t===e||t+"/"===e?"":("/"!=e.charAt(e.length-1)&&(e+="/"),t.substr(0,e.length)==e?decodeURI(t.substr(e.length)):null)}return t}pk(t,e,n,i){const r=this;this.Tk=t,this._k=e;const o=t.doc().child("package"),a=o.attribute("unique-identifier")[0];if(a){const e=t.ey(`${t.url}#${a}`);e&&(this.uid=e.textContent.replace(/[ \n\r\t]/g,""))}const h={};this.items=o.child("manifest").child("item").Vy().map(e=>{const n=new Gi,i=e;n.yk(i,t.url);const s=i.getAttribute("fallback");return s&&!ts[n.mk]&&(h[n.src]=s),!r.wk&&n.xk.nav&&(r.wk=n),!r.cover&&n.xk["cover-image"]&&(r.cover=n),n}),this.Rk=E.w(this.items,Wi),this.Nk=E.w(this.items,t=>r.Mk(t.src));for(const t in h){let e=t;for(;;){const n=this.Rk[h[e]];if(!n)break;if(ts[n.mk]){this.Kx[t]=n.src;break}e=n.src}}this.spine=o.child("spine").child("itemref").Vy().map((t,e)=>{const n=t,i=n.getAttribute("idref"),s=r.Rk[i];return s&&(s.bk=n,s.Qi=e),s});const l=o.child("spine").attribute("toc")[0];l&&(this.Ok=this.Rk[l]);const c=o.child("spine").attribute("page-progression-direction")[0];c&&(this.Ix=function(t){switch(t){case"ltr":return s.LTR;case"rtl":return s.RTL;default:throw new Error(`unknown PageProgression: ${t}`)}}(c));const u=e?e.doc().child("encryption").child("EncryptedData").predicate(_i.zy("EncryptionMethod",_i.Uy("Algorithm","http://www.idpf.org/2008/embedding"))).child("CipherData").child("CipherReference").attribute("URI"):[],f=o.child("bindings").child("mediaType").Vy();for(let t=0;t<f.length;t++){const e=f[t].getAttribute("handler"),n=f[t].getAttribute("media-type");n&&e&&this.Rk[e]&&(this.bindings[n]=this.Rk[e].src)}if(this.metadata=function(t,e){let n;if(e){n={};for(const t in Ki)n[t]=Ki[t];let t;for(;null!=(t=e.match(/^\s*([A-Z_a-z\u007F-\uFFFF][-.A-Z_a-z0-9\u007F-\uFFFF]*):\s*(\S+)/));)e=e.substr(t[0].length),n[t[1]]=t[2]}else n=Ki;const i=t=>{if(t){const e=t.match(/^\s*(([^:]*):)?(\S+)\s*$/);if(e){const t=e[2]?n[e[2]]:Yi;if(t)return t+e[3]}}return null};let s=1;const r=t.Wy().Xy(t=>{if("meta"==t.localName){const e=i(t.getAttribute("property"));if(e)return{name:e,value:t.textContent,id:t.getAttribute("id"),order:s++,refines:t.getAttribute("refines"),lang:null,scheme:i(t.getAttribute("scheme"))}}else if(t.namespaceURI==E.a.DC)return{name:Ki.dcterms+t.localName,order:s++,lang:t.getAttribute("xml:lang"),value:t.textContent,id:t.getAttribute("id"),refines:null,scheme:null};return null}),o=E.A(r,t=>t.refines),a=t=>E.z(t,(t,e)=>t.map(t=>{const e={v:t.value,o:t.order};if(t.schema&&(e.s=t.scheme),t.id||t.lang){let n=o[t.id];if(n||t.lang){if(t.lang){const e={name:qi.language,value:t.lang,lang:null,id:null,refines:t.id,scheme:null,order:t.order};n?n.push(e):n=[e]}const i=E.A(n,t=>t.name);e.r=a(i)}}return e})),h=a(E.A(r,t=>t.refines?null:t.name));let l=null;h[qi.language]&&(l=h[qi.language][0].v);const c=t=>{for(const e in t){const n=t[e];n.sort(Zi(e,l));for(let t=0;t<n.length;t++){const e=n[t].r;e&&c(e)}}};return c(h),h}(o.child("metadata"),o.attribute("prefix")[0]),this.metadata[qi.language]&&(this.lang=this.metadata[qi.language][0].v),this.metadata[qi.layout]&&(this.Ik="pre-paginated"===this.metadata[qi.layout][0].v),!n){if(u.length>0&&this.uid){const t=function(t){const e=function(t){const e=zi(t),n=[];for(const t of e)n.push(t>>>24&255,t>>>16&255,t>>>8&255,255&t);return n}(t);return t=>{const n=X.c("deobfuscator");let i,s;return t.slice?(i=t.slice(0,1040),s=t.slice(1040,t.size)):(i=t.webkitSlice(0,1040),s=t.webkitSlice(1040,t.size-1040)),$.g(i).then(t=>{const i=new DataView(t);for(let t=0;t<i.byteLength;t++){let n=i.getUint8(t);n^=e[t%20],i.setUint8(t,n)}n.finish($.e([i,s]))}),n.result()}}(this.uid);for(let e=0;e<u.length;e++)this.store.deobfuscators[this.Pk+u[e]]=t}return this.Ik&&this.Dk(),X.d(!0)}const d=new E.d,p={};if(u.length>0&&this.uid){const t=Qi(this.uid);for(let e=0;e<u.length;e++)p[u[e]]=t}for(let t=0;t<n.length;t++){const e=n[t],i=e.n;if(i){const t=decodeURI(i),n=this.Nk[t];let s=null;n&&(n.compressed=0!=e.m,n.Ek=e.c,n.mk&&(s=n.mk.replace(/\s+/g,"")));const r=p[t];(s||r)&&(d.append(i),d.append(" "),d.append(s||"application/octet-stream"),r&&(d.append(" "),d.append(r)),d.append("\n"))}}return r.Dk(),$.c(i,$.b.DEFAULT,"POST",d.toString(),"text/plain")}Dk(){let t=0;for(const e of this.spine){const n=this.Ik?1:Math.ceil(e.Ek/1024);e.epage=t,e.epageCount=n,t+=n}this.epageCount=t,this.Ak&&this.Ak(this.epageCount)}Bk(t){this.Fk=t||this.Ik}Uk(t){if(this.Ak=t,this.Fk)return this.Ik&&0==this.epageCount&&this.Dk(),X.d(!0);let e=0,n=0;const i=X.c("countEPages");return i.Ut(t=>{if(n===this.spine.length)return void t.Vt();const i=this.spine[n++];i.epage=e,this.store.load(i.src).then(n=>{let s=1800;const r=n.lang||this.lang;r&&r.match(/^(ja|ko|zh)/)&&(s/=3),i.epageCount=Math.ceil(n.My()/s),e+=i.epageCount,this.epageCount=e,this.Ak&&this.Ak(this.epageCount),t.zt()})}).$t(i),i.result()}zk(t,e){this.Rk={},this.Nk={},this.items=[],this.spine=this.items;const n=this.Tk=new Ti(null,"",(new DOMParser).parseFromString("<spine></spine>","text/xml"));return t.forEach(t=>{const e=new Gi;e.vk(t),b.a(e.id);const i=n.document.createElement("itemref");i.setAttribute("idref",e.id),n.root.appendChild(i),e.bk=i,this.Rk[e.id]=e;let s=this.Mk(t.url);null==s&&(s=t.url),this.Nk[s]=e,this.items.push(e)}),e?this.store.gk(t[0].url,e):X.d(null)}fk(t,e){t.readingProgression&&(this.Ix=t.readingProgression),void 0===this.metadata&&(this.metadata={});const n=e&&e.title||t.name||t.metadata&&t.metadata.title;n&&(this.metadata[qi.title]=[{v:n}]);const i=this.Mk(this.Pk);if(!t.readingOrder&&e&&null!==i){t.readingOrder=[encodeURI(i)];const n="[role=doc-toc] a[href],[role=directory] a[href],nav li a[href],.toc a[href],#toc a[href]";Array.from(e.querySelectorAll(n)).forEach(e=>{const n=E.I(E.C(e.getAttribute("href"),this.Pk)),i=this.Mk(n),s=null!==i?encodeURI(i):n;-1==t.readingOrder.indexOf(s)&&t.readingOrder.push(s)})}const s=[];let r=0,o=-1;[t.readingOrder,t.resources].forEach(e=>{e instanceof Array&&e.forEach(e=>{const n=t.readingOrder.includes(e),i="string"==typeof e?e:e.url||e.href,a="string"==typeof e?"":e.Vk||e.href&&e.type||"";if(n||"text/html"===a||"application/xhtml+xml"===a||/(^|\/)([^\/]+\.(x?html|htm|xht)|[^\/.]*)([#?]|$)/.test(i)){const t={url:E.C(E.n(i),this.Pk),index:r++,startPage:null,skipPagesBefore:null};"contents"===e.rel&&-1===o&&(o=t.index),s.push(t)}})});const a=X.c("initWithWebPubManifest");return this.zk(s).then(()=>{-1!==o&&(this.wk=this.items[o]),this.wk||(this.wk=this.Nk[i]),a.finish(!0)}),a.result()}jk(t,e){const n=this.spine[t],i=X.c("getCFI");return this.store.load(n.src).then(t=>{const s=t.vm(e);let r=null;if(s){const i=t.km(s,0,!1),o=e-i,a=new A;a.Uf(s,o,!1,null),n.bk&&a.Uf(n.bk,0,!1,null),r=a.toString()}i.finish(r)}),i.result()}Xk(t){const e=this;return X.b("resolveFragment",n=>{if(!t)return void n.finish(null);let i,s=new A;if(s.Bf(t),e.Tk){const t=s.navigate(e.Tk.document);if(1!=t.node.nodeType||t.after||!t.ref)return void n.finish(null);const r=t.node,o=r.getAttribute("idref");if("itemref"!=r.localName||!o||!e.Rk[o])return void n.finish(null);i=e.Rk[o],s=t.ref}else i=e.spine[0];e.store.load(i.src).then(t=>{const e=s.navigate(t.document),r=t.km(e.node,e.offset,e.after);n.finish({Qi:i.Qi,Wk:r,jf:-1})})},(e,n)=>{l.b.warn(n,"Cannot resolve fragment:",t),e.finish(null)})}Hk(t){const e=this;return X.b("resolveEPage",n=>{if(t<=0)return void n.finish({Qi:0,Wk:0,jf:-1});if(e.Fk){let i=e.spine.findIndex(e=>0==e.epage&&0==e.epageCount||e.epage<=t&&e.epage+e.epageCount>t);-1==i&&(i=e.spine.length-1);let s=e.spine[i];s&&0!=s.epageCount||(s=e.spine[--i]);const r=Math.floor(t-s.epage);return void n.finish({Qi:i,Wk:-1,jf:r})}let i=E.i(e.spine.length,n=>{const i=e.spine[n];return i.epage+i.epageCount>t});i==e.spine.length&&i--;const s=e.spine[i];e.store.load(s.src).then(e=>{(t-=s.epage)>s.epageCount&&(t=s.epageCount);let r=0;if(t>0){const n=e.My();(r=Math.round(n*t/s.epageCount))==n&&r--}n.finish({Qi:i,Wk:r,jf:-1})})},(e,n)=>{l.b.warn(n,"Cannot resolve epage:",t),e.finish(null)})}Gk(t){const e=this.spine[t.Qi];if(this.Fk){const n=e.epage+t.jf;return X.d(n)}if(t.Wk<=0)return X.d(e.epage);const n=X.c("getEPage");return this.store.load(e.src).then(i=>{const s=i.My(),r=Math.min(s,t.Wk);n.finish(e.epage+r*e.epageCount/s)}),n.result()}}const is=(t,e)=>({page:t,position:{Qi:t.Qi,jf:e,Wk:t.offset}});class ss{constructor(t,e,n,i,s){this.opf=t,this.viewport=e,this.nv=n,this.Yk=s,this.qk=[],this.Kk=[],this.Zk=!1,this.pref=k.E(i),this.rc=new wi(e),this.Wf=new M(t.Gf)}Qk(t){const e=this.qk[t.Qi];return e?e.pages[t.jf]:null}getCurrentPageProgression(t){if(this.opf.Ix)return this.opf.Ix;{const e=this.qk[t?t.Qi:0];return e?e.instance.Ix:null}}Jk(t,e,n){e.container.style.display="none",e.container.style.visibility="visible",e.container.style.position="",e.container.style.top="",e.container.style.left="",e.container.setAttribute("data-vivliostyle-page-side",e.side);const i=t.pages[n];if(e.Yi=0==t.item.Qi&&0==n,t.pages[n]=e,this.opf.Fk){if(0==n&&t.item.Qi>0){const e=this.opf.spine[t.item.Qi-1];t.item.epage=e.epage+e.epageCount}t.item.epageCount=t.pages.length,this.opf.epageCount=this.opf.spine.reduce((t,e)=>t+e.epageCount,0),this.opf.Ak&&this.opf.Ak(this.opf.epageCount)}if(i)t.instance.viewport.Oy.replaceChild(e.container,i.container),i.dispatchEvent({type:"replaced",target:null,currentTarget:null,preventDefault:null,tS:e});else{let i=null;if(n>0)i=t.pages[n-1].container.nextElementSibling;else for(let e=t.item.Qi+1;e<this.qk.length;e++){const t=this.qk[e];if(t&&t.pages[0]){i=t.pages[0].container;break}}t.instance.viewport.Oy.insertBefore(e.container,i)}this.Yk({width:t.instance.fv,height:t.instance.av},t.instance.uv,t.item.Qi,t.instance.sv+n)}eS(t,e){const n=X.c("renderSinglePage");let i=this.sS(t,e);const s=this;return t.instance.Fv(i,e).then(r=>{const o=(e=r)?e.page-1:t.iS.length-1;s.Jk(t,i,o),s.Wf._d(i.Qi,o);let a=null;if(e){const n=t.iS[e.page];t.iS[e.page]=e,n&&t.pages[e.page]&&(e.Jn(n)||(a=s.eS(t,e)))}a||(a=X.d(!0)),a.then(()=>{const r=s.Wf.Rd(i);let a=0;n.Ut(t=>{if(++a>r.length)return void t.Vt();const e=r[a-1];e.refs=e.refs.filter(t=>!t.Xf()),0!==e.refs.length?s.nS(e.Qi).then(n=>{if(!n)return void t.zt();s.Wf.Pd(e.Vf),s.Wf.Nd(e.refs);const r=n.iS[e.jf];s.eS(n,r).then(e=>{s.Wf.Td(),s.Wf.Id();const n=e.rS.position;n.Qi===i.Qi&&n.jf===o&&(i=e.rS.page),t.zt()})}):t.zt()}).then(()=>{i.container.parentElement||(i=t.pages[o]),i.qi=!e&&t.item.Qi===s.opf.spine.length-1,i.qi&&(b.a(s.viewport),s.Wf.Fd(s.viewport)),n.finish({rS:is(i,o),oS:e})})})}),n.result()}hS(t,e){let n=t.jf,i=-1;if(n<0){i=t.Wk;const s=E.i(e.iS.length,t=>e.instance.gv(e.iS[t],!0)>i);n=s===e.iS.length?e.complete?e.iS.length-1:Number.POSITIVE_INFINITY:s-1}else n===Number.POSITIVE_INFINITY&&-1!==t.Wk&&(i=t.Wk);return{Qi:t.Qi,jf:n,Wk:i}}cS(t,e){const n=this,i=X.c("findPage");return n.nS(t.Qi).then(s=>{if(!s)return void i.finish(null);let r,o=null;i.Ut(a=>{const h=n.hS(t,s);r=h.jf,(o=s.pages[r])?a.Vt():s.complete?(r=s.iS.length-1,o=s.pages[r],a.Vt()):e?n.lS(h).then(t=>{t&&(o=t.page,r=t.position.jf),a.Vt()}):i.sleep(100).then(()=>{a.zt()})}).then(()=>{b.a(o),i.finish(is(o,r))})}),i.result()}lS(t){const e=this,n=X.c("renderPage");return e.nS(t.Qi).then(i=>{if(!i)return void n.finish(null);const s=e.hS(t,i);let r=s.jf;const o=s.Wk;let a=i.pages[r];a?n.finish(is(a,r)):n.Ut(t=>{if(r<i.iS.length)return void t.Vt();if(i.complete)return r=i.iS.length-1,void t.Vt();let n=i.iS[i.iS.length-1];e.eS(i,n).then(e=>{const s=e.rS.page;if(n=e.oS){if(o>=0&&i.instance.gv(n)>o)return a=s,r=i.iS.length-2,void t.Vt();t.zt()}else a=s,r=e.rS.position.jf,i.complete=!0,t.Vt()})}).then(()=>{a=a||i.pages[r];const t=i.iS[r];a?n.finish(is(a,r)):e.eS(i,t).then(t=>{t.oS||(i.complete=!0),n.finish(t.rS)})})}),n.result()}renderAllPages(){return this.uS({Qi:this.opf.spine.length-1,jf:Number.POSITIVE_INFINITY,Wk:-1},!1)}uS(t,e){const n=this,i=X.c("renderPagesUpto");t||(t={Qi:0,jf:0,Wk:0});const s=t.Qi,r=t.jf;let o,a=0;return e&&(a=s),i.Ut(e=>{const i={Qi:a,jf:a===s?r:Number.POSITIVE_INFINITY,Wk:a===s?t.Wk:-1};n.lS(i).then(t=>{o=t,++a>s?e.Vt():e.zt()})}).then(()=>{i.finish(o)}),i.result()}firstPage(t,e){return this.cS({Qi:0,jf:0,Wk:-1},e)}lastPage(t,e){return this.cS({Qi:this.opf.spine.length-1,jf:Number.POSITIVE_INFINITY,Wk:-1},e)}nextPage(t,e){const n=this;let i=t.Qi,s=t.jf;const r=X.c("nextPage");return n.nS(i).then(t=>{if(t){if(t.complete&&s==t.iS.length-1){if(i>=n.opf.spine.length-1)return void r.finish(null);i++,s=0;const e=this.qk[i],o=e&&e.pages[0],a=t.pages[t.pages.length-1];o&&a&&o.side==a.side&&(e.pages.forEach(t=>{t.container&&t.container.remove()}),this.qk[i]=null,this.Kk[i]=null)}else s++;n.cS({Qi:i,jf:s,Wk:-1},e).$t(r)}else r.finish(null)}),r.result()}previousPage(t,e){let n=t.Qi,i=t.jf;if(0==i){if(0==n)return X.d(null);n--,i=Number.POSITIVE_INFINITY}else i--;return this.cS({Qi:n,jf:i,Wk:-1},e)}aS(t,e){const n=t.side===r.LEFT,i=this.getCurrentPageProgression(e)===s.LTR;return!n&&i||n&&!i}fS(t,e){const n=X.c("getCurrentSpread"),i=this.Qk(t);if(!i)return X.d({left:null,right:null});const s=i.side===r.LEFT;let o;return(o=this.aS(i,t)?this.previousPage(t,e):this.nextPage(t,e)).then(e=>{const i=this.Qk(t);let r=e&&e.page;r&&r.side===i.side&&(r=null),s?n.finish({left:i,right:r}):n.finish({left:r,right:i})}),n.result()}dS(t,e){const n=this.Qk(t);if(!n)return X.d(null);const i=this.aS(n,t),s=this.nextPage(t,e);if(i)return s;{const t=this;return s.Ot(i=>{if(i){if(i.page.side===n.side)return s;const r=t.nextPage(i.position,e);return r.Ot(t=>t?r:s)}return X.d(null)})}}pS(t,e){const n=this.Qk(t);if(!n)return X.d(null);const i=this.aS(n,t),s=this.previousPage(t,e),r=n.container.previousElementSibling;if(i){const t=this;return s.Ot(i=>i?i.page.side===n.side?s:i.page.container!==r?s:t.previousPage(i.position,e):X.d(null))}return s}wS(t,e,n){const i=X.c("navigateToEPage"),s=this;return this.opf.Hk(t).then(t=>{t?s.cS(t,n).$t(i):i.finish(null)}),i.result()}gS(t,e,n){const i=X.c("navigateToCFI"),s=this;return s.opf.Xk(t).then(t=>{t?s.cS(t,n).$t(i):i.finish(null)}),i.result()}mS(t,e,n){l.b.debug("Navigate to",t);let i=this.opf.Mk(E.I(t));if(!i){if(this.opf.Tk&&t.match(/^#epubcfi\(/))i=this.opf.Mk(this.opf.Tk.url);else if("#"===t.charAt(0)){const e=this.opf.Gf.$k(t);this.opf.Tk?null==(i=this.opf.Mk(e[0]))&&(i=e[0]):i=e[0],t=i+(e[1]?`#${e[1]}`:"")}if(null==i)return X.d(null)}const s=this.opf.Nk[i];if(!s){if(this.opf.Tk&&i==this.opf.Mk(this.opf.Tk.url)){const i=t.indexOf("#");if(i>=0)return this.gS(t.substr(i+1),e,n)}return X.d(null)}const r=X.c("navigateTo"),o=this;return o.nS(s.Qi).then(i=>{if(!i)return void r.finish(null);const a=i.xmldoc.ey(t);a?o.cS({Qi:s.Qi,jf:-1,Wk:i.xmldoc.Aw(a)},n).$t(r):e.Qi!==s.Qi?o.cS({Qi:s.Qi,jf:0,Wk:-1},n).$t(r):r.finish(null)}),r.result()}sS(t,e){const n=t.instance.viewport,s=n.document.createElement("div");s.setAttribute("data-vivliostyle-page-container","true"),s.setAttribute("role","region"),s.style.position="absolute",s.style.top="0",s.style.left="0",i||(s.style.visibility="hidden",s.setAttribute("aria-hidden","true")),n.Iy.appendChild(s);const r=n.document.createElement("div");r.setAttribute("data-vivliostyle-bleed-box","true"),s.appendChild(r);const o=new G.l(s,r);if(o.Qi=t.item.Qi,o.position=e,o.offset=t.instance.gv(e),0===o.offset){const e=this.opf.Gf.Hf("",t.item.src);r.setAttribute("id",e),o.rn(r,e)}if(n!==this.viewport){const t=k.L(this.viewport.width,this.viewport.height,n.width,n.height),e=B.m(null,new V.b(t,null),"");o.Hi.push(new G.d(s,"transform",e))}return o}bS(t,e,n,i){let s=e.getAttribute("data"),r=null;if(s){s=E.C(s,t.url);let n=e.getAttribute("media-type");if(!n){const t=this.opf.Mk(s);if(t){const e=this.opf.Nk[t];e&&(n=e.mk)}}if(n){const t=this.opf.bindings[n];if(t){(r=this.viewport.document.createElement("iframe")).style.border="none";const i=E.y(s),o=E.y(n),a=new E.d;a.append(t),a.append("?src="),a.append(i),a.append("&type="),a.append(o);for(let t=e.firstChild;t;t=t.nextSibling)if(1==t.nodeType){const e=t;if("param"==e.localName&&e.namespaceURI==E.a.XHTML){const t=e.getAttribute("name"),n=e.getAttribute("value");t&&n&&(a.append("&"),a.append(encodeURIComponent(t)),a.append("="),a.append(encodeURIComponent(n)))}}r.setAttribute("src",a.toString());const h=e.getAttribute("width");h&&r.setAttribute("width",h);const l=e.getAttribute("height");l&&r.setAttribute("height",l)}}}return r||(r=this.viewport.document.createElement("span")).setAttribute("data-adapt-process-children","true"),X.d(r)}ES(t,e,n,i){const s=Ji();if(s){const i=n.ownerDocument,r=i.createElement("span");n.appendChild(r);const o=i.importNode(e,!0);this.xS(o,t),r.appendChild(o);const a=s.queue;a.Push(["Typeset",s,r]);const h=X.c("makeMathJaxView"),l=h.suspend();return a.Push(()=>{l.schedule(r)}),h.result()}return X.d(null)}xS(t,e){if(null!=t){if(1===t.nodeType&&"mglyph"===t.tagName){const n=t.attributes;for(const i of n){if("src"!==i.name)continue;const n=E.C(i.nodeValue,e.url);i.namespaceURI?t.setAttributeNS(i.namespaceURI,i.name,n):t.setAttribute(i.name,n)}}t.firstChild&&this.xS(t.firstChild,e),t.nextSibling&&this.xS(t.nextSibling,e)}}yS(t,e,n,i){const s=n?n.ownerDocument:this.viewport.document,r=e.localName;let o;switch(r){case"t":case"tab":case"ec":case"nt":case"fraction":case"comment":case"mark":o="span";break;case"ruby":case"rp":case"rt":o=r;break;default:o="div"}const a=s.createElement(o);return a.setAttribute("data-adapt-process-children","true"),X.d(a)}Zv(t){const e=this;return(n,i,s)=>"object"==n.localName&&n.namespaceURI==E.a.XHTML?e.bS(t,n,i,s):n.namespaceURI==E.a.MATHML?e.ES(t,n,i,s):n.namespaceURI==E.a.SSE?e.yS(t,n,i,s):n.dataset&&"true"==n.dataset.mathTypeset?e.ES(t,n,i,s):X.d(null)}nS(t){const e=this;if(-1===t||t>=e.opf.spine.length)return X.d(null);let n=e.qk[t];if(n)return X.d(n);const i=X.c("getPageViewItem");let s=this.Kk[t];if(s){const t=i.suspend();return s.push(t),i.result()}s=this.Kk[t]=[];const r=e.opf.spine[t],o=e.opf.store;return o.load(r.src).then(a=>{r.title=a.document.title;const h=o.pv(a),l=e.Zv(a);let c=e.viewport;const u=h.iv(c.width,c.height,c.fontSize,e.pref);u.width==c.width&&u.height==c.height&&u.fontSize==c.fontSize||(c=new vi(c.window,u.fontSize,c.root,u.width,u.height));const f=e.qk[t-1];let d;null!==r.startPage?d=r.startPage-1:(!(t>0)||f&&f.complete?d=f?f.instance.sv+f.pages.length:0:(d=r.epage||t,e.opf.Ik||d%2!=0||d++),null!==r.skipPagesBefore&&(d+=r.skipPagesBefore)),e.Wf.Sd(d);const p=new ki(h,a,e.opf.lang,c,e.rc,e.nv,l,e.opf.Kx,d,e.opf.Gf,e.Wf,e.opf.Ix);p.pref=e.pref;const g=e.opf.metadata&&e.opf.metadata[qi.title];p.Kt=g&&g[0]&&g[0].v||"",p.docTitle=r.title||"",p.init().then(()=>{n={item:r,xmldoc:a,instance:p,iS:[null],pages:[],complete:!1},e.qk[t]=n,i.finish(n),s.forEach(t=>{t.schedule(n)})})}),i.result()}vS(){const t=this.qk;for(const e of t)e&&e.pages.splice(0);this.viewport.clear()}kS(){const t=this.qk;for(const e of t)if(e){const t=e.pages;for(const e of t)if(e.Ki&&e.Zi)return!0}return!1}SS(){return this.qk.some(t=>t&&t.pages.length>0)}showTOC(t){const e=this.opf,n=e.wk||e.Ok;if(this.Zk=t,!n)return X.d(null);if(this.CS&&this.CS.page)return this.CS.page.container.style.visibility="visible",this.CS.page.container.setAttribute("aria-hidden","false"),X.d(this.CS.page);const i=X.c("showTOC");this.CS||(this.CS=new Hi(e.store,n.src,e.lang,this.rc,this.nv,this.pref,this,e.Kx,e.Gf,this.Wf));const s=this.viewport,r=Math.min(350,Math.round(.67*s.width)-16),o=s.height-6,a=s.document.createElement("div");return s.root.appendChild(a),a.style.visibility="hidden",a.style.width=`${r+10}px`,a.style.maxHeight=`${o}px`,a.setAttribute("data-vivliostyle-toc-box","true"),a.setAttribute("role","navigation"),this.CS.showTOC(a,s,r,o,this.viewport.fontSize).then(t=>{a.style.visibility="visible",a.setAttribute("aria-hidden","false"),i.finish(t)}),i.result()}Qv(){this.CS&&this.CS.Qv()}isTOCVisible(){return!!this.CS&&this.CS.isTOCVisible()}}const rs="data-vivliostyle-viewer-status",os="data-vivliostyle-spread-view";var as,hs;!function(t){t.SINGLE_PAGE="singlePage",t.SPREAD="spread",t.AUTO_SPREAD="autoSpread"}(as||(as={}));class ls{constructor(t,e,n,s){this.window=t,this.viewportElement=e,this.PS=n,this.TS=s,this._S=!1,this.RS=null;const r=this;e.setAttribute("data-vivliostyle-viewer-viewport",!0),i&&e.setAttribute("data-vivliostyle-debug",!0),e.setAttribute(rs,"loading");const o=t.document;this.nv=new We(o.head,e),this.init(),this.kick=(()=>{}),this.NS=(()=>{}),this.IS=(()=>{r.FS=!0,r.kick()}),this.AS=this.AS.bind(this),this.OS=(t=>{}),this.LS=o.getElementById("vivliostyle-page-rules"),this.actions={loadPublication:this.loadPublication,loadXML:this.loadXML,configure:this.configure,moveTo:this.moveTo,toc:this.showTOC},this.$S()}init(){this.readyState=o.LOADING,this.MS=[],this.opf=null,this.DS=!1,this.BS=!1,this.US=0,this.zS=0,this.FS=!1,this.VS=!1,this.jS=null,this.currentPage=null,this.XS=null,this.WS=null,this.fontSize=16,this.zoom=1,this.fitToScreen=!1,this.pageViewMode=as.SINGLE_PAGE,this.HS=!1,this.renderAllPages=!0,this.pref=k.F(),this.GS=[]}$S(){const t=l.a;l.b.addListener(t.DEBUG,t=>{this.callback({t:"debug",content:t})}),l.b.addListener(t.INFO,t=>{this.callback({t:"info",content:t})}),l.b.addListener(t.WARN,t=>{this.callback({t:"warn",content:t})}),l.b.addListener(t.ERROR,t=>{this.callback({t:"error",content:t})})}callback(t){t.i=this.PS,this.TS(t)}YS(t){this.readyState!==t&&(this.readyState=t,this.viewportElement.setAttribute(rs,t),this.callback({t:"readystatechange"}))}loadPublication(t){g.registerStartTiming("beforeRender"),this.YS(o.LOADING);const e=t.url,n=t.fragment,i=!!t.zipmeta,s=t.authorStyleSheet,r=t.userStyleSheet;this.viewport=null;const a=X.c("loadPublication"),h=this;return h.configure(t).then(()=>{const t=new Xi;t.init(s,r).then(()=>{const s=E.C(E.n(e),h.window.location.href);h.MS=[s],t.lk(s,i).then(t=>{t?(h.opf=t,h.render(n).then(()=>{a.finish(!0)})):a.finish(!1)})})}),a.result()}loadXML(t){g.registerStartTiming("beforeRender"),this.YS(o.LOADING);const e=t.url,n=t.document,i=t.fragment,s=t.authorStyleSheet,r=t.userStyleSheet;this.viewport=null;const a=X.c("loadXML"),h=this;return h.configure(t).then(()=>{const t=new Xi;t.init(s,r).then(()=>{const s=e.map((t,e)=>({url:E.C(E.n(t.url),h.window.location.href),index:e,startPage:t.startPage,skipPagesBefore:t.skipPagesBefore}));h.MS=s.map(t=>t.url),h.opf=new ns(t,""),h.opf.zk(s,n).then(()=>{h.render(i).then(()=>{a.finish(!0)})})})}),a.result()}render(t){this.qS();const e=this;let n;return(n=t?this.opf.Xk(t).Ot(t=>(e.WS=t,X.d(!0))):X.d(!0)).Ot(()=>(g.registerEndTiming("beforeRender"),e.resize()))}KS(t){const e=parseFloat(t);let n;if("string"==typeof t&&(n=t.match(/[a-z]+$/))){const t=n[0];if("em"===t||"rem"===t)return e*this.fontSize;if("ex"===t)return e*k.G.ex*this.fontSize/k.G.em;const i=k.G[t];if(i)return e*i}return e}configure(t){if("boolean"==typeof t.autoresize&&(t.autoresize?(this.jS=null,this.window.addEventListener("resize",this.IS,!1),this.FS=!0):this.window.removeEventListener("resize",this.IS,!1)),"number"==typeof t.fontSize){const e=t.fontSize;e>=5&&e<=72&&this.fontSize!=e&&(this.fontSize=e,this.FS=!0)}if("object"==typeof t.viewport&&t.viewport){const e=t.viewport,n={marginLeft:this.KS(e["margin-left"])||0,marginRight:this.KS(e["margin-right"])||0,marginTop:this.KS(e["margin-top"])||0,marginBottom:this.KS(e["margin-bottom"])||0,width:this.KS(e.width)||0,height:this.KS(e.height)||0};(n.width>=200||n.height>=200)&&(this.window.removeEventListener("resize",this.IS,!1),this.jS=n,this.FS=!0)}return"boolean"==typeof t.hyphenate&&(this.pref.hyphenate=t.hyphenate,this.FS=!0),"boolean"==typeof t.horizontal&&(this.pref.horizontal=t.horizontal,this.FS=!0),"boolean"==typeof t.nightMode&&(this.pref.nightMode=t.nightMode,this.FS=!0),"number"==typeof t.lineHeight&&(this.pref.lineHeight=t.lineHeight,this.FS=!0),"number"==typeof t.columnWidth&&(this.pref.columnWidth=t.columnWidth,this.FS=!0),"string"==typeof t.fontFamily&&(this.pref.fontFamily=t.fontFamily,this.FS=!0),"boolean"==typeof t.load&&(this.HS=t.load),"boolean"==typeof t.renderAllPages&&(this.renderAllPages=t.renderAllPages),"string"==typeof t.userAgentRootURL&&(E.E(t.userAgentRootURL.replace(/resources\/?$/,"")),E.G(t.userAgentRootURL)),"string"==typeof t.rootURL&&(E.E(t.rootURL),E.G(`${E.h}resources/`)),"string"==typeof t.pageViewMode&&t.pageViewMode!==this.pageViewMode&&(this.pageViewMode=t.pageViewMode,this.FS=!0),"number"==typeof t.pageBorder&&t.pageBorder!==this.pref.pageBorder&&(this.viewport=null,this.pref.pageBorder=t.pageBorder,this.FS=!0),"number"==typeof t.zoom&&t.zoom!==this.zoom&&(this.zoom=t.zoom,this.VS=!0),"boolean"==typeof t.fitToScreen&&t.fitToScreen!==this.fitToScreen&&(this.fitToScreen=t.fitToScreen,this.VS=!0),"object"==typeof t.defaultPaperSize&&"number"==typeof t.defaultPaperSize.width&&"number"==typeof t.defaultPaperSize.height&&(this.viewport=null,this.pref.defaultPaperSize=t.defaultPaperSize,this.FS=!0),this.ZS(t),X.d(!0)}ZS(t){h.b(h.a.CONFIGURATION).forEach(e=>{const n=e(t);this.FS=n.FS||this.FS,this.VS=n.VS||this.VS})}AS(t){const e=this.currentPage,n=this.XS,i=t.target;n?n.left!==i&&n.right!==i||this.QS(t.tS):e===t.target&&this.QS(t.tS)}JS(t){const e=[];this.currentPage&&e.push(this.currentPage),this.XS&&(e.push(this.XS.left),e.push(this.XS.right)),e.forEach(e=>{e&&t(e)})}tC(){this.JS(t=>{t.removeEventListener("hyperlink",this.OS,!1),t.removeEventListener("replaced",this.AS,!1)})}eC(){this.tC(),this.JS(t=>{E.F(t.container,"display","none"),t.container.setAttribute("aria-hidden","true")}),this.currentPage=null,this.XS=null}sC(t){t.addEventListener("hyperlink",this.OS,!1),t.addEventListener("replaced",this.AS,!1),E.F(t.container,"visibility","visible"),E.F(t.container,"display","block"),t.container.setAttribute("aria-hidden","false")}iC(t){this.eC(),this.currentPage=t,t.container.style.marginLeft="",t.container.style.marginRight="",this.sC(t)}nC(t){if(this.eC(),this.XS=t,t.left&&t.right){let e=parseFloat(t.left.container.style.width),n=parseFloat(t.right.container.style.width);e&&n&&e!==n&&(e<n?t.left.container.style.marginLeft=`${n-e}px`:t.right.container.style.marginRight=`${e-n}px`)}t.left&&(this.sC(t.left),t.right?t.left.container.removeAttribute("data-vivliostyle-unpaired-page"):t.left.container.setAttribute("data-vivliostyle-unpaired-page",!0)),t.right&&(this.sC(t.right),t.left?t.right.container.removeAttribute("data-vivliostyle-unpaired-page"):t.right.container.setAttribute("data-vivliostyle-unpaired-page",!0))}rC(){const t=X.c("reportPosition"),e=this;return b.a(e.WS),e.opf.jk(this.WS.Qi,this.WS.Wk).then(n=>{const i=e.currentPage;(e.HS&&i.fetchers.length>0?oe.c(i.fetchers):X.d(!0)).then(()=>{e.oC(i,n).$t(t)})}),t.result()}hC(){const t=this.viewportElement;if(this.jS){const e=this.jS;return t.style.marginLeft=`${e.marginLeft}px`,t.style.marginRight=`${e.marginRight}px`,t.style.marginTop=`${e.marginTop}px`,t.style.marginBottom=`${e.marginBottom}px`,new vi(this.window,this.fontSize,t,e.width,e.height)}return new vi(this.window,this.fontSize,t)}cC(t){switch(this.pageViewMode){case as.SINGLE_PAGE:return!1;case as.SPREAD:return!0;case as.AUTO_SPREAD:default:return t.width/t.height>=1.45&&t.width>800}}lC(t){this.pref.jt=t,this.viewportElement.setAttribute(os,t.toString())}uC(){const t=this.hC(),e=this.cC(t),n=this.pref.jt!==e;return this.lC(e),!(this.jS||!this.viewport||this.viewport.fontSize!=this.fontSize||(n||t.width!=this.viewport.width||t.height!=this.viewport.height)&&(n||t.width!=this.viewport.width||t.height==this.viewport.height||!/Android|iPhone|iPad|iPod/.test(navigator.userAgent))&&(!this.aC||!this.aC.SS()||this.aC.kS()||(this.viewport.width=t.width,this.viewport.height=t.height,this.VS=!0,0)))}fC(t,e,n,i){this.GS[i]=t,this.dC(e,n,i)}dC(t,e,n){if(!this._S&&this.LS){let e="";Object.keys(t).forEach(n=>{e+=`@page ${n}{margin:0;size:`;const i=t[n];e+=`${i.width}px ${i.height}px;}`}),this.LS.textContent=e,this._S=!0}}pC(){this.LS&&(this.LS.textContent="",this._S=!1)}reset(){let t=!1,e=!1;this.aC&&(t=this.aC.isTOCVisible(),e=this.aC.Zk,this.aC.Qv(),this.aC.vS()),this.pC(),this.viewport=this.hC(),this.viewport.Ly(),this.aC=new ss(this.opf,this.viewport,this.nv,this.pref,this.fC.bind(this)),t&&this.NS({a:"toc",v:"show",autohide:e})}QS(t,e){this.VS=!1,this.tC();const n=this;return this.pref.jt?this.aC.fS(this.WS,e).Ot(e=>(n.nC(e),n.wC(e),n.currentPage=t,X.d(null))):(this.iC(t),this.gC(t),this.currentPage=t,X.d(null))}gC(t){const e=this.mC(t.dimensions);this.viewport.zoom(t.dimensions.width,t.dimensions.height,e)}wC(t){const e=this.bC(t);this.viewport.zoom(e.width,e.height,this.mC(e))}mC(t){return this.fitToScreen?this.EC(t):this.zoom}bC(t){let e=0,n=0;return t.left&&(e+=t.left.dimensions.width,n=t.left.dimensions.height),t.right&&(e+=t.right.dimensions.width,n=Math.max(n,t.right.dimensions.height)),t.left&&t.right&&(e+=2*this.pref.pageBorder,e+=Math.abs(t.left.dimensions.width-t.right.dimensions.width)),{width:e,height:n}}queryZoomFactor(t){if(!this.currentPage)throw new Error("no page exists.");switch(t){case hs.FIT_INSIDE_VIEWPORT:{let t;return this.pref.jt?(b.a(this.XS),t=this.bC(this.XS)):t=this.currentPage.dimensions,this.EC(t)}default:throw new Error(`unknown zoom type: ${t}`)}}EC(t){const e=this.viewport.width/t.width,n=this.viewport.height/t.height;return Math.min(e,n)}qS(){this.RS&&this.RS.interrupt(new cs),this.RS=null}resize(){if(this.FS=!1,this.VS=!1,this.uC())return X.d(!0);const t=this;this.YS(o.LOADING),this.qS();const e=X.a().bt().run(()=>X.b("resize",n=>{t.opf?(t.RS=e,g.registerStartTiming("render (resize)"),t.reset(),t.WS&&(0==t.WS.jf&&0==t.WS.Wk||(t.WS.jf=-1)),t.opf.Bk(t.renderAllPages),t.aC.uS(t.WS,!t.renderAllPages).then(i=>{i?(t.WS=i.position,t.QS(i.page,!0).then(()=>{t.YS(o.INTERACTIVE),t.opf.Uk(e=>{const n={t:"nav",epageCount:e,first:t.currentPage.Yi,last:t.currentPage.qi,metadata:t.opf.metadata,docTitle:t.opf.spine[t.WS.Qi].title};(t.currentPage.Yi||0==t.WS.jf&&t.opf.spine[t.WS.Qi].epage)&&(n.epage=t.opf.spine[t.WS.Qi].epage),t.callback(n)}).then(()=>{t.rC().then(i=>{(t.renderAllPages?t.aC.renderAllPages():X.d(null)).then(()=>{t.RS===e&&(t.RS=null),g.registerEndTiming("render (resize)"),t.renderAllPages&&t.YS(o.COMPLETE),t.callback({t:"loaded"}),n.finish(i)})})})})):n.finish(!1)})):n.finish(!1)},(t,e)=>{if(!(e instanceof cs))throw e;g.registerEndTiming("render (resize)"),l.b.debug(e.message)}));return X.d(!0)}oC(t,e){const n=X.c("sendLocationNotification"),i={t:"nav",first:t.Yi,last:t.qi,metadata:this.opf.metadata,docTitle:this.opf.spine[t.Qi].title},s=this;return this.opf.Gk(s.WS).then(t=>{i.epage=t,i.epageCount=s.opf.epageCount,e&&(i.cfi=e),s.callback(i),n.finish(!0)}),n.result()}getCurrentPageProgression(){return this.aC?this.aC.getCurrentPageProgression(this.WS):null}moveTo(t){let e;const n=this;if(this.readyState!==o.COMPLETE&&"next"!==t.where&&this.YS(o.LOADING),"string"==typeof t.where){let i;switch(t.where){case"next":i=this.pref.jt?this.aC.dS:this.aC.nextPage;break;case"previous":i=this.pref.jt?this.aC.pS:this.aC.previousPage;break;case"last":i=this.aC.lastPage;break;case"first":i=this.aC.firstPage;break;default:return X.d(!0)}i&&(e=(()=>i.call(n.aC,n.WS,!n.renderAllPages)))}else if("number"==typeof t.epage){const i=t.epage;e=(()=>n.aC.wS(i,n.WS,!n.renderAllPages))}else{if("string"!=typeof t.url)return X.d(!0);{const i=t.url;e=(()=>n.aC.mS(i,n.WS,!n.renderAllPages))}}const i=X.c("moveTo");return e.call(n.aC).then(t=>{let e;if(t){n.WS=t.position;const i=X.c("moveTo.showCurrent");e=i.result(),n.QS(t.page,!n.renderAllPages).then(()=>{n.rC().$t(i)})}else e=X.d(!0);e.then(t=>{n.readyState===o.LOADING&&n.YS(o.INTERACTIVE),i.finish(t)})}),i.result()}showTOC(t){const e=!!t.autohide,n=t.v,i=this.aC.isTOCVisible(),s=e!=this.aC.Zk&&"hide"!=n;if(i){if("show"==n&&!s)return X.d(!0)}else if("hide"==n)return X.d(!0);if(i&&"show"!=n)return this.aC.Qv(),X.d(!0);{const t=this,n=X.c("showTOC");return this.aC.showTOC(e).then(i=>{if(i){if(s&&(i.listeners={}),e){const e=()=>{t.aC.Qv()};i.addEventListener("hyperlink",e,!1)}i.addEventListener("hyperlink",t.OS,!1)}n.finish(!0)}),n.result()}}xC(t){const e=this,n=t.a||"";return X.b("runCommand",i=>{const s=e.actions[n];s?s.call(e,t).then(()=>{e.callback({t:"done",a:n}),i.finish(!0)}):(l.b.error("No such action:",n),i.finish(!0))},(t,e)=>{l.b.error(e,"Error during action:",n),t.finish(!0)})}yC(t){let e=us(t),n=null;const i=this;X.e(()=>{const t=X.c("commandLoop"),s=X.a().bt();return i.OS=(t=>{const e=t,n="#"===e.href.charAt(0)||i.MS.some(t=>e.href.substr(0,t.length)==t);if(n){t.preventDefault();const r={t:"hyperlink",href:e.href,internal:n};s.run(()=>(i.callback(r),X.d(!0)))}}),t.Ut(t=>{if(i.FS)i.resize().then(()=>{t.zt()});else if(i.VS)i.currentPage&&i.QS(i.currentPage).then(()=>{t.zt()});else if(e){const n=e;e=null,i.xC(n).then(()=>{t.zt()})}else{const e=X.c("waitForCommand");n=e.suspend(self),e.result().then(()=>{t.zt()})}}).$t(t),t.result()}),i.kick=(()=>{const t=n;t&&(n=null,t.schedule(!0))}),i.NS=(t=>!e&&(e=us(t),i.kick(),!0)),this.window.adapt_command=i.NS}}(hs||(hs={})).FIT_INSIDE_VIEWPORT="fit inside viewport";class cs extends Error{constructor(){super(),this.name="RenderingCanceledError",this.message="Page rendering has been canceled",this.stack=(new Error).stack}}function us(t){return"string"==typeof t?E.H(t):t}const fs=s;function ds(t){const e={};return Object.keys(t).forEach(n=>{const i=t[n];switch(n){case"autoResize":e.autoresize=i;break;case"pageBorderWidth":e.pageBorder=i;break;default:e[n]=i}}),e}function ps(t){function e(t){return"number"==typeof t?t:null}function n(t){return"string"==typeof t?{url:t,startPage:null,skipPagesBefore:null}:{url:t.url,startPage:e(t.startPage),skipPagesBefore:e(t.skipPagesBefore)}}return Array.isArray(t)?t.map(n):t?[n(t)]:null}var gs;!function(t){t.PREVIOUS="previous",t.NEXT="next",t.LEFT="left",t.RIGHT="right",t.FIRST="first",t.LAST="last",t.EPAGE="epage"}(gs||(gs={}));const ms=as,bs={Viewer:class{constructor(t,e){var n;this.settings=t,this.initialized=!1,n=t.debug,i=n,this.viewer_=new ls(t.window||window,t.viewportElement,"main",this.dispatcher.bind(this)),this.options={vC:!0,fontSize:16,kC:1,renderAllPages:!0,pageViewMode:ms.AUTO_SPREAD,zoom:1,fitToScreen:!1,defaultPaperSize:void 0},e&&this.setOptions(e),this.SC=new E.c,Object.defineProperty(this,"readyState",{get(){return this.viewer_.readyState}})}setOptions(t){const e=Object.assign({a:"configure"},ds(t));this.viewer_.NS(e),Object.assign(this.options,t)}dispatcher(t){const e={type:t.t},n=t;Object.keys(n).forEach(t=>{"t"!==t&&(e[t]=n[t])}),this.SC.dispatchEvent(e)}addListener(t,e){this.SC.addEventListener(t,e,!1)}removeListener(t,e){this.SC.removeEventListener(t,e,!1)}loadDocument(t,e,n){t||this.SC.dispatchEvent({type:"error",content:"No URL specified"}),this.CC(t,null,e,n)}loadPublication(t,e,n){t||this.SC.dispatchEvent({type:"error",content:"No URL specified"}),this.CC(null,t,e,n)}CC(t,e,n,i){const s=n||{};function r(t){return t?t.map(t=>({url:t.url||null,text:t.text||null})):void 0}const o=r(s.authorStyleSheet),a=r(s.userStyleSheet);i&&Object.assign(this.options,i);const h=Object.assign({a:t?"loadXML":"loadPublication",userAgentRootURL:this.settings.userAgentRootURL,url:ps(t)||e,document:s.documentObject,fragment:s.fragment,authorStyleSheet:o,userStyleSheet:a},ds(this.options));this.initialized?this.viewer_.NS(h):(this.initialized=!0,this.viewer_.yC(h))}getCurrentPageProgression(){return this.viewer_.getCurrentPageProgression()}PC(t){switch(t){case gs.LEFT:return this.getCurrentPageProgression()===fs.LTR?gs.PREVIOUS:gs.NEXT;case gs.RIGHT:return this.getCurrentPageProgression()===fs.LTR?gs.NEXT:gs.PREVIOUS;default:return t}}navigateToPage(t,e){t===gs.EPAGE?this.viewer_.NS({a:"moveTo",epage:e}):this.viewer_.NS({a:"moveTo",where:this.PC(t)})}navigateToInternalUrl(t){this.viewer_.NS({a:"moveTo",url:t})}isTOCVisible(){return this.viewer_.aC&&this.viewer_.aC.opf&&(this.viewer_.aC.opf.wk||this.viewer_.aC.opf.Ok)?!!this.viewer_.aC.isTOCVisible():null}showTOC(t,e){const n=null==t?"toggle":t?"show":"hide";this.viewer_.NS({a:"toc",v:n,autohide:e})}queryZoomFactor(t){return this.viewer_.queryZoomFactor(t)}getPageSizes(){return this.viewer_.GS}},PageViewMode:ms,ZoomType:hs};g.Of("load_vivliostyle"),e.default={constants:a,plugin:h.c,profile:m,viewer:bs}}]).default},"object"==typeof n&&"object"==typeof e?e.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof n?n.vivliostyle=s():i.vivliostyle=s()},{}],3:[function(t,e,n){"use strict";var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o="ontouchstart"in window;r.default.bindingHandlers.menuButton={init:function(t,e){r.default.unwrap(e())&&(o?(t.addEventListener("touchstart",function(){r.default.utils.toggleDomNodeCssClass(t,"hover active",!0)}),t.addEventListener("touchend",function(){r.default.utils.toggleDomNodeCssClass(t,"hover active",!1)})):(t.addEventListener("mouseover",function(){r.default.utils.toggleDomNodeCssClass(t,"hover",!0)}),t.addEventListener("mousedown",function(){r.default.utils.toggleDomNodeCssClass(t,"active",!0)}),t.addEventListener("mouseup",function(){r.default.utils.toggleDomNodeCssClass(t,"active",!1)}),t.addEventListener("mouseout",function(){r.default.utils.toggleDomNodeCssClass(t,"hover",!1),r.default.utils.toggleDomNodeCssClass(t,"active",!1),window.getSelection().removeAllRanges()})))}}},{knockout:1}],4:[function(t,e,n){"use strict";var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o="ontouchstart"in window,a=null,h=null,l=null;r.default.bindingHandlers.swipePages={init:function(t,e){o&&r.default.unwrap(e())&&(t.addEventListener("touchstart",function(t){if(!(t.touches.length>1||window.visualViewport&&window.visualViewport.scale>1)){var e=document.getElementById("vivliostyle-viewer-viewport");e&&e.scrollWidth>e.clientWidth||(a=t.touches[0].clientX,h=t.touches[0].clientY)}}),t.addEventListener("touchmove",function(t){if(!(t.touches.length>1)&&null!==a&&null!==h){var e=t.touches[0].clientX-a,n=t.touches[0].clientY-h;Math.abs(e)>Math.abs(n)&&(l=e<0?document.getElementById("vivliostyle-page-navigation-right"):document.getElementById("vivliostyle-page-navigation-left")),Math.abs(e)+Math.abs(n)>=16&&(l&&(l.click(),r.default.utils.toggleDomNodeCssClass(l,"active",!0)),a=null,h=null)}}),t.addEventListener("touchend",function(t){l&&r.default.utils.toggleDomNodeCssClass(l,"active",!1),l=null,a=null,h=null}))}}},{knockout:1}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../models/message-queue"),o=(s=r)&&s.__esModule?s:{default:s},a={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logLevel=a.ERROR}return i(t,[{key:"setLogLevel",value:function(t){this.logLevel=t}},{key:"debug",value:function(t){this.logLevel===a.DEBUG&&o.default.push({type:"debug",content:t})}},{key:"info",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO||o.default.push({type:"info",content:t})}},{key:"warn",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN||o.default.push({type:"warn",content:t})}},{key:"error",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN&&this.logLevel!==a.ERROR||o.default.push({type:"error",content:t})}}]),t}();h.LogLevel=a;var l=new h;h.getLogger=function(){return l},n.default=h,e.exports=n.default},{"../models/message-queue":8}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var s=i(t("vivliostyle")),r=i(t("./models/vivliostyle")),o=i(t("./vivliostyle-viewer"));r.default.setInstance(s.default),o.default.start()},{"./models/vivliostyle":12,"./vivliostyle-viewer":23,vivliostyle:2}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../stores/url-parameters")),a=s(t("./page-style")),h=s(t("../utils/string-util"));var l=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n,i,s,h,l,c=(n=o.default.getParameter("b"),i=o.default.getParameter("x"),s=o.default.getParameter("f"),h=o.default.getParameter("style"),l=o.default.getParameter("userStyle"),{bookUrl:n[0]||null,xUrl:!n[0]&&i.length&&i[0]?i:null,fragment:s[0]||null,authorStyleSheet:h.length?h:[],userStyleSheet:l.length?l:[]});this.bookUrl=r.default.observable(c.bookUrl||""),this.xUrl=r.default.observable(c.xUrl||null),this.fragment=r.default.observable(c.fragment||""),this.authorStyleSheet=r.default.observable(c.authorStyleSheet),this.userStyleSheet=r.default.observable(c.userStyleSheet),this.pageStyle=new a.default,this.dataUserStyleIndex=-1,this.fragment.subscribe(function(t){if(/^epubcfi\(\/([246]\/)?2!\)/.test(t))o.default.removeParameter("f");else{var e=t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent);o.default.setParameter("f",e)}}),c.userStyleSheet.find(function(t,n){if(/^data:,.*?\/\*(?:<|%3C)viewer(?:>|%3E)\*\//.test(t)){e.dataUserStyleIndex=n;var i=t.replace(/^data:,/,"").replace(/%(?![0-9A-Fa-f]{2})/g,"%25"),s=decodeURIComponent(i);return e.pageStyle.cssText(s),!0}return!1}),this.pageStyle.cssText.subscribe(function(t){e.updateUserStyleSheetFromCSSText(t)})}return i(t,[{key:"toObject",value:function(){function t(t){return t.map(function(t){return{url:t}})}var e=t(this.userStyleSheet());return this.pageStyle.pageSizeMode()==a.default.Mode.DEFAULT&&e.unshift({text:"@page{size:auto}"}),{fragment:this.fragment(),authorStyleSheet:t(this.authorStyleSheet()),userStyleSheet:e}}},{key:"updateUserStyleSheetFromCSSText",value:function(t){null==t&&(t=this.pageStyle.toCSSText());var e=this.userStyleSheet();if((!t||/^\s*(\/\*.*?\*\/\s*)*$/.test(t))&&e.length<=(-1==this.dataUserStyleIndex?0:1))return e.pop(),this.dataUserStyleIndex=-1,this.userStyleSheet(e),void o.default.removeParameter("userStyle");var n="data:,"+h.default.percentEncodeForDataURI(t.trim());-1==this.dataUserStyleIndex?(e.push(n),this.dataUserStyleIndex=e.length-1):e[this.dataUserStyleIndex]=n,this.userStyleSheet(e),o.default.setParameter("userStyle",n,this.dataUserStyleIndex)}}]),t}();n.default=l,e.exports=n.default},{"../stores/url-parameters":14,"../utils/string-util":17,"./page-style":9,knockout:1}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i};n.default=new function(){return r.default.observableArray()},e.exports=n.default},{knockout:1}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r,o=t("knockout"),a=(r=o)&&r.__esModule?r:{default:r},h={DEFAULT:"",AUTO:"auto",PRESET:"preset",CUSTOM:"custom",ZERO:"0"},l=[{name:"A5",description:"A5"},{name:"A4",description:"A4"},{name:"A3",description:"A3"},{name:"B5",description:"B5 (ISO)"},{name:"B4",description:"B4 (ISO)"},{name:"JIS-B5",description:"B5 (JIS)"},{name:"JIS-B4",description:"B4 (JIS)"},{name:"letter",description:"letter"},{name:"legal",description:"legal"},{name:"ledger",description:"ledger"}],c={customWidth:"210mm",customHeight:"297mm",customMargin:"10%",baseFontSize:"12pt",baseLineHeight:"1.2",baseFontFamily:"serif",viewerFontSize:16},u=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pageSizeMode=a.default.observable(h.DEFAULT),this.presetSize=a.default.observable(l[1]),this.isLandscape=a.default.observable(!1),this.customWidth=a.default.observable(c.customWidth),this.customHeight=a.default.observable(c.customHeight),this.pageSizeImportant=a.default.observable(!1),this.pageMarginMode=a.default.observable(h.DEFAULT),this.customMargin=a.default.observable(c.customMargin),this.pageMarginImportant=a.default.observable(!1),this.firstPageMarginZero=a.default.observable(!1),this.firstPageMarginZeroImportant=a.default.observable(!1),this.forceHtmlBodyMarginZero=a.default.observable(!1),this.widowsOrphans=a.default.observable(""),this.widowsOrphansImportant=a.default.observable(!1),this.imageMaxSizeToFitPage=a.default.observable(!1),this.imageMaxSizeToFitPageImportant=a.default.observable(!1),this.imageKeepAspectRatio=a.default.observable(!1),this.imageKeepAspectRatioImportant=a.default.observable(!1),this.baseFontSize=a.default.observable(c.baseFontSize),this.baseFontSizeSpecified=a.default.observable(!1),this.baseFontSizeImportant=a.default.observable(!1),this.baseLineHeight=a.default.observable(c.baseLineHeight),this.baseLineHeightSpecified=a.default.observable(!1),this.baseLineHeightImportant=a.default.observable(!1),this.baseFontFamily=a.default.observable(c.baseFontFamily),this.baseFontFamilySpecified=a.default.observable(!1),this.baseFontFamilyImportant=a.default.observable(!1),this.allImportant=a.default.observable(!1),this.pageOtherStyle=a.default.observable(""),this.firstPageOtherStyle=a.default.observable(""),this.rootOtherStyle=a.default.observable(""),this.beforeOtherStyle=a.default.observable(""),this.afterOtherStyle=a.default.observable(""),this.viewerFontSize=null,this.setViewerFontSizeObservable=function(t){n.viewerFontSize=t;var e=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];e&&(e.value=n.fontSizePxToPercent(t(),100,5))},this.viewerFontSizePercent=a.default.pureComputed({read:function(){return this.viewerFontSize?this.fontSizePxToPercent(this.viewerFontSize(),100,5):100},write:function(t){if(this.viewerFontSize){var e=parseFloat(t),n=e&&this.fontSizePercentToPx(e);if(!n||n<5||n>72){var i=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];i&&(i.value="100"),n=c.viewerFontSize}this.viewerFontSize(n)}},owner:this}),this.cssText=a.default.pureComputed({read:this.toCSSText,write:this.fromCSSText,owner:this}),this.allImportant.subscribe(function(t){n.pageSizeImportant(t),n.pageMarginImportant(t),n.firstPageMarginZeroImportant(t),n.widowsOrphansImportant(t),n.imageMaxSizeToFitPageImportant(t),n.imageKeepAspectRatioImportant(t),n.baseFontSizeImportant(t),n.baseLineHeightImportant(t),n.baseFontFamilyImportant(t)}),this.pageStyleRegExp=new RegExp("^((?:\\n|.)*?)\\/\\*<viewer>\\*\\/\\s*(?:@page\\s*\\{\\s*(?:size:\\s*([^\\s!;{}]+)(?:\\s+([^\\s!;{}]+))?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:margin:\\s*([^\\s!;{}]+(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?(?:@page\\s*:first\\s*\\{\\s*(margin:\\s*0(?:\\w+|%)?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?((?:html|:root),\\s*body\\s*\\{\\s*margin:\\s*0(?:\\w+|%)?\\s*!important(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:(?:html|:root)\\s*\\{\\s*(?:font-size:\\s*(calc\\([^()]+\\)|[^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:line-height:\\s*([^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:font-family:\\s*([^!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?([^{}]*)\\}\\s*)?(?:body\\s*\\{\\s*(?:[-\\w]+:\\s*inherit\\s*!important(?:;|(?=[\\s{}]))\\s*)+\\}\\s*)?(?:\\*\\s*\\{\\s*widows:\\s*(1|999)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*orphans:\\s*\\19\\s*\\20(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:img,\\s*svg\\s*\\{\\s*(max-inline-size:\\s*100%\\s*(!important)?(?:;|(?=[\\s{}]))\\s*max-block-size:\\s*100vb\\s*\\22(?:;|(?=[\\s{}]))\\s*)?(object-fit:\\s*contain\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?\\}\\s*)?((?:\\n|.)*)$"),e&&this.copyFrom(e)}return s(t,[{key:"fontSizePxToPercent",value:function(t,e,n){var i=t/c.viewerFontSize*(e||100);return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fontSizePercentToPx",value:function(t,e,n){var i=t/(e||100)*c.viewerFontSize;return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fromCSSText",value:function(t){var e=this,n=this.pageStyleRegExp.exec(t);if(n)!function(){var t=i(n,26),s=t[1],r=t[2],o=t[3],a=t[4],c=t[5],u=t[6],f=t[7],d=t[8],p=t[9],g=t[10],m=t[11],b=t[12],E=t[13],w=t[14],v=t[15],y=t[16],T=t[17],N=t[18],S=t[19],x=t[20],C=t[21],_=t[22],I=t[23],A=t[24],O=t[25],k=0,D=0;if(e.beforeOtherStyle(s),"landscape"==r||"portrait"==r?(e.isLandscape("landscape"==r),r=o,o=null):"landscape"!=o&&"portrait"!=o||(e.isLandscape("landscape"==o),o=null),null!=r){if(null==o)if("auto"==r)e.pageSizeMode(h.AUTO);else{var L=l.find(function(t){return t.name.toLowerCase()==r.toLowerCase()});L?(e.pageSizeMode(h.PRESET),e.presetSize(L)):(e.pageSizeMode(h.CUSTOM),e.customWidth(r),e.customHeight(r))}else e.pageSizeMode(h.CUSTOM),e.customWidth(r),e.customHeight(o);e.pageSizeImportant(!!a),a?k++:D++}else e.pageSizeMode(h.DEFAULT);null!=c?(e.pageMarginMode("0"==c?h.ZERO:h.CUSTOM),"0"==c?e.pageMarginMode(h.ZERO):(e.pageMarginMode(h.CUSTOM),e.customMargin(c)),e.pageMarginImportant(!!u),u?k++:D++):e.pageMarginMode(h.DEFAULT),f=f||"",e.pageOtherStyle(f),d?(e.firstPageMarginZero(!0),e.firstPageMarginZeroImportant(!!p),p?k++:D++):e.firstPageMarginZero(!1),g=g||"",e.firstPageOtherStyle(g),m?e.forceHtmlBodyMarginZero(!0):e.forceHtmlBodyMarginZero(!1),null!=b?(b=b.replace(/^\s*calc\([.\d]+\s*\*\s*([.\d]+\w+)\)\s*$/,"$1"),e.baseFontSizeSpecified(!0),e.baseFontSize(b),e.baseFontSizeImportant(!!E),E?k++:D++):e.baseFontSizeSpecified(!1),null!=w?(e.baseLineHeightSpecified(!0),e.baseLineHeight(w),e.baseLineHeightImportant(!!v),v?k++:D++):e.baseLineHeightSpecified(!1),null!=y?(y=y.trim(),e.baseFontFamilySpecified(!0),e.baseFontFamily(y),e.baseFontFamilyImportant(!!T),T?k++:D++):e.baseFontFamilySpecified(!1),N=N||"",e.rootOtherStyle(N),null!=S?(e.widowsOrphans(S),e.widowsOrphansImportant(!!x),x?k++:D++):e.widowsOrphans(h.DEFAULT),C?(e.imageMaxSizeToFitPage(!0),e.imageMaxSizeToFitPageImportant(!!_),_?k++:D++):e.imageMaxSizeToFitPage(!1),I?(e.imageKeepAspectRatio(!0),e.imageKeepAspectRatioImportant(!!A),A?k++:D++):e.imageKeepAspectRatio(!1),O=O.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"",e.afterOtherStyle(O),e.allImportant(k>0&&0==D)}();else{var s=t.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"";this.afterOtherStyle(s)}}},{key:"toCSSText",value:function(){function t(t){return t?" !important":""}var e=this.beforeOtherStyle();if(e+="/*<viewer>*/\n",this.pageSizeMode()!=h.DEFAULT||this.pageMarginMode()!=h.DEFAULT||this.pageOtherStyle()){if(e+="@page { ",this.pageSizeMode()!=h.DEFAULT){switch(e+="size: ",this.pageSizeMode()){case h.AUTO:e+="auto";break;case h.PRESET:e+=this.presetSize().name,this.isLandscape()&&(e+=" landscape");break;case h.CUSTOM:e+=this.customWidth()+" "+this.customHeight();break;default:throw new Error("Unknown pageSizeMode "+this.pageSizeMode())}e+=t(this.pageSizeImportant())+"; "}if(this.pageMarginMode()!=h.DEFAULT){switch(e+="margin: ",this.pageMarginMode()){case h.AUTO:e+="auto";break;case h.ZERO:e+="0";break;case h.CUSTOM:e+=""+this.customMargin();break;default:throw new Error("Unknown pageMarginMode "+this.pageMarginMode())}e+=t(this.pageMarginImportant())+"; "}e+=this.pageOtherStyle(),e+="}\n"}if((this.firstPageMarginZero()||this.firstPageOtherStyle())&&(e+="@page :first { ",this.firstPageMarginZero()&&(e+="margin: 0"+t(this.firstPageMarginZeroImportant())+"; "),e+=this.firstPageOtherStyle(),e+="}\n"),this.forceHtmlBodyMarginZero()&&(e+=":root, body { margin: 0 !important; }\n"),this.baseFontSizeSpecified()||this.baseLineHeightSpecified()||this.baseFontFamilySpecified()||this.rootOtherStyle()){e+=":root { ";var n=this.baseFontSize();if(this.baseFontSizeSpecified())if(this.viewerFontSize&&this.viewerFontSize()!=c.viewerFontSize&&!n.endsWith("%"))e+="font-size: calc("+this.fontSizePxToPercent(this.viewerFontSize(),1,5)+" * "+n+")"+t(this.baseFontSizeImportant())+"; ";else e+="font-size: "+this.baseFontSize()+t(this.baseFontSizeImportant())+"; ";this.baseLineHeightSpecified()&&(e+="line-height: "+this.baseLineHeight()+t(this.baseLineHeightImportant())+"; "),this.baseFontFamilySpecified()&&(e+="font-family: "+this.baseFontFamily()+t(this.baseFontFamilyImportant())+"; "),e+=this.rootOtherStyle(),e+="}\n"}return(this.baseFontSizeSpecified()&&this.baseFontSizeImportant()||this.baseLineHeightSpecified()&&this.baseLineHeightImportant()||this.baseFontFamilySpecified()&&this.baseFontFamilyImportant())&&(e+="body { ",this.baseFontSizeSpecified()&&this.baseFontSizeImportant()&&(e+="font-size: inherit !important; "),this.baseLineHeightSpecified()&&this.baseLineHeightImportant()&&(e+="line-height: inherit !important; "),this.baseFontFamilySpecified()&&this.baseFontFamilyImportant()&&(e+="font-family: inherit !important; "),e+="}\n"),this.widowsOrphans()&&(e+="* { ",e+="widows: "+this.widowsOrphans()+t(this.widowsOrphansImportant())+"; ",e+="orphans: "+this.widowsOrphans()+t(this.widowsOrphansImportant())+"; ",e+="}\n"),(this.imageMaxSizeToFitPage()||this.imageKeepAspectRatio())&&(e+="img, svg { ",this.imageMaxSizeToFitPage()&&(e+="max-inline-size: 100%"+t(this.imageMaxSizeToFitPageImportant())+"; ",e+="max-block-size: 100vb"+t(this.imageMaxSizeToFitPageImportant())+"; "),this.imageKeepAspectRatio()&&(e+="object-fit: contain"+t(this.imageKeepAspectRatioImportant())+"; "),e+="}\n"),e+="/*</viewer>*/\n",e+=this.afterOtherStyle()}},{key:"copyFrom",value:function(t){this.pageSizeMode(t.pageSizeMode()),this.presetSize(t.presetSize()),this.isLandscape(t.isLandscape()),this.customWidth(t.customWidth()),this.customHeight(t.customHeight()),this.pageSizeImportant(t.pageSizeImportant()),this.pageMarginMode(t.pageMarginMode()),this.customMargin(t.customMargin()),this.pageMarginImportant(t.pageMarginImportant()),this.firstPageMarginZero(t.firstPageMarginZero()),this.firstPageMarginZeroImportant(t.firstPageMarginZeroImportant()),this.forceHtmlBodyMarginZero(t.forceHtmlBodyMarginZero()),this.widowsOrphans(t.widowsOrphans()),this.widowsOrphansImportant(t.widowsOrphansImportant()),this.imageMaxSizeToFitPage(t.imageMaxSizeToFitPage()),this.imageMaxSizeToFitPageImportant(t.imageMaxSizeToFitPageImportant()),this.imageKeepAspectRatio(t.imageKeepAspectRatio()),this.imageKeepAspectRatioImportant(t.imageKeepAspectRatioImportant()),this.baseFontSize(t.baseFontSize()),this.baseFontSizeSpecified(t.baseFontSizeSpecified()),this.baseFontSizeImportant(t.baseFontSizeImportant()),this.baseLineHeight(t.baseLineHeight()),this.baseLineHeightSpecified(t.baseLineHeightSpecified()),this.baseLineHeightImportant(t.baseLineHeightImportant()),this.baseFontFamily(t.baseFontFamily()),this.baseFontFamilySpecified(t.baseFontFamilySpecified()),this.baseFontFamilyImportant(t.baseFontFamilyImportant()),this.allImportant(t.allImportant()),this.pageOtherStyle(t.pageOtherStyle()),this.firstPageOtherStyle(t.firstPageOtherStyle()),this.rootOtherStyle(t.rootOtherStyle()),this.beforeOtherStyle(t.beforeOtherStyle()),this.afterOtherStyle(t.afterOtherStyle()),this.viewerFontSize&&t.viewerFontSize&&this.viewerFontSize(t.viewerFontSize())}},{key:"equivalentTo",value:function(t){return this.pageSizeMode()===t.pageSizeMode()&&((this.pageSizeMode()!==h.PRESET||this.presetSize()===t.presetSize())&&((this.pageSizeMode()!==h.PRESET||this.isLandscape()===t.isLandscape())&&((this.pageSizeMode()!==h.CUSTOM||this.customWidth()===t.customWidth())&&((this.pageSizeMode()!==h.CUSTOM||this.customHeight()===t.customHeight())&&(this.pageSizeImportant()===t.pageSizeImportant()&&(this.pageMarginMode()===t.pageMarginMode()&&((this.pageMarginMode()!==h.CUSTOM||this.customMargin()===t.customMargin())&&(this.pageMarginImportant()===t.pageMarginImportant()&&(this.firstPageMarginZero()===t.firstPageMarginZero()&&(this.firstPageMarginZeroImportant()===t.firstPageMarginZeroImportant()&&(this.forceHtmlBodyMarginZero()===t.forceHtmlBodyMarginZero()&&(this.widowsOrphans()===t.widowsOrphans()&&(this.widowsOrphansImportant()===t.widowsOrphansImportant()&&(this.imageMaxSizeToFitPage()===t.imageMaxSizeToFitPage()&&(this.imageMaxSizeToFitPageImportant()===t.imageMaxSizeToFitPageImportant()&&(this.imageKeepAspectRatio()===t.imageKeepAspectRatio()&&(this.imageKeepAspectRatioImportant()===t.imageKeepAspectRatioImportant()&&(this.baseFontSizeSpecified()===t.baseFontSizeSpecified()&&((!this.baseFontSizeSpecified()||this.baseFontSize()===t.baseFontSize())&&(this.baseFontSizeImportant()===t.baseFontSizeImportant()&&(this.baseLineHeightSpecified()===t.baseLineHeightSpecified()&&((!this.baseLineHeightSpecified()||this.baseLineHeight()===t.baseLineHeight())&&(this.baseLineHeightImportant()===t.baseLineHeightImportant()&&(this.baseFontFamilySpecified()===t.baseFontFamilySpecified()&&((!this.baseFontFamilySpecified()||this.baseFontFamily()===t.baseFontFamily())&&(this.baseFontFamilyImportant()===t.baseFontFamilyImportant()&&(this.allImportant()===t.allImportant()&&(this.pageOtherStyle()===t.pageOtherStyle()&&(this.firstPageOtherStyle()===t.firstPageOtherStyle()&&(this.rootOtherStyle()===t.rootOtherStyle()&&(this.beforeOtherStyle()===t.beforeOtherStyle()&&(this.afterOtherStyle()===t.afterOtherStyle()&&!(!this.viewerFontSize!=!t.viewerFontSize||this.viewerFontSize&&this.viewerFontSize()!==t.viewerFontSize())))))))))))))))))))))))))))))))))}}]),t}();u.Mode=h,u.Constants=c,u.PresetSize=u.prototype.PresetSize=l,n.default=u,e.exports=n.default},{knockout:1}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../models/vivliostyle"),o=(s=r)&&s.__esModule?s:{default:s},a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"toSpreadViewString",value:function(){switch(this){case h.SPREAD:return"true";case h.SINGLE_PAGE:return"false";case h.AUTO_SPREAD:return"auto";default:throw new Error("Invalid PageViewMode")}}},{key:"toString",value:function(){switch(this){case h.SPREAD:return"spread";case h.SINGLE_PAGE:return"singlePage";case h.AUTO_SPREAD:return"autoSpread";default:throw new Error("Invalid PageViewMode")}}}]),t}(),h={AUTO_SPREAD:new a,SINGLE_PAGE:new a,SPREAD:new a,defaultMode:function(){return this.AUTO_SPREAD},fromSpreadViewString:function(t){switch(t){case"true":return this.SPREAD;case"false":return this.SINGLE_PAGE;case"auto":default:return this.AUTO_SPREAD}},of:function(t){switch(t){case o.default.viewer.PageViewMode.SPREAD:return this.SPREAD;case o.default.viewer.PageViewMode.SINGLE_PAGE:return this.SINGLE_PAGE;case o.default.viewer.PageViewMode.AUTO_SPREAD:return this.AUTO_SPREAD;default:throw new Error("Invalid PageViewMode name: "+t)}}};n.default=h,e.exports=n.default},{"../models/vivliostyle":12}],11:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t){return t&&t.__esModule?t:{default:t}}var o=r(t("knockout")),a=r(t("../stores/url-parameters")),h=r(t("./page-view-mode")),l=r(t("./zoom-options"));function c(){return{renderAllPages:a.default.hasParameter("x"),fontSize:16,profile:!1,pageViewMode:h.default.defaultMode(),zoom:l.default.createDefaultOptions()}}var u=function(){function t(e){var n,s,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderAllPages=o.default.observable(),this.fontSize=o.default.observable(),this.profile=o.default.observable(),this.pageViewMode=o.default.observable(),this.zoom=o.default.observable(),e?this.copyFrom(e):(n=c(),s=function(){var t=a.default.getParameter("renderAllPages")[0],e=a.default.getParameter("fontSize")[0],n=/^([\d.]+)(?:(%25|%)|\/([\d.]+))?$/.exec(e),s=null;if(n){var r=i(n,4),o=r[1],l=r[2],c=r[3];s=parseFloat(o),(l||c)&&(s=16*s/(l?100:parseFloat(c))),s<5&&(s=5),s>72&&(s=72)}return{renderAllPages:"true"===t||"false"!==t&&null,fontSize:s,profile:"true"===a.default.getParameter("profile")[0],pageViewMode:h.default.fromSpreadViewString(a.default.getParameter("spread")[0])}}(),r.renderAllPages(null!==s.renderAllPages?s.renderAllPages:n.renderAllPages),r.fontSize(s.fontSize||n.fontSize),r.profile(s.profile||n.profile),r.pageViewMode(s.pageViewMode||n.pageViewMode),r.zoom(n.zoom),r.pageViewMode.subscribe(function(t){t===n.pageViewMode?a.default.removeParameter("spread"):a.default.setParameter("spread",t.toSpreadViewString())}),r.renderAllPages.subscribe(function(t){t===n.renderAllPages?a.default.removeParameter("renderAllPages"):a.default.setParameter("renderAllPages",t.toString())}),r.fontSize.subscribe(function(t){"number"==typeof t&&(t=t.toPrecision(10).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),t==n.fontSize?a.default.removeParameter("fontSize"):a.default.setParameter("fontSize",t+"/"+n.fontSize)}))}return s(t,[{key:"copyFrom",value:function(t){this.renderAllPages(t.renderAllPages()),this.fontSize(t.fontSize()),this.profile(t.profile()),this.pageViewMode(t.pageViewMode()),this.zoom(t.zoom())}},{key:"toObject",value:function(){return{renderAllPages:this.renderAllPages(),fontSize:this.fontSize(),pageViewMode:this.pageViewMode().toString(),zoom:this.zoom().zoom,fitToScreen:this.zoom().fitToScreen}}}]),t}();u.getDefaultValues=c,n.default=u,e.exports=n.default},{"../stores/url-parameters":14,"./page-view-mode":10,"./zoom-options":13,knockout:1}],12:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewer=null,this.constants=null,this.profile=null}return i(t,[{key:"setInstance",value:function(t){this.viewer=t.viewer,this.constants=t.constants,this.profile=t.profile}}]),t}();n.default=new s,e.exports=n.default},{}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t,e,n){for(var i=!0;i;){var s=t,r=e,o=n;i=!1,null===s&&(s=Function.prototype);var a=Object.getOwnPropertyDescriptor(s,r);if(void 0!==a){if("value"in a)return a.value;var h=a.get;if(void 0===h)return;return h.call(o)}var l=Object.getPrototypeOf(s);if(null===l)return;t=l,e=r,n=o,i=!0,a=l=void 0}},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a,h=t("../models/vivliostyle"),l=(a=h)&&a.__esModule?a:{default:a},c=function(){function t(e){o(this,t),this.zoom=e}return s(t,[{key:"zoomIn",value:function(t){return new f(1.25*this.getCurrentZoomFactor(t))}},{key:"zoomOut",value:function(t){return new f(.8*this.getCurrentZoomFactor(t))}},{key:"zoomToActualSize",value:function(){return new f(1)}}],[{key:"createDefaultOptions",value:function(){return new u}},{key:"createFromZoomFactor",value:function(t){return new f(t)}}]),t}(),u=function(t){function e(){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,1)}return r(e,c),s(e,[{key:"toggleFitToScreen",value:function(){return new f(1)}},{key:"getCurrentZoomFactor",value:function(t){return t.queryZoomFactor(l.default.viewer.ZoomType.FIT_INSIDE_VIEWPORT)}},{key:"fitToScreen",get:function(){return!0}}]),e}(),f=function(t){function e(){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,c),s(e,[{key:"toggleFitToScreen",value:function(){return new u}},{key:"getCurrentZoomFactor",value:function(t){return this.zoom}},{key:"fitToScreen",get:function(){return!1}}]),e}();n.default=c,e.exports=n.default},{"../models/vivliostyle":12}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../utils/string-util"),o=(s=r)&&s.__esModule?s:{default:s};function a(t){return new RegExp("[#&]"+o.default.escapeUnicodeString(t)+"=([^&]*)","g")}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.history=window?window.history:{},this.location=window?window.location:{href:""},this.storedUrl=this.location.href}return i(t,[{key:"getBaseURL",value:function(){var t=this.location.href;return(t=t.replace(/#.*$/,"")).replace(/\/[^\/]*$/,"/")}},{key:"hasParameter",value:function(t){var e=this.location.href;return a(t).test(e)}},{key:"getParameter",value:function(t){for(var e=this.location.href,n=a(t),i=[],s=void 0;s=n.exec(e);)i.push(s[1]);return i}},{key:"setParameter",value:function(t,e,n){var i=this.location.href,s=void 0,r=a(t),o=r.exec(i);if(o&&n)for(;n-- >=1;)o=r.exec(i);if(o){var h=o[1].length,l=o.index+o[0].length-h;s=i.substring(0,l)+e+i.substring(l+h)}else s=i+(i.match(/[#&]$/)?"":i.match(/#/)?"&":"#")+t+"="+e;this.history.replaceState?this.history.replaceState(null,"",s):this.location.href=s,this.storedUrl=s}},{key:"removeParameter",value:function(t,e){var n=this.location.href,i=void 0,s=a(t),r=s.exec(n);if(r&&e&&(r=s.exec(n)),r){for(i=n;r;r=s.exec(i)){var o=r.index+r[0].length;i="#"==r[0].charAt(0)?i.substring(0,r.index+1)+i.substring(o+1):i.substring(0,r.index)+i.substring(o),s.lastIndex-=r[0].length}i=i.replace(/^(.*?)[#&]$/,"$1"),this.history.replaceState?this.history.replaceState(null,"",i):this.location.href=i}this.storedUrl=i}}]),t}();n.default=new h,e.exports=n.default},{"../utils/string-util":17}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={Unidentified:"Unidentified",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",Home:"Home",End:"End",PageDown:"PageDown",PageUp:"PageUp",Escape:"Escape",Enter:"Enter",Space:" "};n.default={Keys:i,identifyKeyFromEvent:function(t){var e=t.key,n=t.keyIdentifier,s=t.location;return e===i.ArrowDown||"Down"===e||"Down"===n?t.metaKey?i.End:i.ArrowDown:e===i.ArrowLeft||"Left"===e||"Left"===n?i.ArrowLeft:e===i.ArrowRight||"Right"===e||"Right"===n?i.ArrowRight:e===i.ArrowUp||"Up"===e||"Up"===n?t.metaKey?i.Home:i.ArrowUp:e===i.Escape||"Esc"===e||"U+001B"===n?i.Escape:e===i.Enter||"Enter"===n?i.Enter:e===i.Space||"U+0020"===n?i.Space:"0"===e||"U+0030"===n?"0":"+"===e||"Add"===e||"U+002B"===n||"U+00BB"===n||"U+004B"===n&&s===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"+":"-"===e||"Subtract"===e||"U+002D"===n||"U+00BD"===n||"U+004D"===n&&s===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"-":e||n||i.Unidentified}},e.exports=n.default},{}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o={readonlyObservable:function(t){var e=r.default.observable(t);return{getter:r.default.pureComputed(function(){return e()}),value:e}}};n.default=o,e.exports=n.default},{knockout:1}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={escapeUnicodeChar:function(t){return"\\u"+(65536|t.charCodeAt(0)).toString(16).substring(1)},escapeUnicodeString:function(t){return t.replace(/[^-a-zA-Z0-9_]/g,this.escapeUnicodeChar)},percentEncodeAmpersandAndUnencodedPercent:function(t){return t.replace(/%(?![0-9A-Fa-f]{2})/g,"%25").replace(/&/g,"%26")},percentEncodeAmpersandAndPercent:function(t){return t.replace(/%/g,"%25").replace(/&/g,"%26")},percentDecodeAmpersandAndPercent:function(t){return t.replace(/%26/g,"&").replace(/%25/g,"%")},percentEncodeForDataURI:function(t){return encodeURI(t).replace(/#/g,"%23").replace(/&/g,"%26")}},e.exports=n.default},{}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("knockout"),o=(s=r)&&s.__esModule?s:{default:s},a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.list=e,this.visible=o.default.pureComputed(function(){return e().length>0})}return i(t,[{key:"getDisplayMessage",value:function(t){var e=t.error,n=e&&(e.toString()||e.frameTrace||e.stack);return n&&(n=n.split("\n",1)[0]),n||(n=t.messages.join("\n")),n}}]),t}();n.default=a,e.exports=n.default},{knockout:1}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../models/viewer-options")),a=t("../utils/key-util"),h=s(t("../models/vivliostyle")),l=function(){function t(e,n,i,s){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.viewer_=n,this.settingsPanel_=i,this.justClicked=!1,this.isDisabled=r.default.pureComputed(function(){return o.settingsPanel_.opened()&&!o.settingsPanel_.pinned()||!o.viewer_.state.navigatable()});var a=r.default.pureComputed(function(){return s.disablePageNavigation||o.isDisabled()});a.subscribe(function(t){var e=document.getElementById("vivliostyle-page-number");e&&(e.disabled=t)}),this.isPageNumberDisabled=r.default.pureComputed(function(){return a()}),this.isNavigateToPreviousDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&o.viewer_.firstPage()}),this.isNavigateToNextDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&((!o.viewerOptions_.renderAllPages()||o.viewer_.state.status()==h.default.constants.ReadyState.COMPLETE)&&o.viewer_.lastPage())}),this.isNavigateToLeftDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.pageProgression&&(o.viewer_.state.pageProgression()===h.default.constants.PageProgression.LTR?o.isNavigateToPreviousDisabled():o.isNavigateToNextDisabled())}),this.isNavigateToRightDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.pageProgression&&(o.viewer_.state.pageProgression()===h.default.constants.PageProgression.LTR?o.isNavigateToNextDisabled():o.isNavigateToPreviousDisabled())}),this.isNavigateToFirstDisabled=this.isNavigateToPreviousDisabled,this.isNavigateToLastDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&(!(!o.viewerOptions_.renderAllPages()||o.viewer_.state.status()==h.default.constants.ReadyState.COMPLETE)||o.viewer_.lastPage())}),this.hidePageNavigation=!!s.disablePageNavigation;var l=r.default.pureComputed(function(){return s.disableZoom||o.isDisabled()});this.isZoomOutDisabled=l,this.isZoomInDisabled=l,this.isZoomToActualSizeDisabled=l,this.isToggleFitToScreenDisabled=l,this.hideZoom=!!s.disableZoom,this.fitToScreen=r.default.pureComputed(function(){return e.zoom().fitToScreen});var c=r.default.pureComputed(function(){return s.disableFontSizeChange||o.isDisabled()});this.isIncreaseFontSizeDisabled=r.default.pureComputed(function(){return!!c()||o.viewerOptions_.fontSize()>=72}),this.isDecreaseFontSizeDisabled=r.default.pureComputed(function(){return!!c()||o.viewerOptions_.fontSize()<=5}),this.isDefaultFontSizeDisabled=c,this.hideFontSizeChange=!!s.disableFontSizeChange,this.isTOCToggleDisabled=r.default.pureComputed(function(){return s.disableTOCNavigation||o.isDisabled()||null==o.viewer_.tocVisible()}),this.hideTOCNavigation=!!s.disableTOCNavigation,this.pageNumber=r.default.pureComputed({read:function(){return this.viewer_.epageToPageNumber(this.viewer_.epage())},write:function(t){var e=this,n=this.viewer_.epage(),i=this.viewer_.epageToPageNumber(n),s=parseFloat(t.replace(/[０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)}))||0;if(/^[-+]/.test(t)&&(s=i+s),s<1)s=1;else{var r=this.viewer_.epageCount();this.viewerOptions_.renderAllPages()?s>r&&(s=r):s>r+1&&(s=r+1)}var o=this.viewer_.epageFromPageNumber(s),a=document.getElementById("vivliostyle-page-number");a.value=s,this.viewer_.navigateToEPage(o),setTimeout(function(){e.viewer_.state.status()!=h.default.constants.ReadyState.LOADING&&e.viewer_.epage()===n&&(a.value=i),document.getElementById("vivliostyle-viewer-viewport").focus()},10)},owner:this}),this.totalPages=r.default.pureComputed(function(){var t=o.viewer_.epageCount();if(!t)return t;var e=o.pageNumber();return o.viewer_.lastPage()?t=e:e>=t&&t++,t}),["navigateToPrevious","navigateToNext","navigateToLeft","navigateToRight","navigateToFirst","navigateToLast","zoomIn","zoomOut","zoomToActualSize","toggleFitToScreen","increaseFontSize","decreaseFontSize","defaultFontSize","onclickViewport","toggleTOC"].forEach(function(t){o[t]=o[t].bind(o)})}return i(t,[{key:"navigateToPrevious",value:function(){return!this.isNavigateToPreviousDisabled()&&(this.viewer_.navigateToPrevious(),!0)}},{key:"navigateToNext",value:function(){return!this.isNavigateToNextDisabled()&&(this.viewer_.navigateToNext(),!0)}},{key:"navigateToLeft",value:function(){return!this.isNavigateToLeftDisabled()&&(this.viewer_.navigateToLeft(),!0)}},{key:"navigateToRight",value:function(){return!this.isNavigateToRightDisabled()&&(this.viewer_.navigateToRight(),!0)}},{key:"navigateToFirst",value:function(){return!this.isNavigateToFirstDisabled()&&(this.viewer_.navigateToFirst(),!0)}},{key:"navigateToLast",value:function(){return!this.isNavigateToLastDisabled()&&(this.viewer_.navigateToLast(),!0)}},{key:"zoomIn",value:function(){if(this.isZoomInDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomIn(this.viewer_)),!0}},{key:"zoomOut",value:function(){if(this.isZoomOutDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomOut(this.viewer_)),!0}},{key:"zoomToActualSize",value:function(){if(this.isZoomToActualSizeDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomToActualSize()),!0}},{key:"toggleFitToScreen",value:function(){if(this.isToggleFitToScreenDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.toggleFitToScreen()),!0}},{key:"increaseFontSize",value:function(){if(this.isIncreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t<10?Math.floor(t)+1:t<20?2*(Math.floor(t/2)+1):t<40?4*(Math.floor(t/4)+1):t<72?8*(Math.floor(t/8)+1):72,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"decreaseFontSize",value:function(){if(this.isDecreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t>40?8*(Math.ceil(t/8)-1):t>20?4*(Math.ceil(t/4)-1):t>10?2*(Math.ceil(t/2)-1):t>5?Math.ceil(t)-1:5,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"defaultFontSize",value:function(){if(this.isDefaultFontSizeDisabled())return!1;var t=o.default.getDefaultValues().fontSize;return this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"updateFontSizeSettings",value:function(){this.settingsPanel_.state.viewerOptions.fontSize(this.viewerOptions_.fontSize()),this.viewer_.documentOptions_.pageStyle.baseFontSizeSpecified()&&(this.viewer_.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.viewer_.documentOptions_,this.viewerOptions_))}},{key:"onclickViewport",value:function(){if(this.settingsPanel_.justClicked)return!0;if(this.viewer_.tocVisible()&&!this.viewer_.tocPinned()){var t=document.querySelector("[data-vivliostyle-toc-box]");t&&!t.contains(document.activeElement)&&this.toggleTOC()}return this.settingsPanel_.opened()&&!this.settingsPanel_.pinned()&&this.settingsPanel_.close(),!0}},{key:"toggleTOC",value:function(){var t=this;if(this.isTOCToggleDisabled())return!1;var e=function(){var e=0;document.getElementById("vivliostyle-menu-item_toc-toggle");return t.viewer_.tocVisible()?t.justClicked?(t.viewer_.showTOC(!0,!1),t.justClicked=!1):(e&&(clearInterval(e),e=0),t.viewer_.showTOC(!1),t.justClicked=!0,setTimeout(function(){t.justClicked&&(document.getElementById("vivliostyle-viewer-viewport").focus(),t.justClicked=!1)},300)):(t.justClicked?(t.viewer_.showTOC(!0,!1),t.justClicked=!1):(t.viewer_.showTOC(!0,!0),t.justClicked=!0),e=setInterval(function(){var n=document.querySelector("[data-vivliostyle-toc-box]");n&&"visible"===n.style.visibility&&(n.tabIndex=0,n.focus(),clearInterval(e),e=0),t.justClicked=!1},300)),{v:!0}}();return"object"==typeof e?e.v:void 0}},{key:"navigateTOC",value:function(t){var e=Array.from(document.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) [tabindex='0'],[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) a[href]:not([tabindex='-1'])")),n=e.indexOf(document.activeElement),i=function(t){return e[t]&&"button"===e[t].getAttribute("role")},s=function(t){return e[t]&&"true"===e[t].getAttribute("aria-expanded")};switch(t){case a.Keys.ArrowLeft:if(-1==n){n=e.length-1;break}if(!i(n)&&i(n-1)&&n--,i(n)&&s(n))e[n].click();else for(var r=n-1;r>=0;r--)if(i(r)&&e[r].parentElement.contains(e[n])){n=r;break}break;case a.Keys.ArrowRight:if(-1==n){n=0;break}!i(n)&&i(n-1)&&n--,i(n)&&(s(n)?n+=2:e[n].click());break;case a.Keys.ArrowDown:n++;break;case a.Keys.ArrowUp:if(-1==n){n=e.length-1;break}n>0&&i(--n)&&n--;break;case a.Keys.Home:n=0;break;case a.Keys.End:n=e.length-1;break;case a.Keys.Space:!i(n)&&i(n-1)&&n--,i(n)&&e[n].click()}return i(n)&&n++,e[n]&&e[n].focus(),!0}},{key:"handleKey",value:function(t){if(this.settingsPanel_.opened()&&this.settingsPanel_.settingsToggle.contains(document.activeElement))return!0;var e=document.getElementById("vivliostyle-page-number"),n=document.getElementById("vivliostyle-viewer-viewport"),i=n.scrollWidth>n.clientWidth,s=n.scrollHeight>n.clientHeight,r=e===document.activeElement,o=this.viewer_.tocVisible()&&!r&&n!=document.activeElement;switch(t){case"+":return r||!this.increaseFontSize();case"-":return r||!this.decreaseFontSize();case"0":return r||!this.defaultFontSize();case"1":return r||!this.zoomToActualSize();case a.Keys.ArrowLeft:return o?!this.navigateTOC(t):r||i||!this.navigateToLeft();case a.Keys.ArrowRight:return o?!this.navigateTOC(t):r||i||!this.navigateToRight();case a.Keys.ArrowDown:return o?!this.navigateTOC(t):(n.focus(),s||!this.navigateToNext());case a.Keys.ArrowUp:return o?!this.navigateTOC(t):(n.focus(),s||!this.navigateToPrevious());case a.Keys.PageDown:return!!o||(n.focus(),!this.navigateToNext());case a.Keys.PageUp:return!!o||(n.focus(),!this.navigateToPrevious());case a.Keys.Home:return o?!this.navigateTOC(t):(n.focus(),!this.navigateToFirst());case a.Keys.End:return o?!this.navigateTOC(t):(n.focus(),!this.navigateToLast());case"o":case"O":return n.focus(),!this.zoomOut();case"i":case"I":return n.focus(),!this.zoomIn();case"f":case"F":return n.focus(),!this.toggleFitToScreen();case"g":case"G":return e.focus(),!1;case"t":case"T":return n.focus(),!this.toggleTOC();case a.Keys.Escape:return this.viewer_.tocVisible()?!this.toggleTOC():(n.focus(),!0);case a.Keys.Space:return o?!this.navigateTOC(t):"button"!==document.activeElement.getAttribute("role")||(document.activeElement.click(),!1);default:return!0}}}]),t}();n.default=l,e.exports=n.default},{"../models/viewer-options":11,"../models/vivliostyle":12,"../utils/key-util":15,knockout:1}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../models/viewer-options")),a=s(t("../models/page-style")),h=s(t("../models/page-view-mode")),l=t("../utils/key-util"),c=function(){function t(e,n,i,s,l){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.documentOptions_=n,this.viewer_=i,this.isPageStyleChangeDisabled=!!l.disablePageStyleChange,this.isOverrideDocumentStyleSheetDisabled=this.isPageStyleChangeDisabled,this.isPageViewModeChangeDisabled=!!l.disablePageViewModeChange,this.isRenderAllPagesChangeDisabled=!!l.disableRenderAllPagesChange,this.justClicked=!1,this.settingsToggle=document.getElementById("vivliostyle-menu-item_settings-toggle"),this.opened=r.default.observable(!1),this.pinned=r.default.observable(!1),this.state={viewerOptions:new o.default(e),pageStyle:new a.default(n.pageStyle),pageViewMode:r.default.pureComputed({read:function(){return c.state.viewerOptions.pageViewMode().toString()},write:function(t){c.state.viewerOptions.pageViewMode(h.default.of(t))}}),renderAllPages:r.default.pureComputed({read:function(){return c.state.viewerOptions.renderAllPages()},write:function(t){c.state.viewerOptions.renderAllPages(t)}})},this.state.pageStyle.setViewerFontSizeObservable(this.state.viewerOptions.fontSize),this.defaultPageStyle=new a.default,["close","toggle","apply","cancel","resetUserStyle"].forEach(function(t){this[t]=this[t].bind(this)},this),s.visible.subscribe(function(t){t&&this.close()},this)}return i(t,[{key:"close",value:function(){this.opened(!1),this.pinned(!1);var t=document.getElementById("vivliostyle-viewer-viewport");return t&&t.focus(),!0}},{key:"toggle",value:function(){var t=this;this.opened()?this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.close(),this.justClicked=!0,setTimeout(function(){t.justClicked=!1},300)):(this.viewer_.tocPinned()||this.viewer_.showTOC(!1),this.opened(!0),this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.pinned(!1),this.justClicked=!0,this.focusToFirstItem(),setTimeout(function(){t.justClicked=!1},300)))}},{key:"apply",value:function(){this.state.renderAllPages()===this.viewerOptions_.renderAllPages()&&this.state.pageStyle.equivalentTo(this.documentOptions_.pageStyle)?this.viewerOptions_.copyFrom(this.state.viewerOptions):(this.documentOptions_.pageStyle.copyFrom(this.state.pageStyle),this.documentOptions_.pageStyle.baseFontSizeSpecified()&&this.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.documentOptions_,this.state.viewerOptions)),this.pinned()?this.focusToFirstItem():this.close()}},{key:"cancel",value:function(){this.state.viewerOptions.copyFrom(this.viewerOptions_),this.state.pageStyle.copyFrom(this.documentOptions_.pageStyle),this.close()}},{key:"resetUserStyle",value:function(){return this.state.pageStyle.copyFrom(this.defaultPageStyle),this.state.viewerOptions.fontSize(o.default.getDefaultValues().fontSize),setTimeout(function(){document.getElementsByName("vivliostyle-settings_reset-user-style")[0].checked=!1},200),!0}},{key:"focusToFirstItem",value:function(t){var e=t||this.settingsToggle,n=["input","textarea","summary"].includes(e.localName)?e:Array.from(e.getElementsByTagName("input")).find(function(t){return!t.disabled&&("radio"!=t.type||t.checked)});if(n){for(var i=n.parentElement;i&&i!=this.settingsToggle;i=i.parentElement)"details"==i.localName&&(i.open=!0);n.focus()}}},{key:"handleKey",value:function(t){var e=this.opened()&&this.settingsToggle.contains(document.activeElement),n=e&&("text"==document.activeElement.type||"select"==document.activeElement.localName),i=e&&"textarea"==document.activeElement.localName,s=e&&!n&&!i;switch(t){case l.Keys.Escape:return this.opened()&&(this.cancel(),this.close()),!0;case"s":case"S":return!(!this.opened()||s||!e)||(this.toggle(),!1);case"p":case"P":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-and-rendering").firstElementChild),!1);case"v":case"V":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-mode")),!1);case"a":case"A":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_render-all-pages")[0]),!1);case"u":case"U":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_user-style").firstElementChild),!1);case"z":case"Z":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-size")),!1);case"m":case"M":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-margin")),!1);case"b":case"B":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-breaks")),!1);case"i":case"I":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_images")),!1);case"t":case"T":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_text")),!1);case"o":case"O":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_override-document-stylesheets")[0]),!1);case"c":case"C":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_css-details")[0]),!1);case"r":case"R":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_reset-user-style")[0]),!1);case l.Keys.Enter:return!(n||s&&"vivliostyle-menu-button_apply"!==document.activeElement.id&&"vivliostyle-menu-button_reset"!==document.activeElement.id)||(document.getElementById("vivliostyle-menu-button_apply").focus(),!1);default:return!0}}}]),t}();n.default=c,e.exports=n.default},{"../models/page-style":9,"../models/page-view-mode":10,"../models/viewer-options":11,"../utils/key-util":15,knockout:1}],21:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var s=i(t("../models/vivliostyle")),r=i(t("../models/document-options")),o=i(t("../models/viewer-options")),a=i(t("../models/message-queue")),h=i(t("./viewer")),l=i(t("./navigation")),c=i(t("./settings-panel")),u=i(t("./message-dialog")),f=i(t("../utils/key-util")),d=i(t("../utils/string-util")),p=i(t("../stores/url-parameters"));n.default=function(){var t=this;this.documentOptions=new r.default,this.viewerOptions=new o.default,this.documentOptions.pageStyle.setViewerFontSizeObservable(this.viewerOptions.fontSize),this.viewerOptions.profile()&&s.default.profile.profiler.enable(),this.isDebug="true"===p.default.getParameter("debug")[0],this.viewerSettings={userAgentRootURL:p.default.getBaseURL()+"resources/",viewportElement:document.getElementById("vivliostyle-viewer-viewport"),debug:this.isDebug},p.default.getParameter("b")[0]&&(p.default.removeParameter("b",!0),p.default.removeParameter("x")),p.default.removeParameter("f",!0),p.default.removeParameter("spread",!0),p.default.removeParameter("renderAllPages",!0),p.default.removeParameter("fontSize",!0),p.default.removeParameter("profile",!0),p.default.removeParameter("debug",!0),this.viewer=new h.default(this.viewerSettings,this.viewerOptions),this.viewer.inputUrl.subscribe(function(t){""!=t?(p.default.hasParameter("b")||p.default.history.pushState&&p.default.history.pushState(null,""),t=t.startsWith("<")?"data:,"+d.default.percentEncodeForDataURI(t):d.default.percentEncodeAmpersandAndUnencodedPercent(t),p.default.setParameter("b",t)):p.default.removeParameter("b")}),this.messageDialog=new u.default(a.default),this.settingsPanel=new c.default(this.viewerOptions,this.documentOptions,this.viewer,this.messageDialog,{disablePageStyleChange:!1,disablePageViewModeChange:!1,disableRenderAllPagesChange:!1}),this.navigation=new l.default(this.viewerOptions,this.viewer,this.settingsPanel,{disableTOCNavigation:!1,disablePageNavigation:!1,disableZoom:!1,disableFontSizeChange:!1}),this.handleKey=function(e,n){var i=f.default.identifyKeyFromEvent(n);if("vivliostyle-input-url"===document.activeElement.id)return"Enter"!==i||13!==n.keyCode||(t.documentOptions.bookUrl(p.default.getParameter("b")[0]),t.viewer.loadDocument(t.documentOptions),!1);if("Home"!==i&&"End"!==i&&(n.ctrlKey||n.metaKey)||n.altKey||n.shiftKey)return!0;var s=t.settingsPanel.handleKey(i);return s&&(s=t.navigation.handleKey(i)),s},this.viewer.loadDocument(this.documentOptions),window.onhashchange=function(){window.location.href!=p.default.storedUrl&&window.location.reload()}},e.exports=n.default},{"../models/document-options":7,"../models/message-queue":8,"../models/viewer-options":11,"../models/vivliostyle":12,"../stores/url-parameters":14,"../utils/key-util":15,"../utils/string-util":17,"./message-dialog":18,"./navigation":19,"./settings-panel":20,"./viewer":22}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../utils/observable-util")),a=s(t("../logging/logger")),h=s(t("../models/vivliostyle")),l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=n,this.documentOptions_=null,this.viewer_=new h.default.viewer.Viewer(e,n.toObject());var i=this.state_={status:o.default.readonlyObservable(h.default.constants.ReadyState.LOADING),pageProgression:o.default.readonlyObservable(h.default.constants.PageProgression.LTR)};this.state={status:i.status.getter.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"},notify:"always"}),navigatable:r.default.pureComputed(function(){return i.status.value()&&i.status.value()!==h.default.constants.ReadyState.LOADING}),pageProgression:i.pageProgression.getter},this.epage=r.default.observable(),this.epageCount=r.default.observable(),this.firstPage=r.default.observable(),this.lastPage=r.default.observable(),this.tocVisible=r.default.observable(),this.tocPinned=r.default.observable(),this.inputUrl=r.default.observable(""),this.setupViewerEventHandler(),this.setupViewerOptionSubscriptions()}return i(t,[{key:"setupViewerEventHandler",value:function(){var t=this,e=a.default.getLogger();this.viewer_.addListener("debug",function(t){e.debug(t.content)}),this.viewer_.addListener("info",function(t){e.info(t.content)}),this.viewer_.addListener("warn",function(t){e.warn(t.content)}),this.viewer_.addListener("error",function(t){e.error(t.content)}),this.viewer_.addListener("readystatechange",function(){var e=t.viewer_.readyState;e!==h.default.constants.ReadyState.INTERACTIVE&&e!==h.default.constants.ReadyState.COMPLETE||t.state_.pageProgression.value(t.viewer_.getCurrentPageProgression()),t.state_.status.value(e)}),this.viewer_.addListener("loaded",function(){t.viewerOptions_.profile()&&h.default.profile.profiler.printTimings()}),this.viewer_.addListener("nav",function(e){var n=e.cfi,i=e.first,s=e.last,r=e.epage,o=e.epageCount,a=e.metadata,h=e.docTitle;if(n&&t.documentOptions_.fragment(n),void 0!==i&&t.firstPage(i),void 0!==s&&t.lastPage(s),void 0!==r&&t.epage(r),void 0!==o&&t.epageCount(o),a||h){var l=a&&a["http://purl.org/dc/terms/title"],c=l&&l[0]&&l[0].v;c?!h||h===c||t.firstPage()||/\.xhtml$/.test(h)?document.title=c:document.title=h+" | "+c:document.title=h||"Vivliostyle Viewer"}var u=t.tocVisible(),f=t.viewer_.isTOCVisible();u&&!f||t.tocVisible(f)}),this.viewer_.addListener("hyperlink",function(e){e.internal?(t.navigateToInternalUrl(e.href),t.tocVisible()&&t.tocVisible(!1),document.getElementById("vivliostyle-viewer-viewport").focus()):window.location.href=e.href})}},{key:"setupViewerOptionSubscriptions",value:function(){r.default.computed(function(){var t=this.viewerOptions_.toObject();this.viewer_.setOptions(t)},this).extend({rateLimit:0})}},{key:"loadDocument",value:function(t,e){this.state_.status.value(h.default.constants.ReadyState.LOADING),e&&this.viewerOptions_.copyFrom(e),this.documentOptions_=t,t.xUrl()?this.viewer_.loadDocument(t.xUrl(),t.toObject(),this.viewerOptions_.toObject()):t.bookUrl()?this.viewer_.loadPublication?this.viewer_.loadPublication(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.viewer_.loadEPUB(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.state_.status.value("")}},{key:"navigateToPrevious",value:function(){this.viewer_.navigateToPage("previous")}},{key:"navigateToNext",value:function(){this.viewer_.navigateToPage("next")}},{key:"navigateToLeft",value:function(){this.viewer_.navigateToPage("left")}},{key:"navigateToRight",value:function(){this.viewer_.navigateToPage("right")}},{key:"navigateToFirst",value:function(){this.viewer_.navigateToPage("first")}},{key:"navigateToLast",value:function(){this.viewer_.navigateToPage("last")}},{key:"navigateToEPage",value:function(t){this.viewer_.navigateToPage("epage",t)}},{key:"navigateToInternalUrl",value:function(t){this.viewer_.navigateToInternalUrl(t)}},{key:"queryZoomFactor",value:function(t){return this.viewer_.queryZoomFactor(t)}},{key:"epageToPageNumber",value:function(t){if(t||0==t)return Math.round(t+1)}},{key:"epageFromPageNumber",value:function(t){if(t||0==t)return t-1}},{key:"showTOC",value:function(t,e){if(null!=this.viewer_.isTOCVisible()){var n=null==t?!this.tocVisible():t;this.tocVisible(n),this.tocPinned(!!n&&!e),this.viewer_.showTOC(n,e)}}}]),t}();n.default=l,e.exports=n.default},{"../logging/logger":5,"../models/vivliostyle":12,"../utils/observable-util":16,knockout:1}],23:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var s=i(t("knockout")),r=(i(t("./bindings/menuButton.js")),i(t("./bindings/swipePages.js")),i(t("./viewmodels/viewer-app")));n.default={start:function(){function t(){s.default.applyBindings(new r.default)}window.__loaded?t():window.onload=t}},e.exports=n.default},{"./bindings/menuButton.js":3,"./bindings/swipePages.js":4,"./viewmodels/viewer-app":21,knockout:1}]},{},[6]);