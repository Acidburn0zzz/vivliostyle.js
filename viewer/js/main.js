!function(){return function t(e,n,i){function s(o,a){if(!n[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){return s(e[o][1][t]||t)},c,c.exports,t,e,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}}()({1:[function(t,e,n){!function(t){var i=this||(0,eval)("this"),s=i.document,r=i.navigator,o=i.jQuery,a=i.JSON;o||"undefined"==typeof jQuery||(o=jQuery),function(t){"function"==typeof define&&define.amd?define(["exports","require"],t):t("object"==typeof n&&"object"==typeof e?e.exports||n:i.ko={})}(function(e,n){function l(t,e){return(null===t||typeof t in y)&&t===e}function h(e,n){var i;return function(){i||(i=v.a.setTimeout(function(){i=t,e()},n))}}function c(t,e){var n;return function(){clearTimeout(n),n=v.a.setTimeout(t,e)}}function u(t,e){e&&"change"!==e?"beforeChange"===e?this.oc(t):this.bb(t,e):this.pc(t)}function d(t,e){null!==e&&e.s&&e.s()}function f(t,e){var n=this.pd,i=n[I];i.qa||(this.Pb&&this.kb[e]?(n.tc(e,t,this.kb[e]),this.kb[e]=null,--this.Pb):i.F[e]||n.tc(e,t,i.G?{da:t}:n.Zc(t)),t.Ka&&t.fd())}var p,g,m,b,E,w,v=void 0!==e?e:{};v.b=function(t,e){for(var n=t.split("."),i=v,s=0;s<n.length-1;s++)i=i[n[s]];i[n[n.length-1]]=e},v.J=function(t,e,n){t[e]=n},v.version="3.5.0",v.b("version",v.version),v.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},v.a=function(){function e(t,e){for(var n in t)c.call(t,n)&&e(n,t[n])}function n(t,e){if(e)for(var n in e)c.call(e,n)&&(t[n]=e[n]);return t}function l(t,e){return t.__proto__=e,t}function h(t,e,n,i){var s=t[e].match(E)||[];v.a.C(n.match(E),function(t){v.a.Oa(s,t,i)}),t[e]=s.join(" ")}var c=Object.prototype.hasOwnProperty,u={__proto__:[]}instanceof Array,d="function"==typeof Symbol,f={},p={};f[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(f,function(t,e){if(e.length)for(var n=0,i=e.length;n<i;n++)p[e[n]]=t});var g,m={propertychange:!0},b=s&&function(){for(var e=3,n=s.createElement("div"),i=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",i[0];);return 4<e?e:t}(),E=/\S+/g;return{Ic:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],C:function(t,e,n){for(var i=0,s=t.length;i<s;i++)e.call(n,t[i],i,t)},A:"function"==typeof Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e)}:function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},Lb:function(e,n,i){for(var s=0,r=e.length;s<r;s++)if(n.call(i,e[s],s,e))return e[s];return t},hb:function(t,e){var n=v.a.A(t,e);0<n?t.splice(n,1):0===n&&t.shift()},vc:function(t){var e=[];return t&&v.a.C(t,function(t){0>v.a.A(e,t)&&e.push(t)}),e},Mb:function(t,e,n){var i=[];if(t)for(var s=0,r=t.length;s<r;s++)i.push(e.call(n,t[s],s));return i},fb:function(t,e,n){var i=[];if(t)for(var s=0,r=t.length;s<r;s++)e.call(n,t[s],s)&&i.push(t[s]);return i},gb:function(t,e){if(e instanceof Array)t.push.apply(t,e);else for(var n=0,i=e.length;n<i;n++)t.push(e[n]);return t},Oa:function(t,e,n){var i=v.a.A(v.a.$b(t),e);0>i?n&&t.push(e):n||t.splice(i,1)},Ba:u,extend:n,setPrototypeOf:l,zb:u?l:n,O:e,Ha:function(t,e,n){if(!t)return t;var i,s={};for(i in t)c.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s},Sb:function(t){for(;t.firstChild;)v.removeNode(t.firstChild)},Xb:function(t){for(var e=((t=v.a.la(t))[0]&&t[0].ownerDocument||s).createElement("div"),n=0,i=t.length;n<i;n++)e.appendChild(v.na(t[n]));return e},Ca:function(t,e){for(var n=0,i=t.length,s=[];n<i;n++){var r=t[n].cloneNode(!0);s.push(e?v.na(r):r)}return s},ua:function(t,e){if(v.a.Sb(t),e)for(var n=0,i=e.length;n<i;n++)t.appendChild(e[n])},Wc:function(t,e){var n=t.nodeType?[t]:t;if(0<n.length){for(var i=n[0],s=i.parentNode,r=0,o=e.length;r<o;r++)s.insertBefore(e[r],i);for(r=0,o=n.length;r<o;r++)v.removeNode(n[r])}},Ua:function(t,e){if(t.length){for(e=8===e.nodeType&&e.parentNode||e;t.length&&t[0].parentNode!==e;)t.splice(0,1);for(;1<t.length&&t[t.length-1].parentNode!==e;)t.length--;if(1<t.length){var n=t[0],i=t[t.length-1];for(t.length=0;n!==i;)t.push(n),n=n.nextSibling;t.push(i)}}return t},Yc:function(t,e){7>b?t.setAttribute("selected",e):t.selected=e},Cb:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Td:function(t,e){return t=t||"",!(e.length>t.length)&&t.substring(0,e.length)===e},ud:function(t,e){if(t===e)return!0;if(11===t.nodeType)return!1;if(e.contains)return e.contains(1!==t.nodeType?t.parentNode:t);if(e.compareDocumentPosition)return 16==(16&e.compareDocumentPosition(t));for(;t&&t!=e;)t=t.parentNode;return!!t},Rb:function(t){return v.a.ud(t,t.ownerDocument.documentElement)},jd:function(t){return!!v.a.Lb(t,v.a.Rb)},P:function(t){return t&&t.tagName&&t.tagName.toLowerCase()},zc:function(t){return v.onError?function(){try{return t.apply(this,arguments)}catch(t){throw v.onError&&v.onError(t),t}}:t},setTimeout:function(t,e){return setTimeout(v.a.zc(t),e)},Fc:function(t){setTimeout(function(){throw v.onError&&v.onError(t),t},0)},H:function(t,e,n){var i=v.a.zc(n);if(n=m[e],v.options.useOnlyNativeEvents||n||!o)if(n||"function"!=typeof t.addEventListener){if(void 0===t.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var s=function(e){i.call(t,e)},r="on"+e;t.attachEvent(r,s),v.a.I.za(t,function(){t.detachEvent(r,s)})}else t.addEventListener(e,i,!1);else g||(g="function"==typeof o(t).on?"on":"bind"),o(t)[g](e,i)},Fb:function(t,e){if(!t||!t.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==v.a.P(t)||!t.type||"click"!=e.toLowerCase())&&("checkbox"==(n=t.type)||"radio"==n),v.options.useOnlyNativeEvents||!o||n)if("function"==typeof s.createEvent){if("function"!=typeof t.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=s.createEvent(p[e]||"HTMLEvents")).initEvent(e,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,t),t.dispatchEvent(n)}else if(n&&t.click)t.click();else{if(void 0===t.fireEvent)throw Error("Browser doesn't support triggering events");t.fireEvent("on"+e)}else o(t).trigger(e)},c:function(t){return v.N(t)?t():t},$b:function(t){return v.N(t)?t.w():t},Eb:function(t,e,n){var i;e&&("object"==typeof t.classList?(i=t.classList[n?"add":"remove"],v.a.C(e.match(E),function(e){i.call(t.classList,e)})):"string"==typeof t.className.baseVal?h(t.className,"baseVal",e,n):h(t,"className",e,n))},Ab:function(e,n){var i=v.a.c(n);null!==i&&i!==t||(i="");var s=v.h.firstChild(e);!s||3!=s.nodeType||v.h.nextSibling(s)?v.h.ua(e,[e.ownerDocument.createTextNode(i)]):s.data=i,v.a.zd(e)},Xc:function(t,e){if(t.name=e,7>=b)try{var n=t.name.replace(/[&<>'"]/g,function(t){return"&#"+t.charCodeAt(0)+";"});t.mergeAttributes(s.createElement("<input name='"+n+"'/>"),!1)}catch(t){}},zd:function(t){9<=b&&(t=1==t.nodeType?t:t.parentNode).style&&(t.style.zoom=t.style.zoom)},vd:function(t){if(b){var e=t.style.width;t.style.width=0,t.style.width=e}},Od:function(t,e){t=v.a.c(t),e=v.a.c(e);for(var n=[],i=t;i<=e;i++)n.push(i);return n},la:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(t[n]);return e},Da:function(t){return d?Symbol(t):t},Xd:6===b,Yd:7===b,W:b,Kc:function(t,e){for(var n=v.a.la(t.getElementsByTagName("input")).concat(v.a.la(t.getElementsByTagName("textarea"))),i="string"==typeof e?function(t){return t.name===e}:function(t){return e.test(t.name)},s=[],r=n.length-1;0<=r;r--)i(n[r])&&s.push(n[r]);return s},Md:function(t){return"string"==typeof t&&(t=v.a.Cb(t))?a&&a.parse?a.parse(t):new Function("return "+t)():null},fc:function(t,e,n){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(v.a.c(t),e,n)},Nd:function(t,n,i){var r=(i=i||{}).params||{},o=i.includeFields||this.Ic,a=t;if("object"==typeof t&&"form"===v.a.P(t)){a=t.action;for(var l=o.length-1;0<=l;l--)for(var h=v.a.Kc(t,o[l]),c=h.length-1;0<=c;c--)r[h[c].name]=h[c].value}n=v.a.c(n);var u=s.createElement("form");for(var d in u.style.display="none",u.action=a,u.method="post",n)(t=s.createElement("input")).type="hidden",t.name=d,t.value=v.a.fc(v.a.c(n[d])),u.appendChild(t);e(r,function(t,e){var n=s.createElement("input");n.type="hidden",n.name=t,n.value=e,u.appendChild(n)}),s.body.appendChild(u),i.submitter?i.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),v.b("utils",v.a),v.b("utils.arrayForEach",v.a.C),v.b("utils.arrayFirst",v.a.Lb),v.b("utils.arrayFilter",v.a.fb),v.b("utils.arrayGetDistinctValues",v.a.vc),v.b("utils.arrayIndexOf",v.a.A),v.b("utils.arrayMap",v.a.Mb),v.b("utils.arrayPushAll",v.a.gb),v.b("utils.arrayRemoveItem",v.a.hb),v.b("utils.cloneNodes",v.a.Ca),v.b("utils.createSymbolOrString",v.a.Da),v.b("utils.extend",v.a.extend),v.b("utils.fieldsIncludedWithJsonPost",v.a.Ic),v.b("utils.getFormFields",v.a.Kc),v.b("utils.objectMap",v.a.Ha),v.b("utils.peekObservable",v.a.$b),v.b("utils.postJson",v.a.Nd),v.b("utils.parseJson",v.a.Md),v.b("utils.registerEventHandler",v.a.H),v.b("utils.stringifyJson",v.a.fc),v.b("utils.range",v.a.Od),v.b("utils.toggleDomNodeCssClass",v.a.Eb),v.b("utils.triggerEvent",v.a.Fb),v.b("utils.unwrapObservable",v.a.c),v.b("utils.objectForEach",v.a.O),v.b("utils.addOrRemoveItem",v.a.Oa),v.b("utils.setTextContent",v.a.Ab),v.b("unwrap",v.a.c),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(1===arguments.length)return function(){return e.apply(t,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice(0);return i.push.apply(i,arguments),e.apply(t,i)}}),v.a.g=new function(){var e,n,i=0,s="__ko__"+(new Date).getTime(),r={};return v.a.W?(e=function(e,n){var o=e[s];if(!o||"null"===o||!r[o]){if(!n)return t;o=e[s]="ko"+i++,r[o]={}}return r[o]},n=function(t){var e=t[s];return!!e&&(delete r[e],t[s]=null,!0)}):(e=function(t,e){var n=t[s];return!n&&e&&(n=t[s]={}),n},n=function(t){return!!t[s]&&(delete t[s],!0)}),{get:function(t,n){var i=e(t,!1);return i&&i[n]},set:function(n,i,s){(n=e(n,s!==t))&&(n[i]=s)},Tb:function(t,n,i){return(t=e(t,!0))[n]||(t[n]=i)},clear:n,Z:function(){return i+++s}}},v.b("utils.domData",v.a.g),v.b("utils.domData.clear",v.a.g.clear),v.a.I=new function(){function e(e,n){var i=v.a.g.get(e,s);return i===t&&n&&(i=[],v.a.g.set(e,s,i)),i}function n(t){if(n=e(t,!1))for(var n=n.slice(0),s=0;s<n.length;s++)n[s](t);v.a.g.clear(t),v.a.I.cleanExternalData(t),a[t.nodeType]&&i(t.childNodes,!0)}function i(t,e){for(var i,s=[],r=0;r<t.length;r++)if((!e||8===t[r].nodeType)&&(n(s[s.length]=i=t[r]),t[r]!==i))for(;r--&&-1==v.a.A(s,t[r]););}var s=v.a.g.Z(),r={1:!0,8:!0,9:!0},a={1:!0,9:!0};return{za:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},xb:function(n,i){var r=e(n,!1);r&&(v.a.hb(r,i),0==r.length&&v.a.g.set(n,s,t))},na:function(t){return r[t.nodeType]&&(n(t),a[t.nodeType]&&i(t.getElementsByTagName("*"))),t},removeNode:function(t){v.na(t),t.parentNode&&t.parentNode.removeChild(t)},cleanExternalData:function(t){o&&"function"==typeof o.cleanData&&o.cleanData([t])}}},v.na=v.a.I.na,v.removeNode=v.a.I.removeNode,v.b("cleanNode",v.na),v.b("removeNode",v.removeNode),v.b("utils.domNodeDisposal",v.a.I),v.b("utils.domNodeDisposal.addDisposeCallback",v.a.I.za),v.b("utils.domNodeDisposal.removeDisposeCallback",v.a.I.xb),p=[0,"",""],E={thead:g=[1,"<table>","</table>"],tbody:g,tfoot:g,tr:[2,"<table><tbody>","</tbody></table>"],td:m=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:m,option:b=[1,"<select multiple='multiple'>","</select>"],optgroup:b},w=8>=v.a.W,v.a.ta=function(t,e){var n;if(o){if(o.parseHTML)n=o.parseHTML(t,e)||[];else if((n=o.clean([t],e))&&n[0]){for(var r=n[0];r.parentNode&&11!==r.parentNode.nodeType;)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}}else{(n=e)||(n=s),r=n.parentWindow||n.defaultView||i;var a,l=v.a.Cb(t).toLowerCase(),h=n.createElement("div");for(a=(l=l.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&E[l[1]]||p,l=a[0],a="ignored<div>"+a[1]+t+a[2]+"</div>","function"==typeof r.innerShiv?h.appendChild(r.innerShiv(a)):(w&&n.body.appendChild(h),h.innerHTML=a,w&&h.parentNode.removeChild(h));l--;)h=h.lastChild;n=v.a.la(h.lastChild.childNodes)}return n},v.a.Ld=function(t,e){var n=v.a.ta(t,e);return n.length&&n[0].parentElement||v.a.Xb(n)},v.a.dc=function(e,n){if(v.a.Sb(e),null!==(n=v.a.c(n))&&n!==t)if("string"!=typeof n&&(n=n.toString()),o)o(e).html(n);else for(var i=v.a.ta(n,e.ownerDocument),s=0;s<i.length;s++)e.appendChild(i[s])},v.b("utils.parseHtmlFragment",v.a.ta),v.b("utils.setHtml",v.a.dc),v.aa=function(){var e={};return{Wb:function(t){if("function"!=typeof t)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return e[n]=t,"\x3c!--[ko_memo:"+n+"]--\x3e"},ad:function(n,i){var s=e[n];if(s===t)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return s.apply(null,i||[]),!0}finally{delete e[n]}},bd:function(t,e){var n=[];!function t(e,n){if(e)if(8==e.nodeType)null!=(i=v.aa.Tc(e.nodeValue))&&n.push({sd:e,Jd:i});else if(1==e.nodeType)for(var i=0,s=e.childNodes,r=s.length;i<r;i++)t(s[i],n)}(t,n);for(var i=0,s=n.length;i<s;i++){var r=n[i].sd,o=[r];e&&v.a.gb(o,e),v.aa.ad(n[i].Jd,o),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)}},Tc:function(t){return(t=t.match(/^\[ko_memo\:(.*?)\]$/))?t[1]:null}}}(),v.b("memoization",v.aa),v.b("memoization.memoize",v.aa.Wb),v.b("memoization.unmemoize",v.aa.ad),v.b("memoization.parseMemoText",v.aa.Tc),v.b("memoization.unmemoizeDomNodeAndDescendants",v.aa.bd),v.ma=function(){function t(){if(r)for(var t,e=r,i=0;a<r;)if(t=n[a++]){if(a>e){if(5e3<=++i){a=r,v.a.Fc(Error("'Too much recursion' after processing "+i+" task groups."));break}e=r}try{t()}catch(t){v.a.Fc(t)}}}function e(){t(),a=r=n.length=0}var n=[],r=0,o=1,a=0;return{scheduler:i.MutationObserver?function(t){var e=s.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}(e):s&&"onreadystatechange"in s.createElement("script")?function(t){var e=s.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,s.documentElement.removeChild(e),e=null,t()},s.documentElement.appendChild(e)}:function(t){setTimeout(t,0)},yb:function(t){return r||v.ma.scheduler(e),n[r++]=t,o++},cancel:function(t){(t-=o-r)>=a&&t<r&&(n[t]=null)},resetForTesting:function(){var t=r-a;return a=r=n.length=0,t},Rd:t}}(),v.b("tasks",v.ma),v.b("tasks.schedule",v.ma.yb),v.b("tasks.runEarly",v.ma.Rd),v.Ta={throttle:function(t,e){t.throttleEvaluation=e;var n=null;return v.$({read:t,write:function(i){clearTimeout(n),n=v.a.setTimeout(function(){t(i)},e)}})},rateLimit:function(t,e){var n,i,s;"number"==typeof e?n=e:(n=e.timeout,i=e.method),t.Hb=!1,s="function"==typeof i?i:"notifyWhenChangesStop"==i?c:h,t.tb(function(t){return s(t,n,e)})},deferred:function(e,n){if(!0!==n)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.Hb||(e.Hb=!0,e.tb(function(n){var i,s=!1;return function(){if(!s){v.ma.cancel(i),i=v.ma.yb(n);try{s=!0,e.notifySubscribers(t,"dirty")}finally{s=!1}}}}))},notify:function(t,e){t.equalityComparer="always"==e?null:l}};var y={undefined:1,boolean:1,number:1,string:1};v.b("extenders",v.Ta),v.gc=function(t,e,n){this.da=t,this.kc=e,this.lc=n,this.Ib=!1,this.ab=this.Jb=null,v.J(this,"dispose",this.s),v.J(this,"disposeWhenNodeIsRemoved",this.l)},v.gc.prototype.s=function(){this.Ib||(this.ab&&v.a.I.xb(this.Jb,this.ab),this.Ib=!0,this.lc(),this.da=this.kc=this.lc=this.Jb=this.ab=null)},v.gc.prototype.l=function(t){this.Jb=t,v.a.I.za(t,this.ab=this.s.bind(this))},v.R=function(){v.a.zb(this,T),T.ob(this)};var T={ob:function(t){t.S={change:[]},t.rc=1},subscribe:function(t,e,n){var i=this;n=n||"change";var s=new v.gc(i,e?t.bind(e):t,function(){v.a.hb(i.S[n],s),i.cb&&i.cb(n)});return i.Qa&&i.Qa(n),i.S[n]||(i.S[n]=[]),i.S[n].push(s),s},notifySubscribers:function(t,e){if("change"===(e=e||"change")&&this.Gb(),this.Wa(e)){var n="change"===e&&this.dd||this.S[e].slice(0);try{v.v.wc();for(var i,s=0;i=n[s];++s)i.Ib||i.kc(t)}finally{v.v.end()}}},mb:function(){return this.rc},Cd:function(t){return this.mb()!==t},Gb:function(){++this.rc},tb:function(t){var e,n,i,s,r,o=this,a=v.N(o);o.bb||(o.bb=o.notifySubscribers,o.notifySubscribers=u);var l=t(function(){o.Ka=!1,a&&s===o&&(s=o.mc?o.mc():o());var t=n||r&&o.qb(i,s);r=n=e=!1,t&&o.bb(i=s)});o.pc=function(t,n){n&&o.Ka||(r=!n),o.dd=o.S.change.slice(0),o.Ka=e=!0,s=t,l()},o.oc=function(t){e||(i=t,o.bb(t,"beforeChange"))},o.qc=function(){r=!0},o.fd=function(){o.qb(i,o.w(!0))&&(n=!0)}},Wa:function(t){return this.S[t]&&this.S[t].length},Ad:function(t){if(t)return this.S[t]&&this.S[t].length||0;var e=0;return v.a.O(this.S,function(t,n){"dirty"!==t&&(e+=n.length)}),e},qb:function(t,e){return!this.equalityComparer||!this.equalityComparer(t,e)},toString:function(){return"[object Object]"},extend:function(t){var e=this;return t&&v.a.O(t,function(t,n){var i=v.Ta[t];"function"==typeof i&&(e=i(e,n)||e)}),e}};v.J(T,"init",T.ob),v.J(T,"subscribe",T.subscribe),v.J(T,"extend",T.extend),v.J(T,"getSubscriptionsCount",T.Ad),v.a.Ba&&v.a.setPrototypeOf(T,Function.prototype),v.R.fn=T,v.Pc=function(t){return null!=t&&"function"==typeof t.subscribe&&"function"==typeof t.notifySubscribers},v.b("subscribable",v.R),v.b("isSubscribable",v.Pc),v.U=v.v=function(){function t(t){i.push(n),n=t}function e(){n=i.pop()}var n,i=[],s=0;return{wc:t,end:e,ac:function(t){if(n){if(!v.Pc(t))throw Error("Only subscribable things can act as dependencies");n.nd.call(n.od,t,t.ed||(t.ed=++s))}},K:function(n,i,s){try{return t(),n.apply(i,s||[])}finally{e()}},pa:function(){if(n)return n.o.pa()},Va:function(){if(n)return n.o.Va()},rb:function(){if(n)return n.rb},o:function(){if(n)return n.o}}}(),v.b("computedContext",v.U),v.b("computedContext.getDependenciesCount",v.U.pa),v.b("computedContext.getDependencies",v.U.Va),v.b("computedContext.isInitial",v.U.rb),v.b("computedContext.registerDependency",v.U.ac),v.b("ignoreDependencies",v.Wd=v.v.K);var N=v.a.Da("_latestValue");v.sa=function(t){function e(){return 0<arguments.length?(e.qb(e[N],arguments[0])&&(e.xa(),e[N]=arguments[0],e.wa()),this):(v.v.ac(e),e[N])}return e[N]=t,v.a.Ba||v.a.extend(e,v.R.fn),v.R.fn.ob(e),v.a.zb(e,S),v.options.deferUpdates&&v.Ta.deferred(e,!0),e};var S={equalityComparer:l,w:function(){return this[N]},wa:function(){this.notifySubscribers(this[N],"spectate"),this.notifySubscribers(this[N])},xa:function(){this.notifySubscribers(this[N],"beforeChange")}};v.a.Ba&&v.a.setPrototypeOf(S,v.R.fn);var x=v.sa.Na="__ko_proto__";S[x]=v.sa,v.N=function(t){if((t="function"==typeof t&&t[x])&&t!==S[x]&&t!==v.o.fn[x])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!t},v.Ya=function(t){return"function"==typeof t&&(t[x]===S[x]||t[x]===v.o.fn[x]&&t.Mc)},v.b("observable",v.sa),v.b("isObservable",v.N),v.b("isWriteableObservable",v.Ya),v.b("isWritableObservable",v.Ya),v.b("observable.fn",S),v.J(S,"peek",S.w),v.J(S,"valueHasMutated",S.wa),v.J(S,"valueWillMutate",S.xa),v.Ia=function(t){if("object"!=typeof(t=t||[])||!("length"in t))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return t=v.sa(t),v.a.zb(t,v.Ia.fn),t.extend({trackArrayChanges:!0})},v.Ia.fn={remove:function(t){for(var e=this.w(),n=[],i="function"!=typeof t||v.N(t)?function(e){return e===t}:t,s=0;s<e.length;s++){var r=e[s];if(i(r)){if(0===n.length&&this.xa(),e[s]!==r)throw Error("Array modified during remove; cannot remove item");n.push(r),e.splice(s,1),s--}}return n.length&&this.wa(),n},removeAll:function(e){if(e===t){var n=this.w(),i=n.slice(0);return this.xa(),n.splice(0,n.length),this.wa(),i}return e?this.remove(function(t){return 0<=v.a.A(e,t)}):[]},destroy:function(t){var e=this.w(),n="function"!=typeof t||v.N(t)?function(e){return e===t}:t;this.xa();for(var i=e.length-1;0<=i;i--){var s=e[i];n(s)&&(s._destroy=!0)}this.wa()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=v.a.A(e,t)}):[]},indexOf:function(t){var e=this();return v.a.A(e,t)},replace:function(t,e){var n=this.indexOf(t);0<=n&&(this.xa(),this.w()[n]=e,this.wa())},sorted:function(t){var e=this().slice(0);return t?e.sort(t):e.sort()},reversed:function(){return this().slice(0).reverse()}},v.a.Ba&&v.a.setPrototypeOf(v.Ia.fn,v.sa.fn),v.a.C("pop push reverse shift sort splice unshift".split(" "),function(t){v.Ia.fn[t]=function(){var e=this.w();this.xa(),this.yc(e,t,arguments);var n=e[t].apply(e,arguments);return this.wa(),n===e?this:n}}),v.a.C(["slice"],function(t){v.Ia.fn[t]=function(){var e=this();return e[t].apply(e,arguments)}}),v.Oc=function(t){return v.N(t)&&"function"==typeof t.remove&&"function"==typeof t.push},v.b("observableArray",v.Ia),v.b("isObservableArray",v.Oc),v.Ta.trackArrayChanges=function(e,n){function i(){function t(){if(h){var t,n=[].concat(e.w()||[]);e.Wa("arrayChange")&&((!l||1<h)&&(l=v.a.Ob(r,n,e.Nb)),t=l),r=n,l=null,h=0,t&&t.length&&e.notifySubscribers(t,"arrayChange")}}a?t():(a=!0,o=e.notifySubscribers,e.notifySubscribers=function(t,e){return e&&"change"!==e||++h,o.apply(this,arguments)},r=[].concat(e.w()||[]),l=null,s=e.subscribe(t))}if(e.Nb={},n&&"object"==typeof n&&v.a.extend(e.Nb,n),e.Nb.sparse=!0,!e.yc){var s,r,o,a=!1,l=null,h=0,c=e.Qa,u=e.cb;e.Qa=function(t){c&&c.call(e,t),"arrayChange"===t&&i()},e.cb=function(n){u&&u.call(e,n),"arrayChange"!==n||e.Wa("arrayChange")||(o&&(e.notifySubscribers=o,o=t),s&&s.s(),s=null,a=!1,r=t)},e.yc=function(t,e,n){function i(t,e,n){return s[s.length]={status:t,value:e,index:n}}if(a&&!h){var s=[],r=t.length,o=n.length,c=0;switch(e){case"push":c=r;case"unshift":for(e=0;e<o;e++)i("added",n[e],c+e);break;case"pop":c=r-1;case"shift":r&&i("deleted",t[c],c);break;case"splice":e=Math.min(Math.max(0,0>n[0]?r+n[0]:n[0]),r),r=1===o?r:Math.min(e+(n[1]||0),r),o=e+o-2,c=Math.max(r,o);for(var u=[],d=[],f=2;e<c;++e,++f)e<r&&d.push(i("deleted",t[e],e)),e<o&&u.push(i("added",n[f],e));v.a.Jc(d,u);break;default:return}l=s}}}};var I=v.a.Da("_state");v.o=v.$=function(e,n,i){function s(){if(0<arguments.length){if("function"!=typeof r)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return r.apply(o.lb,arguments),this}return o.qa||v.v.ac(s),(o.ka||o.G&&s.Xa())&&s.ha(),o.X}if("object"==typeof e?i=e:(i=i||{},e&&(i.read=e)),"function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var r=i.write,o={X:t,ra:!0,ka:!0,pb:!1,hc:!1,qa:!1,vb:!1,G:!1,Vc:i.read,lb:n||i.owner,l:i.disposeWhenNodeIsRemoved||i.l||null,Sa:i.disposeWhen||i.Sa,Qb:null,F:{},V:0,Hc:null};return s[I]=o,s.Mc="function"==typeof r,v.a.Ba||v.a.extend(s,v.R.fn),v.R.fn.ob(s),v.a.zb(s,C),i.pure?(o.vb=!0,o.G=!0,v.a.extend(s,O)):i.deferEvaluation&&v.a.extend(s,_),v.options.deferUpdates&&v.Ta.deferred(s,!0),o.l&&(o.hc=!0,o.l.nodeType||(o.l=null)),o.G||i.deferEvaluation||s.ha(),o.l&&s.ja()&&v.a.I.za(o.l,o.Qb=function(){s.s()}),s};var C={equalityComparer:l,pa:function(){return this[I].V},Va:function(){var t=[];return v.a.O(this[I].F,function(e,n){t[n.La]=n.da}),t},Ub:function(t){if(!this[I].V)return!1;var e=this.Va();return-1!==v.a.A(e,t)||!!v.a.Lb(e,function(e){return e.Ub&&e.Ub(t)})},tc:function(t,e,n){if(this[I].vb&&e===this)throw Error("A 'pure' computed must not be called recursively");this[I].F[t]=n,n.La=this[I].V++,n.Ma=e.mb()},Xa:function(){var t,e,n=this[I].F;for(t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&(e=n[t],this.Ja&&e.da.Ka||e.da.Cd(e.Ma)))return!0},Id:function(){this.Ja&&!this[I].pb&&this.Ja(!1)},ja:function(){var t=this[I];return t.ka||0<t.V},Qd:function(){this.Ka?this[I].ka&&(this[I].ra=!0):this.Gc()},Zc:function(t){if(t.Hb){var e=t.subscribe(this.Id,this,"dirty"),n=t.subscribe(this.Qd,this);return{da:t,s:function(){e.s(),n.s()}}}return t.subscribe(this.Gc,this)},Gc:function(){var t=this,e=t.throttleEvaluation;e&&0<=e?(clearTimeout(this[I].Hc),this[I].Hc=v.a.setTimeout(function(){t.ha(!0)},e)):t.Ja?t.Ja(!0):t.ha(!0)},ha:function(t){var e=this[I],n=e.Sa,i=!1;if(!e.pb&&!e.qa){if(e.l&&!v.a.Rb(e.l)||n&&n()){if(!e.hc)return void this.s()}else e.hc=!1;e.pb=!0;try{i=this.yd(t)}finally{e.pb=!1}return i}},yd:function(e){var n=this[I],i=!1,s=n.vb?t:!n.V;i={pd:this,kb:n.F,Pb:n.V},v.v.wc({od:i,nd:f,o:this,rb:s}),n.F={},n.V=0;var r=this.xd(n,i);return n.V?i=this.qb(n.X,r):(this.s(),i=!0),i&&(n.G?this.Gb():this.notifySubscribers(n.X,"beforeChange"),n.X=r,this.notifySubscribers(n.X,"spectate"),!n.G&&e&&this.notifySubscribers(n.X),this.qc&&this.qc()),s&&this.notifySubscribers(n.X,"awake"),i},xd:function(t,e){try{var n=t.Vc;return t.lb?n.call(t.lb):n()}finally{v.v.end(),e.Pb&&!t.G&&v.a.O(e.kb,d),t.ra=t.ka=!1}},w:function(t){var e=this[I];return(e.ka&&(t||!e.V)||e.G&&this.Xa())&&this.ha(),e.X},tb:function(t){v.R.fn.tb.call(this,t),this.mc=function(){return this[I].G||(this[I].ra?this.ha():this[I].ka=!1),this[I].X},this.Ja=function(t){this.oc(this[I].X),this[I].ka=!0,t&&(this[I].ra=!0),this.pc(this,!t)}},s:function(){var e=this[I];!e.G&&e.F&&v.a.O(e.F,function(t,e){e.s&&e.s()}),e.l&&e.Qb&&v.a.I.xb(e.l,e.Qb),e.F=t,e.V=0,e.qa=!0,e.ra=!1,e.ka=!1,e.G=!1,e.l=t,e.Sa=t,e.Vc=t,this.Mc||(e.lb=t)}},O={Qa:function(t){var e=this,n=e[I];if(!n.qa&&n.G&&"change"==t){if(n.G=!1,n.ra||e.Xa())n.F=null,n.V=0,e.ha()&&e.Gb();else{var i=[];v.a.O(n.F,function(t,e){i[e.La]=t}),v.a.C(i,function(t,i){var s=n.F[t],r=e.Zc(s.da);r.La=i,r.Ma=s.Ma,n.F[t]=r}),e.Xa()&&e.ha()&&e.Gb()}n.qa||e.notifySubscribers(n.X,"awake")}},cb:function(e){var n=this[I];n.qa||"change"!=e||this.Wa("change")||(v.a.O(n.F,function(t,e){e.s&&(n.F[t]={da:e.da,La:e.La,Ma:e.Ma},e.s())}),n.G=!0,this.notifySubscribers(t,"asleep"))},mb:function(){var t=this[I];return t.G&&(t.ra||this.Xa())&&this.ha(),v.R.fn.mb.call(this)}},_={Qa:function(t){"change"!=t&&"beforeChange"!=t||this.w()}};v.a.Ba&&v.a.setPrototypeOf(C,v.R.fn);var A=v.sa.Na;C[A]=v.o,v.Nc=function(t){return"function"==typeof t&&t[A]===C[A]},v.Ed=function(t){return v.Nc(t)&&t[I]&&t[I].vb},v.b("computed",v.o),v.b("dependentObservable",v.o),v.b("isComputed",v.Nc),v.b("isPureComputed",v.Ed),v.b("computed.fn",C),v.J(C,"peek",C.w),v.J(C,"dispose",C.s),v.J(C,"isActive",C.ja),v.J(C,"getDependenciesCount",C.pa),v.J(C,"getDependencies",C.Va),v.wb=function(t,e){return"function"==typeof t?v.o(t,e,{pure:!0}):((t=v.a.extend({},t)).pure=!0,v.o(t,e))},v.b("pureComputed",v.wb),function(){function e(i,s,r){if(r=r||new n,"object"!=typeof(i=s(i))||null===i||i===t||i instanceof RegExp||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i;var o=i instanceof Array?[]:{};return r.save(i,o),function(t,e){if(t instanceof Array){for(var n=0;n<t.length;n++)e(n);"function"==typeof t.toJSON&&e("toJSON")}else for(n in t)e(n)}(i,function(n){var a=s(i[n]);switch(typeof a){case"boolean":case"number":case"string":case"function":o[n]=a;break;case"object":case"undefined":var l=r.get(a);o[n]=l!==t?l:e(a,s,r)}}),o}function n(){this.keys=[],this.values=[]}v.$c=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(t){for(var e=0;v.N(t)&&10>e;e++)t=t();return t})},v.toJSON=function(t,e,n){return t=v.$c(t),v.a.fc(t,e,n)},n.prototype={constructor:n,save:function(t,e){var n=v.a.A(this.keys,t);0<=n?this.values[n]=e:(this.keys.push(t),this.values.push(e))},get:function(e){return 0<=(e=v.a.A(this.keys,e))?this.values[e]:t}}}(),v.b("toJS",v.$c),v.b("toJSON",v.toJSON),v.Vd=function(t,e,n){function i(e){var i=v.wb(t,n).extend({Ga:"always"}),s=i.subscribe(function(t){t&&(s.s(),e(t))});return i.notifySubscribers(i.w()),s}return"function"!=typeof Promise||e?i(e.bind(n)):new Promise(i)},v.b("when",v.Vd),v.u={L:function(e){switch(v.a.P(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?v.a.g.get(e,v.f.options.Yb):7>=v.a.W?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?v.u.L(e.options[e.selectedIndex]):t;default:return e.value}},ya:function(e,n,i){switch(v.a.P(e)){case"option":"string"==typeof n?(v.a.g.set(e,v.f.options.Yb,t),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=n):(v.a.g.set(e,v.f.options.Yb,n),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof n?n:"");break;case"select":""!==n&&null!==n||(n=t);for(var s,r=-1,o=0,a=e.options.length;o<a;++o)if((s=v.u.L(e.options[o]))==n||""===s&&n===t){r=o;break}(i||0<=r||n===t&&1<e.size)&&(e.selectedIndex=r,6===v.a.W&&v.a.setTimeout(function(){e.selectedIndex=r},0));break;default:null!==n&&n!==t||(n=""),e.value=n}}},v.b("selectExtensions",v.u),v.b("selectExtensions.readValue",v.u.L),v.b("selectExtensions.writeValue",v.u.ya),v.m=function(){function t(t){123===(t=v.a.Cb(t)).charCodeAt(0)&&(t=t.slice(1,-1));var e,n=[],o=(t+="\n,").match(i),a=[],l=0;if(1<o.length){for(var h,c=0;h=o[c];++c){var u=h.charCodeAt(0);if(44===u){if(0>=l){n.push(e&&a.length?{key:e,value:a.join("")}:{unknown:e||a.join("")}),e=l=0,a=[];continue}}else if(58===u){if(!l&&!e&&1===a.length){e=a.pop();continue}}else{if(47===u&&1<h.length&&(47===h.charCodeAt(1)||42===h.charCodeAt(1)))continue;47===u&&c&&1<h.length?(u=o[c-1].match(s))&&!r[u[0]]&&(o=(t=t.substr(t.indexOf(h)+1)).match(i),c=-1,h="/"):40===u||123===u||91===u?++l:41===u||125===u||93===u?--l:e||a.length||34!==u&&39!==u||(h=h.slice(1,-1))}a.push(h)}if(0<l)throw Error("Unbalanced parentheses, braces, or brackets")}return n}var e=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),s=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},o={};return{Ra:[],va:o,Zb:t,ub:function(i,s){function r(t,i){var s;if(!c){var u=v.getBindingHandler(t);if(u&&u.preprocess&&!(i=u.preprocess(i,t,r)))return;(u=o[t])&&(s=i,0<=v.a.A(e,s)?s=!1:(u=s.match(n),s=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:s)),u=s),u&&l.push("'"+("string"==typeof o[t]?o[t]:t)+"':function(_z){"+s+"=_z}")}h&&(i="function(){return "+i+" }"),a.push("'"+t+"':"+i)}var a=[],l=[],h=(s=s||{}).valueAccessors,c=s.bindingParams,u="string"==typeof i?t(i):i;return v.a.C(u,function(t){r(t.key||t.unknown,t.value)}),l.length&&r("_ko_property_writers","{"+l.join(",")+" }"),a.join(",")},Hd:function(t,e){for(var n=0;n<t.length;n++)if(t[n].key==e)return!0;return!1},$a:function(t,e,n,i,s){t&&v.N(t)?!v.Ya(t)||s&&t.w()===i||t(i):(t=e.get("_ko_property_writers"))&&t[n]&&t[n](i)}}}(),v.b("expressionRewriting",v.m),v.b("expressionRewriting.bindingRewriteValidators",v.m.Ra),v.b("expressionRewriting.parseObjectLiteral",v.m.Zb),v.b("expressionRewriting.preProcessBindings",v.m.ub),v.b("expressionRewriting._twoWayBindings",v.m.va),v.b("jsonExpressionRewriting",v.m),v.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",v.m.ub),function(){function t(t){return 8==t.nodeType&&o.test(r?t.text:t.nodeValue)}function e(t){return 8==t.nodeType&&a.test(r?t.text:t.nodeValue)}function n(n,i){for(var s=n,r=1,o=[];s=s.nextSibling;){if(e(s)&&(v.a.g.set(s,h,!0),0==--r))return o;o.push(s),t(s)&&r++}if(!i)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function i(t,e){var i=n(t,e);return i?0<i.length?i[i.length-1].nextSibling:t.nextSibling:null}var r=s&&"\x3c!--test--\x3e"===s.createComment("test").text,o=r?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,a=r?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0},h="__ko_matchedEndComment__";v.h={ea:{},childNodes:function(e){return t(e)?n(e):e.childNodes},Ea:function(e){if(t(e))for(var n=0,i=(e=v.h.childNodes(e)).length;n<i;n++)v.removeNode(e[n]);else v.a.Sb(e)},ua:function(e,n){if(t(e)){v.h.Ea(e);for(var i=e.nextSibling,s=0,r=n.length;s<r;s++)i.parentNode.insertBefore(n[s],i)}else v.a.ua(e,n)},Uc:function(e,n){t(e)?e.parentNode.insertBefore(n,e.nextSibling):e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)},Vb:function(e,n,i){i?t(e)?e.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):v.h.Uc(e,n)},firstChild:function(n){if(t(n))return!n.nextSibling||e(n.nextSibling)?null:n.nextSibling;if(n.firstChild&&e(n.firstChild))throw Error("Found invalid end comment, as the first child of "+n);return n.firstChild},nextSibling:function(n){if(t(n)&&(n=i(n)),n.nextSibling&&e(n.nextSibling)){var s=n.nextSibling;if(e(s)&&!v.a.g.get(s,h))throw Error("Found end comment without a matching opening comment, as child of "+n);return null}return n.nextSibling},Bd:t,Ud:function(t){return(t=(r?t.text:t.nodeValue).match(o))?t[1]:null},Rc:function(n){if(l[v.a.P(n)]){var s=n.firstChild;if(s)do{if(1===s.nodeType){var r,o=null;if(r=s.firstChild)do{if(o)o.push(r);else if(t(r)){var a=i(r,!0);a?r=a:o=[r]}else e(r)&&(o=[r])}while(r=r.nextSibling);if(r=o)for(o=s.nextSibling,a=0;a<r.length;a++)o?n.insertBefore(r[a],o):n.appendChild(r[a])}}while(s=s.nextSibling)}}}}(),v.b("virtualElements",v.h),v.b("virtualElements.allowedBindings",v.h.ea),v.b("virtualElements.emptyNode",v.h.Ea),v.b("virtualElements.insertAfter",v.h.Vb),v.b("virtualElements.prepend",v.h.Uc),v.b("virtualElements.setDomNodeChildren",v.h.ua),v.ga=function(){this.md={}},v.a.extend(v.ga.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return null!=t.getAttribute("data-bind")||v.i.getComponentNameForNode(t);case 8:return v.h.Bd(t);default:return!1}},getBindings:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t):null;return v.i.sc(n,t,e,!1)},getBindingAccessors:function(t,e){var n=(n=this.getBindingsString(t,e))?this.parseBindingsString(n,e,t,{valueAccessors:!0}):null;return v.i.sc(n,t,e,!0)},getBindingsString:function(t){switch(t.nodeType){case 1:return t.getAttribute("data-bind");case 8:return v.h.Ud(t);default:return null}},parseBindingsString:function(t,e,n,i){try{var s,r=this.md,o=t+(i&&i.valueAccessors||"");if(!(s=r[o])){var a,l="with($context){with($data||{}){return{"+v.m.ub(t,i)+"}}}";a=new Function("$context","$element",l),s=r[o]=a}return s(e,n)}catch(e){throw e.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+e.message,e}}}),v.ga.instance=new v.ga,v.b("bindingProvider",v.ga),function(){function e(t){var e=(t=v.a.g.get(t,y))&&t.M;e&&(t.M=null,e.Sc())}function n(t,n,i){this.node=t,this.xc=n,this.ib=[],this.T=!1,n.M||v.a.I.za(t,e),i&&i.M&&(i.M.ib.push(t),this.Kb=i)}function r(t){return function(){return t}}function a(t){return t()}function l(t){return v.a.Ha(v.v.K(t),function(e,n){return function(){return t()[n]}})}function h(t,e,n){return"function"==typeof t?l(t.bind(null,e,n)):v.a.Ha(t,r)}function c(t,e){return l(this.getBindings.bind(this,t,e))}function u(t,e){var n=v.h.firstChild(e);if(n){var i,s=v.ga.instance,r=s.preprocessNode;if(r){for(;i=n;)n=v.h.nextSibling(i),r.call(s,i);n=v.h.firstChild(e)}for(;i=n;)n=v.h.nextSibling(i),d(t,i)}v.j.Ga(e,v.j.T)}function d(t,e){var n=t,i=1===e.nodeType;i&&v.h.Rc(e),(i||v.ga.instance.nodeHasBindings(e))&&(n=f(e,null,t).bindingContextForDescendants),n&&!E[v.a.P(e)]&&u(n,e)}function f(e,n,i){var s,r=v.a.g.Tb(e,y,{}),o=r.gd;if(!n){if(o)throw Error("You cannot apply bindings multiple times to the same element.");r.gd=!0}if(o||(r.context=i),n&&"function"!=typeof n)s=n;else{var l=v.ga.instance,h=l.getBindingAccessors||c,u=v.$(function(){return(s=n?n(i,e):h.call(l,e,i))&&(i[g]&&i[g](),i[b]&&i[b]()),s},null,{l:e});s&&u.ja()||(u=null)}var d,f=i;if(s){var p=function(){return v.a.Ha(u?u():s,a)},m=u?function(t){return function(){return a(u()[t])}}:function(t){return s[t]};p.get=function(t){return s[t]&&a(m(t))},p.has=function(t){return t in s},v.j.T in s&&v.j.subscribe(e,v.j.T,function(){var t=(0,s[v.j.T])();if(t){var n=v.h.childNodes(e);n.length&&t(n,v.Dc(n[0]))}}),v.j.oa in s&&(f=v.j.Bb(e,i),v.j.subscribe(e,v.j.oa,function(){var t=(0,s[v.j.oa])();t&&v.h.firstChild(e)&&t(e)})),r=function(t){var e=[],n={},i=[];return v.a.O(t,function s(r){if(!n[r]){var o=v.getBindingHandler(r);o&&(o.after&&(i.push(r),v.a.C(o.after,function(e){if(t[e]){if(-1!==v.a.A(i,e))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));s(e)}}),i.length--),e.push({key:r,Lc:o})),n[r]=!0}}),e}(s),v.a.C(r,function(n){var i=n.Lc.init,r=n.Lc.update,o=n.key;if(8===e.nodeType&&!v.h.ea[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof i&&v.v.K(function(){var n=i(e,m(o),p,f.$data,f);if(n&&n.controlsDescendantBindings){if(d!==t)throw Error("Multiple bindings ("+d+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");d=o}}),"function"==typeof r&&v.$(function(){r(e,m(o),p,f.$data,f)},null,{l:e})}catch(t){throw t.message='Unable to process binding "'+o+": "+s[o]+'"\nMessage: '+t.message,t}})}return{shouldBindDescendants:r=d===t,bindingContextForDescendants:r&&f}}function p(e,n){return e&&e instanceof v.fa?e:new v.fa(e,t,t,n)}var g=v.a.Da("_subscribable"),m=v.a.Da("_ancestorBindingInfo"),b=v.a.Da("_dataDependency");v.f={};var E={script:!0,textarea:!0,template:!0};v.getBindingHandler=function(t){return v.f[t]};var w={};v.fa=function(e,n,i,s,r){function o(){var t=u?c():c,e=v.a.c(t);return n?(v.a.extend(l,n),m in n&&(l[m]=n[m])):(l.$parents=[],l.$root=e,l.ko=v),l[g]=a,h?e=l.$data:(l.$rawData=t,l.$data=e),i&&(l[i]=e),s&&s(l,n,e),n&&n[g]&&!v.U.o().Ub(n[g])&&n[g](),d&&(l[b]=d),l.$data}var a,l=this,h=e===w,c=h?t:e,u="function"==typeof c&&!v.N(c),d=r&&r.dataDependency;r&&r.exportDependencies?o():((a=v.wb(o)).w(),a.ja()?a.equalityComparer=null:l[g]=t)},v.fa.prototype.createChildContext=function(t,e,n,i){if(!i&&e&&"object"==typeof e&&(e=(i=e).as,n=i.extend),e&&i&&i.noChildContext){var s="function"==typeof t&&!v.N(t);return new v.fa(w,this,null,function(i){n&&n(i),i[e]=s?t():t},i)}return new v.fa(t,this,e,function(t,e){t.$parentContext=e,t.$parent=e.$data,t.$parents=(e.$parents||[]).slice(0),t.$parents.unshift(t.$parent),n&&n(t)},i)},v.fa.prototype.extend=function(t,e){return new v.fa(w,this,null,function(e){v.a.extend(e,"function"==typeof t?t(e):t)},e)};var y=v.a.g.Z();n.prototype.Sc=function(){this.Kb&&this.Kb.M&&this.Kb.M.rd(this.node)},n.prototype.rd=function(t){v.a.hb(this.ib,t),!this.ib.length&&this.T&&this.Bc()},n.prototype.Bc=function(){this.T=!0,this.xc.M&&!this.ib.length&&(this.xc.M=null,v.a.I.xb(this.node,e),v.j.Ga(this.node,v.j.oa),this.Sc())},v.j={T:"childrenComplete",oa:"descendantsComplete",subscribe:function(t,e,n,i){return(t=v.a.g.Tb(t,y,{})).Fa||(t.Fa=new v.R),t.Fa.subscribe(n,i,e)},Ga:function(e,n){var i=v.a.g.get(e,y);if(i&&(i.Fa&&i.Fa.notifySubscribers(e,n),n==v.j.T))if(i.M)i.M.Bc();else if(i.M===t&&i.Fa&&i.Fa.Wa(v.j.oa))throw Error("descendantsComplete event not supported for bindings on this node")},Bb:function(t,e){var i=v.a.g.Tb(t,y,{});return i.M||(i.M=new n(t,i,e[m])),e[m]==i?e:e.extend(function(t){t[m]=i})}},v.Sd=function(t){return(t=v.a.g.get(t,y))&&t.context},v.eb=function(t,e,n){return 1===t.nodeType&&v.h.Rc(t),f(t,e,p(n))},v.kd=function(t,e,n){return n=p(n),v.eb(t,h(e,n,t),n)},v.Pa=function(t,e){1!==e.nodeType&&8!==e.nodeType||u(p(t),e)},v.uc=function(t,e,n){if(!o&&i.jQuery&&(o=i.jQuery),2>arguments.length){if(!(e=s.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!e||1!==e.nodeType&&8!==e.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");d(p(t,n),e)},v.Cc=function(e){return!e||1!==e.nodeType&&8!==e.nodeType?t:v.Sd(e)},v.Dc=function(e){return(e=v.Cc(e))?e.$data:t},v.b("bindingHandlers",v.f),v.b("bindingEvent",v.j),v.b("bindingEvent.subscribe",v.j.subscribe),v.b("bindingEvent.startPossiblyAsyncContentBinding",v.j.Bb),v.b("applyBindings",v.uc),v.b("applyBindingsToDescendants",v.Pa),v.b("applyBindingAccessorsToNode",v.eb),v.b("applyBindingsToNode",v.kd),v.b("contextFor",v.Cc),v.b("dataFor",v.Dc)}(),function(t){function e(e,i){var o,a=Object.prototype.hasOwnProperty.call(s,e)?s[e]:t;a?a.subscribe(i):((a=s[e]=new v.R).subscribe(i),n(e,function(t,n){var i=!(!n||!n.synchronous);r[e]={definition:t,Fd:i},delete s[e],o||i?a.notifySubscribers(t):v.ma.yb(function(){a.notifySubscribers(t)})}),o=!0)}function n(t,e){i("getConfig",[t],function(n){n?i("loadComponent",[t,n],function(t){e(t,n)}):e(null,null)})}function i(e,n,s,r){r||(r=v.i.loaders.slice(0));var o=r.shift();if(o){var a=o[e];if(a){var l=!1;if(a.apply(o,n.concat(function(t){l?s(null):null!==t?s(t):i(e,n,s,r)}))!==t&&(l=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(e,n,s,r)}else s(null)}var s={},r={};v.i={get:function(n,i){var s=Object.prototype.hasOwnProperty.call(r,n)?r[n]:t;s?s.Fd?v.v.K(function(){i(s.definition)}):v.ma.yb(function(){i(s.definition)}):e(n,i)},Ac:function(t){delete r[t]},nc:i},v.i.loaders=[],v.b("components",v.i),v.b("components.get",v.i.get),v.b("components.clearCachedDefinition",v.i.Ac)}(),function(){function t(t,e,n,i){function s(){0==--a&&i(r)}var r={},a=2,l=n.template;n=n.viewModel,l?o(e,l,function(e){v.i.nc("loadTemplate",[t,e],function(t){r.template=t,s()})}):s(),n?o(e,n,function(e){v.i.nc("loadViewModel",[t,e],function(t){r[h]=t,s()})}):s()}function e(t){switch(v.a.P(t)){case"script":return v.a.ta(t.text);case"textarea":return v.a.ta(t.value);case"template":if(r(t.content))return v.a.Ca(t.content.childNodes)}return v.a.Ca(t.childNodes)}function r(t){return i.DocumentFragment?t instanceof DocumentFragment:t&&11===t.nodeType}function o(t,e,s){"string"==typeof e.require?n||i.require?(n||i.require)([e.require],s):t("Uses require, but no AMD loader is present"):s(e)}function a(t){return function(e){throw Error("Component '"+t+"': "+e)}}var l={};v.i.register=function(t,e){if(!e)throw Error("Invalid configuration for "+t);if(v.i.sb(t))throw Error("Component "+t+" is already registered");l[t]=e},v.i.sb=function(t){return Object.prototype.hasOwnProperty.call(l,t)},v.i.unregister=function(t){delete l[t],v.i.Ac(t)},v.i.Ec={getConfig:function(t,e){e(v.i.sb(t)?l[t]:null)},loadComponent:function(e,n,i){var s=a(e);o(s,n,function(n){t(e,s,n,i)})},loadTemplate:function(t,n,o){if(t=a(t),"string"==typeof n)o(v.a.ta(n));else if(n instanceof Array)o(n);else if(r(n))o(v.a.la(n.childNodes));else if(n.element)if(n=n.element,i.HTMLElement?n instanceof HTMLElement:n&&n.tagName&&1===n.nodeType)o(e(n));else if("string"==typeof n){var l=s.getElementById(n);l?o(e(l)):t("Cannot find element with ID "+n)}else t("Unknown element type: "+n);else t("Unknown template value: "+n)},loadViewModel:function(t,e,n){!function t(e,n,i){if("function"==typeof n)i(function(t){return new n(t)});else if("function"==typeof n[h])i(n[h]);else if("instance"in n){var s=n.instance;i(function(){return s})}else"viewModel"in n?t(e,n.viewModel,i):e("Unknown viewModel value: "+n)}(a(t),e,n)}};var h="createViewModel";v.b("components.register",v.i.register),v.b("components.isRegistered",v.i.sb),v.b("components.unregister",v.i.unregister),v.b("components.defaultLoader",v.i.Ec),v.i.loaders.push(v.i.Ec),v.i.cd=l}(),function(){function t(t,n){if(i=t.getAttribute("params")){var i=e.parseBindingsString(i,n,t,{valueAccessors:!0,bindingParams:!0}),s=(i=v.a.Ha(i,function(e){return v.o(e,null,{l:t})}),v.a.Ha(i,function(e){var n=e.w();return e.ja()?v.o({read:function(){return v.a.c(e())},write:v.Ya(n)&&function(t){e()(t)},l:t}):n}));return Object.prototype.hasOwnProperty.call(s,"$raw")||(s.$raw=i),s}return{$raw:{}}}v.i.getComponentNameForNode=function(t){var e=v.a.P(t);if(v.i.sb(e)&&(-1!=e.indexOf("-")||"[object HTMLUnknownElement]"==""+t||8>=v.a.W&&t.tagName===e))return e},v.i.sc=function(e,n,i,s){if(1===n.nodeType){var r=v.i.getComponentNameForNode(n);if(r){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:r,params:t(n,i)};e.component=s?function(){return o}:o}}return e};var e=new v.ga;9>v.a.W&&(v.i.register=function(t){return function(e){return t.apply(this,arguments)}}(v.i.register),s.createDocumentFragment=function(t){return function(){var e,n=t(),i=v.i.cd;for(e in i);return n}}(s.createDocumentFragment))}(),function(){var t=0;v.f.component={init:function(e,n,i,s,r){function o(){var t=a&&a.dispose;"function"==typeof t&&t.call(a),h&&h.s(),l=a=h=null}var a,l,h,c=v.a.la(v.h.childNodes(e));return v.h.Ea(e),v.a.I.za(e,o),v.o(function(){var i,s,u=v.a.c(n());if("string"==typeof u?i=u:(i=v.a.c(u.name),s=v.a.c(u.params)),!i)throw Error("No component name specified");var d=v.j.Bb(e,r),f=l=++t;v.i.get(i,function(t){if(l===f){if(o(),!t)throw Error("Unknown component '"+i+"'");!function(t,e,n){if(!(e=e.template))throw Error("Component '"+t+"' has no template");t=v.a.Ca(e),v.h.ua(n,t)}(i,t,e);var n=function(t,e,n){var i=t.createViewModel;return i?i.call(t,e,n):e}(t,s,{element:e,templateNodes:c});t=d.createChildContext(n,{extend:function(t){t.$component=n,t.$componentTemplateNodes=c}}),n&&n.koDescendantsComplete&&(h=v.j.subscribe(e,v.j.oa,n.koDescendantsComplete,n)),a=n,v.Pa(t,e)}})},null,{l:e}),{controlsDescendantBindings:!0}}},v.h.ea.component=!0}();var k={class:"className",for:"htmlFor"};v.f.attr={update:function(e,n){var i=v.a.c(n())||{};v.a.O(i,function(n,i){i=v.a.c(i);var s=n.indexOf(":"),r=(s="lookupNamespaceURI"in e&&0<s&&e.lookupNamespaceURI(n.substr(0,s)),!1===i||null===i||i===t);r?s?e.removeAttributeNS(s,n):e.removeAttribute(n):i=i.toString(),8>=v.a.W&&n in k?(n=k[n],r?e.removeAttribute(n):e[n]=i):r||(s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)),"name"===n&&v.a.Xc(e,r?"":i)})}},v.f.checked={after:["value","attr"],init:function(e,n,i){function s(){var s=e.checked,l=r();if(!v.U.rb()&&(s||!a&&!v.U.pa())){var u=v.v.K(n);if(h){var f=c?u.w():u,p=d;d=l,p!==l?s&&(v.a.Oa(f,l,!0),v.a.Oa(f,p,!1)):v.a.Oa(f,l,s),c&&v.Ya(u)&&u(f)}else o&&(l===t?l=s:s||(l=t)),v.m.$a(u,i,"checked",l,!0)}}var r=v.wb(function(){return i.has("checkedValue")?v.a.c(i.get("checkedValue")):u?i.has("value")?v.a.c(i.get("value")):e.value:void 0}),o="checkbox"==e.type,a="radio"==e.type;if(o||a){var l=n(),h=o&&v.a.c(l)instanceof Array,c=!(h&&l.push&&l.splice),u=a||h,d=h?r():t;a&&!e.name&&v.f.uniqueName.init(e,function(){return!0}),v.o(s,null,{l:e}),v.a.H(e,"click",s),v.o(function(){var i=v.a.c(n()),s=r();h?(e.checked=0<=v.a.A(i,s),d=s):e.checked=o&&s===t?!!i:r()===i},null,{l:e}),l=t}}},v.m.va.checked=!0,v.f.checkedValue={update:function(t,e){t.value=v.a.c(e())}},v.f.class={update:function(t,e){var n=v.a.Cb(v.a.c(e()));v.a.Eb(t,t.__ko__cssValue,!1),t.__ko__cssValue=n,v.a.Eb(t,n,!0)}},v.f.css={update:function(t,e){var n=v.a.c(e());null!==n&&"object"==typeof n?v.a.O(n,function(e,n){n=v.a.c(n),v.a.Eb(t,e,n)}):v.f.class.update(t,e)}},v.f.enable={update:function(t,e){var n=v.a.c(e());n&&t.disabled?t.removeAttribute("disabled"):n||t.disabled||(t.disabled=!0)}},v.f.disable={update:function(t,e){v.f.enable.update(t,function(){return!v.a.c(e())})}},v.f.event={init:function(t,e,n,i,s){var r=e()||{};v.a.O(r,function(r){"string"==typeof r&&v.a.H(t,r,function(t){var o,a=e()[r];if(a){try{var l=v.a.la(arguments);i=s.$data,l.unshift(i),o=a.apply(i,l)}finally{!0!==o&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}!1===n.get(r+"Bubble")&&(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation())}})})}},v.f.foreach={Qc:function(t){return function(){var e=t(),n=v.a.$b(e);return n&&"number"!=typeof n.length?(v.a.c(e),{foreach:n.data,as:n.as,noChildContext:n.noChildContext,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:v.ba.Na}):{foreach:e,templateEngine:v.ba.Na}}},init:function(t,e){return v.f.template.init(t,v.f.foreach.Qc(e))},update:function(t,e,n,i,s){return v.f.template.update(t,v.f.foreach.Qc(e),n,i,s)}},v.m.Ra.foreach=!1,v.h.ea.foreach=!0,v.f.hasfocus={init:function(t,e,n){function i(i){t.__ko_hasfocusUpdating=!0;var s=t.ownerDocument;if("activeElement"in s){var r;try{r=s.activeElement}catch(t){r=s.body}i=r===t}s=e(),v.m.$a(s,n,"hasfocus",i,!0),t.__ko_hasfocusLastValue=i,t.__ko_hasfocusUpdating=!1}var s=i.bind(null,!0),r=i.bind(null,!1);v.a.H(t,"focus",s),v.a.H(t,"focusin",s),v.a.H(t,"blur",r),v.a.H(t,"focusout",r),t.__ko_hasfocusLastValue=!1},update:function(t,e){var n=!!v.a.c(e());t.__ko_hasfocusUpdating||t.__ko_hasfocusLastValue===n||(n?t.focus():t.blur(),!n&&t.__ko_hasfocusLastValue&&t.ownerDocument.body.focus(),v.v.K(v.a.Fb,null,[t,n?"focusin":"focusout"]))}},v.m.va.hasfocus=!0,v.f.hasFocus=v.f.hasfocus,v.m.va.hasFocus="hasfocus",v.f.html={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){v.a.dc(t,e())}},function(){function t(t,e,n){v.f[t]={init:function(t,i,s,r,o){var a,l,h,c,u,d={};if(e){r=s.get("as");var f=s.get("noChildContext");d={as:r,noChildContext:f,exportDependencies:u=!(r&&f)}}return c=(h="render"==s.get("completeOn"))||s.has(v.j.oa),v.o(function(){var s,r=v.a.c(i()),f=!n!=!r,p=!l;(u||f!==a)&&(c&&(o=v.j.Bb(t,o)),f&&(e&&!u||(d.dataDependency=v.U.o()),s=e?o.createChildContext("function"==typeof r?r:i,d):v.U.pa()?o.extend(null,d):o),p&&v.U.pa()&&(l=v.a.Ca(v.h.childNodes(t),!0)),f?(p||v.h.ua(t,v.a.Ca(l)),v.Pa(s,t)):(v.h.Ea(t),h||v.j.Ga(t,v.j.T)),a=f)},null,{l:t}),{controlsDescendantBindings:!0}}},v.m.Ra[t]=!1,v.h.ea[t]=!0}t("if"),t("ifnot",!1,!0),t("with",!0)}(),v.f.let={init:function(t,e,n,i,s){return e=s.extend(e),v.Pa(e,t),{controlsDescendantBindings:!0}}},v.h.ea.let=!0;var D={};v.f.options={init:function(t){if("select"!==v.a.P(t))throw Error("options binding applies only to SELECT elements");for(;0<t.length;)t.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,i){function s(){return v.a.fb(e.options,function(t){return t.selected})}function r(t,e,n){var i=typeof e;return"function"==i?e(t):"string"==i?t[e]:n}function o(t,n){if(p&&c)v.u.ya(e,v.a.c(i.get("value")),!0);else if(f.length){var s=0<=v.a.A(f,v.u.L(n[0]));v.a.Yc(n[0],s),p&&!s&&v.v.K(v.a.Fb,null,[e,"change"])}}var a=e.multiple,l=0!=e.length&&a?e.scrollTop:null,h=v.a.c(n()),c=i.get("valueAllowUnset")&&i.has("value"),u=i.get("optionsIncludeDestroyed");n={};var d,f=[];c||(a?f=v.a.Mb(s(),v.u.L):0<=e.selectedIndex&&f.push(v.u.L(e.options[e.selectedIndex]))),h&&(void 0===h.length&&(h=[h]),d=v.a.fb(h,function(e){return u||e===t||null===e||!v.a.c(e._destroy)}),i.has("optionsCaption")&&null!==(h=v.a.c(i.get("optionsCaption")))&&h!==t&&d.unshift(D));var p=!1;n.beforeRemove=function(t){e.removeChild(t)},h=o,i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(h=function(e,n){o(0,n),v.v.K(i.get("optionsAfterRender"),null,[n[0],e!==D?e:t])}),v.a.cc(e,d,function(n,s,o){return o.length&&(f=!c&&o[0].selected?[v.u.L(o[0])]:[],p=!0),s=e.ownerDocument.createElement("option"),n===D?(v.a.Ab(s,i.get("optionsCaption")),v.u.ya(s,t)):(o=r(n,i.get("optionsValue"),n),v.u.ya(s,v.a.c(o)),n=r(n,i.get("optionsText"),o),v.a.Ab(s,n)),[s]},n,h),v.v.K(function(){c?v.u.ya(e,v.a.c(i.get("value")),!0):(a?f.length&&s().length<f.length:f.length&&0<=e.selectedIndex?v.u.L(e.options[e.selectedIndex])!==f[0]:f.length||0<=e.selectedIndex)&&v.a.Fb(e,"change")}),v.a.vd(e),l&&20<Math.abs(l-e.scrollTop)&&(e.scrollTop=l)}},v.f.options.Yb=v.a.g.Z(),v.f.selectedOptions={after:["options","foreach"],init:function(t,e,n){v.a.H(t,"change",function(){var i=e(),s=[];v.a.C(t.getElementsByTagName("option"),function(t){t.selected&&s.push(v.u.L(t))}),v.m.$a(i,n,"selectedOptions",s)})},update:function(t,e){if("select"!=v.a.P(t))throw Error("values binding applies only to SELECT elements");var n=v.a.c(e()),i=t.scrollTop;n&&"number"==typeof n.length&&v.a.C(t.getElementsByTagName("option"),function(t){var e=0<=v.a.A(n,v.u.L(t));t.selected!=e&&v.a.Yc(t,e)}),t.scrollTop=i}},v.m.va.selectedOptions=!0,v.f.style={update:function(e,n){var i=v.a.c(n()||{});v.a.O(i,function(n,i){if(null!==(i=v.a.c(i))&&i!==t&&!1!==i||(i=""),o)o(e).css(n,i);else if(/^--/.test(n))e.style.setProperty(n,i);else{n=n.replace(/-(\w)/g,function(t,e){return e.toUpperCase()});var s=e.style[n];e.style[n]=i,i===s||e.style[n]!=s||isNaN(i)||(e.style[n]=i+"px")}})}},v.f.submit={init:function(t,e,n,i,s){if("function"!=typeof e())throw Error("The value for a submit binding must be a function");v.a.H(t,"submit",function(n){var i,r=e();try{i=r.call(s.$data,t)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},v.f.text={init:function(){return{controlsDescendantBindings:!0}},update:function(t,e){v.a.Ab(t,e())}},v.h.ea.text=!0,function(){if(i&&i.navigator){var e,n,s,r,o,a=function(t){if(t)return parseFloat(t[1])},l=i.navigator.userAgent;(e=i.opera&&i.opera.version&&parseInt(i.opera.version()))||(o=a(l.match(/Edge\/([^ ]+)$/)))||a(l.match(/Chrome\/([^ ]+)/))||(n=a(l.match(/Version\/([^ ]+) Safari/)))||(s=a(l.match(/Firefox\/([^ ]+)/)))||(r=v.a.W||a(l.match(/MSIE ([^ ]+)/)))||(r=a(l.match(/rv:([^ )]+)/)))}if(8<=r&&10>r)var h=v.a.g.Z(),c=v.a.g.Z(),u=function(t){var e=this.activeElement;(e=e&&v.a.g.get(e,c))&&e(t)},d=function(t,e){var n=t.ownerDocument;v.a.g.get(n,h)||(v.a.g.set(n,h,!0),v.a.H(n,"selectionchange",u)),v.a.g.set(t,c,e)};v.f.textInput={init:function(i,a,l){function h(t,e){v.a.H(i,t,e)}function c(){f||(p=i.value,f=v.a.setTimeout(u,4))}function u(){clearTimeout(f),p=f=t;var e=i.value;g!==e&&(g=e,v.m.$a(a(),l,"textInput",e))}var f,p,g=i.value,m=9==v.a.W?c:u,b=!1;r&&h("keypress",u),11>r&&h("propertychange",function(t){b||"value"!==t.propertyName||m(t)}),8==r&&(h("keyup",u),h("keydown",u)),d&&(d(i,m),h("dragend",c)),(!r||9<=r)&&h("input",m),5>n&&"textarea"===v.a.P(i)?(h("keydown",c),h("paste",c),h("cut",c)):11>e?h("keydown",c):4>s?(h("DOMAutoComplete",u),h("dragdrop",u),h("drop",u)):o&&"number"===i.type&&h("keydown",c),h("change",u),h("blur",u),v.o(function e(){var n=v.a.c(a());null!==n&&n!==t||(n=""),p!==t&&n===p?v.a.setTimeout(e,4):i.value!==n&&(b=!0,i.value=n,b=!1,g=i.value)},null,{l:i})}},v.m.va.textInput=!0,v.f.textinput={preprocess:function(t,e,n){n("textInput",t)}}}(),v.f.uniqueName={init:function(t,e){if(e()){var n="ko_unique_"+ ++v.f.uniqueName.qd;v.a.Xc(t,n)}}},v.f.uniqueName.qd=0,v.f.using={init:function(t,e,n,i,s){var r;return n.has("as")&&(r={as:n.get("as"),noChildContext:n.get("noChildContext")}),e=s.createChildContext(e,r),v.Pa(e,t),{controlsDescendantBindings:!0}}},v.h.ea.using=!0,v.f.value={after:["options","foreach"],init:function(e,n,i){var s=v.a.P(e),r="input"==s;if(!r||"checkbox"!=e.type&&"radio"!=e.type){var o=["change"],a=i.get("valueUpdate"),l=!1,h=null;a&&("string"==typeof a&&(a=[a]),v.a.gb(o,a),o=v.a.vc(o));var c,u=function(){h=null,l=!1;var t=n(),s=v.u.L(e);v.m.$a(t,i,"value",s)};!v.a.W||!r||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=v.a.A(o,"propertychange")||(v.a.H(e,"propertychange",function(){l=!0}),v.a.H(e,"focus",function(){l=!1}),v.a.H(e,"blur",function(){l&&u()})),v.a.C(o,function(t){var n=u;v.a.Td(t,"after")&&(n=function(){h=v.u.L(e),v.a.setTimeout(u,0)},t=t.substring(5)),v.a.H(e,t,n)}),c=r&&"file"==e.type?function(){var i=v.a.c(n());null===i||i===t||""===i?e.value="":v.v.K(u)}:function(){var r=v.a.c(n()),o=v.u.L(e);null!==h&&r===h?v.a.setTimeout(c,0):r===o&&o!==t||("select"===s?(o=i.get("valueAllowUnset"),v.u.ya(e,r,o),o||r===v.u.L(e)||v.v.K(u)):v.u.ya(e,r))},v.o(c,null,{l:e})}else v.eb(e,{checkedValue:n})},update:function(){}},v.m.va.value=!0,v.f.visible={update:function(t,e){var n=v.a.c(e()),i="none"!=t.style.display;n&&!i?t.style.display="":!n&&i&&(t.style.display="none")}},v.f.hidden={update:function(t,e){v.f.visible.update(t,function(){return!v.a.c(e())})}},function(t){v.f[t]={init:function(e,n,i,s,r){return v.f.event.init.call(this,e,function(){var e={};return e[t]=n(),e},i,s,r)}}}("click"),v.ca=function(){},v.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},v.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},v.ca.prototype.makeTemplateSource=function(t,e){if("string"==typeof t){var n=(e=e||s).getElementById(t);if(!n)throw Error("Cannot find template with ID "+t);return new v.B.D(n)}if(1==t.nodeType||8==t.nodeType)return new v.B.ia(t);throw Error("Unknown template type: "+t)},v.ca.prototype.renderTemplate=function(t,e,n,i){return t=this.makeTemplateSource(t,i),this.renderTemplateSource(t,e,n,i)},v.ca.prototype.isTemplateRewritten=function(t,e){return!1===this.allowTemplateRewriting||this.makeTemplateSource(t,e).data("isRewritten")},v.ca.prototype.rewriteTemplate=function(t,e,n){e=e((t=this.makeTemplateSource(t,n)).text()),t.text(e),t.data("isRewritten",!0)},v.b("templateEngine",v.ca),v.ic=function(){function t(t,e,n,i){t=v.m.Zb(t);for(var s=v.m.Ra,r=0;r<t.length;r++){var o=t[r].key;if(Object.prototype.hasOwnProperty.call(s,o)){var a=s[o];if("function"==typeof a){if(o=a(t[r].value))throw Error(o)}else if(!a)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+v.m.ub(t,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+e}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{wd:function(t,e,n){e.isTemplateRewritten(t,n)||e.rewriteTemplate(t,function(t){return v.ic.Kd(t,e)},n)},Kd:function(i,s){return i.replace(e,function(e,n,i,r,o){return t(o,n,i,s)}).replace(n,function(e,n){return t(n,"\x3c!-- ko --\x3e","#comment",s)})},ld:function(t,e){return v.aa.Wb(function(n,i){var s=n.nextSibling;s&&s.nodeName.toLowerCase()===e&&v.eb(s,t,i)})}}}(),v.b("__tr_ambtns",v.ic.ld),function(){v.B={},v.B.D=function(t){if(this.D=t){var e=v.a.P(t);this.Db="script"===e?1:"textarea"===e?2:"template"==e&&t.content&&11===t.content.nodeType?3:4}},v.B.D.prototype.text=function(){var t=1===this.Db?"text":2===this.Db?"value":"innerHTML";if(0==arguments.length)return this.D[t];var e=arguments[0];"innerHTML"===t?v.a.dc(this.D,e):this.D[t]=e};var e=v.a.g.Z()+"_";v.B.D.prototype.data=function(t){if(1===arguments.length)return v.a.g.get(this.D,e+t);v.a.g.set(this.D,e+t,arguments[1])};var n=v.a.g.Z();v.B.D.prototype.nodes=function(){var e=this.D;if(0==arguments.length){var i=v.a.g.get(e,n)||{},s=i.jb||(3===this.Db?e.content:4===this.Db?e:t);return s&&!i.hd||(i=this.text())&&(s=v.a.Ld(i,e.ownerDocument),this.text(""),v.a.g.set(e,n,{jb:s,hd:!0})),s}v.a.g.set(e,n,{jb:arguments[0]})},v.B.ia=function(t){this.D=t},v.B.ia.prototype=new v.B.D,v.B.ia.prototype.constructor=v.B.ia,v.B.ia.prototype.text=function(){if(0==arguments.length){var e=v.a.g.get(this.D,n)||{};return e.jc===t&&e.jb&&(e.jc=e.jb.innerHTML),e.jc}v.a.g.set(this.D,n,{jc:arguments[0]})},v.b("templateSources",v.B),v.b("templateSources.domElement",v.B.D),v.b("templateSources.anonymousTemplate",v.B.ia)}(),function(){function e(t,e,n){var i;for(e=v.h.nextSibling(e);t&&(i=t)!==e;)n(i,t=v.h.nextSibling(i))}function n(t,n){if(t.length){var i=t[0],s=t[t.length-1],r=i.parentNode,o=v.ga.instance,a=o.preprocessNode;if(a){if(e(i,s,function(t,e){var n=t.previousSibling,r=a.call(o,t);r&&(t===i&&(i=r[0]||e),t===s&&(s=r[r.length-1]||n))}),t.length=0,!i)return;i===s?t.push(i):(t.push(i,s),v.a.Ua(t,r))}e(i,s,function(t){1!==t.nodeType&&8!==t.nodeType||v.uc(n,t)}),e(i,s,function(t){1!==t.nodeType&&8!==t.nodeType||v.aa.bd(t,[n])}),v.a.Ua(t,r)}}function i(t){return t.nodeType?t:0<t.length?t[0]:null}function s(t,e,s,r,a){a=a||{};var l=(t&&i(t)||s||{}).ownerDocument,h=a.templateEngine||o;if(v.ic.wd(s,h,l),"number"!=typeof(s=h.renderTemplate(s,r,a,l)).length||0<s.length&&"number"!=typeof s[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(l=!1,e){case"replaceChildren":v.h.ua(t,s),l=!0;break;case"replaceNode":v.a.Wc(t,s),l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return l&&(n(s,r),a.afterRender&&v.v.K(a.afterRender,null,[s,r[a.as||"$data"]]),"replaceChildren"==e&&v.j.Ga(t,v.j.T)),s}function r(t,e,n){return v.N(t)?t():"function"==typeof t?t(e,n):t}var o;v.ec=function(e){if(e!=t&&!(e instanceof v.ca))throw Error("templateEngine must inherit from ko.templateEngine");o=e},v.bc=function(e,n,a,l,h){if(((a=a||{}).templateEngine||o)==t)throw Error("Set a template engine before calling renderTemplate");if(h=h||"replaceChildren",l){var c=i(l);return v.$(function(){var t=n&&n instanceof v.fa?n:new v.fa(n,null,null,null,{exportDependencies:!0}),o=r(e,t.$data,t);t=s(l,h,o,t,a),"replaceNode"==h&&(c=i(l=t))},null,{Sa:function(){return!c||!v.a.Rb(c)},l:c&&"replaceNode"==h?c.parentNode:c})}return v.aa.Wb(function(t){v.bc(e,n,a,t,"replaceNode")})},v.Pd=function(e,i,o,a,l){function h(t,e){v.v.K(v.a.cc,null,[a,t,u,o,c,e]),v.j.Ga(a,v.j.T)}function c(t,e){n(e,d),o.afterRender&&o.afterRender(e,t),d=null}function u(t,n){d=l.createChildContext(t,{as:f,noChildContext:o.noChildContext,extend:function(t){t.$index=n,f&&(t[f+"Index"]=n)}});var i=r(e,t,d);return s(a,"ignoreTargetNode",i,d,o)}var d,f=o.as,p=!1===o.includeDestroyed||v.options.foreachHidesDestroyed&&!o.includeDestroyed;if(p||o.beforeRemove||!v.Oc(i))return v.$(function(){var e=v.a.c(i)||[];void 0===e.length&&(e=[e]),p&&(e=v.a.fb(e,function(e){return e===t||null===e||!v.a.c(e._destroy)})),h(e)},null,{l:a});h(i.w());var g=i.subscribe(function(t){h(i(),t)},null,"arrayChange");return g.l(a),g};var a=v.a.g.Z(),l=v.a.g.Z();v.f.template={init:function(t,e){var n=v.a.c(e());if("string"==typeof n||n.name)v.h.Ea(t);else if("nodes"in n){if(n=n.nodes||[],v.N(n))throw Error('The "nodes" option must be a plain, non-observable array.');var i=n[0]&&n[0].parentNode;i&&v.a.g.get(i,l)||(i=v.a.Xb(n),v.a.g.set(i,l,!0)),new v.B.ia(t).nodes(i)}else{if(!(0<(n=v.h.childNodes(t)).length))throw Error("Anonymous template defined, but no template content was provided");i=v.a.Xb(n),new v.B.ia(t).nodes(i)}return{controlsDescendantBindings:!0}},update:function(e,n,i,s,r){var o=n();i=!0,s=null,"string"==typeof(n=v.a.c(o))?n={}:(o=n.name,"if"in n&&(i=v.a.c(n.if)),i&&"ifnot"in n&&(i=!v.a.c(n.ifnot))),"foreach"in n?s=v.Pd(o||e,i&&n.foreach||[],n,e,r):i?(i=r,"data"in n&&(i=r.createChildContext(n.data,{as:n.as,noChildContext:n.noChildContext,exportDependencies:!0})),s=v.bc(o||e,i,n,e)):v.h.Ea(e),r=s,(n=v.a.g.get(e,a))&&"function"==typeof n.s&&n.s(),v.a.g.set(e,a,!r||r.ja&&!r.ja()?t:r)}},v.m.Ra.template=function(t){return 1==(t=v.m.Zb(t)).length&&t[0].unknown||v.m.Hd(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},v.h.ea.template=!0}(),v.b("setTemplateEngine",v.ec),v.b("renderTemplate",v.bc),v.a.Jc=function(t,e,n){var i,s,r,o,a;if(t.length&&e.length)for(i=s=0;(!n||i<n)&&(o=t[s]);++s){for(r=0;a=e[r];++r)if(o.value===a.value){o.moved=a.index,a.moved=o.index,e.splice(r,1),i=r=0;break}i+=r}},v.a.Ob=function(){function t(t,e,n,i,s){var r,o,a,l,h,c=Math.min,u=Math.max,d=[],f=t.length,p=e.length,g=p-f||1,m=f+p+1;for(r=0;r<=f;r++)for(l=a,d.push(a=[]),h=c(p,r+g),o=u(0,r-1);o<=h;o++)a[o]=o?r?t[r-1]===e[o-1]?l[o-1]:c(l[o]||m,a[o-1]||m)+1:o+1:r+1;for(c=[],u=[],g=[],r=f,o=p;r||o;)p=d[r][o]-1,o&&p===d[r][o-1]?u.push(c[c.length]={status:n,value:e[--o],index:o}):r&&p===d[r-1][o]?g.push(c[c.length]={status:i,value:t[--r],index:r}):(--o,--r,s.sparse||c.push({status:"retained",value:e[o]}));return v.a.Jc(g,u,!s.dontLimitMoves&&10*f),c.reverse()}return function(e,n,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},n=n||[],(e=e||[]).length<n.length?t(e,n,"added","deleted",i):t(n,e,"deleted","added",i)}}(),v.b("utils.compareArrays",v.a.Ob),function(){function e(e,n,i,s,r){var o=[],a=v.$(function(){var t=n(i,r,v.a.Ua(o,e))||[];0<o.length&&(v.a.Wc(o,t),s&&v.v.K(s,null,[i,t,r])),o.length=0,v.a.gb(o,t)},null,{l:e,Sa:function(){return!v.a.jd(o)}});return{Y:o,$:a.ja()?a:t}}var n=v.a.g.Z(),i=v.a.g.Z();v.a.cc=function(s,r,o,a,l,h){function c(t){f={Aa:t,nb:v.sa(T++)},w.push(f),E||C.push(f)}function u(t){f=b[t],T!==f.nb.w()&&I.push(f),f.nb(T++),v.a.Ua(f.Y,s),w.push(f)}function d(t,e){if(t)for(var n=0,i=e.length;n<i;n++)v.a.C(e[n].Y,function(i){t(i,n,e[n].Aa)})}void 0===(r=r||[]).length&&(r=[r]),a=a||{};var f,p,g,m,b=v.a.g.get(s,n),E=!b,w=[],y=0,T=0,N=[],S=[],x=[],I=[],C=[],O=0;if(E)v.a.C(r,c);else{if(!h||b&&b._countWaitingForRemove){var _=v.a.Mb(b,function(t){return t.Aa});h=v.a.Ob(_,r,{dontLimitMoves:a.dontLimitMoves,sparse:!0})}var A,k,D;for(_=0;A=h[_];_++)switch(k=A.moved,D=A.index,A.status){case"deleted":for(;y<D;)u(y++);k===t&&((f=b[y]).$&&(f.$.s(),f.$=t),v.a.Ua(f.Y,s).length&&(a.beforeRemove&&(w.push(f),O++,f.Aa===i?f=null:x.push(f)),f&&N.push.apply(N,f.Y))),y++;break;case"added":for(;T<D;)u(y++);k!==t?(S.push(w.length),u(k)):c(A.value)}for(;T<r.length;)u(y++);w._countWaitingForRemove=O}v.a.g.set(s,n,w),d(a.beforeMove,I),v.a.C(N,a.beforeRemove?v.na:v.removeNode);try{m=s.ownerDocument.activeElement}catch(t){}if(S.length)for(;(_=S.shift())!=t;){for(f=w[_],p=t;_;)if((g=w[--_].Y)&&g.length){p=g[g.length-1];break}for(r=0;y=f.Y[r];p=y,r++)v.h.Vb(s,y,p)}for(_=0,S=v.h.firstChild(s);f=w[_];_++){for(f.Y||v.a.extend(f,e(s,o,f.Aa,l,f.nb)),r=0;y=f.Y[r];S=y.nextSibling,p=y,r++)y!==S&&v.h.Vb(s,y,p);!f.Dd&&l&&(l(f.Aa,f.Y,f.nb),f.Dd=!0,p=f.Y[f.Y.length-1])}for(m&&s.ownerDocument.activeElement!=m&&m.focus(),d(a.beforeRemove,x),_=0;_<x.length;++_)x[_].Aa=i;d(a.afterMove,I),d(a.afterAdd,C)}}(),v.b("utils.setDomNodeChildrenFromArrayMapping",v.a.cc),v.ba=function(){this.allowTemplateRewriting=!1},v.ba.prototype=new v.ca,v.ba.prototype.constructor=v.ba,v.ba.prototype.renderTemplateSource=function(t,e,n,i){return(e=9>v.a.W||!t.nodes?null:t.nodes())?v.a.la(e.cloneNode(!0).childNodes):(t=t.text(),v.a.ta(t,i))},v.ba.Na=new v.ba,v.ec(v.ba.Na),v.b("nativeTemplateEngine",v.ba),function(){v.Za=function(){var t=this.Gd=function(){if(!o||!o.tmpl)return 0;try{if(0<=o.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(t){}return 1}();this.renderTemplateSource=function(e,n,i,r){if(r=r||s,i=i||{},2>t)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var a=e.data("precompiled");return a||(a=e.text()||"",a=o.template(null,"{{ko_with $item.koBindingContext}}"+a+"{{/ko_with}}"),e.data("precompiled",a)),e=[n.$data],n=o.extend({koBindingContext:n},i.templateOptions),(n=o.tmpl(a,e,n)).appendTo(r.createElement("div")),o.fragments={},n},this.createJavaScriptEvaluatorBlock=function(t){return"{{ko_code ((function() { return "+t+" })()) }}"},this.addTemplate=function(t,e){s.write("<script type='text/html' id='"+t+"'>"+e+"<\/script>")},0<t&&(o.tmpl.tag.ko_code={open:"__.push($1 || '');"},o.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},v.Za.prototype=new v.ca,v.Za.prototype.constructor=v.Za;var t=new v.Za;0<t.Gd&&v.ec(t),v.b("jqueryTmplTemplateEngine",v.Za)}()})}()},{}],2:[function(t,e,n){"use strict";var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o="ontouchstart"in window;r.default.bindingHandlers.menuButton={init:function(t,e){r.default.unwrap(e())&&(o?(t.addEventListener("touchstart",function(){r.default.utils.toggleDomNodeCssClass(t,"hover active",!0)}),t.addEventListener("touchend",function(){r.default.utils.toggleDomNodeCssClass(t,"hover active",!1)})):(t.addEventListener("mouseover",function(){r.default.utils.toggleDomNodeCssClass(t,"hover",!0)}),t.addEventListener("mousedown",function(){r.default.utils.toggleDomNodeCssClass(t,"active",!0)}),t.addEventListener("mouseup",function(){r.default.utils.toggleDomNodeCssClass(t,"active",!1)}),t.addEventListener("mouseout",function(){r.default.utils.toggleDomNodeCssClass(t,"hover",!1),r.default.utils.toggleDomNodeCssClass(t,"active",!1),window.getSelection().removeAllRanges()})))}}},{knockout:1}],3:[function(t,e,n){"use strict";var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o="ontouchstart"in window,a=null,l=null,h=null;r.default.bindingHandlers.swipePages={init:function(t,e){o&&r.default.unwrap(e())&&(t.addEventListener("touchstart",function(t){if(!(t.touches.length>1||window.visualViewport&&window.visualViewport.scale>1)){var e=document.getElementById("vivliostyle-viewer-viewport");e&&e.scrollWidth>e.clientWidth||(a=t.touches[0].clientX,l=t.touches[0].clientY)}}),t.addEventListener("touchmove",function(t){if(!(t.touches.length>1)&&null!==a&&null!==l){var e=t.touches[0].clientX-a,n=t.touches[0].clientY-l;Math.abs(e)>Math.abs(n)&&(h=e<0?document.getElementById("vivliostyle-page-navigation-right"):document.getElementById("vivliostyle-page-navigation-left")),Math.abs(e)+Math.abs(n)>=16&&(h&&(h.click(),r.default.utils.toggleDomNodeCssClass(h,"active",!0)),a=null,l=null)}}),t.addEventListener("touchend",function(t){h&&r.default.utils.toggleDomNodeCssClass(h,"active",!1),h=null,a=null,l=null}))}}},{knockout:1}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../models/message-queue"),o=(s=r)&&s.__esModule?s:{default:s},a={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logLevel=a.ERROR}return i(t,[{key:"setLogLevel",value:function(t){this.logLevel=t}},{key:"debug",value:function(t){this.logLevel===a.DEBUG&&o.default.push({type:"debug",content:t})}},{key:"info",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO||o.default.push({type:"info",content:t})}},{key:"warn",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN||o.default.push({type:"warn",content:t})}},{key:"error",value:function(t){this.logLevel!==a.DEBUG&&this.logLevel!==a.INFO&&this.logLevel!==a.WARN&&this.logLevel!==a.ERROR||o.default.push({type:"error",content:t})}}]),t}();l.LogLevel=a;var h=new l;l.getLogger=function(){return h},n.default=l,e.exports=n.default},{"../models/message-queue":7}],5:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var s=i(t("vivliostyle")),r=i(t("./models/vivliostyle")),o=i(t("./vivliostyle-viewer"));r.default.setInstance(s.default),o.default.start()},{"./models/vivliostyle":11,"./vivliostyle-viewer":22,vivliostyle:23}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../stores/url-parameters")),a=s(t("./page-style")),l=s(t("../utils/string-util"));var h=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n,i,s,l,h,c=(n=o.default.getParameter("b"),i=o.default.getParameter("x"),s=o.default.getParameter("f"),l=o.default.getParameter("style"),h=o.default.getParameter("userStyle"),{bookUrl:n[0]||null,xUrl:!n[0]&&i.length&&i[0]?i:null,fragment:s[0]||null,authorStyleSheet:l.length?l:[],userStyleSheet:h.length?h:[]});this.bookUrl=r.default.observable(c.bookUrl||""),this.xUrl=r.default.observable(c.xUrl||null),this.fragment=r.default.observable(c.fragment||""),this.authorStyleSheet=r.default.observable(c.authorStyleSheet),this.userStyleSheet=r.default.observable(c.userStyleSheet),this.pageStyle=new a.default,this.dataUserStyleIndex=-1,this.fragment.subscribe(function(t){if(/^epubcfi\(\/([246]\/)?2!\)/.test(t))o.default.removeParameter("f");else{var e=t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent);o.default.setParameter("f",e)}}),c.userStyleSheet.find(function(t,n){if(/^data:,.*?\/\*(?:<|%3C)viewer(?:>|%3E)\*\//.test(t)){e.dataUserStyleIndex=n;var i=t.replace(/^data:,/,"").replace(/%(?![0-9A-Fa-f]{2})/g,"%25"),s=decodeURIComponent(i);return e.pageStyle.cssText(s),!0}return!1}),this.pageStyle.cssText.subscribe(function(t){e.updateUserStyleSheetFromCSSText(t)})}return i(t,[{key:"toObject",value:function(){function t(t){return t.map(function(t){return{url:t}})}var e=t(this.userStyleSheet());return this.pageStyle.pageSizeMode()==a.default.Mode.DEFAULT&&e.unshift({text:"@page{size:auto}"}),{fragment:this.fragment(),authorStyleSheet:t(this.authorStyleSheet()),userStyleSheet:e}}},{key:"updateUserStyleSheetFromCSSText",value:function(t){null==t&&(t=this.pageStyle.toCSSText());var e=this.userStyleSheet();if((!t||/^\s*(\/\*.*?\*\/\s*)*$/.test(t))&&e.length<=(-1==this.dataUserStyleIndex?0:1))return e.pop(),this.dataUserStyleIndex=-1,this.userStyleSheet(e),void o.default.removeParameter("userStyle");var n="data:,"+l.default.percentEncodeForDataURI(t.trim());-1==this.dataUserStyleIndex?(e.push(n),this.dataUserStyleIndex=e.length-1):e[this.dataUserStyleIndex]=n,this.userStyleSheet(e),o.default.setParameter("userStyle",n,this.dataUserStyleIndex)}}]),t}();n.default=h,e.exports=n.default},{"../stores/url-parameters":13,"../utils/string-util":16,"./page-style":8,knockout:1}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i};n.default=new function(){return r.default.observableArray()},e.exports=n.default},{knockout:1}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r,o=t("knockout"),a=(r=o)&&r.__esModule?r:{default:r},l={DEFAULT:"",AUTO:"auto",PRESET:"preset",CUSTOM:"custom",ZERO:"0"},h=[{name:"A5",description:"A5"},{name:"A4",description:"A4"},{name:"A3",description:"A3"},{name:"B5",description:"B5 (ISO)"},{name:"B4",description:"B4 (ISO)"},{name:"JIS-B5",description:"B5 (JIS)"},{name:"JIS-B4",description:"B4 (JIS)"},{name:"letter",description:"letter"},{name:"legal",description:"legal"},{name:"ledger",description:"ledger"}],c={customWidth:"210mm",customHeight:"297mm",customMargin:"10%",baseFontSize:"12pt",baseLineHeight:"1.2",baseFontFamily:"serif",viewerFontSize:16},u=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pageSizeMode=a.default.observable(l.DEFAULT),this.presetSize=a.default.observable(h[1]),this.isLandscape=a.default.observable(!1),this.customWidth=a.default.observable(c.customWidth),this.customHeight=a.default.observable(c.customHeight),this.pageSizeImportant=a.default.observable(!1),this.pageMarginMode=a.default.observable(l.DEFAULT),this.customMargin=a.default.observable(c.customMargin),this.pageMarginImportant=a.default.observable(!1),this.firstPageMarginZero=a.default.observable(!1),this.firstPageMarginZeroImportant=a.default.observable(!1),this.forceHtmlBodyMarginZero=a.default.observable(!1),this.widowsOrphans=a.default.observable(""),this.widowsOrphansImportant=a.default.observable(!1),this.imageMaxSizeToFitPage=a.default.observable(!1),this.imageMaxSizeToFitPageImportant=a.default.observable(!1),this.imageKeepAspectRatio=a.default.observable(!1),this.imageKeepAspectRatioImportant=a.default.observable(!1),this.baseFontSize=a.default.observable(c.baseFontSize),this.baseFontSizeSpecified=a.default.observable(!1),this.baseFontSizeImportant=a.default.observable(!1),this.baseLineHeight=a.default.observable(c.baseLineHeight),this.baseLineHeightSpecified=a.default.observable(!1),this.baseLineHeightImportant=a.default.observable(!1),this.baseFontFamily=a.default.observable(c.baseFontFamily),this.baseFontFamilySpecified=a.default.observable(!1),this.baseFontFamilyImportant=a.default.observable(!1),this.allImportant=a.default.observable(!1),this.pageOtherStyle=a.default.observable(""),this.firstPageOtherStyle=a.default.observable(""),this.rootOtherStyle=a.default.observable(""),this.beforeOtherStyle=a.default.observable(""),this.afterOtherStyle=a.default.observable(""),this.viewerFontSize=null,this.setViewerFontSizeObservable=function(t){n.viewerFontSize=t;var e=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];e&&(e.value=n.fontSizePxToPercent(t(),100,5))},this.viewerFontSizePercent=a.default.pureComputed({read:function(){return this.viewerFontSize?this.fontSizePxToPercent(this.viewerFontSize(),100,5):100},write:function(t){if(this.viewerFontSize){var e=parseFloat(t),n=e&&this.fontSizePercentToPx(e);if(!n||n<5||n>72){var i=document.getElementsByName("vivliostyle-settings_viewer-font-size")[0];i&&(i.value="100"),n=c.viewerFontSize}this.viewerFontSize(n)}},owner:this}),this.cssText=a.default.pureComputed({read:this.toCSSText,write:this.fromCSSText,owner:this}),this.allImportant.subscribe(function(t){n.pageSizeImportant(t),n.pageMarginImportant(t),n.firstPageMarginZeroImportant(t),n.widowsOrphansImportant(t),n.imageMaxSizeToFitPageImportant(t),n.imageKeepAspectRatioImportant(t),n.baseFontSizeImportant(t),n.baseLineHeightImportant(t),n.baseFontFamilyImportant(t)}),this.pageStyleRegExp=new RegExp("^((?:\\n|.)*?)\\/\\*<viewer>\\*\\/\\s*(?:@page\\s*\\{\\s*(?:size:\\s*([^\\s!;{}]+)(?:\\s+([^\\s!;{}]+))?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:margin:\\s*([^\\s!;{}]+(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?(?:\\s+[^\\s!;{}]+)?)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?(?:@page\\s*:first\\s*\\{\\s*(margin:\\s*0(?:\\w+|%)?\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?((?:[^{}]+|\\{[^{}]*\\})*)\\}\\s*)?((?:html|:root),\\s*body\\s*\\{\\s*margin:\\s*0(?:\\w+|%)?\\s*!important(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:(?:html|:root)\\s*\\{\\s*(?:font-size:\\s*(calc\\([^()]+\\)|[^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:line-height:\\s*([^\\s!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?(?:font-family:\\s*([^!;{}]+)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?([^{}]*)\\}\\s*)?(?:body\\s*\\{\\s*(?:[-\\w]+:\\s*inherit\\s*!important(?:;|(?=[\\s{}]))\\s*)+\\}\\s*)?(?:\\*\\s*\\{\\s*widows:\\s*(1|999)\\s*(!important)?(?:;|(?=[\\s{}]))\\s*orphans:\\s*\\19\\s*\\20(?:;|(?=[\\s{}]))\\s*\\}\\s*)?(?:img,\\s*svg\\s*\\{\\s*(max-inline-size:\\s*100%\\s*(!important)?(?:;|(?=[\\s{}]))\\s*max-block-size:\\s*100vb\\s*\\22(?:;|(?=[\\s{}]))\\s*)?(object-fit:\\s*contain\\s*(!important)?(?:;|(?=[\\s{}]))\\s*)?\\}\\s*)?((?:\\n|.)*)$"),e&&this.copyFrom(e)}return s(t,[{key:"fontSizePxToPercent",value:function(t,e,n){var i=t/c.viewerFontSize*(e||100);return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fontSizePercentToPx",value:function(t,e,n){var i=t/(e||100)*c.viewerFontSize;return n&&(i=i.toPrecision(n).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),i}},{key:"fromCSSText",value:function(t){var e=this,n=this.pageStyleRegExp.exec(t);if(n)!function(){var t=i(n,26),s=t[1],r=t[2],o=t[3],a=t[4],c=t[5],u=t[6],d=t[7],f=t[8],p=t[9],g=t[10],m=t[11],b=t[12],E=t[13],w=t[14],v=t[15],y=t[16],T=t[17],N=t[18],S=t[19],x=t[20],I=t[21],C=t[22],O=t[23],_=t[24],A=t[25],k=0,D=0;if(e.beforeOtherStyle(s),"landscape"==r||"portrait"==r?(e.isLandscape("landscape"==r),r=o,o=null):"landscape"!=o&&"portrait"!=o||(e.isLandscape("landscape"==o),o=null),null!=r){if(null==o)if("auto"==r)e.pageSizeMode(l.AUTO);else{var L=h.find(function(t){return t.name.toLowerCase()==r.toLowerCase()});L?(e.pageSizeMode(l.PRESET),e.presetSize(L)):(e.pageSizeMode(l.CUSTOM),e.customWidth(r),e.customHeight(r))}else e.pageSizeMode(l.CUSTOM),e.customWidth(r),e.customHeight(o);e.pageSizeImportant(!!a),a?k++:D++}else e.pageSizeMode(l.DEFAULT);null!=c?(e.pageMarginMode("0"==c?l.ZERO:l.CUSTOM),"0"==c?e.pageMarginMode(l.ZERO):(e.pageMarginMode(l.CUSTOM),e.customMargin(c)),e.pageMarginImportant(!!u),u?k++:D++):e.pageMarginMode(l.DEFAULT),d=d||"",e.pageOtherStyle(d),f?(e.firstPageMarginZero(!0),e.firstPageMarginZeroImportant(!!p),p?k++:D++):e.firstPageMarginZero(!1),g=g||"",e.firstPageOtherStyle(g),m?e.forceHtmlBodyMarginZero(!0):e.forceHtmlBodyMarginZero(!1),null!=b?(b=b.replace(/^\s*calc\([.\d]+\s*\*\s*([.\d]+\w+)\)\s*$/,"$1"),e.baseFontSizeSpecified(!0),e.baseFontSize(b),e.baseFontSizeImportant(!!E),E?k++:D++):e.baseFontSizeSpecified(!1),null!=w?(e.baseLineHeightSpecified(!0),e.baseLineHeight(w),e.baseLineHeightImportant(!!v),v?k++:D++):e.baseLineHeightSpecified(!1),null!=y?(y=y.trim(),e.baseFontFamilySpecified(!0),e.baseFontFamily(y),e.baseFontFamilyImportant(!!T),T?k++:D++):e.baseFontFamilySpecified(!1),N=N||"",e.rootOtherStyle(N),null!=S?(e.widowsOrphans(S),e.widowsOrphansImportant(!!x),x?k++:D++):e.widowsOrphans(l.DEFAULT),I?(e.imageMaxSizeToFitPage(!0),e.imageMaxSizeToFitPageImportant(!!C),C?k++:D++):e.imageMaxSizeToFitPage(!1),O?(e.imageKeepAspectRatio(!0),e.imageKeepAspectRatioImportant(!!_),_?k++:D++):e.imageKeepAspectRatio(!1),A=A.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"",e.afterOtherStyle(A),e.allImportant(k>0&&0==D)}();else{var s=t.replace(/\/\*<\/?viewer>\*\/\n?/g,"")||"";this.afterOtherStyle(s)}}},{key:"toCSSText",value:function(){function t(t){return t?" !important":""}var e=this.beforeOtherStyle();if(e+="/*<viewer>*/\n",this.pageSizeMode()!=l.DEFAULT||this.pageMarginMode()!=l.DEFAULT||this.pageOtherStyle()){if(e+="@page { ",this.pageSizeMode()!=l.DEFAULT){switch(e+="size: ",this.pageSizeMode()){case l.AUTO:e+="auto";break;case l.PRESET:e+=this.presetSize().name,this.isLandscape()&&(e+=" landscape");break;case l.CUSTOM:e+=this.customWidth()+" "+this.customHeight();break;default:throw new Error("Unknown pageSizeMode "+this.pageSizeMode())}e+=t(this.pageSizeImportant())+"; "}if(this.pageMarginMode()!=l.DEFAULT){switch(e+="margin: ",this.pageMarginMode()){case l.AUTO:e+="auto";break;case l.ZERO:e+="0";break;case l.CUSTOM:e+=""+this.customMargin();break;default:throw new Error("Unknown pageMarginMode "+this.pageMarginMode())}e+=t(this.pageMarginImportant())+"; "}e+=this.pageOtherStyle(),e+="}\n"}if((this.firstPageMarginZero()||this.firstPageOtherStyle())&&(e+="@page :first { ",this.firstPageMarginZero()&&(e+="margin: 0"+t(this.firstPageMarginZeroImportant())+"; "),e+=this.firstPageOtherStyle(),e+="}\n"),this.forceHtmlBodyMarginZero()&&(e+=":root, body { margin: 0 !important; }\n"),this.baseFontSizeSpecified()||this.baseLineHeightSpecified()||this.baseFontFamilySpecified()||this.rootOtherStyle()){e+=":root { ";var n=this.baseFontSize();if(this.baseFontSizeSpecified())if(this.viewerFontSize&&this.viewerFontSize()!=c.viewerFontSize&&!n.endsWith("%"))e+="font-size: calc("+this.fontSizePxToPercent(this.viewerFontSize(),1,5)+" * "+n+")"+t(this.baseFontSizeImportant())+"; ";else e+="font-size: "+this.baseFontSize()+t(this.baseFontSizeImportant())+"; ";this.baseLineHeightSpecified()&&(e+="line-height: "+this.baseLineHeight()+t(this.baseLineHeightImportant())+"; "),this.baseFontFamilySpecified()&&(e+="font-family: "+this.baseFontFamily()+t(this.baseFontFamilyImportant())+"; "),e+=this.rootOtherStyle(),e+="}\n"}return(this.baseFontSizeSpecified()&&this.baseFontSizeImportant()||this.baseLineHeightSpecified()&&this.baseLineHeightImportant()||this.baseFontFamilySpecified()&&this.baseFontFamilyImportant())&&(e+="body { ",this.baseFontSizeSpecified()&&this.baseFontSizeImportant()&&(e+="font-size: inherit !important; "),this.baseLineHeightSpecified()&&this.baseLineHeightImportant()&&(e+="line-height: inherit !important; "),this.baseFontFamilySpecified()&&this.baseFontFamilyImportant()&&(e+="font-family: inherit !important; "),e+="}\n"),this.widowsOrphans()&&(e+="* { ",e+="widows: "+this.widowsOrphans()+t(this.widowsOrphansImportant())+"; ",e+="orphans: "+this.widowsOrphans()+t(this.widowsOrphansImportant())+"; ",e+="}\n"),(this.imageMaxSizeToFitPage()||this.imageKeepAspectRatio())&&(e+="img, svg { ",this.imageMaxSizeToFitPage()&&(e+="max-inline-size: 100%"+t(this.imageMaxSizeToFitPageImportant())+"; ",e+="max-block-size: 100vb"+t(this.imageMaxSizeToFitPageImportant())+"; "),this.imageKeepAspectRatio()&&(e+="object-fit: contain"+t(this.imageKeepAspectRatioImportant())+"; "),e+="}\n"),e+="/*</viewer>*/\n",e+=this.afterOtherStyle()}},{key:"copyFrom",value:function(t){this.pageSizeMode(t.pageSizeMode()),this.presetSize(t.presetSize()),this.isLandscape(t.isLandscape()),this.customWidth(t.customWidth()),this.customHeight(t.customHeight()),this.pageSizeImportant(t.pageSizeImportant()),this.pageMarginMode(t.pageMarginMode()),this.customMargin(t.customMargin()),this.pageMarginImportant(t.pageMarginImportant()),this.firstPageMarginZero(t.firstPageMarginZero()),this.firstPageMarginZeroImportant(t.firstPageMarginZeroImportant()),this.forceHtmlBodyMarginZero(t.forceHtmlBodyMarginZero()),this.widowsOrphans(t.widowsOrphans()),this.widowsOrphansImportant(t.widowsOrphansImportant()),this.imageMaxSizeToFitPage(t.imageMaxSizeToFitPage()),this.imageMaxSizeToFitPageImportant(t.imageMaxSizeToFitPageImportant()),this.imageKeepAspectRatio(t.imageKeepAspectRatio()),this.imageKeepAspectRatioImportant(t.imageKeepAspectRatioImportant()),this.baseFontSize(t.baseFontSize()),this.baseFontSizeSpecified(t.baseFontSizeSpecified()),this.baseFontSizeImportant(t.baseFontSizeImportant()),this.baseLineHeight(t.baseLineHeight()),this.baseLineHeightSpecified(t.baseLineHeightSpecified()),this.baseLineHeightImportant(t.baseLineHeightImportant()),this.baseFontFamily(t.baseFontFamily()),this.baseFontFamilySpecified(t.baseFontFamilySpecified()),this.baseFontFamilyImportant(t.baseFontFamilyImportant()),this.allImportant(t.allImportant()),this.pageOtherStyle(t.pageOtherStyle()),this.firstPageOtherStyle(t.firstPageOtherStyle()),this.rootOtherStyle(t.rootOtherStyle()),this.beforeOtherStyle(t.beforeOtherStyle()),this.afterOtherStyle(t.afterOtherStyle()),this.viewerFontSize&&t.viewerFontSize&&this.viewerFontSize(t.viewerFontSize())}},{key:"equivalentTo",value:function(t){return this.pageSizeMode()===t.pageSizeMode()&&((this.pageSizeMode()!==l.PRESET||this.presetSize()===t.presetSize())&&((this.pageSizeMode()!==l.PRESET||this.isLandscape()===t.isLandscape())&&((this.pageSizeMode()!==l.CUSTOM||this.customWidth()===t.customWidth())&&((this.pageSizeMode()!==l.CUSTOM||this.customHeight()===t.customHeight())&&(this.pageSizeImportant()===t.pageSizeImportant()&&(this.pageMarginMode()===t.pageMarginMode()&&((this.pageMarginMode()!==l.CUSTOM||this.customMargin()===t.customMargin())&&(this.pageMarginImportant()===t.pageMarginImportant()&&(this.firstPageMarginZero()===t.firstPageMarginZero()&&(this.firstPageMarginZeroImportant()===t.firstPageMarginZeroImportant()&&(this.forceHtmlBodyMarginZero()===t.forceHtmlBodyMarginZero()&&(this.widowsOrphans()===t.widowsOrphans()&&(this.widowsOrphansImportant()===t.widowsOrphansImportant()&&(this.imageMaxSizeToFitPage()===t.imageMaxSizeToFitPage()&&(this.imageMaxSizeToFitPageImportant()===t.imageMaxSizeToFitPageImportant()&&(this.imageKeepAspectRatio()===t.imageKeepAspectRatio()&&(this.imageKeepAspectRatioImportant()===t.imageKeepAspectRatioImportant()&&(this.baseFontSizeSpecified()===t.baseFontSizeSpecified()&&((!this.baseFontSizeSpecified()||this.baseFontSize()===t.baseFontSize())&&(this.baseFontSizeImportant()===t.baseFontSizeImportant()&&(this.baseLineHeightSpecified()===t.baseLineHeightSpecified()&&((!this.baseLineHeightSpecified()||this.baseLineHeight()===t.baseLineHeight())&&(this.baseLineHeightImportant()===t.baseLineHeightImportant()&&(this.baseFontFamilySpecified()===t.baseFontFamilySpecified()&&((!this.baseFontFamilySpecified()||this.baseFontFamily()===t.baseFontFamily())&&(this.baseFontFamilyImportant()===t.baseFontFamilyImportant()&&(this.allImportant()===t.allImportant()&&(this.pageOtherStyle()===t.pageOtherStyle()&&(this.firstPageOtherStyle()===t.firstPageOtherStyle()&&(this.rootOtherStyle()===t.rootOtherStyle()&&(this.beforeOtherStyle()===t.beforeOtherStyle()&&(this.afterOtherStyle()===t.afterOtherStyle()&&!(!this.viewerFontSize!=!t.viewerFontSize||this.viewerFontSize&&this.viewerFontSize()!==t.viewerFontSize())))))))))))))))))))))))))))))))))}}]),t}();u.Mode=l,u.Constants=c,u.PresetSize=u.prototype.PresetSize=h,n.default=u,e.exports=n.default},{knockout:1}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../models/vivliostyle"),o=(s=r)&&s.__esModule?s:{default:s},a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"toSpreadViewString",value:function(){switch(this){case l.SPREAD:return"true";case l.SINGLE_PAGE:return"false";case l.AUTO_SPREAD:return"auto";default:throw new Error("Invalid PageViewMode")}}},{key:"toString",value:function(){switch(this){case l.SPREAD:return"spread";case l.SINGLE_PAGE:return"singlePage";case l.AUTO_SPREAD:return"autoSpread";default:throw new Error("Invalid PageViewMode")}}}]),t}(),l={AUTO_SPREAD:new a,SINGLE_PAGE:new a,SPREAD:new a,defaultMode:function(){return this.AUTO_SPREAD},fromSpreadViewString:function(t){switch(t){case"true":return this.SPREAD;case"false":return this.SINGLE_PAGE;case"auto":default:return this.AUTO_SPREAD}},of:function(t){switch(t){case o.default.viewer.PageViewMode.SPREAD:return this.SPREAD;case o.default.viewer.PageViewMode.SINGLE_PAGE:return this.SINGLE_PAGE;case o.default.viewer.PageViewMode.AUTO_SPREAD:return this.AUTO_SPREAD;default:throw new Error("Invalid PageViewMode name: "+t)}}};n.default=l,e.exports=n.default},{"../models/vivliostyle":11}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw r}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t){return t&&t.__esModule?t:{default:t}}var o=r(t("knockout")),a=r(t("../stores/url-parameters")),l=r(t("./page-view-mode")),h=r(t("./zoom-options"));function c(){return{renderAllPages:a.default.hasParameter("x"),fontSize:16,profile:!1,pageViewMode:l.default.defaultMode(),zoom:h.default.createDefaultOptions()}}var u=function(){function t(e){var n,s,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderAllPages=o.default.observable(),this.fontSize=o.default.observable(),this.profile=o.default.observable(),this.pageViewMode=o.default.observable(),this.zoom=o.default.observable(),e?this.copyFrom(e):(n=c(),s=function(){var t=a.default.getParameter("renderAllPages")[0],e=a.default.getParameter("fontSize")[0],n=/^([\d.]+)(?:(%25|%)|\/([\d.]+))?$/.exec(e),s=null;if(n){var r=i(n,4),o=r[1],h=r[2],c=r[3];s=parseFloat(o),(h||c)&&(s=16*s/(h?100:parseFloat(c))),s<5&&(s=5),s>72&&(s=72)}return{renderAllPages:"true"===t||"false"!==t&&null,fontSize:s,profile:"true"===a.default.getParameter("profile")[0],pageViewMode:l.default.fromSpreadViewString(a.default.getParameter("spread")[0])}}(),r.renderAllPages(null!==s.renderAllPages?s.renderAllPages:n.renderAllPages),r.fontSize(s.fontSize||n.fontSize),r.profile(s.profile||n.profile),r.pageViewMode(s.pageViewMode||n.pageViewMode),r.zoom(n.zoom),r.pageViewMode.subscribe(function(t){t===n.pageViewMode?a.default.removeParameter("spread"):a.default.setParameter("spread",t.toSpreadViewString())}),r.renderAllPages.subscribe(function(t){t===n.renderAllPages?a.default.removeParameter("renderAllPages"):a.default.setParameter("renderAllPages",t.toString())}),r.fontSize.subscribe(function(t){"number"==typeof t&&(t=t.toPrecision(10).replace(/(?:\.0*|(\.\d*?)0+)$/,"$1")),t==n.fontSize?a.default.removeParameter("fontSize"):a.default.setParameter("fontSize",t+"/"+n.fontSize)}))}return s(t,[{key:"copyFrom",value:function(t){this.renderAllPages(t.renderAllPages()),this.fontSize(t.fontSize()),this.profile(t.profile()),this.pageViewMode(t.pageViewMode()),this.zoom(t.zoom())}},{key:"toObject",value:function(){return{renderAllPages:this.renderAllPages(),fontSize:this.fontSize(),pageViewMode:this.pageViewMode().toString(),zoom:this.zoom().zoom,fitToScreen:this.zoom().fitToScreen}}}]),t}();u.getDefaultValues=c,n.default=u,e.exports=n.default},{"../stores/url-parameters":13,"./page-view-mode":9,"./zoom-options":12,knockout:1}],11:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewer=null,this.constants=null,this.profile=null}return i(t,[{key:"setInstance",value:function(t){this.viewer=t.viewer,this.constants=t.constants,this.profile=t.profile}}]),t}();n.default=new s,e.exports=n.default},{}],12:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t,e,n){for(var i=!0;i;){var s=t,r=e,o=n;i=!1,null===s&&(s=Function.prototype);var a=Object.getOwnPropertyDescriptor(s,r);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(o)}var h=Object.getPrototypeOf(s);if(null===h)return;t=h,e=r,n=o,i=!0,a=h=void 0}},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a,l=t("../models/vivliostyle"),h=(a=l)&&a.__esModule?a:{default:a},c=function(){function t(e){o(this,t),this.zoom=e}return s(t,[{key:"zoomIn",value:function(t){return new d(1.25*this.getCurrentZoomFactor(t))}},{key:"zoomOut",value:function(t){return new d(.8*this.getCurrentZoomFactor(t))}},{key:"zoomToActualSize",value:function(){return new d(1)}}],[{key:"createDefaultOptions",value:function(){return new u}},{key:"createFromZoomFactor",value:function(t){return new d(t)}}]),t}(),u=function(t){function e(){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,1)}return r(e,c),s(e,[{key:"toggleFitToScreen",value:function(){return new d(1)}},{key:"getCurrentZoomFactor",value:function(t){return t.queryZoomFactor(h.default.viewer.ZoomType.FIT_INSIDE_VIEWPORT)}},{key:"fitToScreen",get:function(){return!0}}]),e}(),d=function(t){function e(){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return r(e,c),s(e,[{key:"toggleFitToScreen",value:function(){return new u}},{key:"getCurrentZoomFactor",value:function(t){return this.zoom}},{key:"fitToScreen",get:function(){return!1}}]),e}();n.default=c,e.exports=n.default},{"../models/vivliostyle":11}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("../utils/string-util"),o=(s=r)&&s.__esModule?s:{default:s};function a(t){return new RegExp("[#&]"+o.default.escapeUnicodeString(t)+"=([^&]*)","g")}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.history=window?window.history:{},this.location=window?window.location:{href:""},this.storedUrl=this.location.href}return i(t,[{key:"getBaseURL",value:function(){var t=this.location.href;return(t=t.replace(/#.*$/,"")).replace(/\/[^\/]*$/,"/")}},{key:"hasParameter",value:function(t){var e=this.location.href;return a(t).test(e)}},{key:"getParameter",value:function(t){for(var e=this.location.href,n=a(t),i=[],s=void 0;s=n.exec(e);)i.push(s[1]);return i}},{key:"setParameter",value:function(t,e,n){var i=this.location.href,s=void 0,r=a(t),o=r.exec(i);if(o&&n)for(;n-- >=1;)o=r.exec(i);if(o){var l=o[1].length,h=o.index+o[0].length-l;s=i.substring(0,h)+e+i.substring(h+l)}else s=i+(i.match(/[#&]$/)?"":i.match(/#/)?"&":"#")+t+"="+e;this.history.replaceState?this.history.replaceState(null,"",s):this.location.href=s,this.storedUrl=s}},{key:"removeParameter",value:function(t,e){var n=this.location.href,i=void 0,s=a(t),r=s.exec(n);if(r&&e&&(r=s.exec(n)),r){for(i=n;r;r=s.exec(i)){var o=r.index+r[0].length;i="#"==r[0].charAt(0)?i.substring(0,r.index+1)+i.substring(o+1):i.substring(0,r.index)+i.substring(o),s.lastIndex-=r[0].length}i=i.replace(/^(.*?)[#&]$/,"$1"),this.history.replaceState?this.history.replaceState(null,"",i):this.location.href=i}this.storedUrl=i}}]),t}();n.default=new l,e.exports=n.default},{"../utils/string-util":16}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={Unidentified:"Unidentified",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",Home:"Home",End:"End",PageDown:"PageDown",PageUp:"PageUp",Escape:"Escape",Enter:"Enter",Space:" "};n.default={Keys:i,identifyKeyFromEvent:function(t){var e=t.key,n=t.keyIdentifier,s=t.location;return e===i.ArrowDown||"Down"===e||"Down"===n?t.metaKey?i.End:i.ArrowDown:e===i.ArrowLeft||"Left"===e||"Left"===n?i.ArrowLeft:e===i.ArrowRight||"Right"===e||"Right"===n?i.ArrowRight:e===i.ArrowUp||"Up"===e||"Up"===n?t.metaKey?i.Home:i.ArrowUp:e===i.Escape||"Esc"===e||"U+001B"===n?i.Escape:e===i.Enter||"Enter"===n?i.Enter:e===i.Space||"U+0020"===n?i.Space:"0"===e||"U+0030"===n?"0":"+"===e||"Add"===e||"U+002B"===n||"U+00BB"===n||"U+004B"===n&&s===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"+":"-"===e||"Subtract"===e||"U+002D"===n||"U+00BD"===n||"U+004D"===n&&s===KeyboardEvent.DOM_KEY_LOCATION_NUMPAD?"-":e||n||i.Unidentified}},e.exports=n.default},{}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,s=t("knockout"),r=(i=s)&&i.__esModule?i:{default:i},o={readonlyObservable:function(t){var e=r.default.observable(t);return{getter:r.default.pureComputed(function(){return e()}),value:e}}};n.default=o,e.exports=n.default},{knockout:1}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={escapeUnicodeChar:function(t){return"\\u"+(65536|t.charCodeAt(0)).toString(16).substring(1)},escapeUnicodeString:function(t){return t.replace(/[^-a-zA-Z0-9_]/g,this.escapeUnicodeChar)},percentEncodeAmpersandAndUnencodedPercent:function(t){return t.replace(/%(?![0-9A-Fa-f]{2})/g,"%25").replace(/&/g,"%26")},percentEncodeAmpersandAndPercent:function(t){return t.replace(/%/g,"%25").replace(/&/g,"%26")},percentDecodeAmpersandAndPercent:function(t){return t.replace(/%26/g,"&").replace(/%25/g,"%")},percentEncodeForDataURI:function(t){return encodeURI(t).replace(/#/g,"%23").replace(/&/g,"%26")}},e.exports=n.default},{}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var s,r=t("knockout"),o=(s=r)&&s.__esModule?s:{default:s},a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.list=e,this.visible=o.default.pureComputed(function(){return e().length>0})}return i(t,[{key:"getDisplayMessage",value:function(t){var e=t.error,n=e&&(e.toString()||e.frameTrace||e.stack);return n&&(n=n.split("\n",1)[0]),n||(n=t.messages.join("\n")),n}}]),t}();n.default=a,e.exports=n.default},{knockout:1}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../models/viewer-options")),a=t("../utils/key-util"),l=s(t("../models/vivliostyle")),h=function(){function t(e,n,i,s){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.viewer_=n,this.settingsPanel_=i,this.justClicked=!1,this.isDisabled=r.default.pureComputed(function(){return o.settingsPanel_.opened()&&!o.settingsPanel_.pinned()||!o.viewer_.state.navigatable()});var a=r.default.pureComputed(function(){return s.disablePageNavigation||o.isDisabled()});a.subscribe(function(t){var e=document.getElementById("vivliostyle-page-number");e&&(e.disabled=t)}),this.isPageNumberDisabled=r.default.pureComputed(function(){return a()}),this.isNavigateToPreviousDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&o.viewer_.firstPage()}),this.isNavigateToNextDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&((!o.viewerOptions_.renderAllPages()||o.viewer_.state.status()==l.default.constants.ReadyState.COMPLETE)&&o.viewer_.lastPage())}),this.isNavigateToLeftDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.pageProgression&&(o.viewer_.state.pageProgression()===l.default.constants.PageProgression.LTR?o.isNavigateToPreviousDisabled():o.isNavigateToNextDisabled())}),this.isNavigateToRightDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.pageProgression&&(o.viewer_.state.pageProgression()===l.default.constants.PageProgression.LTR?o.isNavigateToNextDisabled():o.isNavigateToPreviousDisabled())}),this.isNavigateToFirstDisabled=this.isNavigateToPreviousDisabled,this.isNavigateToLastDisabled=r.default.pureComputed(function(){return!!a()||void 0!==o.viewer_.state.status&&(!(!o.viewerOptions_.renderAllPages()||o.viewer_.state.status()==l.default.constants.ReadyState.COMPLETE)||o.viewer_.lastPage())}),this.hidePageNavigation=!!s.disablePageNavigation;var h=r.default.pureComputed(function(){return s.disableZoom||o.isDisabled()});this.isZoomOutDisabled=h,this.isZoomInDisabled=h,this.isZoomToActualSizeDisabled=h,this.isToggleFitToScreenDisabled=h,this.hideZoom=!!s.disableZoom,this.fitToScreen=r.default.pureComputed(function(){return e.zoom().fitToScreen});var c=r.default.pureComputed(function(){return s.disableFontSizeChange||o.isDisabled()});this.isIncreaseFontSizeDisabled=r.default.pureComputed(function(){return!!c()||o.viewerOptions_.fontSize()>=72}),this.isDecreaseFontSizeDisabled=r.default.pureComputed(function(){return!!c()||o.viewerOptions_.fontSize()<=5}),this.isDefaultFontSizeDisabled=c,this.hideFontSizeChange=!!s.disableFontSizeChange,this.isTOCToggleDisabled=r.default.pureComputed(function(){return s.disableTOCNavigation||o.isDisabled()||null==o.viewer_.tocVisible()}),this.hideTOCNavigation=!!s.disableTOCNavigation,this.pageNumber=r.default.pureComputed({read:function(){return this.viewer_.epageToPageNumber(this.viewer_.epage())},write:function(t){var e=this,n=this.viewer_.epage(),i=this.viewer_.epageToPageNumber(n),s=parseFloat(t.replace(/[０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)}))||0;if(/^[-+]/.test(t)&&(s=i+s),s<1)s=1;else{var r=this.viewer_.epageCount();this.viewerOptions_.renderAllPages()?s>r&&(s=r):s>r+1&&(s=r+1)}var o=this.viewer_.epageFromPageNumber(s),a=document.getElementById("vivliostyle-page-number");a.value=s,this.viewer_.navigateToEPage(o),setTimeout(function(){e.viewer_.state.status()!=l.default.constants.ReadyState.LOADING&&e.viewer_.epage()===n&&(a.value=i),document.getElementById("vivliostyle-viewer-viewport").focus()},10)},owner:this}),this.totalPages=r.default.pureComputed(function(){var t=o.viewer_.epageCount();if(!t)return t;var e=o.pageNumber();return o.viewer_.lastPage()?t=e:e>=t&&t++,t}),["navigateToPrevious","navigateToNext","navigateToLeft","navigateToRight","navigateToFirst","navigateToLast","zoomIn","zoomOut","zoomToActualSize","toggleFitToScreen","increaseFontSize","decreaseFontSize","defaultFontSize","onclickViewport","toggleTOC"].forEach(function(t){o[t]=o[t].bind(o)})}return i(t,[{key:"navigateToPrevious",value:function(){return!this.isNavigateToPreviousDisabled()&&(this.viewer_.navigateToPrevious(),!0)}},{key:"navigateToNext",value:function(){return!this.isNavigateToNextDisabled()&&(this.viewer_.navigateToNext(),!0)}},{key:"navigateToLeft",value:function(){return!this.isNavigateToLeftDisabled()&&(this.viewer_.navigateToLeft(),!0)}},{key:"navigateToRight",value:function(){return!this.isNavigateToRightDisabled()&&(this.viewer_.navigateToRight(),!0)}},{key:"navigateToFirst",value:function(){return!this.isNavigateToFirstDisabled()&&(this.viewer_.navigateToFirst(),!0)}},{key:"navigateToLast",value:function(){return!this.isNavigateToLastDisabled()&&(this.viewer_.navigateToLast(),!0)}},{key:"zoomIn",value:function(){if(this.isZoomInDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomIn(this.viewer_)),!0}},{key:"zoomOut",value:function(){if(this.isZoomOutDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomOut(this.viewer_)),!0}},{key:"zoomToActualSize",value:function(){if(this.isZoomToActualSizeDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.zoomToActualSize()),!0}},{key:"toggleFitToScreen",value:function(){if(this.isToggleFitToScreenDisabled())return!1;var t=this.viewerOptions_.zoom();return this.viewerOptions_.zoom(t.toggleFitToScreen()),!0}},{key:"increaseFontSize",value:function(){if(this.isIncreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t<10?Math.floor(t)+1:t<20?2*(Math.floor(t/2)+1):t<40?4*(Math.floor(t/4)+1):t<72?8*(Math.floor(t/8)+1):72,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"decreaseFontSize",value:function(){if(this.isDecreaseFontSizeDisabled())return!1;var t=this.viewerOptions_.fontSize();return t=t>40?8*(Math.ceil(t/8)-1):t>20?4*(Math.ceil(t/4)-1):t>10?2*(Math.ceil(t/2)-1):t>5?Math.ceil(t)-1:5,this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"defaultFontSize",value:function(){if(this.isDefaultFontSizeDisabled())return!1;var t=o.default.getDefaultValues().fontSize;return this.viewerOptions_.fontSize(t),this.updateFontSizeSettings(),!0}},{key:"updateFontSizeSettings",value:function(){this.settingsPanel_.state.viewerOptions.fontSize(this.viewerOptions_.fontSize()),this.viewer_.documentOptions_.pageStyle.baseFontSizeSpecified()&&(this.viewer_.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.viewer_.documentOptions_,this.viewerOptions_))}},{key:"onclickViewport",value:function(){if(this.settingsPanel_.justClicked)return!0;if(this.viewer_.tocVisible()&&!this.viewer_.tocPinned()){var t=document.querySelector("[data-vivliostyle-toc-box]");t&&!t.contains(document.activeElement)&&this.toggleTOC()}return this.settingsPanel_.opened()&&!this.settingsPanel_.pinned()&&this.settingsPanel_.close(),!0}},{key:"toggleTOC",value:function(){var t=this;if(this.isTOCToggleDisabled())return!1;var e=function(){var e=0;document.getElementById("vivliostyle-menu-item_toc-toggle");return t.viewer_.tocVisible()?t.justClicked?(t.viewer_.showTOC(!0,!1),t.justClicked=!1):(e&&(clearInterval(e),e=0),t.viewer_.showTOC(!1),t.justClicked=!0,setTimeout(function(){t.justClicked&&(document.getElementById("vivliostyle-viewer-viewport").focus(),t.justClicked=!1)},300)):(t.justClicked?(t.viewer_.showTOC(!0,!1),t.justClicked=!1):(t.viewer_.showTOC(!0,!0),t.justClicked=!0),e=setInterval(function(){var n=document.querySelector("[data-vivliostyle-toc-box]");n&&"visible"===n.style.visibility&&(n.tabIndex=0,n.focus(),clearInterval(e),e=0),t.justClicked=!1},300)),{v:!0}}();return"object"==typeof e?e.v:void 0}},{key:"navigateTOC",value:function(t){var e=Array.from(document.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) [tabindex='0'],[data-vivliostyle-toc-box]>*>*>*>*>*:not([hidden]) a[href]:not([tabindex='-1'])")),n=e.indexOf(document.activeElement),i=function(t){return e[t]&&"button"===e[t].getAttribute("role")},s=function(t){return e[t]&&"true"===e[t].getAttribute("aria-expanded")};switch(t){case a.Keys.ArrowLeft:if(-1==n){n=e.length-1;break}if(!i(n)&&i(n-1)&&n--,i(n)&&s(n))e[n].click();else for(var r=n-1;r>=0;r--)if(i(r)&&e[r].parentElement.contains(e[n])){n=r;break}break;case a.Keys.ArrowRight:if(-1==n){n=0;break}!i(n)&&i(n-1)&&n--,i(n)&&(s(n)?n+=2:e[n].click());break;case a.Keys.ArrowDown:n++;break;case a.Keys.ArrowUp:if(-1==n){n=e.length-1;break}n>0&&i(--n)&&n--;break;case a.Keys.Home:n=0;break;case a.Keys.End:n=e.length-1;break;case a.Keys.Space:!i(n)&&i(n-1)&&n--,i(n)&&e[n].click()}return i(n)&&n++,e[n]&&e[n].focus(),!0}},{key:"handleKey",value:function(t){if(this.settingsPanel_.opened()&&this.settingsPanel_.settingsToggle.contains(document.activeElement))return!0;var e=document.getElementById("vivliostyle-page-number"),n=document.getElementById("vivliostyle-viewer-viewport"),i=n.scrollWidth>n.clientWidth,s=n.scrollHeight>n.clientHeight,r=e===document.activeElement,o=this.viewer_.tocVisible()&&!r&&n!=document.activeElement;switch(t){case"+":return r||!this.increaseFontSize();case"-":return r||!this.decreaseFontSize();case"0":return r||!this.defaultFontSize();case"1":return r||!this.zoomToActualSize();case a.Keys.ArrowLeft:return o?!this.navigateTOC(t):r||i||!this.navigateToLeft();case a.Keys.ArrowRight:return o?!this.navigateTOC(t):r||i||!this.navigateToRight();case a.Keys.ArrowDown:return o?!this.navigateTOC(t):(n.focus(),s||!this.navigateToNext());case a.Keys.ArrowUp:return o?!this.navigateTOC(t):(n.focus(),s||!this.navigateToPrevious());case a.Keys.PageDown:return!!o||(n.focus(),!this.navigateToNext());case a.Keys.PageUp:return!!o||(n.focus(),!this.navigateToPrevious());case a.Keys.Home:return o?!this.navigateTOC(t):(n.focus(),!this.navigateToFirst());case a.Keys.End:return o?!this.navigateTOC(t):(n.focus(),!this.navigateToLast());case"o":case"O":return n.focus(),!this.zoomOut();case"i":case"I":return n.focus(),!this.zoomIn();case"f":case"F":return n.focus(),!this.toggleFitToScreen();case"g":case"G":return e.focus(),!1;case"t":case"T":return n.focus(),!this.toggleTOC();case a.Keys.Escape:return this.viewer_.tocVisible()?!this.toggleTOC():(n.focus(),!0);case a.Keys.Space:return o?!this.navigateTOC(t):"button"!==document.activeElement.getAttribute("role")||(document.activeElement.click(),!1);default:return!0}}}]),t}();n.default=h,e.exports=n.default},{"../models/viewer-options":10,"../models/vivliostyle":11,"../utils/key-util":14,knockout:1}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../models/viewer-options")),a=s(t("../models/page-style")),l=s(t("../models/page-view-mode")),h=t("../utils/key-util"),c=function(){function t(e,n,i,s,h){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=e,this.documentOptions_=n,this.viewer_=i,this.isPageStyleChangeDisabled=!!h.disablePageStyleChange,this.isOverrideDocumentStyleSheetDisabled=this.isPageStyleChangeDisabled,this.isPageViewModeChangeDisabled=!!h.disablePageViewModeChange,this.isRenderAllPagesChangeDisabled=!!h.disableRenderAllPagesChange,this.justClicked=!1,this.settingsToggle=document.getElementById("vivliostyle-menu-item_settings-toggle"),this.opened=r.default.observable(!1),this.pinned=r.default.observable(!1),this.state={viewerOptions:new o.default(e),pageStyle:new a.default(n.pageStyle),pageViewMode:r.default.pureComputed({read:function(){return c.state.viewerOptions.pageViewMode().toString()},write:function(t){c.state.viewerOptions.pageViewMode(l.default.of(t))}}),renderAllPages:r.default.pureComputed({read:function(){return c.state.viewerOptions.renderAllPages()},write:function(t){c.state.viewerOptions.renderAllPages(t)}})},this.state.pageStyle.setViewerFontSizeObservable(this.state.viewerOptions.fontSize),this.defaultPageStyle=new a.default,["close","toggle","apply","cancel","resetUserStyle"].forEach(function(t){this[t]=this[t].bind(this)},this),s.visible.subscribe(function(t){t&&this.close()},this)}return i(t,[{key:"close",value:function(){this.opened(!1),this.pinned(!1);var t=document.getElementById("vivliostyle-viewer-viewport");return t&&t.focus(),!0}},{key:"toggle",value:function(){var t=this;this.opened()?this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.close(),this.justClicked=!0,setTimeout(function(){t.justClicked=!1},300)):(this.viewer_.tocPinned()||this.viewer_.showTOC(!1),this.opened(!0),this.justClicked?(this.justClicked=!1,this.pinned(!0)):(this.pinned(!1),this.justClicked=!0,this.focusToFirstItem(),setTimeout(function(){t.justClicked=!1},300)))}},{key:"apply",value:function(){this.state.renderAllPages()===this.viewerOptions_.renderAllPages()&&this.state.pageStyle.equivalentTo(this.documentOptions_.pageStyle)?this.viewerOptions_.copyFrom(this.state.viewerOptions):(this.documentOptions_.pageStyle.copyFrom(this.state.pageStyle),this.documentOptions_.pageStyle.baseFontSizeSpecified()&&this.documentOptions_.updateUserStyleSheetFromCSSText(),this.viewer_.loadDocument(this.documentOptions_,this.state.viewerOptions)),this.pinned()?this.focusToFirstItem():this.close()}},{key:"cancel",value:function(){this.state.viewerOptions.copyFrom(this.viewerOptions_),this.state.pageStyle.copyFrom(this.documentOptions_.pageStyle),this.close()}},{key:"resetUserStyle",value:function(){return this.state.pageStyle.copyFrom(this.defaultPageStyle),this.state.viewerOptions.fontSize(o.default.getDefaultValues().fontSize),setTimeout(function(){document.getElementsByName("vivliostyle-settings_reset-user-style")[0].checked=!1},200),!0}},{key:"focusToFirstItem",value:function(t){var e=t||this.settingsToggle,n=["input","textarea","summary"].includes(e.localName)?e:Array.from(e.getElementsByTagName("input")).find(function(t){return!t.disabled&&("radio"!=t.type||t.checked)});if(n){for(var i=n.parentElement;i&&i!=this.settingsToggle;i=i.parentElement)"details"==i.localName&&(i.open=!0);n.focus()}}},{key:"handleKey",value:function(t){var e=this.opened()&&this.settingsToggle.contains(document.activeElement),n=e&&("text"==document.activeElement.type||"select"==document.activeElement.localName),i=e&&"textarea"==document.activeElement.localName,s=e&&!n&&!i;switch(t){case h.Keys.Escape:return this.opened()&&(this.cancel(),this.close()),!0;case"s":case"S":return!(!this.opened()||s||!e)||(this.toggle(),!1);case"p":case"P":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-and-rendering").firstElementChild),!1);case"v":case"V":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-view-mode")),!1);case"a":case"A":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_render-all-pages")[0]),!1);case"u":case"U":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_user-style").firstElementChild),!1);case"z":case"Z":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-size")),!1);case"m":case"M":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-margin")),!1);case"b":case"B":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_page-breaks")),!1);case"i":case"I":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_images")),!1);case"t":case"T":return!s||(this.focusToFirstItem(document.getElementById("vivliostyle-settings_text")),!1);case"o":case"O":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_override-document-stylesheets")[0]),!1);case"c":case"C":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_css-details")[0]),!1);case"r":case"R":return!s||(this.focusToFirstItem(document.getElementsByName("vivliostyle-settings_reset-user-style")[0]),!1);case h.Keys.Enter:return!(n||s&&"vivliostyle-menu-button_apply"!==document.activeElement.id&&"vivliostyle-menu-button_reset"!==document.activeElement.id)||(document.getElementById("vivliostyle-menu-button_apply").focus(),!1);default:return!0}}}]),t}();n.default=c,e.exports=n.default},{"../models/page-style":8,"../models/page-view-mode":9,"../models/viewer-options":10,"../utils/key-util":14,knockout:1}],20:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var s=i(t("../models/vivliostyle")),r=i(t("../models/document-options")),o=i(t("../models/viewer-options")),a=i(t("../models/message-queue")),l=i(t("./viewer")),h=i(t("./navigation")),c=i(t("./settings-panel")),u=i(t("./message-dialog")),d=i(t("../utils/key-util")),f=i(t("../utils/string-util")),p=i(t("../stores/url-parameters"));n.default=function(){var t=this;this.documentOptions=new r.default,this.viewerOptions=new o.default,this.documentOptions.pageStyle.setViewerFontSizeObservable(this.viewerOptions.fontSize),this.viewerOptions.profile()&&s.default.profile.profiler.enable(),this.isDebug="true"===p.default.getParameter("debug")[0],this.viewerSettings={userAgentRootURL:p.default.getBaseURL()+"resources/",viewportElement:document.getElementById("vivliostyle-viewer-viewport"),debug:this.isDebug},p.default.getParameter("b")[0]&&(p.default.removeParameter("b",!0),p.default.removeParameter("x")),p.default.removeParameter("f",!0),p.default.removeParameter("spread",!0),p.default.removeParameter("renderAllPages",!0),p.default.removeParameter("fontSize",!0),p.default.removeParameter("profile",!0),p.default.removeParameter("debug",!0),this.viewer=new l.default(this.viewerSettings,this.viewerOptions),this.viewer.inputUrl.subscribe(function(t){""!=t?(p.default.hasParameter("b")||p.default.history.pushState&&p.default.history.pushState(null,""),t=t.startsWith("<")?"data:,"+f.default.percentEncodeForDataURI(t):f.default.percentEncodeAmpersandAndUnencodedPercent(t),p.default.setParameter("b",t)):p.default.removeParameter("b")}),this.messageDialog=new u.default(a.default),this.settingsPanel=new c.default(this.viewerOptions,this.documentOptions,this.viewer,this.messageDialog,{disablePageStyleChange:!1,disablePageViewModeChange:!1,disableRenderAllPagesChange:!1}),this.navigation=new h.default(this.viewerOptions,this.viewer,this.settingsPanel,{disableTOCNavigation:!1,disablePageNavigation:!1,disableZoom:!1,disableFontSizeChange:!1}),this.handleKey=function(e,n){var i=d.default.identifyKeyFromEvent(n);if("vivliostyle-input-url"===document.activeElement.id)return"Enter"!==i||13!==n.keyCode||(t.documentOptions.bookUrl(p.default.getParameter("b")[0]),t.viewer.loadDocument(t.documentOptions),!1);if("Home"!==i&&"End"!==i&&(n.ctrlKey||n.metaKey)||n.altKey||n.shiftKey)return!0;var s=t.settingsPanel.handleKey(i);return s&&(s=t.navigation.handleKey(i)),s},this.viewer.loadDocument(this.documentOptions),window.onhashchange=function(){window.location.href!=p.default.storedUrl&&window.location.reload()}},e.exports=n.default},{"../models/document-options":6,"../models/message-queue":7,"../models/viewer-options":10,"../models/vivliostyle":11,"../stores/url-parameters":13,"../utils/key-util":14,"../utils/string-util":16,"./message-dialog":17,"./navigation":18,"./settings-panel":19,"./viewer":21}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function s(t){return t&&t.__esModule?t:{default:t}}var r=s(t("knockout")),o=s(t("../utils/observable-util")),a=s(t("../logging/logger")),l=s(t("../models/vivliostyle")),h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewerOptions_=n,this.documentOptions_=null,this.viewer_=new l.default.viewer.Viewer(e,n.toObject());var i=this.state_={status:o.default.readonlyObservable(l.default.constants.ReadyState.LOADING),pageProgression:o.default.readonlyObservable(l.default.constants.PageProgression.LTR)};this.state={status:i.status.getter.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"},notify:"always"}),navigatable:r.default.pureComputed(function(){return i.status.value()&&i.status.value()!==l.default.constants.ReadyState.LOADING}),pageProgression:i.pageProgression.getter},this.epage=r.default.observable(),this.epageCount=r.default.observable(),this.firstPage=r.default.observable(),this.lastPage=r.default.observable(),this.tocVisible=r.default.observable(),this.tocPinned=r.default.observable(),this.inputUrl=r.default.observable(""),this.setupViewerEventHandler(),this.setupViewerOptionSubscriptions()}return i(t,[{key:"setupViewerEventHandler",value:function(){var t=this,e=a.default.getLogger();this.viewer_.addListener("debug",function(t){e.debug(t.content)}),this.viewer_.addListener("info",function(t){e.info(t.content)}),this.viewer_.addListener("warn",function(t){e.warn(t.content)}),this.viewer_.addListener("error",function(t){e.error(t.content)}),this.viewer_.addListener("readystatechange",function(){var e=t.viewer_.readyState;e!==l.default.constants.ReadyState.INTERACTIVE&&e!==l.default.constants.ReadyState.COMPLETE||t.state_.pageProgression.value(t.viewer_.getCurrentPageProgression()),t.state_.status.value(e)}),this.viewer_.addListener("loaded",function(){t.viewerOptions_.profile()&&l.default.profile.profiler.printTimings()}),this.viewer_.addListener("nav",function(e){var n=e.cfi,i=e.first,s=e.last,r=e.epage,o=e.epageCount,a=e.metadata,l=e.docTitle;if(n&&t.documentOptions_.fragment(n),void 0!==i&&t.firstPage(i),void 0!==s&&t.lastPage(s),void 0!==r&&t.epage(r),void 0!==o&&t.epageCount(o),a||l){var h=a&&a["http://purl.org/dc/terms/title"],c=h&&h[0]&&h[0].v;c?!l||l===c||t.firstPage()||/\.xhtml$/.test(l)?document.title=c:document.title=l+" | "+c:document.title=l||"Vivliostyle Viewer"}var u=t.tocVisible(),d=t.viewer_.isTOCVisible();u&&!d||t.tocVisible(d)}),this.viewer_.addListener("hyperlink",function(e){e.internal?(t.navigateToInternalUrl(e.href),t.tocVisible()&&t.tocVisible(!1),document.getElementById("vivliostyle-viewer-viewport").focus()):window.location.href=e.href})}},{key:"setupViewerOptionSubscriptions",value:function(){r.default.computed(function(){var t=this.viewerOptions_.toObject();this.viewer_.setOptions(t)},this).extend({rateLimit:0})}},{key:"loadDocument",value:function(t,e){this.state_.status.value(l.default.constants.ReadyState.LOADING),e&&this.viewerOptions_.copyFrom(e),this.documentOptions_=t,t.xUrl()?this.viewer_.loadDocument(t.xUrl(),t.toObject(),this.viewerOptions_.toObject()):t.bookUrl()?this.viewer_.loadPublication?this.viewer_.loadPublication(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.viewer_.loadEPUB(t.bookUrl(),t.toObject(),this.viewerOptions_.toObject()):this.state_.status.value("")}},{key:"navigateToPrevious",value:function(){this.viewer_.navigateToPage("previous")}},{key:"navigateToNext",value:function(){this.viewer_.navigateToPage("next")}},{key:"navigateToLeft",value:function(){this.viewer_.navigateToPage("left")}},{key:"navigateToRight",value:function(){this.viewer_.navigateToPage("right")}},{key:"navigateToFirst",value:function(){this.viewer_.navigateToPage("first")}},{key:"navigateToLast",value:function(){this.viewer_.navigateToPage("last")}},{key:"navigateToEPage",value:function(t){this.viewer_.navigateToPage("epage",t)}},{key:"navigateToInternalUrl",value:function(t){this.viewer_.navigateToInternalUrl(t)}},{key:"queryZoomFactor",value:function(t){return this.viewer_.queryZoomFactor(t)}},{key:"epageToPageNumber",value:function(t){if(t||0==t)return Math.round(t+1)}},{key:"epageFromPageNumber",value:function(t){if(t||0==t)return t-1}},{key:"showTOC",value:function(t,e){if(null!=this.viewer_.isTOCVisible()){var n=null==t?!this.tocVisible():t;this.tocVisible(n),this.tocPinned(!!n&&!e),this.viewer_.showTOC(n,e)}}}]),t}();n.default=h,e.exports=n.default},{"../logging/logger":4,"../models/vivliostyle":11,"../utils/observable-util":15,knockout:1}],22:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var s=i(t("knockout")),r=(i(t("./bindings/menuButton.js")),i(t("./bindings/swipePages.js")),i(t("./viewmodels/viewer-app")));n.default={start:function(){function t(){s.default.applyBindings(new r.default)}window.__loaded?t():window.onload=t}},e.exports=n.default},{"./bindings/menuButton.js":2,"./bindings/swipePages.js":3,"./viewmodels/viewer-app":20,knockout:1}],23:[function(t,e,n){var i,s;i=window,s=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){"use strict";n.d(e,"m",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"o",function(){return h}),n.d(e,"w",function(){return u}),n.d(e,"k",function(){return d}),n.d(e,"f",function(){return p}),n.d(e,"r",function(){return g}),n.d(e,"i",function(){return m}),n.d(e,"h",function(){return b}),n.d(e,"g",function(){return E}),n.d(e,"a",function(){return w}),n.d(e,"l",function(){return v}),n.d(e,"j",function(){return T}),n.d(e,"b",function(){return N}),n.d(e,"e",function(){return S}),n.d(e,"c",function(){return x}),n.d(e,"x",function(){return I}),n.d(e,"n",function(){return C}),n.d(e,"t",function(){return O}),n.d(e,"s",function(){return _}),n.d(e,"q",function(){return A}),n.d(e,"p",function(){return k}),n.d(e,"u",function(){return D}),n.d(e,"v",function(){return R});var i=n(1),s=n(4);class r{S(t){for(let e=0;e<t.length;e++)t[e].visit(this)}T(t){throw new Error("E_CSS_EMPTY_NOT_ALLOWED")}R(t){throw new Error("E_CSS_SLASH_NOT_ALLOWED")}_(t){throw new Error("E_CSS_STR_NOT_ALLOWED")}$(t){throw new Error("E_CSS_IDENT_NOT_ALLOWED")}U(t){throw new Error("E_CSS_NUMERIC_NOT_ALLOWED")}V(t){throw new Error("E_CSS_NUM_NOT_ALLOWED")}X(t){return this.V(t)}W(t){throw new Error("E_CSS_COLOR_NOT_ALLOWED")}Y(t){throw new Error("E_CSS_URL_NOT_ALLOWED")}Z(t){throw new Error("E_CSS_LIST_NOT_ALLOWED")}tt(t){throw new Error("E_CSS_COMMA_NOT_ALLOWED")}et(t){throw new Error("E_CSS_FUNC_NOT_ALLOWED")}nt(t){throw new Error("E_CSS_EXPR_NOT_ALLOWED")}}class o extends r{constructor(){super()}S(t){let e=null;for(let n=0;n<t.length;n++){const i=t[n],s=i.visit(this);if(e)e[n]=s;else if(i!==s){e=new Array(t.length);for(let i=0;i<n;i++)e[i]=t[i];e[n]=s}}return e||t}_(t){return t}$(t){return t}R(t){return t}U(t){return t}V(t){return t}X(t){return t}W(t){return t}Y(t){return t}Z(t){const e=this.S(t.values);return e===t.values?t:new T(e)}tt(t){const e=this.S(t.values);return e===t.values?t:new N(e)}et(t){const e=this.S(t.values);return e===t.values?t:new S(t.name,e)}nt(t){return t}}class a{toString(){const t=new i.d;return this.it(t,!0),t.toString()}stringValue(){const t=new i.d;return this.it(t,!1),t.toString()}st(t,e){throw new Error("F_ABSTRACT")}it(t,e){t.append("[error]")}rt(){return!1}ot(){return!1}ht(){return!1}lt(){return!1}ct(){return!1}visit(t){throw new Error("F_ABSTRACT")}}class l extends a{static get instance(){return this.empty||(this.empty=new l),this.empty}constructor(){super()}st(t,e){return new s.f(t,"")}it(t,e){}visit(t){return t.T(this)}}const h=l.instance;class c extends a{static get instance(){return this.slash||(this.slash=new c),this.slash}constructor(){super()}st(t,e){return new s.f(t,"/")}it(t,e){t.append("/")}visit(t){return t.R(this)}}const u=c.instance;class d extends a{constructor(t){super(),this.str=t}st(t,e){return new s.f(t,this.str)}it(t,e){e?(t.append('"'),t.append(i.q(this.str)),t.append('"')):t.append(this.str)}visit(t){return t._(this)}}const f={};class p extends a{constructor(t){if(super(),this.name=t,f[t])throw new Error("E_INVALID_CALL");f[t]=this}st(t,e){return new s.f(t,this.name)}it(t,e){e?t.append(i.p(this.name)):t.append(this.name)}visit(t){return t.$(this)}lt(){return!0}}function g(t){let e=f[t];return e||(e=new p(t)),e}class m extends a{constructor(t,e){super(),this.num=t,this.unit=e.toLowerCase()}st(t,e){return 0==this.num?t.zero:e&&"%"==this.unit?100==this.num?e:new s.r(t,e,new s.f(t,this.num/100)):new s.x(t,this.num,this.unit)}it(t,e){t.append(this.num.toString()),t.append(this.unit)}visit(t){return t.U(this)}ot(){return!0}}class b extends a{constructor(t){super(),this.num=t}st(t,e){return 0==this.num?t.zero:1==this.num?t.one:new s.f(t,this.num)}it(t,e){t.append(this.num.toString())}visit(t){return t.V(this)}ht(){return!0}}class E extends b{constructor(t){super(t)}visit(t){return t.X(this)}}class w extends a{constructor(t){super(),this.rgb=t}it(t,e){t.append("#");const n=this.rgb.toString(16);t.append("000000".substr(n.length)),t.append(n)}visit(t){return t.W(this)}}class v extends a{constructor(t){super(),this.url=t}it(t,e){t.append('url("'),t.append(i.q(this.url)),t.append('")')}visit(t){return t.Y(this)}}function y(t,e,n,i){const s=e.length;e[0].it(t,i);for(let r=1;r<s;r++)t.append(n),e[r].it(t,i)}class T extends a{constructor(t){super(),this.values=t}it(t,e){y(t,this.values," ",e)}visit(t){return t.Z(this)}ct(){return!0}}class N extends a{constructor(t){super(),this.values=t}it(t,e){y(t,this.values,",",e)}visit(t){return t.tt(this)}}class S extends a{constructor(t,e){super(),this.name=t,this.values=e}it(t,e){t.append(i.p(this.name)),t.append("("),y(t,this.values,",",e),t.append(")")}visit(t){return t.et(this)}}class x extends a{constructor(t){super(),this.expr=t}st(){return this.expr}it(t,e){t.append("-epubx-expr("),this.expr.it(t,0),t.append(")")}visit(t){return t.nt(this)}rt(){return!0}}function I(t,e){if(t){if(t.ot()){const n=t;return e.at(n.unit,!1)*n.num}if(t.ht())return t.num}return 0}function C(t,e){return new m(I(t,e),"px")}const O={absolute:g("absolute"),all:g("all"),always:g("always"),auto:g("auto"),avoid:g("avoid"),balance:g("balance"),balance_all:g("balance-all"),block:g("block"),block_end:g("block-end"),block_start:g("block-start"),both:g("both"),bottom:g("bottom"),border_box:g("border-box"),break_all:g("break-all"),break_word:g("break-word"),crop:g("crop"),cross:g("cross"),column:g("column"),exclusive:g("exclusive"),_false:g("false"),fixed:g("fixed"),flex:g("flex"),footnote:g("footnote"),footer:g("footer"),header:g("header"),hidden:g("hidden"),horizontal_tb:g("horizontal-tb"),inherit:g("inherit"),inline:g("inline"),inline_block:g("inline-block"),inline_end:g("inline-end"),inline_start:g("inline-start"),landscape:g("landscape"),left:g("left"),line:g("line"),list_item:g("list-item"),ltr:g("ltr"),manual:g("manual"),none:g("none"),normal:g("normal"),oeb_page_foot:g("oeb-page-foot"),oeb_page_head:g("oeb-page-head"),page:g("page"),relative:g("relative"),right:g("right"),same:g("same"),scale:g("scale"),snap_block:g("snap-block"),spread:g("spread"),_static:g("static"),rtl:g("rtl"),table:g("table"),table_caption:g("table-caption"),table_cell:g("table-cell"),table_footer_group:g("table-footer-group"),table_header_group:g("table-header-group"),table_row:g("table-row"),top:g("top"),transparent:g("transparent"),vertical_lr:g("vertical-lr"),vertical_rl:g("vertical-rl"),visible:g("visible"),_true:g("true")},_=new m(100,"%"),A=new m(100,"pvw"),k=new m(100,"pvh"),D=new m(0,"px"),L={"font-size":1,color:2};function R(t,e){return(L[t]||Number.MAX_VALUE)-(L[e]||Number.MAX_VALUE)}},function(t,e,n){"use strict";n.d(e,"o",function(){return s}),n.d(e,"H",function(){return r}),n.d(e,"I",function(){return o}),n.d(e,"h",function(){return a}),n.d(e,"E",function(){return l}),n.d(e,"D",function(){return h}),n.d(e,"G",function(){return c}),n.d(e,"C",function(){return u}),n.d(e,"n",function(){return d}),n.d(e,"a",function(){return f}),n.d(e,"g",function(){return p}),n.d(e,"b",function(){return g}),n.d(e,"v",function(){return w}),n.d(e,"F",function(){return v}),n.d(e,"t",function(){return y}),n.d(e,"u",function(){return T}),n.d(e,"d",function(){return N}),n.d(e,"p",function(){return x}),n.d(e,"q",function(){return I}),n.d(e,"y",function(){return C}),n.d(e,"x",function(){return O}),n.d(e,"r",function(){return _}),n.d(e,"s",function(){return A}),n.d(e,"J",function(){return k}),n.d(e,"i",function(){return D}),n.d(e,"B",function(){return L}),n.d(e,"e",function(){return P}),n.d(e,"w",function(){return F}),n.d(e,"f",function(){return M}),n.d(e,"A",function(){return U}),n.d(e,"z",function(){return z}),n.d(e,"c",function(){return B}),n.d(e,"m",function(){return $}),n.d(e,"j",function(){return G}),n.d(e,"k",function(){return X}),n.d(e,"l",function(){return K});var i=n(6);let s={};function r(t){return JSON.parse(t)}function o(t){const e=t.match(/^([^#]*)/);return e?e[1]:t}let a=window.location.href;function l(t){a=t}let h=window.location.href;function c(t){h=t}function u(t,e){if(e.startsWith("data:"))return t||e;if(!e||t.match(/^\w{2,}:/))return t.toLowerCase().match("^javascript:")?"#":(t.match(/^\w{2,}:\/\/[^\/]+$/)&&(t=`${t}/`),t);let n;if(e.match(/^\w{2,}:\/\/[^\/]+$/)&&(e=`${e}/`),t.match(/^\/\//))return(n=e.match(/^(\w{2,}:)\/\//))?n[1]+t:t;if(t.match(/^\//))return(n=e.match(/^(\w{2,}:\/\/[^\/]+)\//))?n[1]+t:t;if(t.match(/^\.(\/|$)/)&&(t=t.substr(2)),e=function(t){const e=t.match(/^([^#?]*)/);return e?e[1]:t}(e),t.match(/^#/))return e+t;let i=e.lastIndexOf("/");if(i<0)return t;if(i<e.length-1&&e.lastIndexOf(".")<i){if(""==t)return e;i=(e+="/").length-1}let s=e.substr(0,i+1)+t;for(;!((i=s.indexOf("/../"))<=0);){const t=s.lastIndexOf("/",i-1);if(t<=0)break;s=s.substr(0,t)+s.substr(i+3)}return s.replace(/\/(\.\/)+/g,"/")}function d(t){let e;return(e=/^(https?:)\/\/github\.com\/([^\/]+\/[^\/]+)\/(blob\/|tree\/|raw\/)?(.*)$/.exec(t))?t=`${e[1]}//raw.githubusercontent.com/${e[2]}/${e[3]?"":"master/"}${e[4]}`:(e=/^(https?:)\/\/www\.aozora\.gr\.jp\/(cards\/[^\/]+\/files\/[^\/.]+\.html)$/.exec(t))?t=`${e[1]}//raw.githubusercontent.com/aozorabunko/aozorabunko/master/${e[2]}`:(e=/^(https?:)\/\/gist\.github\.com\/([^\/]+\/\w+)(\/|$)(raw(\/|$))?(.*)$/.exec(t))?t=`${e[1]}//gist.githubusercontent.com/${e[2]}/raw/${e[6]}`:(e=/^(https?:)\/\/(?:[^\/.]+\.)?jsbin\.com\/(?!(?:blog|help)\b)(\w+)((\/\d+)?).*$/.exec(t))&&(t=`${e[1]}//output.jsbin.com/${e[2]}${e[3]}/`),t}var f;function p(t){return null==t?t:t.toString()}!function(t){t.FB2="http://www.gribuser.ru/xml/fictionbook/2.0",t.epub="http://www.idpf.org/2007/ops",t.EV="http://www.w3.org/2001/xml-events",t.MATHML="http://www.w3.org/1998/Math/MathML",t.XML="http://www.w3.org/XML/1998/namespace",t.XHTML="http://www.w3.org/1999/xhtml",t.XLINK="http://www.w3.org/1999/xlink",t.SHADOW="http://www.pyroxy.com/ns/shadow",t.SVG="http://www.w3.org/2000/svg",t.DC="http://purl.org/dc/elements/1.1/",t.NCX="http://www.daisy.org/z3986/2005/ncx/",t.SSE="http://example.com/sse"}(f||(f={}));class g{constructor(){this.queue=[null]}length(){return this.queue.length-1}add(t){let e=this.queue.length;for(;e>1;){const n=Math.floor(e/2),i=this.queue[n];if(i.compare(t)>0)return void(this.queue[e]=t);this.queue[e]=i,e=n}this.queue[1]=t}peek(){return this.queue[1]}remove(){const t=this.queue[1],e=this.queue.pop(),n=this.queue.length;if(n>1){let t=1;for(;;){let i=2*t;if(i>=n)break;if(this.queue[i].compare(e)>0)i+1<n&&this.queue[i+1].compare(this.queue[i])>0&&i++;else{if(!(i+1<n&&this.queue[i+1].compare(e)>0))break;i++}this.queue[t]=this.queue[i],t=i}this.queue[t]=e}return t}}const m=["","-webkit-","-moz-","-ms-","-o-","-epub-"],b={};function E(t,e){if("writing-mode"===e){const n=document.createElement("span");return"-ms-"===t?(n.style.setProperty(t+e,"tb-rl"),"tb-rl"===n.style["writing-mode"]):(n.style.setProperty(t+e,"vertical-rl"),"vertical-rl"===n.style[t+e])}return"string"==typeof document.documentElement.style[function(t,e){return t&&(e=`-${e}`,"moz"===(t=t.replace(/-/g,""))&&(t="Moz")),t+e.replace(/-[a-z]/g,t=>t.substr(1).toUpperCase())}(t,e)]}function w(t){let e=b[t];if(e||null===e)return e;switch(t){case"text-combine-upright":if(E("-webkit-","text-combine")&&!E("","text-combine-upright"))return b[t]=["-webkit-text-combine"],["-webkit-text-combine"];break;case"writing-mode":if(E("-ms-","writing-mode"))return b[t]=["-ms-writing-mode"],["-ms-writing-mode"];break;case"filter":if(E("-webkit-","filter"))return b[t]=["-webkit-filter"],["-webkit-filter"];break;case"clip-path":if(E("-webkit-","clip-path"))return b[t]=["-webkit-clip-path","clip-path"];break;case"margin-inline-start":if(E("-webkit-","margin-start"))return b[t]=["-webkit-margin-start"],["-webkit-margin-start"];break;case"margin-inline-end":if(E("-webkit-","margin-end"))return b[t]=["-webkit-margin-end"],["-webkit-margin-end"];break;case"padding-inline-start":if(E("-webkit-","padding-start"))return b[t]=["-webkit-padding-start"],["-webkit-padding-start"];break;case"padding-inline-end":if(E("-webkit-","padding-end"))return b[t]=["-webkit-padding-end"],["-webkit-padding-end"]}for(const n of m)if(E(n,t))return e=n+t,b[t]=[e],[e];return i.b.warn("Property not supported by the browser: ",t),b[t]=null,null}function v(t,e,n){try{const s=w(e);if(!s)return;s.forEach(e=>{if("-ms-writing-mode"===e)switch(n){case"horizontal-tb":n="lr-tb";break;case"vertical-rl":n="tb-rl";break;case"vertical-lr":n="tb-lr"}else if("-webkit-text-combine"===e)switch(n){case"all":n="horizontal"}t&&t.style&&t.style.setProperty(e,n)})}catch(t){i.b.warn(t)}}function y(t,e,n){try{const n=b[e];return t.style.getPropertyValue(n?n[0]:e)}catch(t){}return n||""}function T(t){let e=t.getAttributeNS(f.XML,"lang");return e||t.namespaceURI!=f.XHTML||(e=t.getAttribute("lang")),e}class N{constructor(){this.list=[]}append(t){return this.list.push(t),this}clear(){this.list=[]}toString(){const t=this.list.join("");return this.list=[t],t}}function S(t){return`\\${t.charCodeAt(0).toString(16)} `}function x(t){return t.replace(/[^-_a-zA-Z0-9\u0080-\uFFFF]/g,S)}function I(t){return t.replace(/[\u0000-\u001F"\\]/g,S)}function C(t){return t.replace(/[\s+&?=#\u007F-\uFFFF]+/g,encodeURIComponent)}function O(t){return!!t.match(/^[a-zA-Z\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u024F\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]$/)}function _(t,e){return t.replace(/[^-a-zA-Z0-9_]/g,function(t){return function(t,e){return(e="string"==typeof e?e:"\\u")+(65536|t.charCodeAt(0)).toString(16).substr(1)}(t,e)})}function A(t){return _(t)}function k(t,e){e="string"==typeof e?e:"\\u";const n=new RegExp(`${A(e)}[0-9a-fA-F]{4}`,"g");return t.replace(n,function(t){return function(t,e){return e="string"==typeof e?e:"\\u",0===t.indexOf(e)?String.fromCharCode(parseInt(t.substring(e.length),16)):t}(t,e)})}function D(t,e){let n=0,i=t;for(;;){if(n==i)return n;const t=n+i>>1;e(t)?i=t:n=t+1}}function L(t,e){return t-e}const R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function P(t,e){const n=e.length,i=3*Math.floor(n/3);for(let n=0;n<i;n+=3){const i=255&e.charCodeAt(n),s=255&e.charCodeAt(n+1),r=255&e.charCodeAt(n+2);t.append(R.charAt(i>>2)),t.append(R.charAt(63&(i<<4|s>>4))),t.append(R.charAt(63&(s<<2|r>>6))),t.append(R.charAt(63&r))}switch(n-i){case 1:{const n=255&e.charCodeAt(i);t.append(R.charAt(n>>2)),t.append(R.charAt(n<<4&63)),t.append("==");break}case 2:{const n=255&e.charCodeAt(i),s=255&e.charCodeAt(i+1);t.append(R.charAt(n>>2)),t.append(R.charAt(63&(n<<4|s>>4))),t.append(R.charAt(s<<2&63)),t.append("=");break}}}function F(t,e){const n={};for(const i of t){const t=e(i);t&&!n[t]&&(n[t]=i)}return n}function M(t){const e={};for(let n=0;n<t.length;n++)e[t[n]]=!0;return e}function U(t,e){const n={};for(const i of t){const t=e(i);t&&(n[t]?n[t].push(i):n[t]=[i])}return n}function z(t,e){const n={};for(const i in t)n[i]=e(t[i],i);return n}class B{constructor(){this.listeners={}}dispatchEvent(t){const e=this.listeners[t.type];if(e){t.target=this,t.currentTarget=this;for(let n=0;n<e.length;n++)e[n](t)}}addEventListener(t,e,n){if(n)return;const i=this.listeners[t];i?i.push(e):this.listeners[t]=[e]}removeEventListener(t,e,n){if(n)return;const i=this.listeners[t];if(i){const t=i.indexOf(e);t>=0&&i.splice(t,1)}}}let H=null;function $(t){if(null==H){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="100px",n.style.height="100px",n.style.overflow="hidden",n.style.lineHeight="16px",n.style.fontSize="16px",v(n,"writing-mode","vertical-rl"),t.appendChild(n);const i=e.createTextNode("a a a a a a a a a a a a a a a a");n.appendChild(i);const s=e.createRange();s.setStart(i,0),s.setEnd(i,1);const r=s.getBoundingClientRect();H=r.right-r.left<10,t.removeChild(n)}return H}let V=null;function G(t){if(null===V){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="30px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a | ");n.appendChild(i);const s=e.createElement("span");s.style.display="inline-block",s.style.width="30px",n.appendChild(s);const r=e.createRange();r.setStart(i,0),r.setEnd(i,3);const o=r.getBoundingClientRect();V=o.right<27,t.removeChild(n)}return V}let j=null;function X(t){if(null===j){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a a-");n.appendChild(i);const s=e.createElement("span");s.style.display="inline-block",s.style.width="40px",n.appendChild(s);const r=e.createRange();r.setStart(i,2),r.setEnd(i,4);const o=r.getBoundingClientRect();j=o.right<37,t.removeChild(n)}return j}let Y=null;function K(t){if(null===Y){const e=t.ownerDocument,n=e.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.width="40px",n.style.height="100px",n.style.lineHeight="16px",n.style.fontSize="16px",n.style.textAlign="justify",t.appendChild(n);const i=e.createTextNode("a a-");n.appendChild(i),n.appendChild(e.createElement("wbr"));const s=e.createElement("span");s.style.display="inline-block",s.style.width="40px",n.appendChild(s);const r=e.createRange();r.setStart(i,2),r.setEnd(i,4);const o=r.getBoundingClientRect();Y=o.right<37,t.removeChild(n)}return Y}},function(t,e,n){"use strict";function i(t){if((t=t.substr(1)).match(/^[^0-9a-fA-F\n\r]$/))return t;const e=parseInt(t,16);return isNaN(e)?"":e<=65535?String.fromCharCode(e):e<=1114111?String.fromCharCode(55296|e>>10&1023,56320|1023&e):"�"}function s(t){return t.replace(/\\([0-9a-fA-F]{0,6}(\r\n|[ \n\r\t\f])?|[^0-9a-fA-F\n\r])/g,i)}var r,o;n.d(e,"a",function(){return r}),n.d(e,"b",function(){return U}),function(t){t[t.EOF=0]="EOF",t[t.IDENT=1]="IDENT",t[t.STR=2]="STR",t[t.NUMERIC=3]="NUMERIC",t[t.NUM=4]="NUM",t[t.INT=5]="INT",t[t.FUNC=6]="FUNC",t[t.HASH=7]="HASH",t[t.URL=8]="URL",t[t.CLASS=9]="CLASS",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.O_BRC=12]="O_BRC",t[t.C_BRC=13]="C_BRC",t[t.O_BRK=14]="O_BRK",t[t.C_BRK=15]="C_BRK",t[t.COMMA=16]="COMMA",t[t.SEMICOL=17]="SEMICOL",t[t.COLON=18]="COLON",t[t.SLASH=19]="SLASH",t[t.AT=20]="AT",t[t.PERCENT=21]="PERCENT",t[t.QMARK=22]="QMARK",t[t.PLUS=23]="PLUS",t[t.MINUS=24]="MINUS",t[t.BAR_BAR=25]="BAR_BAR",t[t.AMP_AMP=26]="AMP_AMP",t[t.BANG=31]="BANG",t[t.DOLLAR=32]="DOLLAR",t[t.HAT=33]="HAT",t[t.BAR=34]="BAR",t[t.TILDE=35]="TILDE",t[t.STAR=36]="STAR",t[t.GT=37]="GT",t[t.LT=38]="LT",t[t.EQ=39]="EQ",t[t.BANG_EQ=41]="BANG_EQ",t[t.DOLLAR_EQ=42]="DOLLAR_EQ",t[t.HAT_EQ=43]="HAT_EQ",t[t.BAR_EQ=44]="BAR_EQ",t[t.TILDE_EQ=45]="TILDE_EQ",t[t.STAR_EQ=46]="STAR_EQ",t[t.GT_EQ=47]="GT_EQ",t[t.LT_EQ=48]="LT_EQ",t[t.EQ_EQ=49]="EQ_EQ",t[t.COL_COL=50]="COL_COL",t[t.INVALID=51]="INVALID",t[t.LAST=51]="LAST"}(r||(r={}));class a{constructor(){this.ut=!1,this.num=0,this.text="",this.position=0,this.type=r.EOF}}function l(t,e){const n=Array(128);let i;for(i=0;i<128;i++)n[i]=t;for(n.NaN=t==o.END?o.END:o.INVALID,i=0;i<e.length;i+=2)n[e[i]]=e[i+1];return n}!function(t){t[t.SPACE=1]="SPACE",t[t.INT=2]="INT",t[t.IDENT=3]="IDENT",t[t.BANG=4]="BANG",t[t.HASH=6]="HASH",t[t.DOLLAR=7]="DOLLAR",t[t.PERCENT=8]="PERCENT",t[t.AMP=9]="AMP",t[t.O_PAR=10]="O_PAR",t[t.C_PAR=11]="C_PAR",t[t.STAR=12]="STAR",t[t.PLUS=13]="PLUS",t[t.COMMA=14]="COMMA",t[t.MINUS=15]="MINUS",t[t.DOT=16]="DOT",t[t.SLASH=17]="SLASH",t[t.COLON=18]="COLON",t[t.SEMICOL=19]="SEMICOL",t[t.LT=20]="LT",t[t.EQ=21]="EQ",t[t.GT=22]="GT",t[t.QMARK=23]="QMARK",t[t.AT=24]="AT",t[t.O_BRK=25]="O_BRK",t[t.C_BRK=26]="C_BRK",t[t.O_BRC=27]="O_BRC",t[t.C_BRC=28]="C_BRC",t[t.BSLASH=29]="BSLASH",t[t.HAT=30]="HAT",t[t.BAR=31]="BAR",t[t.TILDE=32]="TILDE",t[t.STR1=33]="STR1",t[t.STR2=34]="STR2",t[t.END=35]="END",t[t.EQTAIL=36]="EQTAIL",t[t.ENDINT=37]="ENDINT",t[t.ENDNUM=38]="ENDNUM",t[t.CONT=39]="CONT",t[t.UNIT=40]="UNIT",t[t.PCUNIT=41]="PCUNIT",t[t.NUMBER=42]="NUMBER",t[t.ENDIDNT=43]="ENDIDNT",t[t.IDNTESC=44]="IDNTESC",t[t.ENDIDES=45]="ENDIDES",t[t.ENDSTR=46]="ENDSTR",t[t.ENDESTR=47]="ENDESTR",t[t.STR1ESC=48]="STR1ESC",t[t.STR2ESC=49]="STR2ESC",t[t.BAR_BAR=50]="BAR_BAR",t[t.AMP_AMP=51]="AMP_AMP",t[t.FUNC=52]="FUNC",t[t.FUNCES=53]="FUNCES",t[t.COMMENT=54]="COMMENT",t[t.COMMST=55]="COMMST",t[t.ENDNOTK=56]="ENDNOTK",t[t.MINMIN=57]="MINMIN",t[t.TOINT=58]="TOINT",t[t.TONUM=59]="TONUM",t[t.TOIDENT=60]="TOIDENT",t[t.TOIDES=61]="TOIDES",t[t.KILL1=62]="KILL1",t[t.KILL2=63]="KILL2",t[t.URL=64]="URL",t[t.URL1=65]="URL1",t[t.URL2=66]="URL2",t[t.ENDURL=67]="ENDURL",t[t.TERMURL=68]="TERMURL",t[t.FINURL=69]="FINURL",t[t.LT_BG=70]="LT_BG",t[t.LT_BG_M=71]="LT_BG_M",t[t.INVALID=72]="INVALID",t[t.CHKPOSS=73]="CHKPOSS",t[t.CHKPOSN=74]="CHKPOSN",t[t.URLESC=75]="URLESC",t[t.IDESCH=76]="IDESCH",t[t.COL_COL=77]="COL_COL",t[t.TOCLASS=78]="TOCLASS",t[t.CHKSP=79]="CHKSP",t[t.EOF=80]="EOF"}(o||(o={}));const h=[o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.SPACE,o.SPACE,o.INVALID,o.SPACE,o.SPACE,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.SPACE,o.BANG,o.STR2,o.HASH,o.DOLLAR,o.PERCENT,o.AMP,o.STR1,o.O_PAR,o.C_PAR,o.STAR,o.PLUS,o.COMMA,o.MINUS,o.DOT,o.SLASH,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.INT,o.COLON,o.SEMICOL,o.LT,o.EQ,o.GT,o.QMARK,o.AT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.O_BRK,o.BSLASH,o.C_BRK,o.HAT,o.IDENT,o.INVALID,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.IDENT,o.O_BRC,o.BAR,o.C_BRC,o.TILDE,o.INVALID];h.NaN=o.EOF;const c=[o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.FUNC,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.IDNTESC,o.ENDIDNT,o.ENDIDNT,o.CONT,o.ENDIDNT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT,o.ENDIDNT];c.NaN=o.ENDIDNT;const u=[o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.TOCLASS,o.TONUM,o.INVALID,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.TONUM,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.INVALID,o.TOIDES,o.INVALID,o.INVALID,o.TOCLASS,o.INVALID,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.TOCLASS,o.INVALID,o.INVALID,o.INVALID,o.INVALID,o.INVALID];c.NaN=o.ENDIDNT;const d=[o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.MINMIN,o.TONUM,o.END,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.TOINT,o.END,o.END,o.END,o.END,o.END,o.END,o.END,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.END,o.TOIDES,o.END,o.END,o.TOIDENT,o.END,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.TOIDENT,o.END,o.END,o.END,o.END,o.END];d.NaN=o.END;const f=[o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CHKPOSS,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CHKPOSS,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.FUNCES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.IDNTESC,o.ENDIDES,o.ENDIDES,o.CONT,o.ENDIDES,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES,o.ENDIDES];f.NaN=o.ENDIDES;const p=[o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.PCUNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.NUMBER,o.ENDINT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.UNIT,o.ENDINT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT,o.ENDINT];p.NaN=o.ENDINT;const g=[o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.PCUNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.CONT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.UNIT,o.ENDNUM,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.UNIT,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM,o.ENDNUM];g.NaN=o.ENDNUM;const m=l(o.END,[61,o.EQTAIL]),b=l(o.END,[58,o.COL_COL]),E=l(o.END,[61,o.EQTAIL,124,o.BAR_BAR]),w=l(o.END,[38,o.AMP_AMP]),v=l(o.END,[42,o.COMMENT]),y=l(o.CONT,[42,o.COMMST]),T=l(o.COMMENT,[42,o.COMMST,47,o.ENDNOTK]),N=l(o.KILL1,[62,o.ENDNOTK]),S=l(o.END,[61,o.EQTAIL,33,o.LT_BG]),x=l(o.KILL1,[45,o.LT_BG_M]),I=l(o.KILL2,[45,o.ENDNOTK]),C=l(o.IDESCH,[9,o.INVALID,10,o.INVALID,13,o.INVALID,32,o.INVALID]),O=l(o.CONT,[39,o.ENDSTR,10,o.INVALID,13,o.INVALID,92,o.STR1ESC]),_=l(o.CONT,[34,o.ENDSTR,10,o.INVALID,13,o.INVALID,92,o.STR2ESC]),A=l(o.CONT,[39,o.ENDESTR,10,o.CHKPOSN,13,o.CHKPOSN,92,o.STR1ESC]),k=l(o.CONT,[34,o.ENDESTR,10,o.CHKPOSN,13,o.CHKPOSN,92,o.STR2ESC]),D=l(o.URL,[9,o.CONT,32,o.CONT,34,o.URL2,39,o.URL1,41,o.INVALID,10,o.CONT,13,o.CONT]),L=l(o.CONT,[41,o.ENDURL,9,o.CHKSP,10,o.CHKSP,13,o.CHKSP,32,o.CHKSP,92,o.URLESC,40,o.INVALID,91,o.INVALID,93,o.INVALID,123,o.INVALID,125,o.INVALID,NaN,o.ENDURL]),R=l(o.CONT,[39,o.TERMURL,10,o.CHKPOSN,13,o.CHKPOSN,92,o.URLESC,NaN,o.ENDURL]),P=l(o.CONT,[34,o.TERMURL,10,o.CHKPOSN,13,o.CHKPOSN,92,o.URLESC,NaN,o.ENDURL]),F=l(o.INVALID,[9,o.CONT,10,o.CONT,13,o.CONT,32,o.CONT,41,o.FINURL]),M=15;class U{constructor(t,e){this.input=t,this.handler=e,this.head=-1,this.tail=0,this.curr=0,this.position=0,this.ft=M,this.buffer=Array(this.ft+1);for(let t=0;t<=this.ft;t++)this.buffer[t]=new a}token(){return this.tail==this.curr&&this.dt(),this.buffer[this.curr]}gt(t){return(this.tail-this.curr&this.ft)<=t&&this.dt(),this.buffer[this.curr+t&this.ft]}consume(){this.curr=this.curr+1&this.ft}mark(){if(this.head>=0)throw new Error("F_CSSTOK_BAD_CALL mark");this.head=this.curr}reset(){if(this.head<0)throw new Error("F_CSSTOK_BAD_CALL reset");this.curr=this.head,this.head=-1}unmark(){this.head=-1}bt(){return this.head>=0}reallocate(){const t=2*(this.ft+1)-1,e=Array(t+1);let n=this.head,i=0;for(;n!=this.tail;)e[i]=this.buffer[n],n==this.curr&&(this.curr=i),n=n+1&this.ft,i++;for(this.head=0,this.tail=i,this.ft=t,this.buffer=e;i<=t;)e[i++]=new a}error(t,e,n){this.handler&&this.handler.error(n,e)}dt(){let t=this.tail,e=this.head>=0?this.head:this.curr,n=this.ft;if(t>=e?e+=n:e--,e==t){if(this.head<0)throw new Error("F_CSSTOK_INTERNAL");this.reallocate(),t=this.tail,e=n=this.ft}let i=h;const a=this.input;let l=this.position;const M=this.buffer;let U=r.EOF,z=0,B="",H=0,$=!1,V=M[t],G=-9;for(;;){const j=a.charCodeAt(l);switch(i[j]||i[65]){case o.INVALID:U=r.INVALID,B=isNaN(j)?"E_CSS_UNEXPECTED_EOF":"E_CSS_UNEXPECTED_CHAR",i=h,l++;break;case o.SPACE:l++,$=!0;continue;case o.INT:z=l++,i=p;continue;case o.IDENT:U=r.IDENT,z=l++,i=c;continue;case o.BANG:z=l++,U=r.BANG,i=m;continue;case o.STR1:U=r.STR,z=++l,i=O;continue;case o.STR2:U=r.STR,z=++l,i=_;continue;case o.HASH:z=++l,U=r.HASH,i=c;continue;case o.DOLLAR:z=l++,U=r.DOLLAR,i=m;continue;case o.PERCENT:z=l++,U=r.PERCENT;break;case o.AMP:z=l++,U=r.DOLLAR,i=w;continue;case o.O_PAR:z=l++,U=r.O_PAR;break;case o.C_PAR:z=l++,U=r.C_PAR;break;case o.STAR:z=l++,U=r.STAR,i=m;continue;case o.PLUS:z=l++,U=r.PLUS;break;case o.COMMA:z=l++,U=r.COMMA;break;case o.MINUS:U=r.MINUS,z=l++,i=d;continue;case o.DOT:z=l++,i=u;continue;case o.TOCLASS:z=l++,U=r.CLASS,i=c;continue;case o.SLASH:z=l++,U=r.SLASH,i=v;continue;case o.COLON:z=l++,U=r.COLON,i=b;continue;case o.COL_COL:l++,U=r.COL_COL;break;case o.SEMICOL:z=l++,U=r.SEMICOL;break;case o.LT:z=l++,U=r.LT,i=S;continue;case o.EQ:z=l++,U=r.EQ,i=m;continue;case o.GT:z=l++,U=r.GT,i=m;continue;case o.QMARK:z=l++,U=r.QMARK;break;case o.AT:z=++l,U=r.AT,i=c;continue;case o.O_BRK:z=l++,U=r.O_BRK;break;case o.C_BRK:z=l++,U=r.C_BRK;break;case o.O_BRC:z=l++,U=r.O_BRC;break;case o.C_BRC:z=l++,U=r.C_BRC;break;case o.BSLASH:G=z=l++,U=r.IDENT,i=C;continue;case o.HAT:z=l++,U=r.HAT,i=m;continue;case o.BAR:z=l++,U=r.BAR,i=E;continue;case o.TILDE:z=l++,U=r.TILDE,i=m;continue;case o.END:break;case o.EQTAIL:l++,U=U+r.BANG_EQ-r.BANG;break;case o.ENDINT:U=r.INT,H=parseInt(a.substring(z,l),10);break;case o.ENDNUM:U=r.NUM,H=parseFloat(a.substring(z,l));break;case o.CONT:l++;continue;case o.UNIT:U=r.NUMERIC,H=parseFloat(a.substring(z,l)),z=l++,i=c;continue;case o.PCUNIT:U=r.NUMERIC,H=parseFloat(a.substring(z,l)),B="%",z=l++;break;case o.NUMBER:l++,i=g;continue;case o.ENDIDNT:B=a.substring(z,l);break;case o.IDNTESC:G=l++,i=C;continue;case o.ENDIDES:B=s(a.substring(z,l));break;case o.ENDSTR:B=a.substring(z,l),l++;break;case o.ENDESTR:B=s(a.substring(z,l)),l++;break;case o.STR1ESC:G=l,l+=2,i=A;continue;case o.STR2ESC:G=l,l+=2,i=k;continue;case o.BAR_BAR:l++,U=r.BAR_BAR;break;case o.AMP_AMP:l++,U=r.AMP_AMP;break;case o.FUNC:if(B=a.substring(z,l),U==r.IDENT){if(l++,"url"==B.toLowerCase()){i=D;continue}U=r.FUNC}break;case o.FUNCES:if(B=s(a.substring(z,l)),U==r.IDENT){if(l++,"url"==B.toLowerCase()){i=D;continue}U=r.FUNC}break;case o.COMMENT:i=y,l++;continue;case o.COMMST:i=T,l++;continue;case o.ENDNOTK:i=h,l++;continue;case o.MINMIN:i=N,l++;continue;case o.TOINT:U=r.INT,i=p,l++;continue;case o.TONUM:U=r.NUM,i=g,l++;continue;case o.TOIDENT:U=r.IDENT,i=c,l++;continue;case o.TOIDES:U=r.IDENT,i=C,G=l++;continue;case o.KILL1:l--;break;case o.KILL2:l-=2;break;case o.URL:z=l++,i=L;continue;case o.URL1:z=++l,i=R;continue;case o.URL2:z=++l,i=P;continue;case o.ENDURL:U=r.URL,B=s(a.substring(z,l)),l++;break;case o.FINURL:l++;break;case o.LT_BG:i=x,l++;continue;case o.LT_BG_M:i=I,l++;continue;case o.CHKSP:if(l-G<8&&a.substring(G+1,l+1).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])|[ \t]$/)){l++;continue}case o.TERMURL:U=r.URL,B=s(a.substring(z,l)),l++,i=F;continue;case o.CHKPOSN:if(++l-G<9&&a.substring(G+1,l).match(/^[0-9a-fA-F]{0,6}(\r\n|[\n\r])$/))continue;U=r.INVALID,B="E_CSS_UNEXPECTED_NEWLINE",i=h;break;case o.CHKPOSS:if(l-G<9&&a.substring(G+1,l+1).match(/^[0-9a-fA-F]{0,6}[ \t]$/)){l++;continue}B=s(a.substring(z,l));break;case o.URLESC:G=l++;continue;case o.IDESCH:l++,i=f;continue;default:if(i!==h){U=r.INVALID,B="E_CSS_UNEXPECTED_STATE";break}z=l,U=r.EOF}if(V.type=U,V.ut=$,V.num=H,V.text=B,V.position=z,++t>=e)break;i=h,$=!1,V=M[t&n]}this.position=l,this.tail=t&n}}},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return h}),n.d(e,"b",function(){return c}),n.d(e,"e",function(){return u});var i=n(1),s=n(6);let r=null,o=null;function a(){return r}function l(t){if(!r)throw new Error("E_TASK_NO_CONTEXT");r.name||(r.name=t);const e=r,n=new w(e,e.top,t);return e.top=n,n.state=d.ACTIVE,n}function h(t){return new b(t)}function c(t,e,n){const i=l(t);i.handler=n;try{e(i)}catch(t){i.task.raise(t,i)}return i.result()}function u(t,e){return(r?r.wt():o||new p(new f)).run(t,e)}var d;!function(t){t[t.INIT=0]="INIT",t[t.ACTIVE=1]="ACTIVE",t[t.FINISHED=2]="FINISHED",t[t.DEAD=3]="DEAD"}(d||(d={}));class f{currentTime(){return(new Date).valueOf()}setTimeout(t,e){return setTimeout(t,e)}clearTimeout(t){clearTimeout(t)}}class p{constructor(t){this.timer=t,this.timeout=1,this.slice=25,this.Et=0,this.xt=null,this.yt=null,this.kt=!1,this.order=0,this.queue=new i.b,o||(o=this)}St(t){this.slice=t}setTimeout(t){this.timeout=t}vt(){return this.timer.currentTime()>=this.Et}arm(){if(this.kt)return;const t=this.queue.peek().Tt,e=this.timer.currentTime();if(null!=this.yt){if(e+this.timeout>this.xt)return;this.timer.clearTimeout(this.yt)}let n=t-e;n<=this.timeout&&(n=this.timeout),this.xt=e+n;const i=this;this.yt=this.timer.setTimeout(()=>{i.yt=null,i.Nt()},n)}schedule(t,e){const n=t,i=this.timer.currentTime();n.order=this.order++,n.Tt=i+(e||0),this.queue.add(n),this.arm()}Nt(){null!=this.yt&&(this.timer.clearTimeout(this.yt),this.yt=null),this.kt=!0;try{let t=this.timer.currentTime();for(this.Et=t+this.slice;this.queue.length();){const e=this.queue.peek();if(e.Tt>t)break;if(this.queue.remove(),e.canceled||e.Ct(),(t=this.timer.currentTime())>=this.Et)break}}catch(t){s.b.error(t)}this.kt=!1,this.queue.length()&&this.arm()}run(t,e){const n=new m(this,e||"");n.top=new w(n,null,"bootstrap"),n.top.state=d.ACTIVE,n.top.then(()=>{const e=()=>{n.running=!1;for(const t of n.callbacks)try{t()}catch(t){s.b.error(t)}};try{t().then(t=>{n.result=t,e()})}catch(t){n.raise(t),e()}});const i=r;return r=n,this.schedule(n.top.suspend("bootstrap")),r=i,n}}class g{constructor(t){this.task=t,this.Tt=0,this.order=0,this.result=null,this.canceled=!1}compare(t){const e=t;return e.Tt-this.Tt||e.order-this.order}Pt(){return this.task}schedule(t,e){this.result=t,this.task.scheduler.schedule(this,e)}Ct(){const t=this.task;if(this.task=null,t&&t.continuation==this){t.continuation=null;const e=r;return r=t,t.top.finish(this.result),r=e,!0}return!1}cancel(){this.canceled=!0}}class m{constructor(t,e){this.scheduler=t,this.name=e,this.callbacks=[],this.exception=null,this.running=!0,this.result=null,this.Rt=null,this.top=null,this.continuation=null}_t(){return this.name}interrupt(t){if(this.raise(t||new Error("E_TASK_INTERRUPT")),this!==r&&this.continuation){this.continuation.cancel();const t=new g(this);this.Rt="interrupt",this.continuation=t,this.scheduler.schedule(t)}}wt(){return this.scheduler}At(){return this.running}It(t){this.callbacks.push(t)}join(){const t=l("Task.join");if(this.running){const e=t.suspend(this),n=this;this.It(()=>{e.schedule(n.result)})}else t.finish(this.result);return t.result()}unwind(){for(;this.top&&!this.top.handler;)this.top=this.top.parent;if(this.top&&this.top.handler&&this.exception){const t=this.exception;this.exception=null,this.top.handler(this.top,t)}else this.exception&&s.b.error(this.exception,"Unhandled exception in task",this.name)}raise(t,e){if(this.Ft(t),e){let t=this.top;for(;t&&t!=e;)t=t.parent;t==e&&(this.top=t)}this.exception=t,this.unwind()}Ft(t){let e=t.frameTrace;if(!e){e=t.stack?`${t.stack}\n\t---- async ---\n`:"";for(let t=this.top;t;t=t.parent)e+="\t",e+=t._t(),e+="\n";t.frameTrace=e}}}class b{constructor(t){this.value=t}then(t){t(this.value)}Ot(t){return t(this.value)}Lt(t){return new b(t)}Mt(t){t.finish(this.value)}Dt(){return!1}get(){return this.value}}class E{constructor(t){this.frame=t}then(t){this.frame.then(t)}Ot(t){if(this.Dt()){const e=new w(this.frame.task,this.frame.parent,"AsyncResult.thenAsync");return e.state=d.ACTIVE,this.frame.parent=e,this.frame.then(n=>{t(n).then(t=>{e.finish(t)})}),e.result()}return t(this.frame.res)}Lt(t){return this.Dt()?this.Ot(()=>new b(t)):new b(t)}Mt(t){this.Dt()?this.then(e=>{t.finish(e)}):t.finish(this.frame.res)}Dt(){return this.frame.state==d.ACTIVE}get(){if(this.Dt())throw new Error("Result is pending");return this.frame.res}}class w{constructor(t,e,n){this.task=t,this.parent=e,this.name=n,this.res=null,this.callback=null,this.handler=null,this.state=d.INIT}$t(){if(!r)throw new Error("F_TASK_NO_CONTEXT");if(this!==r.top)throw new Error("F_TASK_NOT_TOP_FRAME")}result(){return new E(this)}finish(t){this.$t(),r&&!r.exception&&(this.res=t),this.state=d.FINISHED;const e=this.parent;if(r&&(r.top=e),this.callback){try{this.callback(t)}catch(t){this.task.raise(t,e)}this.state=d.DEAD}}Pt(){return this.task}_t(){return this.name}wt(){return this.task.scheduler}then(t){switch(this.state){case d.ACTIVE:if(this.callback)throw new Error("F_TASK_FRAME_ALREADY_HAS_CALLBACK");this.callback=t;break;case d.FINISHED:{const e=this.task,n=this.parent;try{t(this.res),this.state=d.DEAD}catch(t){this.state=d.DEAD,e.raise(t,n)}break}case d.DEAD:throw new Error("F_TASK_DEAD_FRAME");default:throw new Error(`F_TASK_UNEXPECTED_FRAME_STATE ${this.state}`)}}Bt(){const t=l("Frame.timeSlice");return t.wt().vt()?(s.b.debug("-- time slice --"),t.suspend().schedule(!0)):t.finish(!0),t.result()}sleep(t){const e=l("Frame.sleep");return e.suspend().schedule(!0,t),e.result()}loop(t){const e=l("Frame.loop"),n=i=>{try{for(;i;){const e=t();if(e.Dt())return void e.then(n);e.then(t=>{i=t})}e.finish(!0)}catch(t){e.task.raise(t,e)}};return n(!0),e.result()}Ut(t){const e=r;if(!e)throw new Error("E_TASK_NO_CONTEXT");return this.loop(()=>{let n;do{const i=new v(e,e.top);e.top=i,i.state=d.ACTIVE,t(i),n=i.result()}while(!n.Dt()&&n.get());return n})}suspend(t){if(this.$t(),this.task.continuation)throw new Error("E_TASK_ALREADY_SUSPENDED");const e=new g(this.task);return this.task.continuation=e,r=null,this.task.Rt=t||null,e}}class v extends w{constructor(t,e){super(t,e,"loop")}Gt(){this.finish(!0)}zt(){this.finish(!1)}}},function(t,e,n){"use strict";n.d(e,"F",function(){return s}),n.d(e,"E",function(){return r}),n.d(e,"L",function(){return l}),n.d(e,"M",function(){return u}),n.d(e,"m",function(){return f}),n.d(e,"I",function(){return p}),n.d(e,"K",function(){return g}),n.d(e,"J",function(){return m}),n.d(e,"G",function(){return b}),n.d(e,"O",function(){return E}),n.d(e,"g",function(){return w}),n.d(e,"w",function(){return C}),n.d(e,"v",function(){return O}),n.d(e,"b",function(){return _}),n.d(e,"c",function(){return A}),n.d(e,"y",function(){return k}),n.d(e,"z",function(){return D}),n.d(e,"n",function(){return L}),n.d(e,"l",function(){return R}),n.d(e,"k",function(){return P}),n.d(e,"j",function(){return F}),n.d(e,"i",function(){return M}),n.d(e,"u",function(){return U}),n.d(e,"a",function(){return z}),n.d(e,"B",function(){return B}),n.d(e,"r",function(){return H}),n.d(e,"h",function(){return $}),n.d(e,"q",function(){return V}),n.d(e,"x",function(){return G}),n.d(e,"s",function(){return j}),n.d(e,"o",function(){return X}),n.d(e,"t",function(){return Y}),n.d(e,"d",function(){return K}),n.d(e,"e",function(){return W}),n.d(e,"f",function(){return Z}),n.d(e,"p",function(){return q}),n.d(e,"A",function(){return Q}),n.d(e,"D",function(){return J}),n.d(e,"C",function(){return tt}),n.d(e,"P",function(){return et}),n.d(e,"N",function(){return nt}),n.d(e,"H",function(){return it});var i=n(1);function s(){return{fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,Ht:!1,pageBorder:1,Vt:{vivliostyle:!0,print:!0},defaultPaperSize:void 0}}function r(t){return{fontFamily:t.fontFamily,lineHeight:t.lineHeight,margin:t.margin,hyphenate:t.hyphenate,columnWidth:t.columnWidth,horizontal:t.horizontal,nightMode:t.nightMode,Ht:t.Ht,pageBorder:t.pageBorder,Vt:Object.assign({},t.Vt),defaultPaperSize:t.defaultPaperSize?Object.assign({},t.defaultPaperSize):void 0}}const o={fontFamily:"serif",lineHeight:1.25,margin:8,hyphenate:!1,columnWidth:25,horizontal:!1,nightMode:!1,Ht:!1,pageBorder:1,Vt:{vivliostyle:!0,print:!0},defaultPaperSize:void 0},a={PENDING:{}};function l(t,e,n,i){const s=Math.min((t-0)/n,(e-0)/i);return`matrix(${s},0,0,${s},0,0)`}function h(t){return`"${i.q(`${t}`)}"`}function c(t){return i.p(`${t}`)}function u(t,e){return t?`${i.p(t)}.${i.p(e)}`:i.p(e)}let d=0;class f{constructor(t,e){if(this.parent=t,this.resolver=e,this.children=[],this.values={},this.funcs={},this.jt={},this.Xt=`S${d++}`,this.zero=new Z(this,0),this.one=new Z(this,1),this._true=new Z(this,!0),this._false=new Z(this,!1),t&&t.children.push(this),!t){const t=this.jt;t.floor=Math.floor,t.ceil=Math.ceil,t.round=Math.round,t.sqrt=Math.sqrt,t.min=Math.min,t.max=Math.max,t.letterbox=l,t["css-string"]=h,t["css-name"]=c,t.typeof=(t=>typeof t),this.Wt("page-width",function(){return this.Yt()}),this.Wt("page-height",function(){return this.qt()}),this.Wt("pref-font-family",function(){return this.pref.fontFamily}),this.Wt("pref-night-mode",function(){return this.pref.nightMode}),this.Wt("pref-hyphenate",function(){return this.pref.hyphenate}),this.Wt("pref-margin",function(){return this.pref.margin}),this.Wt("pref-line-height",function(){return this.pref.lineHeight}),this.Wt("pref-column-width",function(){return this.pref.columnWidth*this.fontSize}),this.Wt("pref-horizontal",function(){return this.pref.horizontal}),this.Wt("pref-spread-view",function(){return this.pref.Ht}),this.Wt("pub-title",function(){return h(this.Kt?this.Kt:"")}),this.Wt("doc-title",function(){return h(this.docTitle?this.docTitle:"")})}}Wt(t,e){this.values[t]=new Y(this,e,t)}Zt(t,e){this.values[t]=e}Qt(t,e){this.funcs[t]=e}Jt(t,e){this.jt[t]=e}}function p(t){switch(t.toLowerCase()){case"px":case"in":case"pt":case"pc":case"cm":case"mm":case"q":return!0;default:return!1}}function g(t){switch(t.toLowerCase()){case"vw":case"vh":case"vi":case"vb":case"vmin":case"vmax":case"pvw":case"pvh":case"pvi":case"pvb":case"pvmin":case"pvmax":return!0;default:return!1}}function m(t){switch(t.toLowerCase()){case"em":case"ex":case"rem":return!0;default:return!1}}const b={px:1,in:96,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,q:96/2.54/40,em:16,rem:16,ex:8,dppx:1,dpi:1/96,dpcm:2.54/96};function E(t){switch(t){case"q":case"rem":return!0;default:return!1}}class w{constructor(t,e,n,i){this.te=t,this.ee=e,this.ne=n,this.ie=null,this.se=null,this.re=null,this.scopes={},this.oe=null,this.he=null,this.le=null,this.Kt=null,this.docTitle=null,this.Yt=function(){return this.ie?this.ie:this.pref.Ht?Math.floor(e/2)-this.pref.pageBorder:e},this.qt=function(){return this.se?this.se:n},this.ce=i,this.fontSize=function(){return this.re?this.re:i},this.pref=o}ae(t){let e=this.scopes[t.Xt];return e||(e={},this.scopes[t.Xt]=e),e}ue(t){this.scopes[t.Xt]={};for(let e=0;e<t.children.length;e++)this.ue(t.children[e])}at(t,e){if(g(t)){const e=this.Yt()/100,n=this.qt()/100,i=null!=this.oe?this.oe/100:e,s=null!=this.he?this.he/100:n;switch(t){case"vw":return i;case"vh":return s;case"vi":return this.le?s:i;case"vb":return this.le?i:s;case"vmin":return i<s?i:s;case"vmax":return i>s?i:s;case"pvw":return e;case"pvh":return n;case"pvi":return this.le?n:e;case"pvb":return this.le?e:n;case"pvmin":return e<n?e:n;case"pvmax":return e>n?e:n}}return"em"==t||"rem"==t?e?this.ce:this.fontSize():"ex"==t?b.ex*(e?this.ce:this.fontSize())/b.em:b[t]}fe(t,e){do{let n=t.values[e];if(n)return n;if(t.resolver&&(n=t.resolver.call(this,e,!1)))return n;t=t.parent}while(t);throw new Error(`Name '${e}' is undefined`)}de(t,e,n,i){do{let s=t.funcs[e];if(s)return s;if(t.resolver&&(s=t.resolver.call(this,e,!0)))return s;const r=t.jt[e];if(r){if(i)return t.zero;const e=Array(n.length);for(let t=0;t<n.length;t++)e[t]=n[t].evaluate(this);return new Z(t,r.apply(this,e))}t=t.parent}while(t);throw new Error(`Function '${e}' is undefined`)}pe(t,e){const n="all"===t||!!this.pref.Vt[t];return e?!n:n}ge(t,e){let n="";const i=t.match(/^(min|max)-(.*)$/);i&&(n=i[1],t=i[2]);let s=null,r=null;switch(t){case"width":case"height":case"device-width":case"device-height":case"color":e&&(s=e.evaluate(this))}switch(t){case"width":r=this.Yt();break;case"height":r=this.qt();break;case"device-width":r=window.screen.availWidth;break;case"device-height":r=window.screen.availHeight;break;case"color":r=window.screen.pixelDepth}if(null!=r&&null!=s)switch(n){case"min":return r>=s;case"max":return r<=s;default:return r==s}else if(null!=r&&null==e)return 0!==r;return!1}me(t,e){const n=this.scopes[t.Xt];return n?n[e]:void 0}be(t,e,n){this.ae(t)[e]=n}}class v{constructor(t){this.scope=t,this.scope=t,this.key=`_${d++}`}toString(){const t=new i.d;return this.it(t,0),t.toString()}it(t,e){throw new Error("F_ABSTRACT")}we(t){throw new Error("F_ABSTRACT")}expand(t,e){return this}Ee(t,e,n){return t===this}xe(t,e,n){const i=n[this.key];if(null!=i)return i!==a.PENDING&&i;{n[this.key]=a.PENDING;const i=this.Ee(t,e,n);return n[this.key]=i,i}}depend(t,e){return this.xe(t,e,{})}evaluate(t){let e=t.me(this.scope,this.key);return void 0!==e?e:(e=this.we(t),t.be(this.scope,this.key,e),e)}ye(){return!1}}class y extends v{constructor(t,e){super(t),this.val=e}ke(){throw new Error("F_ABSTRACT")}Se(t){throw new Error("F_ABSTRACT")}we(t){const e=this.val.evaluate(t);return this.Se(e)}Ee(t,e,n){return t===this||this.val.xe(t,e,n)}it(t,e){10<e&&t.append("("),t.append(this.ke()),this.val.it(t,10),10<e&&t.append(")")}expand(t,e){const n=this.val.expand(t,e);return n===this.val?this:new this.constructor(this.scope,n)}}class T extends v{constructor(t,e,n){super(t),this.lhs=e,this.rhs=n}ve(){throw new Error("F_ABSTRACT")}ke(){throw new Error("F_ABSTRACT")}Te(t,e){throw new Error("F_ABSTRACT")}we(t){const e=this.lhs.evaluate(t),n=this.rhs.evaluate(t);return this.Te(e,n)}Ee(t,e,n){return t===this||this.lhs.xe(t,e,n)||this.rhs.xe(t,e,n)}it(t,e){const n=this.ve();n<=e&&t.append("("),this.lhs.it(t,n),t.append(this.ke()),this.rhs.it(t,n),n<=e&&t.append(")")}expand(t,e){const n=this.lhs.expand(t,e),i=this.rhs.expand(t,e);return n===this.lhs&&i===this.rhs?this:new this.constructor(this.scope,n,i)}}class N extends T{constructor(t,e,n){super(t,e,n)}ve(){return 1}}class S extends T{constructor(t,e,n){super(t,e,n)}ve(){return 2}}class x extends T{constructor(t,e,n){super(t,e,n)}ve(){return 3}}class I extends T{constructor(t,e,n){super(t,e,n)}ve(){return 4}}class C extends y{constructor(t,e){super(t,e)}ke(){return"!"}Se(t){return!t}}class O extends y{constructor(t,e){super(t,e)}ke(){return"-"}Se(t){return-t}}class _ extends N{constructor(t,e,n){super(t,e,n)}ke(){return"&&"}we(t){return this.lhs.evaluate(t)&&this.rhs.evaluate(t)}}class A extends _{constructor(t,e,n){super(t,e,n)}ke(){return" and "}}class k extends N{constructor(t,e,n){super(t,e,n)}ke(){return"||"}we(t){return this.lhs.evaluate(t)||this.rhs.evaluate(t)}}class D extends k{constructor(t,e,n){super(t,e,n)}ke(){return", "}}class L extends S{constructor(t,e,n){super(t,e,n)}ke(){return"<"}Te(t,e){return t<e}}class R extends S{constructor(t,e,n){super(t,e,n)}ke(){return"<="}Te(t,e){return t<=e}}class P extends S{constructor(t,e,n){super(t,e,n)}ke(){return">"}Te(t,e){return t>e}}class F extends S{constructor(t,e,n){super(t,e,n)}ke(){return">="}Te(t,e){return t>=e}}class M extends S{constructor(t,e,n){super(t,e,n)}ke(){return"=="}Te(t,e){return t==e}}class U extends S{constructor(t,e,n){super(t,e,n)}ke(){return"!="}Te(t,e){return t!=e}}class z extends x{constructor(t,e,n){super(t,e,n)}ke(){return"+"}Te(t,e){return t+e}}class B extends x{constructor(t,e,n){super(t,e,n)}ke(){return" - "}Te(t,e){return t-e}}class H extends I{constructor(t,e,n){super(t,e,n)}ke(){return"*"}Te(t,e){return t*e}}class $ extends I{constructor(t,e,n){super(t,e,n)}ke(){return"/"}Te(t,e){return t/e}}class V extends I{constructor(t,e,n){super(t,e,n)}ke(){return"%"}Te(t,e){return t%e}}class G extends v{constructor(t,e,n){super(t),this.num=e,this.unit=n.toLowerCase()}it(t,e){t.append(this.num.toString()),t.append(i.p(this.unit))}we(t){return this.num*t.at(this.unit,!1)}}class j extends v{constructor(t,e){super(t),this.Ne=e}it(t,e){t.append(this.Ne)}we(t){return t.fe(this.scope,this.Ne).evaluate(t)}Ee(t,e,n){return t===this||e.fe(this.scope,this.Ne).xe(t,e,n)}}class X extends v{constructor(t,e,n){super(t),this.not=e,this.name=n}it(t,e){this.not&&t.append("not "),t.append(i.p(this.name))}we(t){return t.pe(this.name,this.not)}Ee(t,e,n){return t===this||this.value.xe(t,e,n)}ye(){return!0}}class Y extends v{constructor(t,e,n){super(t),this.fn=e,this.str=n}it(t,e){t.append(this.str)}we(t){return this.fn.call(t)}}class K extends v{constructor(t,e,n){super(t),this.Ne=e,this.params=n}it(t,e){t.append(this.Ne),function(t,e){t.append("(");for(let n=0;n<e.length;n++)n&&t.append(","),e[n].it(t,0);t.append(")")}(t,this.params)}we(t){return t.de(this.scope,this.Ne,this.params,!1).expand(t,this.params).evaluate(t)}Ee(t,e,n){if(t===this)return!0;for(let i=0;i<this.params.length;i++)if(this.params[i].xe(t,e,n))return!0;return e.de(this.scope,this.Ne,this.params,!0).xe(t,e,n)}expand(t,e){const n=function(t,e,n){let i=e;for(let s=0;s<e.length;s++){const r=e[s].expand(t,n);if(e!==i)i[s]=r;else if(r!==e[s]){i=Array(e.length);for(let t=0;t<s;t++)i[t]=e[t];i[s]=r}}return i}(t,this.params,e);return n===this.params?this:new K(this.scope,this.Ne,n)}}class W extends v{constructor(t,e,n,i){super(t),this.cond=e,this.Ce=n,this.Pe=i}it(t,e){e>0&&t.append("("),this.cond.it(t,0),t.append("?"),this.Ce.it(t,0),t.append(":"),this.Pe.it(t,0),e>0&&t.append(")")}we(t){return this.cond.evaluate(t)?this.Ce.evaluate(t):this.Pe.evaluate(t)}Ee(t,e,n){return t===this||this.cond.xe(t,e,n)||this.Ce.xe(t,e,n)||this.Pe.xe(t,e,n)}expand(t,e){const n=this.cond.expand(t,e),i=this.Ce.expand(t,e),s=this.Pe.expand(t,e);return n===this.cond&&i===this.Ce&&s===this.Pe?this:new W(this.scope,n,i,s)}}class Z extends v{constructor(t,e){super(t),this.val=e}it(t,e){switch(typeof this.val){case"number":case"boolean":t.append(this.val.toString());break;case"string":t.append('"'),t.append(i.q(this.val)),t.append('"');break;default:throw new Error("F_UNEXPECTED_STATE")}}we(t){return this.val}}class q extends v{constructor(t,e,n){super(t),this.name=e,this.value=n}it(t,e){t.append("("),t.append(i.q(this.name.name)),t.append(":"),this.value.it(t,0),t.append(")")}we(t){return t.ge(this.name.name,this.value)}Ee(t,e,n){return t===this||this.value.xe(t,e,n)}expand(t,e){const n=this.value.expand(t,e);return n===this.value?this:new q(this.scope,this.name,n)}}class Q extends v{constructor(t,e){super(t),this.index=e}it(t,e){t.append("$"),t.append(this.index.toString())}expand(t,e){const n=e[this.index];if(!n)throw new Error(`Parameter missing: ${this.index}`);return n}}function J(t,e,n){return e===t._false||e===t.zero||n==t._false||n==t.zero?t._false:e===t._true||e===t.one?n:n===t._true||n===t.one?e:new _(t,e,n)}function tt(t,e,n){return e===t.zero?n:n===t.zero?e:new z(t,e,n)}function et(t,e,n){return e===t.zero?new O(t,n):n===t.zero?e:new B(t,e,n)}function nt(t,e,n){return e===t.zero||n===t.zero?t.zero:e===t.one?n:n===t.one?e:new H(t,e,n)}function it(t,e,n){return e===t.zero?t.zero:n===t.one?e:new $(t,e,n)}},function(t,e,n){"use strict";n.d(e,"v",function(){return f}),n.d(e,"r",function(){return g}),n.d(e,"H",function(){return m}),n.d(e,"m",function(){return y}),n.d(e,"l",function(){return T}),n.d(e,"c",function(){return x}),n.d(e,"i",function(){return C}),n.d(e,"x",function(){return A}),n.d(e,"w",function(){return k}),n.d(e,"s",function(){return D}),n.d(e,"F",function(){return L}),n.d(e,"u",function(){return R}),n.d(e,"q",function(){return P}),n.d(e,"t",function(){return M}),n.d(e,"B",function(){return z}),n.d(e,"A",function(){return B}),n.d(e,"g",function(){return $}),n.d(e,"j",function(){return V}),n.d(e,"a",function(){return Y}),n.d(e,"d",function(){return K}),n.d(e,"e",function(){return Ot}),n.d(e,"G",function(){return Ht}),n.d(e,"b",function(){return $t}),n.d(e,"f",function(){return Xt}),n.d(e,"h",function(){return Yt}),n.d(e,"p",function(){return Wt}),n.d(e,"D",function(){return Zt}),n.d(e,"E",function(){return qt}),n.d(e,"z",function(){return Qt}),n.d(e,"y",function(){return Jt}),n.d(e,"n",function(){return te}),n.d(e,"o",function(){return ee}),n.d(e,"C",function(){return ne}),n.d(e,"k",function(){return ie});var i=n(7),s=n(1),r=n(0),o=n(10),a=n(20),l=n(2),h=n(4),c=n(6),u=n(25),d=n(9);const f={azimuth:!0,"border-collapse":!0,"border-spacing":!0,"caption-side":!0,"clip-rule":!0,color:!0,"color-interpolation":!0,"color-rendering":!0,cursor:!0,direction:!0,elevation:!0,"empty-cells":!0,fill:!0,"fill-opacity":!0,"fill-rule":!0,"font-kerning":!0,"font-size":!0,"font-size-adjust":!0,"font-family":!0,"font-feature-settings":!0,"font-style":!0,"font-stretch":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-vertical":!0,hyphens:!0,"hyphenate-character":!0,"hyphenate-limit-chars":!0,"hyphenate-limit-last":!0,"image-rendering":!0,"image-resolution":!0,"letter-spacing":!0,"line-break":!0,"line-height":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,marker:!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,orphans:!0,"overflow-wrap":!0,"paint-order":!0,"pointer-events":!0,"pitch-range":!0,quotes:!0,richness:!0,"ruby-align":!0,"ruby-position":!0,"speak-header":!0,"speak-numeral":!0,"speak-punctuation":!0,"speech-rate":!0,"shape-rendering":!0,stress:!0,stroke:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,"tab-size":!0,"text-align":!0,"text-align-last":!0,"text-anchor":!0,"text-decoration-skip":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-combine-upright":!0,"text-indent":!0,"text-justify":!0,"text-rendering":!0,"text-size-adjust":!0,"text-transform":!0,"text-underline-position":!0,visibility:!0,"voice-family":!0,volume:!0,"white-space":!0,widows:!0,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"writing-mode":!0},p=["box-decoration-break","image-resolution","orphans","widows"];function g(){return d.b(d.a.POLYFILLED_INHERITED_PROPS).reduce((t,e)=>t.concat(e()),[].concat(p))}const m={"http://www.idpf.org/2007/ops":!0,"http://www.w3.org/1999/xhtml":!0,"http://www.w3.org/2000/svg":!0},b=["margin-%","padding-%","border-%-width","border-%-style","border-%-color","%"],E=["max-%","min-%","%"],w=(()=>{const t=["left","right","top","bottom"],e={width:!0,height:!0,"max-width":!0,"max-height":!0,"min-width":!0,"min-height":!0};for(let n=0;n<b.length;n++)for(let i=0;i<t.length;i++)e[b[n].replace("%",t[i])]=!0;return e})();function v(t,e){const n={};for(const e of b)for(const i in t){const s=e.replace("%",i),r=e.replace("%",t[i]);n[s]=r,n[r]=s}for(const t of E)for(const i in e){const s=t.replace("%",i),r=t.replace("%",e[i]);n[s]=r,n[r]=s}return n}const y=v({"block-start":"right","block-end":"left","inline-start":"top","inline-end":"bottom"},{"block-size":"width","inline-size":"height"}),T=v({"block-start":"top","block-end":"bottom","inline-start":"left","inline-end":"right"},{"block-size":"height","inline-size":"width"}),N=v({"block-start":"right","block-end":"left","inline-start":"bottom","inline-end":"top"},{"block-size":"width","inline-size":"height"}),S=v({"block-start":"top","block-end":"bottom","inline-start":"right","inline-end":"left"},{"block-size":"height","inline-size":"width"});class x{constructor(t,e){this.value=t,this.priority=e}Re(){return this}_e(t){const e=this.value.visit(t);return e===this.value?this:new x(e,this.priority)}Ae(t){return 0==t?this:new x(this.value,this.priority+t)}evaluate(t,e){return o.i(t,this.value,e)}isEnabled(t){return!0}}class I extends x{constructor(t,e,n){super(t,e),this.condition=n}Re(){return new x(this.value,this.priority)}_e(t){const e=this.value.visit(t);return e===this.value?this:new I(e,this.priority,this.condition)}Ae(t){return 0==t?this:new I(this.value,this.priority+t,this.condition)}isEnabled(t){return!!this.condition.evaluate(t)}}function C(t,e,n){return(null==e||n.priority>e.priority)&&n.isEnabled(t)?n.Re():e}const O={"region-id":!0,"fragment-selector-id":!0};function _(t){return!!O[t]}function A(t){return"_"!=t.charAt(0)&&!O[t]}function k(t){return!!f[t]}function D(t,e){return t[e]}function L(t,e,n){n?t[e]=n:delete t[e]}function R(t,e){return t[e]}function P(t,e){let n=t[e];return n||(n={},t[e]=n),n}const F=t=>{let e=t._viewConditionalStyles;return e||(e=[],t._viewConditionalStyles=e),e};function M(t,e){return t[e]}function U(t,e){let n=t[e];return n||(n=[],t[e]=n),n}function z(t,e,n,i,s,r,o){if([{id:s,Ie:"_pseudos"},{id:r,Ie:"_regions"}].forEach(t=>{if(t.id){const n=P(e,t.Ie);(e=n[t.id])||(e={},n[t.id]=e)}}),o){const t=F(e);e={},t.push({styles:e,matcher:o})}for(const s in n)if("_"!=s.charAt(0))if(_(s)){const t=M(n,s),i=U(e,s);Array.prototype.push.apply(i,t)}else{const r=D(n,s).Ae(i),o=D(e,s);L(e,s,C(t,o,r))}}function B(t,e){const n={};for(let i=0;i<e.length;i++)z(t,n,e[i],0,null,null,null);return n}function H(t,e){if(t.length>0){t.sort((t,e)=>e.ve()-t.ve());let n=null;for(let i=t.length-1;i>=0;i--)(n=t[i]).chained=e,e=n;return n}return e}class $ extends r.d{constructor(t,e){super(),this.props=t,this.context=e,this.Fe=""}Oe(t){this.Fe=t}Le(){const t=D(this.props,"font-size").value;if(!h.I(t.unit))throw new Error("Unexpected state");return t.num*h.G[t.unit]}U(t){if(i.a(this.context),"font-size"===this.Fe)return function(t,e,n){const i=(t=V(t,e,n)).unit,s=t.num;return"px"===i?t:"%"===i?new r.i(s/100*e,"px"):new r.i(s*n.at(i,!1),"px")}(t,this.Le(),this.context);if("em"==t.unit||"ex"==t.unit||"rem"==t.unit)return V(t,this.Le(),this.context);if("%"==t.unit){if("line-height"===this.Fe)return t;const e=this.Fe.match(/height|^(top|bottom)$/)?"vh":"vw";return new r.i(t.num,e)}return t}nt(t){return"font-size"==this.Fe?o.i(this.context,t,this.Fe).visit(this):t}}function V(t,e,n){const i=t.unit,s=t.num;if("em"===i||"ex"===i){const t=h.G[i]/h.G.em;return new r.i(s*t*e,"px")}return"rem"===i?new r.i(s*n.fontSize(),"px"):t}class G{apply(t){}Me(t){return new X([this,t])}clone(){return this}}class j extends G{constructor(t){super(),this.De=t}apply(t){t.$e(this.De.fresh(t))}}class X extends G{constructor(t){super(),this.list=t}apply(t){for(let e=0;e<this.list.length;e++)this.list[e].apply(t)}Me(t){return this.list.push(t),this}clone(){return new X([].concat(this.list))}}class Y extends G{constructor(t,e,n,i,s){super(),this.style=t,this.specificity=e,this.pseudoelement=n,this.regionId=i,this.Be=s}apply(t){z(t.context,t.currentStyle,this.style,this.specificity,this.pseudoelement,this.regionId,t.Ue(this.Be))}}class K extends G{constructor(){super(),this.chained=null}apply(t){this.chained.apply(t)}ve(){return 0}Ge(t){return!1}}class W extends K{constructor(t){super(),this.className=t}apply(t){t.ze.includes(this.className)&&this.chained.apply(t)}ve(){return 10}Ge(t){return this.chained&&t.He(t.classes,this.className,this.chained),!0}}class Z extends K{constructor(t){super(),this.id=t}apply(t){t.Ve!=this.id&&t.je!=this.id||this.chained.apply(t)}ve(){return 11}Ge(t){return this.chained&&t.He(t.ids,this.id,this.chained),!0}}class q extends K{constructor(t){super(),this.localName=t}apply(t){t.Xe==this.localName&&this.chained.apply(t)}ve(){return 8}Ge(t){return this.chained&&t.He(t.tags,this.localName,this.chained),!0}}class Q extends K{constructor(t,e){super(),this.ns=t,this.localName=e}apply(t){t.Xe==this.localName&&t.We==this.ns&&this.chained.apply(t)}ve(){return 8}Ge(t){if(this.chained){let e=t.Ye[this.ns];e||(e=`ns${t.qe++}:`,t.Ye[this.ns]=e);const n=e+this.localName;t.He(t.nstags,n,this.chained)}return!0}}class J extends K{constructor(t){super(),this.Ke=t}apply(t){const e=t.Ze;if(e&&"a"==t.Xe){const n=e.getAttribute("href");if(n&&n.match(/^#/)){const i=n.substring(1),r=e.ownerDocument.getElementById(i);if(r){const e=r.getAttributeNS(s.a.epub,"type");e&&e.match(this.Ke)&&this.chained.apply(t)}}}}}class tt extends K{constructor(t){super(),this.ns=t}apply(t){t.We==this.ns&&this.chained.apply(t)}}class et extends K{constructor(t,e){super(),this.ns=t,this.name=e}apply(t){t.Ze&&t.Ze.hasAttributeNS(this.ns,this.name)&&this.chained.apply(t)}}class nt extends K{constructor(t,e,n){super(),this.ns=t,this.name=e,this.value=n}apply(t){t.Ze&&t.Ze.getAttributeNS(this.ns,this.name)==this.value&&this.chained.apply(t)}ve(){return"type"==this.name&&this.ns==s.a.epub?9:0}Ge(t){return"type"==this.name&&this.ns==s.a.epub&&(this.chained&&t.He(t.epubtypes,this.value,this.chained),!0)}}class it extends K{constructor(t,e){super(),this.ns=t,this.name=e}apply(t){if(t.Ze){const e=t.Ze.getAttributeNS(this.ns,this.name);e&&m[e]&&this.chained.apply(t)}}ve(){return 0}Ge(t){return!1}}class st extends K{constructor(t,e,n){super(),this.ns=t,this.name=e,this.regexp=n}apply(t){if(t.Ze){const e=t.Ze.getAttributeNS(this.ns,this.name);e&&e.match(this.regexp)&&this.chained.apply(t)}}}class rt extends K{constructor(t){super(),this.Qe=t}apply(t){t.lang.match(this.Qe)&&this.chained.apply(t)}}class ot extends K{constructor(){super()}apply(t){t.Je&&this.chained.apply(t)}ve(){return 6}}class at extends K{constructor(){super()}apply(t){t.tn&&this.chained.apply(t)}ve(){return 12}}class lt extends K{constructor(t,e){super(),this.a=t,this.b=e}en(t){return u.c(t,this.a,this.b)}}class ht extends lt{constructor(t,e){super(t,e)}apply(t){const e=t.nn[t.We][t.Xe];this.en(e)&&this.chained.apply(t)}ve(){return 5}}class ct extends lt{constructor(t,e){super(t,e)}apply(t){let e=t.sn;null===e&&(e=t.sn=t.Ze.parentNode.childElementCount-t.rn+1),this.en(e)&&this.chained.apply(t)}ve(){return 4}}class ut extends lt{constructor(t,e){super(t,e)}apply(t){const e=t.on;if(!e[t.We]){let n=t.Ze;do{const t=n.namespaceURI,i=n.localName;let s=e[t];s||(s=e[t]={}),s[i]=(s[i]||0)+1}while(n=n.nextElementSibling)}this.en(e[t.We][t.Xe])&&this.chained.apply(t)}ve(){return 4}}class dt extends K{constructor(){super()}apply(t){let e=t.Ze.firstChild;for(;e;){switch(e.nodeType){case Node.ELEMENT_NODE:return;case Node.TEXT_NODE:if(e.length>0)return}e=e.nextSibling}this.chained.apply(t)}ve(){return 4}}class ft extends K{constructor(){super()}apply(t){!1===t.Ze.disabled&&this.chained.apply(t)}ve(){return 5}}class pt extends K{constructor(){super()}apply(t){!0===t.Ze.disabled&&this.chained.apply(t)}ve(){return 5}}class gt extends K{constructor(){super()}apply(t){const e=t.Ze;!0!==e.selected&&!0!==e.checked||this.chained.apply(t)}ve(){return 5}}class mt extends K{constructor(t){super(),this.condition=t}apply(t){if(t.conditions[this.condition])try{t.hn.push(this.condition),this.chained.apply(t)}finally{t.hn.pop()}}ve(){return 5}}class bt extends G{constructor(){super(),this.applied=!1}apply(t){this.applied=!0}clone(){const t=new bt;return t.applied=this.applied,t}}class Et extends K{constructor(t){super(),this.ln=new bt,this.cn=H(t,this.ln)}apply(t){this.cn.apply(t),this.ln.applied||this.chained.apply(t),this.ln.applied=!1}ve(){return this.cn.ve()}}class wt{constructor(t,e,n){this.condition=t,this.Be=e,this.an=n}increment(t){t.increment(this.condition,this.an)}decrement(t){t.decrement(this.condition,this.an)}Ue(t){return t.Ue(this.Be)}}class vt extends wt{constructor(t,e,n){super(t,e,n)}fresh(t){return new vt(this.condition,this.Be,this.Ue(t))}push(t,e){return 0==e&&this.increment(t),!1}pop(t,e){return 0==e&&(this.decrement(t),!0)}}class yt extends wt{constructor(t,e,n){super(t,e,n)}fresh(t){return new yt(this.condition,this.Be,this.Ue(t))}push(t,e){return 0==e?this.increment(t):1==e&&this.decrement(t),!1}pop(t,e){return 0==e?(this.decrement(t),!0):(1==e&&this.increment(t),!1)}}class Tt extends wt{constructor(t,e,n){super(t,e,n),this.fired=!1}fresh(t){return new Tt(this.condition,this.Be,this.Ue(t))}push(t,e){return!!this.fired&&(this.decrement(t),!0)}pop(t,e){return this.fired?(this.decrement(t),!0):(0==e&&(this.fired=!0,this.increment(t)),!1)}}class Nt extends wt{constructor(t,e,n){super(t,e,n),this.fired=!1}fresh(t){return new Nt(this.condition,this.Be,this.Ue(t))}push(t,e){return this.fired&&(-1==e?this.increment(t):0==e&&this.decrement(t)),!1}pop(t,e){if(this.fired){if(-1==e)return this.decrement(t),!0;0==e&&this.increment(t)}else 0==e&&(this.fired=!0,this.increment(t));return!1}}class St{constructor(t,e){this.afterprop=t,this.element=e}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.un(this.afterprop,this.element),!0)}}class xt{constructor(t){this.lang=t}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.lang=this.lang,!0)}}class It{constructor(t){this.dn=t}fresh(t){return this}push(t,e){return!1}pop(t,e){return 0==e&&(t.quotes=this.dn,!0)}}class Ct extends r.d{constructor(t){super(),this.element=t}pn(t,e){switch(e){case"url":return t?new r.l(t):new r.l("about:invalid");case"string":default:return t?new r.k(t):new r.k("")}}et(t){if("attr"!==t.name)return super.et(t);let e="string",n=null,i=null;if(t.values[0]instanceof r.j){const i=t.values[0].values;i.length>=2&&(e=i[1].stringValue()),n=i[0].stringValue()}else n=t.values[0].stringValue();return i=t.values.length>1?this.pn(t.values[1].stringValue(),e):this.pn(null,e),this.element&&this.element.hasAttribute(n)?this.pn(this.element.getAttribute(n),e):i}}class Ot extends r.d{constructor(t,e,n){super(),this.cascade=t,this.element=e,this.gn=n}$(t){const e=this.cascade,n=e.quotes,i=Math.floor(n.length/2)-1;switch(t.name){case"open-quote":{const t=n[2*Math.min(i,e.mn)];return e.mn++,t}case"close-quote":return e.mn>0&&e.mn--,n[2*Math.min(i,e.mn)+1];case"no-open-quote":return e.mn++,new r.k("");case"no-close-quote":return e.mn>0&&e.mn--,new r.k("")}return t}format(t,e){let n,i=!1,r=!1;null!=(n=e.match(/^upper-(.*)/))?(i=!0,e=n[1]):null!=(n=e.match(/^lower-(.*)/))&&(r=!0,e=n[1]);let o="";return _t[e]?o=function(t,e){if(e>t[0]||e<=0||e!=Math.round(e))return"";let n="";for(let i=1;i<t.length;i+=2){const s=t[i];let r=Math.floor(e/s);if(r>20)return"";for(e-=r*s;r>0;)n+=t[i+1],r--}return n}(_t[e],t):At[e]?o=function(t,e){if(e<=0||e!=Math.round(e))return"";const n=function(t){const e=[];let n=0;for(;n<t.length;)if("-"==t.substr(n+1,1)){const i=t.charCodeAt(n),s=t.charCodeAt(n+2);n+=3;for(let t=i;t<=s;t++)e.push(String.fromCharCode(t))}else e.push(t.substr(n++,1));return e}(t);let i="";do{const t=--e%n.length;i=n[t]+i,e=(e-t)/n.length}while(e>0);return i}(At[e],t):null!=kt[e]?o=kt[e]:"decimal-leading-zero"==e?1==(o=`${t}`).length&&(o=`0${o}`):o="cjk-ideographic"==e||"trad-chinese-informal"==e?function(t,e){if(t>9999||t<-9999)return`${t}`;if(0==t)return e.digits.charAt(0);const n=new s.d;if(t<0&&(n.append(e.negative),t=-t),t<10)n.append(e.digits.charAt(t));else if(!e.formal&&t<=19)n.append(e.markers.charAt(0)),0!=t&&n.append(e.digits.charAt(t-10));else{const i=Math.floor(t/1e3);i&&(n.append(e.digits.charAt(i)),n.append(e.markers.charAt(2)));const s=Math.floor(t/100)%10;s&&(n.append(e.digits.charAt(s)),n.append(e.markers.charAt(1)));const r=Math.floor(t/10)%10;r&&(n.append(e.digits.charAt(r)),n.append(e.markers.charAt(0)));const o=t%10;o&&n.append(e.digits.charAt(o))}return n.toString()}(t,Dt):`${t}`,i?o.toUpperCase():r?o.toLowerCase():o}bn(t){const e=t[0].toString(),n=t.length>1?t[1].stringValue():"decimal",i=this.cascade.counters[e];if(i&&i.length){const t=i&&i.length&&i[i.length-1]||0;return new r.k(this.format(t,n))}{const t=this,i=new r.c(this.gn.wn(e,e=>t.format(e||0,n)));return new r.j([i])}}En(t){const e=t[0].toString(),n=t[1].stringValue(),i=t.length>2?t[2].stringValue():"decimal",o=this.cascade.counters[e],a=new s.d;if(o&&o.length)for(let t=0;t<o.length;t++)t>0&&a.append(n),a.append(this.format(o[t],i));const l=this,h=new r.c(this.gn.xn(e,t=>{const e=[];if(t.length)for(let n=0;n<t.length;n++)e.push(l.format(t[n],i));const s=a.toString();return s.length&&e.push(s),e.length?e.join(n):l.format(0,i)}));return new r.j([h])}yn(t){const e=t[0];let n;n=e instanceof r.l?e.url:e.stringValue();const i=t[1].toString(),s=t.length>2?t[2].stringValue():"decimal",o=this,a=new r.c(this.gn.kn(n,i,t=>o.format(t||0,s)));return new r.j([a])}Sn(t){const e=t[0];let n;n=e instanceof r.l?e.url:e.stringValue();const i=t[1].toString(),s=t[2].stringValue(),o=t.length>3?t[3].stringValue():"decimal",a=this,l=new r.c(this.gn.vn(n,i,t=>{const e=t.map(t=>a.format(t,o));return e.length?e.join(s):a.format(0,o)}));return new r.j([l])}et(t){switch(t.name){case"counter":if(t.values.length<=2)return this.bn(t.values);break;case"counters":if(t.values.length<=3)return this.En(t.values);break;case"target-counter":if(t.values.length<=3)return this.yn(t.values);break;case"target-counters":if(t.values.length<=4)return this.Sn(t.values)}return c.b.warn("E_CSS_CONTENT_PROP:",t.toString()),new r.k("")}}const _t={roman:[4999,1e3,"M",900,"CM",500,"D",400,"CD",100,"C",90,"XC",50,"L",40,"XL",10,"X",9,"IX",5,"V",4,"IV",1,"I"],armenian:[9999,9e3,"ք",8e3,"փ",7e3,"ւ",6e3,"ց",5e3,"ր",4e3,"տ",3e3,"վ",2e3,"ս",1e3,"ռ",900,"ջ",800,"պ",700,"չ",600,"ո",500,"շ",400,"ն",300,"յ",200,"մ",100,"ճ",90,"ղ",80,"ձ",70,"հ",60,"կ",50,"ծ",40,"խ",30,"լ",20,"ի",10,"ժ",9,"թ",8,"ը",7,"է",6,"զ",5,"ե",4,"դ",3,"գ",2,"բ",1,"ա"],georgian:[19999,1e4,"ჵ",9e3,"ჰ",8e3,"ჯ",7e3,"ჴ",6e3,"ხ",5e3,"ჭ",4e3,"წ",3e3,"ძ",2e3,"ც",1e3,"ჩ",900,"შ",800,"ყ",700,"ღ",600,"ქ",500,"ფ",400,"ჳ",300,"ტ",200,"ს",100,"რ",90,"ჟ",80,"პ",70,"ო",60,"ჲ",50,"ნ",40,"მ",30,"ლ",20,"კ",10,"ი",9,"თ",8,"ჱ",7,"ზ",6,"ვ",5,"ე",4,"დ",3,"გ",2,"ბ",1,"ა"],hebrew:[999,400,"ת",300,"ש",200,"ר",100,"ק",90,"צ",80,"פ",70,"ע",60,"ס",50,"נ",40,"מ",30,"ל",20,"כ",19,"יט",18,"יח",17,"יז",16,"טז",15,"טו",10,"י",9,"ט",8,"ח",7,"ז",6,"ו",5,"ה",4,"ד",3,"ג",2,"ב",1,"א"]},At={latin:"a-z",alpha:"a-z",greek:"α-ρσ-ω",russian:"а-ик-щэ-я"},kt={square:"■",disc:"•",circle:"◦",none:""},Dt={formal:!1,digits:"零一二三四五六七八九",markers:"十百千",negative:"負"},Lt=1/1048576;function Rt(t,e){for(const n in t)e[n]=t[n].clone()}class Pt{constructor(){this.qe=0,this.Ye={},this.tags={},this.nstags={},this.epubtypes={},this.classes={},this.ids={},this.pagetypes={},this.order=0}clone(){const t=new Pt;t.qe=this.qe;for(const e in this.Ye)t.Ye[e]=this.Ye[e];return Rt(this.tags,t.tags),Rt(this.nstags,t.nstags),Rt(this.epubtypes,t.epubtypes),Rt(this.classes,t.classes),Rt(this.ids,t.ids),Rt(this.pagetypes,t.pagetypes),t.order=this.order,t}He(t,e,n){const i=t[e];i&&(n=i.Me(n)),t[e]=n}Tn(t,e,n,i){return new Ft(this,t,e,n,i)}Nn(){return this.order+=Lt}}class Ft{constructor(t,e,n,i,s){this.context=e,this.Cn=n,this.gn=i,this.stack=[[],[]],this.conditions={},this.Ze=null,this.Pn=null,this.currentStyle=null,this.ze=null,this.Xe="",this.We="",this.Ve="",this.je="",this.Rn="",this._n=null,this.An=null,this.Je=!0,this.tn=!0,this.counters={},this.In=[{}],this.mn=0,this.lang="",this.Fn=[0],this.rn=0,this.On=[{}],this.sn=null,this.Ln=[{}],this.Mn={},this.hn=[],this.code=t,this.quotes=[new r.k("“"),new r.k("”"),new r.k("‘"),new r.k("’")],this.nn=this.On[0],this.Dn=[this.sn],this.on=this.On[0]}$e(t){this.stack[this.stack.length-1].push(t)}increment(t,e){this.conditions[t]=(this.conditions[t]||0)+1,e&&(this.Mn[t]?this.Mn[t].push(e):this.Mn[t]=[e])}decrement(t,e){this.conditions[t]--,this.Mn[t]&&(this.Mn[t]=this.Mn[t].filter(t=>t!==e),0===this.Mn[t].length&&delete this.Mn[t])}Ue(t){let e=null;t&&(i.a(this.Pn),e=u.a.Ue(this.Pn,t));const n=this.hn.map(t=>{const e=this.Mn[t];return e&&e.length>0?1===e.length?e[0]:u.a.$n([].concat(e)):null}).filter(t=>t);return n.length<=0?e:null===e?1===n.length?n[0]:u.a.Bn(n):u.a.Bn([e].concat(n))}Un(t,e){const n=t[e];n&&n.apply(this)}Gn(t,e,n){this.Ze=null,this.Pn=null,this.currentStyle=n,this.We="",this.Xe="",this.Ve="",this.je="",this.ze=t,this.Rn="",this._n=Mt,this.An=e,this.zn()}Hn(t,e){this.counters[t]?this.counters[t].push(e):this.counters[t]=[e];let n=this.In[this.In.length-1];n||(n={},this.In[this.In.length-1]=n),n[t]=!0}Vn(t){let e=r.t.inline;const n=t.display;n&&(e=n.evaluate(this.context));let i=null,o=null,l=null;const h=t["counter-reset"];if(h){const t=h.evaluate(this.context);t&&(i=a.b(t,!0))}const c=t["counter-set"];if(c){const t=c.evaluate(this.context);t&&(l=a.b(t,!1))}const u=t["counter-increment"];if(u){const t=u.evaluate(this.context);t&&(o=a.b(t,!1))}if("ol"!=this.Xe&&"ul"!=this.Xe||this.We!=s.a.XHTML||(i||(i={}),i["ua-list-item"]=0),e===r.t.list_item&&(o||(o={}),o["ua-list-item"]=1),i)for(const t in i)this.Hn(t,i[t]);if(l)for(const t in l)if(this.counters[t]){const e=this.counters[t];e[e.length-1]=l[t]}else this.Hn(t,l[t]);if(o)for(const t in o){this.counters[t]||this.Hn(t,0);const e=this.counters[t];e[e.length-1]+=o[t]}if(e===r.t.list_item){const e=this.counters["ua-list-item"],n=e[e.length-1];t["ua-list-item-count"]=new x(new r.h(n),0)}this.In.push(null)}jn(){const t=this.In.pop();if(t)for(const e in t){const t=this.counters[e];t&&(1==t.length?delete this.counters[e]:t.pop())}}un(t,e){this.Vn(t),t.content&&(t.content=t.content._e(new Ot(this,e,this.gn))),this.jn()}Xn(t,e,n){this.An=null,this.Ze=t,this.Pn=n,this.currentStyle=e,this.We=t.namespaceURI,this.Xe=t.localName;const i=this.code.Ye[this.We];this.Rn=i?i+this.Xe:"",this.Ve=t.getAttribute("id"),this.je=t.getAttributeNS(s.a.XML,"id");const o=t.getAttribute("class");this.ze=o?o.split(/\s+/):Mt;const a=t.getAttributeNS(s.a.epub,"type");if(this._n=a?a.split(/\s+/):Mt,"style"==this.Xe&&this.We==s.a.FB2){const e=t.getAttribute("name")||"";this.ze=[e]}const l=s.u(t);l&&(this.stack[this.stack.length-1].push(new xt(this.lang)),this.lang=l.toLowerCase());const h=this.tn,c=this.Fn;this.rn=++c[c.length-1],c.push(0);const u=this.On,d=this.nn=u[u.length-1];let f=d[this.We];f||(f=d[this.We]={}),f[this.Xe]=(f[this.Xe]||0)+1,u.push({});const p=this.Dn;null!==p[p.length-1]?this.sn=--p[p.length-1]:this.sn=null,p.push(null);const g=this.Ln,m=this.on=g[g.length-1];m&&m[this.We]&&m[this.We][this.Xe]--,g.push({}),this.zn(),this.Wn(t);const b=e.quotes;let E=null;if(b){const t=b.evaluate(this.context);t&&(E=new It(this.quotes),t===r.t.none?this.quotes=[new r.k(""),new r.k("")]:t instanceof r.j&&(this.quotes=t.values))}this.Vn(this.currentStyle);const w=this.Ve||this.je||t.getAttribute("name")||"";if(h||w){const t={};Object.keys(this.counters).forEach(e=>{t[e]=Array.from(this.counters[e])}),this.Cn.Yn(w,t)}const v=R(this.currentStyle,"_pseudos");if(v){let e=!0;for(const n of Ut){n||(e=!1);const i=v[n];i&&(e?this.un(i,t):this.stack[this.stack.length-2].push(new St(i,t)))}}E&&this.stack[this.stack.length-2].push(E)}qn(t,e){for(const n in e)A(n)&&(e[n]=e[n]._e(t))}Wn(t){const e=new Ct(t),n=this.currentStyle,i=R(n,"_pseudos");for(const t in i)this.qn(e,i[t]);this.qn(e,n)}zn(){let t;for(t=0;t<this.ze.length;t++)this.Un(this.code.classes,this.ze[t]);for(t=0;t<this._n.length;t++)this.Un(this.code.epubtypes,this._n[t]);this.Un(this.code.ids,this.Ve),this.Un(this.code.tags,this.Xe),""!=this.Xe&&this.Un(this.code.tags,"*"),this.Un(this.code.nstags,this.Rn),null!==this.An&&(this.Un(this.code.pagetypes,this.An),this.Un(this.code.pagetypes,"*")),this.Ze=null,this.Kn=null,this.stack.push([]);for(let e=1;e>=-1;--e){const n=this.stack[this.stack.length-e-2];for(t=0;t<n.length;)n[t].push(this,e)?n.splice(t,1):t++}this.Je=!0,this.tn=!1}pop(){for(let t=1;t>=-1;--t){const e=this.stack[this.stack.length-t-2];let n=0;for(;n<e.length;)e[n].pop(this,t)?e.splice(n,1):n++}this.stack.pop(),this.Je=!1}Zn(){this.pop()}Qn(t){this.Fn.pop(),this.On.pop(),this.Dn.pop(),this.Ln.pop(),this.pop(),this.jn()}}const Mt=[],Ut=["before","transclusion-before","footnote-call","footnote-marker","inner","first-letter","first-line","","transclusion-after","after"];var zt;!function(t){t[t.TOP=0]="TOP",t[t.SELECTOR=1]="SELECTOR",t[t.RULE=2]="RULE"}(zt||(zt={}));let Bt=null;function Ht(t){Bt=t}class $t extends o.f{constructor(t,e,n,i,s,r,o){super(t,e,o),this.condition=n,this.regionId=s,this.Jn=r,this.chain=null,this.specificity=0,this.ti=null,this.ei=0,this.pseudoelement=null,this.ni=!1,this.Be=null,this.cascade=i?i.cascade:Bt?Bt.clone():new Pt,this.state=zt.TOP}ii(t){this.cascade.He(this.cascade.tags,"*",t)}si(t){const e=H(this.chain,t);e!==t&&e.Ge(this.cascade)||this.ii(e)}ri(t){return this.state!=zt.TOP&&(this.oi(t),!0)}hi(t,e){(e||t)&&(this.specificity+=1,e&&t?this.chain.push(new Q(t,e.toLowerCase())):e?this.chain.push(new q(e.toLowerCase())):this.chain.push(new tt(t)))}li(t){if(this.pseudoelement)return c.b.warn(`::${this.pseudoelement}`,`followed by .${t}`),void this.chain.push(new mt(""));this.specificity+=256,this.chain.push(new W(t))}ci(t,e){if(this.pseudoelement)return c.b.warn(`::${this.pseudoelement}`,`followed by :${t}`),void this.chain.push(new mt(""));switch(t.toLowerCase()){case"enabled":this.chain.push(new ft);break;case"disabled":this.chain.push(new pt);break;case"checked":this.chain.push(new gt);break;case"root":this.chain.push(new at);break;case"link":this.chain.push(new q("a")),this.chain.push(new et("","href"));break;case"-adapt-href-epub-type":case"href-epub-type":if(e&&1==e.length&&"string"==typeof e[0]){const t=e[0],n=new RegExp(`(^|s)${s.s(t)}($|s)`);this.chain.push(new J(n))}else this.chain.push(new mt(""));break;case"-adapt-footnote-content":case"footnote-content":this.ni=!0;break;case"visited":case"active":case"hover":case"focus":this.chain.push(new mt(""));break;case"lang":if(e&&1==e.length&&"string"==typeof e[0]){const t=e[0];this.chain.push(new rt(new RegExp(`^${s.s(t.toLowerCase())}($|-)`)))}else this.chain.push(new mt(""));break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":{const n=Vt[t.toLowerCase()];e&&2==e.length?this.chain.push(new n(e[0],e[1])):this.chain.push(new mt(""));break}case"first-child":this.chain.push(new ot);break;case"last-child":this.chain.push(new ct(0,1));break;case"first-of-type":this.chain.push(new ht(0,1));break;case"last-of-type":this.chain.push(new ut(0,1));break;case"only-child":this.chain.push(new ot),this.chain.push(new ct(0,1));break;case"only-of-type":this.chain.push(new ht(0,1)),this.chain.push(new ut(0,1));break;case"empty":this.chain.push(new dt);break;case"before":case"after":case"first-line":case"first-letter":return void this.ai(t,e);default:c.b.warn(`unknown pseudo-class selector: ${t}`),this.chain.push(new mt(""))}this.specificity+=256}ai(t,e){switch(t){case"before":case"after":case"first-line":case"first-letter":case"footnote-call":case"footnote-marker":case"inner":case"after-if-continues":this.pseudoelement?(c.b.warn(`Double pseudoelement ::${this.pseudoelement}::${t}`),this.chain.push(new mt(""))):this.pseudoelement=t;break;case"first-n-lines":if(e&&1==e.length&&"number"==typeof e[0]){const n=Math.round(e[0]);if(n>0&&n==e[0]){this.pseudoelement?(c.b.warn(`Double pseudoelement ::${this.pseudoelement}::${t}`),this.chain.push(new mt(""))):this.pseudoelement=`first-${n}-lines`;break}}this.chain.push(new mt(""));break;case"nth-fragment":e&&2==e.length?this.Be=`NFS_${e[0]}_${e[1]}`:this.chain.push(new mt(""));break;default:c.b.warn(`Unrecognized pseudoelement: ::${t}`),this.chain.push(new mt(""))}this.specificity+=1}ui(t){this.specificity+=65536,this.chain.push(new Z(t))}fi(t,e,n,i){let r;switch(this.specificity+=256,e=e.toLowerCase(),i=i||"",n){case l.a.EOF:r=new et(t,e);break;case l.a.EQ:r=new nt(t,e,i);break;case l.a.TILDE_EQ:r=!i||i.match(/\s/)?new mt(""):new st(t,e,new RegExp(`(^|\\s)${s.s(i)}($|\\s)`));break;case l.a.BAR_EQ:r=new st(t,e,new RegExp(`^${s.s(i)}($|-)`));break;case l.a.HAT_EQ:r=i?new st(t,e,new RegExp(`^${s.s(i)}`)):new mt("");break;case l.a.DOLLAR_EQ:r=i?new st(t,e,new RegExp(`${s.s(i)}$`)):new mt("");break;case l.a.STAR_EQ:r=i?new st(t,e,new RegExp(s.s(i))):new mt("");break;case l.a.COL_COL:"supported"==i?r=new it(t,e):(c.b.warn("Unsupported :: attr selector op:",i),r=new mt(""));break;default:c.b.warn("Unsupported attr selector:",n),r=new mt("")}this.chain.push(r)}di(){const t=`d${Gt++}`;this.si(new j(new vt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}pi(){const t=`c${Gt++}`;this.si(new j(new yt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}gi(){const t=`a${Gt++}`;this.si(new j(new Tt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}mi(){const t=`f${Gt++}`;this.si(new j(new Nt(t,this.Be,null))),this.chain=[new mt(t)],this.Be=null}bi(){this.wi(),this.pseudoelement=null,this.ni=!1,this.specificity=0,this.chain=[]}Ei(){this.ri("E_CSS_UNEXPECTED_SELECTOR")||(this.state=zt.SELECTOR,this.ti={},this.pseudoelement=null,this.specificity=0,this.ni=!1,this.chain=[])}error(t,e){super.error(t,e),this.state==zt.SELECTOR&&(this.state=zt.TOP)}xi(t){super.xi(t),this.state=zt.TOP}yi(){this.wi(),super.yi(),this.state==zt.SELECTOR&&(this.state=zt.TOP)}ki(){super.ki(),this.Si=zt.TOP}wi(){if(this.chain){const t=this.specificity+this.cascade.Nn();this.si(this.Ti(t)),this.chain=null,this.pseudoelement=null,this.Be=null,this.ni=!1,this.specificity=0}}Ti(t){let e=this.regionId;return this.ni&&(e=e?"xxx-bogus-xxx":"footnote"),new Y(this.ti,t,this.pseudoelement,e,this.Be)}special(t,e){let n;n=this.condition?new I(e,0,this.condition):new x(e,0),U(this.ti,t).push(n)}property(t,e,n){this.Jn.Ni(t,e,n,this)}Ci(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Pi(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}Ri(t,e,n){"display"!=t||e!==r.t.oeb_page_head&&e!==r.t.oeb_page_foot||(this.Ri("flow-options",new r.j([r.t.exclusive,r.t._static]),n),this.Ri("flow-into",e,n),e=r.t.block),d.b("SIMPLE_PROPERTY").forEach(i=>{const s=i({name:t,value:e,important:n});t=s.name,e=s.value,n=s.important});const i=n?this._i():this.Ai(),s=this.condition?new I(e,i,this.condition):new x(e,i);L(this.ti,t,s)}finish(){return this.cascade}Ii(t){switch(t){case"not":{const t=new jt(this);t.Ei(),this.owner.Fi(t);break}}}}const Vt={"nth-child":class extends lt{constructor(t,e){super(t,e)}apply(t){this.en(t.rn)&&this.chained.apply(t)}ve(){return 5}},"nth-of-type":ht,"nth-last-child":ct,"nth-last-of-type":ut};let Gt=0;class jt extends $t{constructor(t){super(t.scope,t.owner,t.condition,t,t.regionId,t.Jn,!1),this.parent=t,this.Oi=t.chain}Ii(t){"not"==t&&this.oi("E_CSS_UNEXPECTED_NOT")}yi(){this.oi("E_CSS_UNEXPECTED_RULE_BODY")}bi(){this.oi("E_CSS_UNEXPECTED_NEXT_SELECTOR")}Li(){this.chain&&this.chain.length>0&&this.Oi.push(new Et(this.chain)),this.parent.specificity+=this.specificity,this.owner.Mi()}error(t,e){super.error(t,e),this.owner.Mi()}}class Xt extends o.f{constructor(t,e){super(t,e,!1)}property(t,e,n){if(this.scope.values[t])this.error(`E_CSS_NAME_REDEFINED ${t}`,this.Di());else{const n=t.match(/height|^(top|bottom)$/)?"vh":"vw",i=new h.x(this.scope,100,n);this.scope.Zt(t,e.st(this.scope,i))}}}class Yt extends o.f{constructor(t,e,n,i,s){super(t,e,!1),this.condition=n,this.ti=i,this.Jn=s,this.order=0}property(t,e,n){n?c.b.warn("E_IMPORTANT_NOT_ALLOWED"):this.Jn.Ni(t,e,n,this)}Ci(t,e){c.b.warn("E_INVALID_PROPERTY_VALUE",`${t}:`,e.toString())}Pi(t,e){c.b.warn("E_INVALID_PROPERTY",`${t}:`,e.toString())}Ri(t,e,n){let i=n?this._i():this.Ai();i+=this.order,this.order+=Lt;const s=this.condition?new I(e,i,this.condition):new x(e,i);L(this.ti,t,s)}}class Kt extends o.b{constructor(t,e){super(t),this.Jn=e,this.ti={},this.order=0}property(t,e,n){this.Jn.Ni(t,e,n,this)}Ci(t,e){c.b.warn("E_INVALID_PROPERTY_VALUE",`${t}:`,e.toString())}Pi(t,e){c.b.warn("E_INVALID_PROPERTY",`${t}:`,e.toString())}Ri(t,e,n){let i=n?o.e:o.d;i+=this.order,this.order+=Lt;const s=new x(e,i);L(this.ti,t,s)}}function Wt(t,e){const n=F(t);n&&n.forEach(t=>{t.matcher.matches()&&e(t.styles)})}function Zt(t,e,n){Wt(n,n=>{ne(t,n,e)})}function qt(t,e,n,i){const s=new Kt(t,e),r=new l.b(i,s);try{o.j(r,s,n)}catch(t){c.b.warn(t,"Style attribute parse error:")}return s.ti}function Qt(t,e,n){const i=t["writing-mode"];if(i){const t=i.evaluate(e,"writing-mode");if(t&&t!==r.t.inherit)return t===r.t.vertical_rl}return n}function Jt(t,e,n){const i=t.direction;if(i){const t=i.evaluate(e,"direction");if(t&&t!==r.t.inherit)return t===r.t.rtl}return n}function te(t,e,n,i,s){const r={};for(const e in t)A(e)&&(r[e]=D(t,e));return Zt(r,e,t),ee(t,n,i,(t,n)=>{ne(r,n,e),Zt(r,e,n)}),r}function ee(t,e,n,i){const s=R(t,"_regions");if((e||n)&&s){if(n){const t=["footnote"];e=e?e.concat(t):t}for(const t of e){const e=s[t];e&&i(t,e)}}}function ne(t,e,n){for(const i in e)if(A(i)){const s=D(e,i),r=t[i];t[i]=C(n,r,s)}}const ie=(t,e,n,i,s)=>{const r=n?i?N:y:i?S:T;for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];if(!i)continue;const o=r[n];let a;if(o){const e=t[o];if(e&&e.priority>i.priority)continue;a=w[o]?o:n}else a=n;e[a]=s(n,i)}}},function(t,e,n){"use strict";var i;function s(t){const e=Array.from(t);let n=null;return e[0]instanceof Error&&(n=e.shift()),{error:n,messages:e}}function r(t){const e=t.error,n=e&&(e.frameTrace||e.stack);let i=[].concat(t.messages);return e&&(i.length>0&&(i=i.concat(["\n"])),i=i.concat([e.toString()]),n&&(i=i.concat(["\n"]).concat(n))),i}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"}(i||(i={}));const o=new class{constructor(t){this.opt_console=t,this.listeners={}}$i(t){this.opt_console?this.opt_console.debug?this.opt_console.debug(...t):this.opt_console.log(...t):console.debug(...t)}Bi(t){this.opt_console?this.opt_console.info?this.opt_console.info(...t):this.opt_console.log(...t):console.info(...t)}Ui(t){this.opt_console?this.opt_console.warn?this.opt_console.warn(...t):this.opt_console.log(...t):console.warn(...t)}Gi(t){this.opt_console?this.opt_console.error?this.opt_console.error(...t):this.opt_console.log(...t):console.error(...t)}zi(t,e){const n=this.listeners[t];n&&n.forEach(t=>{t(e)})}addListener(t,e){let n=this.listeners[t];n||(n=this.listeners[t]=[]),n.push(e)}debug(...t){const e=s(arguments);this.$i(r(e)),this.zi(i.DEBUG,e)}info(...t){const e=s(arguments);this.Bi(r(e)),this.zi(i.INFO,e)}warn(...t){const e=s(arguments);this.Ui(r(e)),this.zi(i.WARN,e)}error(...t){const e=s(arguments);this.Gi(r(e)),this.zi(i.ERROR,e)}}},function(t,e,n){"use strict";function i(t){}function s(t){}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})},function(t,e,n){"use strict";n.d(e,"s",function(){return f}),n.d(e,"t",function(){return p}),n.d(e,"d",function(){return g}),n.d(e,"l",function(){return E}),n.d(e,"m",function(){return w}),n.d(e,"z",function(){return y}),n.d(e,"p",function(){return T}),n.d(e,"f",function(){return N}),n.d(e,"g",function(){return S}),n.d(e,"r",function(){return x}),n.d(e,"q",function(){return I}),n.d(e,"u",function(){return O}),n.d(e,"w",function(){return _}),n.d(e,"x",function(){return A}),n.d(e,"v",function(){return k}),n.d(e,"o",function(){return D}),n.d(e,"n",function(){return L}),n.d(e,"e",function(){return P}),n.d(e,"k",function(){return F}),n.d(e,"a",function(){return M}),n.d(e,"h",function(){return U}),n.d(e,"i",function(){return z}),n.d(e,"j",function(){return B}),n.d(e,"b",function(){return H}),n.d(e,"c",function(){return $}),n.d(e,"y",function(){return V});var i=n(7),s=n(1),r=n(0),o=n(10),a=n(20),l=n(2),h=n(27),c=n(4),u=n(11),d=n(15);const f={transform:!0,"transform-origin":!0},p={top:!0,bottom:!0,left:!0,right:!0};class g{constructor(t,e,n){this.target=t,this.name=e,this.value=n}}const m={show:function(t){t.style.visibility="visible"},hide:function(t){t.style.visibility="hidden"},play:function(t){t.currentTime=0,t.play()},pause:function(t){t.pause()},resume:function(t){t.play()},mute:function(t){t.muted=!0},unmute:function(t){t.muted=!1}};function b(t,e){const n=m[e];return n?()=>{for(let e=0;e<t.length;e++)try{n(t[e])}catch(t){}}:null}class E extends s.c{constructor(t,e){super(),this.container=t,this.Hi=e,this.Vi=null,this.ji=[],this.Xi={},this.dimensions={width:0,height:0},this.Wi=!1,this.Yi=!1,this.qi=!0,this.Ki=!0,this.Zi=0,this.position=null,this.offset=-1,this.side=null,this.fetchers=[],this.Qi={top:{},bottom:{},left:{},right:{}};const n=this;this.Ji=(t=>{const e=t.currentTarget,i=e.getAttribute("href")||e.getAttributeNS(s.a.XLINK,"href");if(i){const s={type:"hyperlink",target:null,currentTarget:null,ts:e,href:i,preventDefault(){t.preventDefault()}};n.dispatchEvent(s)}})}es(t){this.qi=t,t?this.container.setAttribute(E.AUTO_PAGE_WIDTH_ATTRIBUTE,"true"):this.container.removeAttribute(E.AUTO_PAGE_WIDTH_ATTRIBUTE)}ss(t){this.Ki=t,t?this.container.setAttribute(E.AUTO_PAGE_HEIGHT_ATTRIBUTE,"true"):this.container.removeAttribute(E.AUTO_PAGE_HEIGHT_ATTRIBUTE)}rs(t,e){const n=this.Xi[e];n?n.push(t):this.Xi[e]=[t]}finish(t,e){Object.keys(this.Xi).forEach(t=>{const e=this.Xi[t];for(let t=0;t<e.length;)this.container.contains(e[t])?t++:e.splice(t,1);0===e.length&&delete this.Xi[t]});const n=this.ji;for(let t=0;t<n.length;t++){const e=n[t];(e.target!==this.container||"transform"!==e.name||this.qi||this.Ki)&&s.F(e.target,e.name,e.value.toString())}const i=e.os(this.container);this.dimensions.width=i.width,this.dimensions.height=i.height;for(let e=0;e<t.length;e++){const n=t[e],i=this.Xi[n.ref],s=this.Xi[n.observer];if(i&&s){const t=b(i,n.action);if(t)for(let e=0;e<s.length;e++)s[e].addEventListener(n.event,t,!1)}}}zoom(t){s.F(this.container,"transform",`scale(${t})`)}hs(){return this.Vi||this.container}}E.AUTO_PAGE_WIDTH_ATTRIBUTE="data-vivliostyle-auto-page-width",E.AUTO_PAGE_HEIGHT_ATTRIBUTE="data-vivliostyle-auto-page-height";const w="data-adapt-spec",v=d.f.Whitespace;function y(t){switch(t){case"normal":case"nowrap":return v.IGNORE;case"pre-line":return v.NEWLINE;case"pre":case"pre-wrap":return v.PRESERVE;default:return null}}function T(t,e){if(1==t.nodeType)return!1;const n=t.textContent;switch(e){case v.IGNORE:return!!n.match(/^\s*$/);case v.NEWLINE:return!!n.match(/^[ \t\f]*$/);case v.PRESERVE:return 0==n.length}throw new Error(`Unexpected whitespace: ${e}`)}class N{constructor(t,e){this.ls=t,this.cs=e,this.as=[],this.us=null}}class S{constructor(t,e,n,i,s,r,o,a,l){this.ls=t,this.element=e,this.startOffset=n,this.priority=i,this.linger=s,this.exclusive=r,this.repeated=o,this.last=a,this.breakBefore=l,this.startPage=-1}fs(t){return!!this.exclusive&&(!t.exclusive||this.priority>t.priority||this.last)}}function x(t,e){return t.top-e.top}function I(t,e){return e.right-t.right}function C(t,e){return t===e||!(!t||!e)&&t.node===e.node&&t.ds===e.ds&&R(t.ps,e.ps)&&R(t.gs,e.gs)&&C(t.bs,e.bs)}function O(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.ws!==e.ws||t.after!==e.after||t.steps.length!==e.steps.length)return!1;for(let n=0;n<t.steps.length;n++)if(!C(t.steps[n],e.steps[n]))return!1;return!0}function _(t){return{steps:[{node:t,ds:D.NONE,ps:null,gs:null,bs:null,us:null,Es:0}],ws:0,after:!1,xs:null}}function A(t,e){return{steps:[{node:t.ys,ds:D.NONE,ps:t.ps,gs:null,bs:null,us:null,Es:null!=e?e:t.Es}],ws:0,after:!1,xs:t.xs}}function k(t,e){const n=new F(t.node,e,0);return n.ds=t.ds,n.ps=t.ps,n.gs=t.gs,n.bs=t.bs?k(t.bs,e.copy()):null,n.us=t.us,n.Es=t.Es+1,n}const D=d.f.ShadowType;class L{constructor(t,e,n,i,s,r,o){this.owner=t,this.root=e,this.xmldoc=n,this.ks=i,this.type=r,this.styler=o,this.Ss=null,s&&(s.Ss=this)}equals(t){return!!t&&this.owner===t.owner&&this.xmldoc===t.xmldoc&&this.type===t.type&&R(this.ks,t.ks)}}function R(t,e){return t===e||!!t&&!!e&&t.equals(e)}class P{constructor(t,e){this.outer=t,this.count=e}}class F{constructor(t,e,n){this.ys=t,this.parent=e,this.vs=n,this.ws=0,this.after=!1,this.gs=null,this.bs=null,this.shared=!1,this.inline=!0,this.overflow=!1,this.display=null,this.Ts=null,this.Ns=null,this.Cs=null,this.columnSpan=null,this.verticalAlign="baseline",this.captionSide="top",this.Ps=0,this.Rs=0,this._s=!1,this.As=!1,this.Is=!1,this.breakBefore=null,this.breakAfter=null,this.Fs=null,this.Os=null,this.lang=null,this.xs=null,this.Ls=null,this.Ms={},this.Es=1,this.Ds=null,this.$s=null,this.ds=D.NONE,this.ps=e?e.ps:null,this.Bs=e?e.Bs:0,this.Us=d.b.FloatReference.INLINE,this.whitespace=e?e.whitespace:v.IGNORE,this.Gs=e?e.Gs:null,this.zs=!!e&&e.zs,this.Hs=e?e.Hs:{},this.vertical=!!e&&e.vertical,this.direction=e?e.direction:"ltr",this.Vs=e?e.Vs:null,this.us=e?e.us:null}js(){this.inline=!0,this.Bs=this.parent?this.parent.Bs:0,this.Fs=null,this.Os=null,this.ws=0,this.after=!1,this.display=null,this.Us=d.b.FloatReference.INLINE,this.Ts=null,this.Ns=null,this.Cs=null,this.columnSpan=null,this.verticalAlign="baseline",this._s=!1,this.whitespace=this.parent?this.parent.whitespace:v.IGNORE,this.Gs=this.parent?this.parent.Gs:null,this.zs=!!this.parent&&this.parent.zs,this.breakBefore=null,this.breakAfter=null,this.gs=null,this.As=!1,this.Is=!1,this.vertical=!!this.parent&&this.parent.vertical,this.gs=null,this.xs=null,this.us=this.parent?this.parent.us:null,this.Ls=null,this.Ms={},this.Es=1,this.Ds=null,this.$s=null}Xs(){const t=new F(this.ys,this.parent,this.vs);return t.ws=this.ws,t.after=this.after,t.gs=this.gs,t.ds=this.ds,t.ps=this.ps,t.bs=this.bs,t.inline=this.inline,t.Bs=this.Bs,t.display=this.display,t.Us=this.Us,t.Ts=this.Ts,t.Ns=this.Ns,t.Cs=this.Cs,t.columnSpan=this.columnSpan,t.verticalAlign=this.verticalAlign,t.captionSide=this.captionSide,t.Ps=this.Ps,t.Rs=this.Rs,t.As=this.As,t.Is=this.Is,t._s=this._s,t.whitespace=this.whitespace,t.Gs=this.Gs,t.zs=this.zs,t.breakBefore=this.breakBefore,t.breakAfter=this.breakAfter,t.Fs=this.Fs,t.Os=this.Os,t.Vs=this.Vs,t.vertical=this.vertical,t.overflow=this.overflow,t.xs=this.xs,t.us=this.us,t.Ls=this.Ls,t.Ms=Object.create(this.Ms),t.Es=this.Es,t.Ds=this.Ds,t.$s=this.$s,t}modify(){return this.shared?this.Xs():this}copy(){let t=this;do{if(t.shared)break;t.shared=!0,t=t.parent}while(t);return this}clone(){const t=this.Xs();let e,n=t;for(;null!=(e=n.parent);)e=e.Xs(),n.parent=e,n=e;return t}Ws(){return{node:this.ys,ds:this.ds,ps:this.ps,gs:this.gs,bs:this.bs?this.bs.Ws():null,us:this.us,Es:this.Es}}Ys(){let t=this;const e=[];do{t.Vs&&t.parent&&t.parent.Vs!==t.Vs||e.push(t.Ws()),t=t.parent}while(t);return{steps:e,ws:this.xs?h.c(this.xs,this.ws):this.ws,after:this.after,xs:this.xs}}qs(){let t=this.parent;for(;t;){if(t.As)return!0;t=t.parent}return!1}Ks(){let t=this.parent;for(;t;){if(t.Is)return t;t=t.parent}return null}Zs(t){let e=this;for(;e;)e.inline||t(e),e=e.parent}Qs(t){return this.us===t&&!!this.parent&&this.parent.us===t}}class M{constructor(t){this.primary=t,this.floats=null}clone(){const t=new M(this.primary);if(this.floats){t.floats=[];for(let e=0;e<this.floats.length;++e)t.floats[e]=this.floats[e]}return t}Js(t){if(!t)return!1;if(this===t)return!0;if(!O(this.primary,t.primary))return!1;if(this.floats){if(!t.floats||this.floats.length!==t.floats.length)return!1;for(let e=0;e<this.floats.length;e++)if(!O(this.floats[e],t.floats[e]))return!1}else if(t.floats)return!1;return!0}}class U{constructor(t,e){this.er=t,this.nr=e}clone(){return new U(this.er.clone(),this.nr)}Js(t){return!!t&&(this===t||this.er.Js(t.er))}}class z{constructor(){this.positions=[],this.ir="any",this.breakAfter=null}clone(){const t=new z,e=this.positions,n=t.positions;for(let t=0;t<e.length;t++)n[t]=e[t].clone();return t.ir=this.ir,t.breakAfter=this.breakAfter,t}Js(t){if(this===t)return!0;if(!t||this.positions.length!==t.positions.length)return!1;for(let e=0;e<this.positions.length;e++)if(!this.positions[e].Js(t.positions[e]))return!1;return!0}sr(t){return this.positions.length>0&&this.positions[0].nr.startOffset<=t}}class B{constructor(){this.page=0,this.flows={},this.rr={},this.or=0}clone(){const t=new B;t.page=this.page,t.hr=this.hr,t.or=this.or,t.lr=this.lr,t.flows=this.flows;for(const e in this.rr)t.rr[e]=this.rr[e].clone();return t}Js(t){if(this===t)return!0;if(!t||this.page!==t.page||this.or!==t.or)return!1;const e=Object.keys(this.rr),n=Object.keys(t.rr);if(e.length!==n.length)return!1;for(const n of e)if(!this.rr[n].Js(t.rr[n]))return!1;return!0}sr(t,e){const n=this.rr[t];return!!n&&n.sr(e)}cr(t){const e=this.rr[t];return e?e.ir:"any"}ar(t){const e=this.rr[t];if(!e)return null;const n=e.positions[0];return n?n.nr:null}}class H{constructor(t){this.element=t,this.left=0,this.top=0,this.marginLeft=0,this.marginRight=0,this.marginTop=0,this.marginBottom=0,this.borderLeft=0,this.borderRight=0,this.borderTop=0,this.borderBottom=0,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.width=0,this.height=0,this.ur=0,this.dr=0,this.exclusions=null,this.pr=null,this.gr=0,this.mr=0,this.br=0,this.wr=0,this.Er=0,this.vertical=!1}xr(){return this.marginTop+this.borderTop+this.paddingTop}yr(){return this.marginBottom+this.borderBottom+this.paddingBottom}kr(){return this.marginLeft+this.borderLeft+this.paddingLeft}Sr(){return this.marginRight+this.borderRight+this.paddingRight}vr(){return this.vertical?this.Sr():this.xr()}Tr(){return this.vertical?this.kr():this.yr()}Nr(){return this.vertical?this.xr():this.kr()}Cr(){return this.vertical?this.yr():this.Sr()}Pr(t){return this.vertical?t.right:t.top}Rr(t){return this.vertical?t.left:t.bottom}_r(t){return this.vertical?t.top:t.left}Ar(t){return this.vertical?t.bottom:t.right}Ir(t){return this.vertical?t.bottom-t.top:t.right-t.left}Fr(t){return this.vertical?t.right-t.left:t.bottom-t.top}Or(){return this.vertical?-1:1}Lr(){return 1}Mr(t){this.element=t.element,this.left=t.left,this.top=t.top,this.marginLeft=t.marginLeft,this.marginRight=t.marginRight,this.marginTop=t.marginTop,this.marginBottom=t.marginBottom,this.borderLeft=t.borderLeft,this.borderRight=t.borderRight,this.borderTop=t.borderTop,this.borderBottom=t.borderBottom,this.paddingLeft=t.paddingLeft,this.paddingRight=t.paddingRight,this.paddingTop=t.paddingTop,this.paddingBottom=t.paddingBottom,this.width=t.width,this.height=t.height,this.ur=t.ur,this.dr=t.dr,this.pr=t.pr,this.exclusions=t.exclusions,this.gr=t.gr,this.mr=t.mr,this.br=t.br,this.vertical=t.vertical}Dr(t,e){this.top=t,this.height=e,s.F(this.element,"top",`${t}px`),s.F(this.element,"height",`${e}px`)}$r(t,e){this.left=t,this.width=e,s.F(this.element,"left",`${t}px`),s.F(this.element,"width",`${e}px`)}Br(t,e){this.vertical?this.$r(t+e*this.Or(),e):this.Dr(t,e)}Ur(t,e){this.vertical?this.Dr(t,e):this.$r(t,e)}clear(){const t=this.element;let e;for(;e=t.lastChild;)t.removeChild(e)}Gr(){const t=this.zr();return this.pr?this.pr.Hr(t.x1,t.y1):u.k(t.x1,t.y1,t.x2,t.y2)}zr(){const t=this.ur+this.left+this.kr(),e=this.dr+this.top+this.xr();return new u.c(t,e,t+this.width,e+this.height)}Vr(){const t=this.ur+this.left+this.marginLeft+this.borderLeft,e=this.dr+this.top+this.marginTop+this.borderTop,n=this.paddingLeft+this.width+this.paddingRight,i=this.paddingTop+this.height+this.paddingBottom;return new u.c(t,e,t+n,e+i)}jr(t,e){const n=this.Xr();return a.e(t,n.x1,n.y1,n.x2-n.x1,n.y2-n.y1,e)}Xr(){const t=this.ur+this.left,e=this.dr+this.top,n=this.kr()+this.width+this.Sr(),i=this.xr()+this.height+this.yr();return new u.c(t,e,t+n,e+i)}}class $ extends r.m{constructor(t,e,n,i){super(),this.elem=t,this.context=e,this.Wr=n,this.Yr=i}qr(t,e){e||(e=this.elem.ownerDocument.createTextNode(t)),this.elem.appendChild(e)}_(t){return this.qr(t.str),null}Y(t){if(this.Wr.url)this.elem.setAttribute("src",t.url);else{const e=this.elem.ownerDocument.createElementNS(s.a.XHTML,"img");e.setAttribute("src",t.url),this.elem.appendChild(e)}return null}Z(t){return this.S(t.values),null}nt(t){const e=t.st();let n=e.evaluate(this.context);if("string"==typeof n){e instanceof c.s&&(n=o.m(e.scope,new l.b(n,null),"").stringValue()),i.a(this.elem.ownerDocument);const t=this.Yr(e,n,this.elem.ownerDocument);this.qr(n,t)}return null}}function V(t){return null!=t&&t!==r.t.normal&&t!==r.t.none&&t!==r.t.inherit}},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return l});var i,s=n(6);!function(t){t.SIMPLE_PROPERTY="SIMPLE_PROPERTY",t.PREPROCESS_SINGLE_DOCUMENT="PREPROCESS_SINGLE_DOCUMENT",t.PREPROCESS_TEXT_CONTENT="PREPROCESS_TEXT_CONTENT",t.PREPROCESS_ELEMENT_STYLE="PREPROCESS_ELEMENT_STYLE",t.POLYFILLED_INHERITED_PROPS="POLYFILLED_INHERITED_PROPS",t.CONFIGURATION="CONFIGURATION",t.RESOLVE_TEXT_NODE_BREAKER="RESOLVE_TEXT_NODE_BREAKER",t.RESOLVE_FORMATTING_CONTEXT="RESOLVE_FORMATTING_CONTEXT",t.RESOLVE_LAYOUT_PROCESSOR="RESOLVE_LAYOUT_PROCESSOR",t.POST_LAYOUT_BLOCK="POST_LAYOUT_BLOCK"}(i||(i={}));const r={};function o(t,e){if(i[t]){let n=r[t];n||(n=r[t]=[]),n.push(e)}else s.b.warn(new Error(`Skipping unknown plugin hook '${t}'.`))}function a(t){return r[t]||[]}const l={Kr:o,Zr:function(t,e){if(i[t]){const n=r[t];if(n){const t=n.indexOf(e);t>=0&&n.splice(t,1)}}else s.b.warn(new Error(`Ignoring unknown plugin hook '${t}'.`))}}},function(t,e,n){"use strict";n.d(e,"c",function(){return d}),n.d(e,"d",function(){return f}),n.d(e,"e",function(){return p}),n.d(e,"g",function(){return b}),n.d(e,"h",function(){return E}),n.d(e,"a",function(){return v}),n.d(e,"f",function(){return T}),n.d(e,"b",function(){return B}),n.d(e,"k",function(){return $}),n.d(e,"l",function(){return V}),n.d(e,"m",function(){return G}),n.d(e,"j",function(){return j}),n.d(e,"i",function(){return Y});var i=n(1),s=n(0),r=n(2),o=n(4),a=n(6),l=n(16),h=n(3);const c=0,u=16777216,d=33554432,f=50331648,p=67108864,g=83886080,m=100663296;var b;function E(t){let e=parseInt(t,16);if(isNaN(e))throw new Error("E_CSS_COLOR");if(6==t.length)return new s.a(e);if(3==t.length)return e=15&e|(15&e)<<4|(240&e)<<4|(240&e)<<8|(3840&e)<<8|(3840&e)<<12,new s.a(e);throw new Error("E_CSS_COLOR")}!function(t){t.USER_AGENT="UA",t.USER="User",t.AUTHOR="Author"}(b||(b={}));class w{constructor(t){this.scope=t,this.flavor=b.AUTHOR}Di(){return null}Qr(){return this.scope}error(t,e){}xi(t){this.flavor=t}hi(t,e){}li(t){}ci(t,e){}ai(t,e){}ui(t){}fi(t,e,n,i){}di(){}pi(){}gi(){}mi(){}bi(){}Ei(){}Jr(){}eo(t){}no(){}io(){}so(){}ro(){}oo(t){}ho(t){}lo(t){this.ho(t)}co(t){}ao(){}uo(t,e,n){}fo(t,e,n){}do(t,e,n){}yi(){}property(t,e,n){}ki(){}Ii(t){}Li(){}_i(){switch(this.flavor){case b.USER_AGENT:return c;case b.USER:return m;default:return g}}Ai(){switch(this.flavor){case b.USER_AGENT:return c;case b.USER:return u;default:return d}}}class v extends w{constructor(){super(null),this.stack=[],this.tokenizer=null,this.slave=null}Fi(t){this.stack.push(this.slave),this.slave=t}Mi(){this.slave=this.stack.pop()}Di(){return this.tokenizer?this.tokenizer.token():null}Qr(){return this.slave.Qr()}error(t,e){this.slave.error(t,e)}po(t,e){a.b.warn(t)}xi(t){super.xi(t),this.stack.length>0&&(this.slave=this.stack[0],this.stack=[]),this.slave.xi(t)}hi(t,e){this.slave.hi(t,e)}li(t){this.slave.li(t)}ci(t,e){this.slave.ci(t,e)}ai(t,e){this.slave.ai(t,e)}ui(t){this.slave.ui(t)}fi(t,e,n,i){this.slave.fi(t,e,n,i)}di(){this.slave.di()}pi(){this.slave.pi()}gi(){this.slave.gi()}mi(){this.slave.mi()}bi(){this.slave.bi()}Ei(){this.slave.Ei()}Jr(){this.slave.Jr()}eo(t){this.slave.eo(t)}no(){this.slave.no()}io(){this.slave.io()}so(){this.slave.so()}ro(){this.slave.ro()}oo(t){this.slave.oo(t)}ho(t){this.slave.ho(t)}co(t){this.slave.co(t)}ao(){this.slave.ao()}uo(t,e,n){this.slave.uo(t,e,n)}fo(t,e,n){this.slave.fo(t,e,n)}do(t,e,n){this.slave.do(t,e,n)}yi(){this.slave.yi()}property(t,e,n){this.slave.property(t,e,n)}ki(){this.slave.ki()}Ii(t){this.slave.Ii(t)}Li(){this.slave.Li()}}class y extends w{constructor(t,e,n){super(t),this.owner=e,this.mo=n,this.depth=0,e&&(this.flavor=e.flavor)}Di(){return this.owner.Di()}error(t,e){this.owner.po(t,e)}yi(){this.depth++}ki(){0!=--this.depth||this.mo||this.owner.Mi()}}class T extends y{constructor(t,e,n){super(t,e,n)}report(t){this.error(t,this.Di())}oi(t){this.report(t),this.owner.Fi(new y(this.scope,this.owner,!1))}Ei(){this.oi("E_CSS_UNEXPECTED_SELECTOR")}Jr(){this.oi("E_CSS_UNEXPECTED_FONT_FACE")}eo(t){this.oi("E_CSS_UNEXPECTED_FOOTNOTE")}no(){this.oi("E_CSS_UNEXPECTED_VIEWPORT")}io(){this.oi("E_CSS_UNEXPECTED_DEFINE")}so(){this.oi("E_CSS_UNEXPECTED_REGION")}ro(){this.oi("E_CSS_UNEXPECTED_PAGE")}ho(t){this.oi("E_CSS_UNEXPECTED_WHEN")}co(t){this.oi("E_CSS_UNEXPECTED_FLOW")}ao(){this.oi("E_CSS_UNEXPECTED_PAGE_TEMPLATE")}uo(t,e,n){this.oi("E_CSS_UNEXPECTED_PAGE_MASTER")}fo(t,e,n){this.oi("E_CSS_UNEXPECTED_PARTITION")}do(t,e,n){this.oi("E_CSS_UNEXPECTED_PARTITION_GROUP")}Ii(t){this.oi("E_CSS_UNEXPECTED_SELECTOR_FUNC")}Li(){this.oi("E_CSS_UNEXPECTED_END_SELECTOR_FUNC")}property(t,e,n){this.error("E_CSS_UNEXPECTED_PROPERTY",this.Di())}}const N=[],S=[],x=[],I=[],C=[],O=[],_=[],A=[],k=[],D=[],L=[],R=[],P=[];var F;!function(t){t[t.SELECTOR_NAME_1=1]="SELECTOR_NAME_1",t[t.SELECTOR_NAME=2]="SELECTOR_NAME",t[t.SELECTOR_ANY_1=3]="SELECTOR_ANY_1",t[t.SELECTOR_ANY=4]="SELECTOR_ANY",t[t.SELECTOR_ID_1=5]="SELECTOR_ID_1",t[t.SELECTOR_ID=6]="SELECTOR_ID",t[t.SELECTOR_CLASS_1=7]="SELECTOR_CLASS_1",t[t.SELECTOR_CLASS=8]="SELECTOR_CLASS",t[t.SELECTOR_ATTR_1=9]="SELECTOR_ATTR_1",t[t.SELECTOR_ATTR=10]="SELECTOR_ATTR",t[t.SELECTOR_CHILD=11]="SELECTOR_CHILD",t[t.SELECTOR_SIBLING=12]="SELECTOR_SIBLING",t[t.SELECTOR_BODY=13]="SELECTOR_BODY",t[t.SELECTOR_PSEUDOCLASS=14]="SELECTOR_PSEUDOCLASS",t[t.VAL_IDENT=15]="VAL_IDENT",t[t.VAL_HASH=16]="VAL_HASH",t[t.VAL_NUM=17]="VAL_NUM",t[t.VAL_INT=18]="VAL_INT",t[t.VAL_NUMERIC=19]="VAL_NUMERIC",t[t.VAL_STR=20]="VAL_STR",t[t.VAL_URL=21]="VAL_URL",t[t.VAL_COMMA=22]="VAL_COMMA",t[t.VAL_SLASH=23]="VAL_SLASH",t[t.VAL_FUNC=24]="VAL_FUNC",t[t.VAL_C_PAR=25]="VAL_C_PAR",t[t.VAL_END=26]="VAL_END",t[t.RULE_END=27]="RULE_END",t[t.IDENT=28]="IDENT",t[t.SELECTOR_START=29]="SELECTOR_START",t[t.AT=30]="AT",t[t.EXPR_IDENT=31]="EXPR_IDENT",t[t.EXPR_NUM=32]="EXPR_NUM",t[t.EXPR_NUMERIC=33]="EXPR_NUMERIC",t[t.EXPR_STR=34]="EXPR_STR",t[t.EXPR_PARAM=35]="EXPR_PARAM",t[t.EXPR_PREFIX=36]="EXPR_PREFIX",t[t.EXPR_INFIX=37]="EXPR_INFIX",t[t.EXPR_FUNC=38]="EXPR_FUNC",t[t.EXPR_C_PAR=39]="EXPR_C_PAR",t[t.EXPR_O_PAR=40]="EXPR_O_PAR",t[t.SELECTOR_NEXT=41]="SELECTOR_NEXT",t[t.SELECTOR_PSEUDOELEM=42]="SELECTOR_PSEUDOELEM",t[t.EXPR_O_BRC=43]="EXPR_O_BRC",t[t.VAL_FINISH=44]="VAL_FINISH",t[t.EXPR_INFIX_NAME=45]="EXPR_INFIX_NAME",t[t.PROP=46]="PROP",t[t.VAL_BANG=47]="VAL_BANG",t[t.VAL_BRC=48]="VAL_BRC",t[t.EXPR_SEMICOL=49]="EXPR_SEMICOL",t[t.ERROR_PUSH=50]="ERROR_PUSH",t[t.ERROR_POP=51]="ERROR_POP",t[t.ERROR_POP_DECL=52]="ERROR_POP_DECL",t[t.ERROR_SEMICOL=53]="ERROR_SEMICOL",t[t.VAL_PLUS=54]="VAL_PLUS",t[t.SELECTOR_PSEUDOCLASS_1=55]="SELECTOR_PSEUDOCLASS_1",t[t.SELECTOR_FOLLOWING_SIBLING=56]="SELECTOR_FOLLOWING_SIBLING",t[t.DONE=200]="DONE"}(F||(F={}));const M=r.a.LAST+1;var U;N[r.a.IDENT]=F.IDENT,N[r.a.STAR]=F.SELECTOR_START,N[r.a.HASH]=F.SELECTOR_START,N[r.a.CLASS]=F.SELECTOR_START,N[r.a.O_BRK]=F.SELECTOR_START,N[r.a.COLON]=F.SELECTOR_START,N[r.a.AT]=F.AT,N[r.a.C_BRC]=F.RULE_END,N[r.a.EOF]=F.DONE,S[r.a.IDENT]=F.PROP,S[r.a.EOF]=F.DONE,O[r.a.IDENT]=F.SELECTOR_NAME,O[r.a.STAR]=F.SELECTOR_ANY,O[r.a.HASH]=F.SELECTOR_ID,O[r.a.CLASS]=F.SELECTOR_CLASS,O[r.a.O_BRK]=F.SELECTOR_ATTR,O[r.a.COLON]=F.SELECTOR_PSEUDOCLASS,x[r.a.GT]=F.SELECTOR_CHILD,x[r.a.PLUS]=F.SELECTOR_SIBLING,x[r.a.TILDE]=F.SELECTOR_FOLLOWING_SIBLING,x[r.a.IDENT]=F.SELECTOR_NAME_1,x[r.a.STAR]=F.SELECTOR_ANY_1,x[r.a.HASH]=F.SELECTOR_ID_1,x[r.a.CLASS]=F.SELECTOR_CLASS_1,x[r.a.O_BRK]=F.SELECTOR_ATTR_1,x[r.a.O_BRC]=F.SELECTOR_BODY,x[r.a.COLON]=F.SELECTOR_PSEUDOCLASS_1,x[r.a.COL_COL]=F.SELECTOR_PSEUDOELEM,x[r.a.COMMA]=F.SELECTOR_NEXT,I[r.a.IDENT]=F.SELECTOR_NAME_1,I[r.a.STAR]=F.SELECTOR_ANY_1,I[r.a.HASH]=F.SELECTOR_ID_1,I[r.a.CLASS]=F.SELECTOR_CLASS_1,I[r.a.O_BRK]=F.SELECTOR_ATTR_1,I[r.a.C_PAR]=F.DONE,I[r.a.COLON]=F.SELECTOR_PSEUDOCLASS_1,C[r.a.IDENT]=F.SELECTOR_NAME,C[r.a.STAR]=F.SELECTOR_ANY,C[r.a.HASH]=F.SELECTOR_ID,C[r.a.CLASS]=F.SELECTOR_CLASS,C[r.a.COLON]=F.SELECTOR_PSEUDOCLASS,C[r.a.COL_COL]=F.SELECTOR_PSEUDOELEM,C[r.a.O_BRK]=F.SELECTOR_ATTR,C[r.a.O_BRC]=F.SELECTOR_BODY,_[r.a.IDENT]=F.VAL_IDENT,_[r.a.HASH]=F.VAL_HASH,_[r.a.NUM]=F.VAL_NUM,_[r.a.INT]=F.VAL_INT,_[r.a.NUMERIC]=F.VAL_NUMERIC,_[r.a.STR]=F.VAL_STR,_[r.a.URL]=F.VAL_URL,_[r.a.COMMA]=F.VAL_COMMA,_[r.a.SLASH]=F.VAL_SLASH,_[r.a.FUNC]=F.VAL_FUNC,_[r.a.C_PAR]=F.VAL_C_PAR,_[r.a.SEMICOL]=F.VAL_END,_[r.a.C_BRC]=F.VAL_BRC,_[r.a.BANG]=F.VAL_BANG,_[r.a.PLUS]=F.VAL_PLUS,_[r.a.EOF]=F.VAL_FINISH,A[r.a.IDENT]=F.EXPR_IDENT,A[r.a.NUM]=F.EXPR_NUM,A[r.a.INT]=F.EXPR_NUM,A[r.a.NUMERIC]=F.EXPR_NUMERIC,A[r.a.STR]=F.EXPR_STR,A[r.a.O_PAR]=F.EXPR_O_PAR,A[r.a.FUNC]=F.EXPR_FUNC,A[r.a.BANG]=F.EXPR_PREFIX,A[r.a.MINUS]=F.EXPR_PREFIX,A[r.a.DOLLAR]=F.EXPR_PARAM,k[r.a.IDENT]=F.EXPR_INFIX_NAME,k[r.a.COMMA]=F.EXPR_INFIX,k[r.a.GT]=F.EXPR_INFIX,k[r.a.LT]=F.EXPR_INFIX,k[r.a.GT_EQ]=F.EXPR_INFIX,k[r.a.LT_EQ]=F.EXPR_INFIX,k[r.a.EQ]=F.EXPR_INFIX,k[r.a.EQ_EQ]=F.EXPR_INFIX,k[r.a.BANG_EQ]=F.EXPR_INFIX,k[r.a.AMP_AMP]=F.EXPR_INFIX,k[r.a.BAR_BAR]=F.EXPR_INFIX,k[r.a.PLUS]=F.EXPR_INFIX,k[r.a.MINUS]=F.EXPR_INFIX,k[r.a.SLASH]=F.EXPR_INFIX,k[r.a.PERCENT]=F.EXPR_INFIX,k[r.a.STAR]=F.EXPR_INFIX,k[r.a.COLON]=F.EXPR_INFIX,k[r.a.QMARK]=F.EXPR_INFIX,k[r.a.C_PAR]=F.EXPR_C_PAR,k[r.a.O_BRC]=F.EXPR_O_BRC,k[r.a.SEMICOL]=F.EXPR_SEMICOL,D[r.a.EOF]=F.DONE,D[r.a.O_BRC]=F.ERROR_PUSH,D[r.a.C_BRC]=F.ERROR_POP,D[r.a.O_BRK]=F.ERROR_PUSH,D[r.a.C_BRK]=F.ERROR_POP,D[r.a.O_PAR]=F.ERROR_PUSH,D[r.a.C_PAR]=F.ERROR_POP,D[r.a.SEMICOL]=F.ERROR_SEMICOL,L[r.a.EOF]=F.DONE,L[r.a.O_BRC]=F.ERROR_PUSH,L[r.a.C_BRC]=F.ERROR_POP_DECL,L[r.a.O_BRK]=F.ERROR_PUSH,L[r.a.C_BRK]=F.ERROR_POP,L[r.a.O_PAR]=F.ERROR_PUSH,L[r.a.C_PAR]=F.ERROR_POP,L[r.a.SEMICOL]=F.ERROR_SEMICOL,R[r.a.EOF]=F.DONE,R[r.a.O_BRC]=F.ERROR_PUSH,R[r.a.C_BRC]=F.ERROR_POP,R[r.a.O_BRK]=F.ERROR_PUSH,R[r.a.C_BRK]=F.ERROR_POP,R[r.a.O_PAR]=F.ERROR_PUSH,R[r.a.C_PAR]=F.ERROR_POP,P[r.a.C_PAR]=0,P[r.a.COMMA]=0,P[r.a.QMARK]=1,P[r.a.COLON]=1,P[r.a.AMP_AMP]=2,P[r.a.BAR_BAR]=2,P[r.a.LT]=3,P[r.a.GT]=3,P[r.a.LT_EQ]=3,P[r.a.GT_EQ]=3,P[r.a.EQ]=3,P[r.a.EQ_EQ]=3,P[r.a.BANG_EQ]=3,P[r.a.PLUS]=4,P[r.a.MINUS]=4,P[r.a.STAR]=5,P[r.a.SLASH]=5,P[r.a.PERCENT]=5,P[r.a.EOF]=6,P[M]=2,function(t){t[t.PROP=0]="PROP",t[t.WHEN=1]="WHEN",t[t.MEDIA=2]="MEDIA",t[t.IMPORT=3]="IMPORT"}(U||(U={}));class z{constructor(t,e,n,i){this.actions=t,this.tokenizer=e,this.handler=n,this.bo=i,this.wo=[],this.Eo={},this.xo=null,this.Fe=null,this.yo=!1,this.result=null,this.ko=!1,this.So=null,this.vo=null,this.To=[],this.No=[],this.Co=!1,this.Po=!1,this.Ro=U.MEDIA}_o(t,e){const n=[],i=this.wo;for(;n.push(i[e++]),e!=i.length;)if(i[e++]!=t)throw new Error("Unexpected state");return n}Ao(t,e){const n=this.wo;let i,r=n.length;do{i=n[--r]}while(void 0!==i&&"string"!=typeof i);let o=n.length-(r+1);if(o>1&&n.splice(r+1,o,new s.j(n.slice(r+1,n.length))),","==t)return null;r++;do{i=n[--r]}while(void 0!==i&&("string"!=typeof i||","==i));if(o=n.length-(r+1),"("==i){if(")"!=t)return this.handler.error("E_CSS_MISMATCHED_C_PAR",e),this.actions=L,null;const i=new s.e(n[r-1],this._o(",",r+1));return n.splice(r-1,o+2,i),null}return";"!=t||r>=0?(this.handler.error("E_CSS_UNEXPECTED_VAL_END",e),this.actions=L,null):o>1?new s.b(this._o(",",r+1)):n[0]}Io(t,e){this.actions=this.Fe?L:D,this.handler.error(t,e)}Fo(t,e){const n=this.wo,i=this.handler;let a,l=n.pop();for(;;){let h=n.pop();if(t==r.a.C_PAR){const e=[l];for(;h==r.a.COMMA;)e.unshift(n.pop()),h=n.pop();if("string"==typeof h){if("{"==h){for(;e.length>=2;){const t=e.shift(),n=e.shift(),s=new o.z(i.Qr(),t,n);e.unshift(s)}return n.push(new s.c(e[0])),!0}if("("==h){const s=n.pop(),a=n.pop();l=new o.d(i.Qr(),o.M(a,s),e),t=r.a.EOF;continue}}if(h==r.a.O_PAR){l.ye()&&(l=new o.p(i.Qr(),l,null)),t=r.a.EOF;continue}}else if("string"==typeof h){n.push(h);break}if(h<0)if(h==-r.a.BANG)l=new o.w(i.Qr(),l);else{if(h!=-r.a.MINUS)return this.Io("F_UNEXPECTED_STATE",e),!1;l=new o.v(i.Qr(),l)}else{if(P[t]>P[h]){n.push(h);break}switch(a=n.pop(),h){case r.a.AMP_AMP:l=new o.b(i.Qr(),a,l);break;case M:l=new o.c(i.Qr(),a,l);break;case r.a.BAR_BAR:l=new o.y(i.Qr(),a,l);break;case r.a.LT:l=new o.n(i.Qr(),a,l);break;case r.a.GT:l=new o.k(i.Qr(),a,l);break;case r.a.LT_EQ:l=new o.l(i.Qr(),a,l);break;case r.a.GT_EQ:l=new o.j(i.Qr(),a,l);break;case r.a.EQ:case r.a.EQ_EQ:l=new o.i(i.Qr(),a,l);break;case r.a.BANG_EQ:l=new o.u(i.Qr(),a,l);break;case r.a.PLUS:l=new o.a(i.Qr(),a,l);break;case r.a.MINUS:l=new o.B(i.Qr(),a,l);break;case r.a.STAR:l=new o.r(i.Qr(),a,l);break;case r.a.SLASH:l=new o.h(i.Qr(),a,l);break;case r.a.PERCENT:l=new o.q(i.Qr(),a,l);break;case r.a.COLON:if(!(n.length>1))return this.Io("E_CSS_EXPR_COND",e),!1;switch(n[n.length-1]){case r.a.QMARK:n.pop(),l=new o.e(i.Qr(),n.pop(),a,l);break;case r.a.O_PAR:if(!a.ye())return this.Io("E_CSS_MEDIA_TEST",e),!1;l=new o.p(i.Qr(),a,l)}break;case r.a.QMARK:if(t!=r.a.COLON)return this.Io("E_CSS_EXPR_COND",e),!1;case r.a.O_PAR:return n.push(a),n.push(h),n.push(l),!1;default:return this.Io("F_UNEXPECTED_STATE",e),!1}}}return n.push(l),!1}Oo(){const t=[];for(;;){const e=this.tokenizer.token();switch(e.type){case r.a.IDENT:t.push(e.text);break;case r.a.PLUS:t.push("+");break;case r.a.NUM:case r.a.INT:t.push(e.num);break;default:return t}this.tokenizer.consume()}}Lo(){let t=!1,e=this.tokenizer.token();if(e.type===r.a.PLUS)t=!0,this.tokenizer.consume(),e=this.tokenizer.token();else if(e.type===r.a.IDENT&&("even"===e.text||"odd"===e.text))return this.tokenizer.consume(),[2,"odd"===e.text?1:0];switch(e.type){case r.a.NUMERIC:if(t&&e.num<0)return null;case r.a.IDENT:if(t&&"-"===e.text.charAt(0))return null;if("n"===e.text||"-n"===e.text){if(t&&e.ut)return null;let n="-n"===e.text?-1:1;e.type===r.a.NUMERIC&&(n=e.num);let i=0;this.tokenizer.consume();const s=(e=this.tokenizer.token()).type===r.a.MINUS,o=e.type===r.a.PLUS||s;if(o&&(this.tokenizer.consume(),e=this.tokenizer.token()),e.type===r.a.INT){if(1/(i=e.num)==-1/0){if(i=0,o)return null}else if(i<0){if(o)return null}else if(i>=0&&!o)return null;this.tokenizer.consume()}else if(o)return null;return[n,s&&i>0?-i:i]}if("n-"===e.text||"-n-"===e.text){if(t&&e.ut)return null;let n="-n-"===e.text?-1:1;if(e.type===r.a.NUMERIC&&(n=e.num),this.tokenizer.consume(),(e=this.tokenizer.token()).type===r.a.INT)return e.num<0||1/e.num==-1/0?null:(this.tokenizer.consume(),[n,e.num])}else{let n=e.text.match(/^n(-[0-9]+)$/);if(n)return t&&e.ut?null:(this.tokenizer.consume(),[e.type===r.a.NUMERIC?e.num:1,parseInt(n[1],10)]);if(n=e.text.match(/^-n(-[0-9]+)$/))return this.tokenizer.consume(),[-1,parseInt(n[1],10)]}return null;case r.a.INT:return t&&(e.ut||e.num<0)?null:(this.tokenizer.consume(),[0,e.num])}return null}Mo(t,e){const n=this.handler.Qr();if(!n)return null;if(e=e||n._true,t){const i=t.split(/\s+/);for(const t of i)switch(t){case"vertical":e=o.D(n,e,new o.w(n,new o.s(n,"pref-horizontal")));break;case"horizontal":e=o.D(n,e,new o.s(n,"pref-horizontal"));break;case"day":e=o.D(n,e,new o.w(n,new o.s(n,"pref-night-mode")));break;case"night":e=o.D(n,e,new o.s(n,"pref-night-mode"));break;default:e=n._false}}return e===n._true?null:new s.c(e)}Do(){switch(this.No[this.No.length-1]){case"[selector]":case"font-face":case"-epubx-flow":case"-epubx-viewport":case"-epubx-define":case"-adapt-footnote-area":return!0}return!1}$o(t,e,n,a,l){const h=this.handler,c=this.tokenizer,u=this.wo;let d,f,p,g,m,b,w;a&&(this.Ro=U.MEDIA,this.wo.push("{"));t:for(;t>0;--t)switch(d=c.token(),this.actions[d.type]){case F.IDENT:if(c.gt(1).type!=r.a.COLON){this.Do()?(h.error("E_CSS_COLON_EXPECTED",c.gt(1)),this.actions=L):(this.actions=O,h.Ei());continue}(f=c.gt(2)).ut||f.type!=r.a.IDENT&&f.type!=r.a.FUNC||c.mark(),this.Fe=d.text,this.yo=!1,c.consume(),c.consume(),this.actions=_,u.splice(0,u.length);continue;case F.PROP:if(c.gt(1).type!=r.a.COLON){this.actions=L,h.error("E_CSS_COLON_EXPECTED",c.gt(1));continue}this.Fe=d.text,this.yo=!1,c.consume(),c.consume(),this.actions=_,u.splice(0,u.length);continue;case F.SELECTOR_START:this.actions=O,h.Ei();continue;case F.SELECTOR_NAME_1:if(!d.ut){this.actions=R,h.error("E_CSS_SPACE_EXPECTED",d);continue}h.di();case F.SELECTOR_NAME:if(c.gt(1).type==r.a.BAR)if(c.consume(),c.consume(),null!=(p=this.Eo[d.text]))switch((d=c.token()).type){case r.a.IDENT:h.hi(p,d.text),this.actions=l?I:x,c.consume();break;case r.a.STAR:h.hi(p,null),this.actions=l?I:x,c.consume();break;default:this.actions=D,h.error("E_CSS_NAMESPACE",d)}else this.actions=D,h.error("E_CSS_UNDECLARED_PREFIX",d);else h.hi(this.xo,d.text),this.actions=l?I:x,c.consume();continue;case F.SELECTOR_ANY_1:if(!d.ut){this.actions=R,h.error("E_CSS_SPACE_EXPECTED",d);continue}h.di();case F.SELECTOR_ANY:if(c.gt(1).type==r.a.BAR)switch(c.consume(),c.consume(),(d=c.token()).type){case r.a.IDENT:h.hi(null,d.text),this.actions=l?I:x,c.consume();break;case r.a.STAR:h.hi(null,null),this.actions=l?I:x,c.consume();break;default:this.actions=D,h.error("E_CSS_NAMESPACE",d)}else h.hi(this.xo,null),this.actions=l?I:x,c.consume();continue;case F.SELECTOR_ID_1:d.ut&&h.di();case F.SELECTOR_ID:h.ui(d.text),this.actions=l?I:x,c.consume();continue;case F.SELECTOR_CLASS_1:d.ut&&h.di();case F.SELECTOR_CLASS:h.li(d.text),this.actions=l?I:x,c.consume();continue;case F.SELECTOR_PSEUDOCLASS_1:d.ut&&h.di();case F.SELECTOR_PSEUDOCLASS:c.consume();e:switch((d=c.token()).type){case r.a.IDENT:h.ci(d.text,null),c.consume(),this.actions=l?I:x;continue;case r.a.FUNC:switch(g=d.text,c.consume(),g){case"not":this.actions=O,h.Ii("not"),this.$o(Number.POSITIVE_INFINITY,!1,!1,!1,!0)?this.actions=x:this.actions=R;break t;case"lang":case"href-epub-type":if((d=c.token()).type===r.a.IDENT){w=[d.text],c.consume();break}break e;case"nth-child":case"nth-of-type":case"nth-last-child":case"nth-last-of-type":if(w=this.Lo())break;break e;default:w=this.Oo()}if((d=c.token()).type==r.a.C_PAR){h.ci(g,w),c.consume(),this.actions=l?I:x;continue}}h.error("E_CSS_PSEUDOCLASS_SYNTAX",d),this.actions=D;continue;case F.SELECTOR_PSEUDOELEM:switch(c.consume(),(d=c.token()).type){case r.a.IDENT:h.ai(d.text,null),this.actions=l?I:x,c.consume();continue;case r.a.FUNC:if(g=d.text,c.consume(),"nth-fragment"==g){if(null===(w=this.Lo()))break}else w=this.Oo();if((d=c.token()).type==r.a.C_PAR){h.ai(g,w),this.actions=l?I:x,c.consume();continue}}h.error("E_CSS_PSEUDOELEM_SYNTAX",d),this.actions=D;continue;case F.SELECTOR_ATTR_1:d.ut&&h.di();case F.SELECTOR_ATTR:if(c.consume(),(d=c.token()).type==r.a.IDENT)g=d.text,c.consume();else if(d.type==r.a.STAR)g=null,c.consume();else{if(d.type!=r.a.BAR){this.actions=R,h.error("E_CSS_ATTR",d),c.consume();continue}g=""}if((d=c.token()).type==r.a.BAR){if(null==(p=g?this.Eo[g]:g)){this.actions=R,h.error("E_CSS_UNDECLARED_PREFIX",d),c.consume();continue}if(c.consume(),(d=c.token()).type!=r.a.IDENT){this.actions=R,h.error("E_CSS_ATTR_NAME_EXPECTED",d);continue}g=d.text,c.consume(),d=c.token()}else p="";switch(d.type){case r.a.EQ:case r.a.TILDE_EQ:case r.a.BAR_EQ:case r.a.HAT_EQ:case r.a.DOLLAR_EQ:case r.a.STAR_EQ:case r.a.COL_COL:m=d.type,c.consume(),d=c.token();break;case r.a.C_BRK:h.fi(p,g,r.a.EOF,null),this.actions=l?I:x,c.consume();continue;default:this.actions=R,h.error("E_CSS_ATTR_OP_EXPECTED",d);continue}switch(d.type){case r.a.IDENT:case r.a.STR:h.fi(p,g,m,d.text),c.consume(),d=c.token();break;default:this.actions=R,h.error("E_CSS_ATTR_VAL_EXPECTED",d);continue}if(d.type!=r.a.C_BRK){this.actions=R,h.error("E_CSS_ATTR",d);continue}this.actions=l?I:x,c.consume();continue;case F.SELECTOR_CHILD:h.pi(),this.actions=C,c.consume();continue;case F.SELECTOR_SIBLING:h.gi(),this.actions=C,c.consume();continue;case F.SELECTOR_FOLLOWING_SIBLING:h.mi(),this.actions=C,c.consume();continue;case F.SELECTOR_BODY:this.Co?(this.No.push("-epubx-region"),this.Co=!1):this.Po?(this.No.push("page"),this.Po=!1):this.No.push("[selector]"),h.yi(),this.actions=N,c.consume();continue;case F.SELECTOR_NEXT:h.bi(),this.actions=O,c.consume();continue;case F.VAL_IDENT:u.push(s.r(d.text)),c.consume();continue;case F.VAL_HASH:m=parseInt(d.text,16);try{u.push(E(d.text))}catch(t){h.error("E_CSS_COLOR",d),this.actions=D}c.consume();continue;case F.VAL_NUM:u.push(new s.h(d.num)),c.consume();continue;case F.VAL_INT:u.push(new s.g(d.num)),c.consume();continue;case F.VAL_NUMERIC:o.K(d.text)?u.push(new s.c(new o.x(h.Qr(),d.num,d.text))):u.push(new s.i(d.num,d.text)),c.consume();continue;case F.VAL_STR:u.push(new s.k(d.text)),c.consume();continue;case F.VAL_URL:u.push(new s.l(i.C(d.text,this.bo))),c.consume();continue;case F.VAL_COMMA:this.Ao(",",d),u.push(","),c.consume();continue;case F.VAL_SLASH:u.push(s.w),c.consume();continue;case F.VAL_FUNC:"-epubx-expr"==(g=d.text.toLowerCase())||"calc"==g||"env"==g?(this.actions=A,this.Ro=U.PROP,u.push("{")):(u.push(g),u.push("(")),c.consume();continue;case F.VAL_C_PAR:this.Ao(")",d),c.consume();continue;case F.VAL_BANG:if(c.consume(),d=c.token(),f=c.gt(1),d.type==r.a.IDENT&&"important"==d.text.toLowerCase()&&(f.type==r.a.SEMICOL||f.type==r.a.EOF||f.type==r.a.C_BRC)){c.consume(),this.yo=!0;continue}this.Io("E_CSS_SYNTAX",d);continue;case F.VAL_PLUS:switch((f=c.gt(1)).type){case r.a.NUM:case r.a.NUMERIC:case r.a.INT:if(!f.ut){c.consume();continue}}if(this.actions===_&&c.bt()){c.reset(),this.actions=O,h.Ei();continue}this.Io("E_CSS_UNEXPECTED_PLUS",d);continue;case F.VAL_END:c.consume();case F.VAL_BRC:c.unmark(),(b=this.Ao(";",d))&&this.Fe&&h.property(this.Fe,b,this.yo),this.actions=n?S:N;continue;case F.VAL_FINISH:if(c.consume(),c.unmark(),b=this.Ao(";",d),e)return this.result=b,!0;if(this.Fe&&b&&h.property(this.Fe,b,this.yo),n)return!0;this.Io("E_CSS_SYNTAX",d);continue;case F.EXPR_IDENT:(f=c.gt(1)).type==r.a.CLASS?(c.gt(2).type!=r.a.O_PAR||c.gt(2).ut?(u.push(new o.s(h.Qr(),o.M(d.text,f.text))),this.actions=k):(u.push(d.text,f.text,"("),c.consume()),c.consume()):(this.Ro==U.MEDIA||this.Ro==U.IMPORT?"not"==d.text.toLowerCase()?(c.consume(),u.push(new o.o(h.Qr(),!0,f.text))):("only"==d.text.toLowerCase()&&(c.consume(),d=f),u.push(new o.o(h.Qr(),!1,d.text))):u.push(new o.s(h.Qr(),d.text)),this.actions=k),c.consume();continue;case F.EXPR_FUNC:u.push(null,d.text,"("),c.consume();continue;case F.EXPR_NUM:u.push(new o.f(h.Qr(),d.num)),c.consume(),this.actions=k;continue;case F.EXPR_NUMERIC:"%"==(g=d.text)&&(g=this.Fe&&this.Fe.match(/height|^(top|bottom)$/)?"vh":"vw"),u.push(new o.x(h.Qr(),d.num,g)),c.consume(),this.actions=k;continue;case F.EXPR_STR:u.push(new o.f(h.Qr(),d.text)),c.consume(),this.actions=k;continue;case F.EXPR_PARAM:c.consume(),(d=c.token()).type!=r.a.INT||d.ut?this.Io("E_CSS_SYNTAX",d):(u.push(new o.A(h.Qr(),d.num)),c.consume(),this.actions=k);continue;case F.EXPR_PREFIX:u.push(-d.type),c.consume();continue;case F.EXPR_INFIX:this.actions=A,this.Fo(d.type,d),u.push(d.type),c.consume();continue;case F.EXPR_INFIX_NAME:"and"==d.text.toLowerCase()?(this.actions=A,this.Fo(M,d),u.push(M),c.consume()):this.Io("E_CSS_SYNTAX",d);continue;case F.EXPR_C_PAR:this.Fo(d.type,d)&&(this.Fe?this.actions=_:this.Io("E_CSS_UNBALANCED_PAR",d)),c.consume();continue;case F.EXPR_O_BRC:this.Fo(r.a.C_PAR,d)&&(this.Fe||this.Ro==U.IMPORT?this.Io("E_CSS_UNEXPECTED_BRC",d):(this.Ro==U.WHEN?h.ho(u.pop()):h.lo(u.pop()),this.No.push("media"),h.yi(),this.actions=N)),c.consume();continue;case F.EXPR_SEMICOL:if(this.Fo(r.a.C_PAR,d)){if(!this.Fe&&this.Ro==U.IMPORT)return this.vo=u.pop(),this.ko=!0,this.actions=N,c.consume(),!1;this.Io("E_CSS_UNEXPECTED_SEMICOL",d)}c.consume();continue;case F.EXPR_O_PAR:u.push(d.type),c.consume();continue;case F.RULE_END:this.actions=N,c.consume(),h.ki(),this.No.length&&this.No.pop();continue;case F.AT:switch(g=d.text.toLowerCase()){case"import":if(c.consume(),(d=c.token()).type==r.a.STR||d.type==r.a.URL){if(this.So=d.text,c.consume(),(d=c.token()).type==r.a.SEMICOL||d.type==r.a.EOF)return this.ko=!0,c.consume(),!1;this.Fe=null,this.Ro=U.IMPORT,this.actions=A,u.push("{");continue}h.error("E_CSS_IMPORT_SYNTAX",d),this.actions=D;continue;case"namespace":switch(c.consume(),(d=c.token()).type){case r.a.IDENT:if(g=d.text,c.consume(),((d=c.token()).type==r.a.STR||d.type==r.a.URL)&&c.gt(1).type==r.a.SEMICOL){this.Eo[g]=d.text,c.consume(),c.consume();continue}break;case r.a.STR:case r.a.URL:if(c.gt(1).type==r.a.SEMICOL){this.xo=d.text,c.consume(),c.consume();continue}}h.error("E_CSS_NAMESPACE_SYNTAX",d),this.actions=D;continue;case"charset":if(c.consume(),(d=c.token()).type==r.a.STR&&c.gt(1).type==r.a.SEMICOL){"utf-8"!=(g=d.text.toLowerCase())&&"utf-16"!=g&&h.error(`E_CSS_UNEXPECTED_CHARSET ${g}`,d),c.consume(),c.consume();continue}h.error("E_CSS_CHARSET_SYNTAX",d),this.actions=D;continue;case"font-face":case"-epubx-page-template":case"-epubx-define":case"-epubx-viewport":if(c.gt(1).type==r.a.O_BRC){switch(c.consume(),c.consume(),g){case"font-face":h.Jr();break;case"-epubx-page-template":h.ao();break;case"-epubx-define":h.io();break;case"-epubx-viewport":h.no()}this.No.push(g),h.yi();continue}break;case"-adapt-footnote-area":switch(c.consume(),(d=c.token()).type){case r.a.O_BRC:c.consume(),h.eo(null),this.No.push(g),h.yi();continue;case r.a.COL_COL:if(c.consume(),(d=c.token()).type==r.a.IDENT&&c.gt(1).type==r.a.O_BRC){g=d.text,c.consume(),c.consume(),h.eo(g),this.No.push("-adapt-footnote-area"),h.yi();continue}}break;case"-epubx-region":c.consume(),h.so(),this.Co=!0,this.actions=O;continue;case"page":c.consume(),h.ro(),this.Po=!0,this.actions=C;continue;case"top-left-corner":case"top-left":case"top-center":case"top-right":case"top-right-corner":case"right-top":case"right-middle":case"right-bottom":case"bottom-right-corner":case"bottom-right":case"bottom-center":case"bottom-left":case"bottom-left-corner":case"left-bottom":case"left-middle":case"left-top":if(c.consume(),(d=c.token()).type==r.a.O_BRC){c.consume(),h.oo(g),this.No.push(g),h.yi();continue}break;case"-epubx-when":c.consume(),this.Fe=null,this.Ro=U.WHEN,this.actions=A,u.push("{");continue;case"media":c.consume(),this.Fe=null,this.Ro=U.MEDIA,this.actions=A,u.push("{");continue;case"-epubx-flow":if(c.gt(1).type==r.a.IDENT&&c.gt(2).type==r.a.O_BRC){h.co(c.gt(1).text),c.consume(),c.consume(),c.consume(),this.No.push(g),h.yi();continue}break;case"-epubx-page-master":case"-epubx-partition":case"-epubx-partition-group":{c.consume();let t=null,e=null;const n=[];for((d=c.token()).type==r.a.IDENT&&(t=d.text,c.consume(),d=c.token()),d.type==r.a.COLON&&c.gt(1).type==r.a.IDENT&&(e=c.gt(1).text,c.consume(),c.consume(),d=c.token());d.type==r.a.FUNC&&"class"==d.text.toLowerCase()&&c.gt(1).type==r.a.IDENT&&c.gt(2).type==r.a.C_PAR;)n.push(c.gt(1).text),c.consume(),c.consume(),c.consume(),d=c.token();if(d.type==r.a.O_BRC){switch(c.consume(),g){case"-epubx-page-master":h.uo(t,e,n);break;case"-epubx-partition":h.fo(t,e,n);break;case"-epubx-partition-group":h.do(t,e,n)}this.No.push(g),h.yi();continue}break}case"":h.error(`E_CSS_UNEXPECTED_AT${g}`,d),this.actions=R;continue;default:h.error(`E_CSS_AT_UNKNOWN ${g}`,d),this.actions=D;continue}h.error(`E_CSS_AT_SYNTAX ${g}`,d),this.actions=D;continue;case F.ERROR_PUSH:if(e||n)return!0;this.To.push(d.type+1),c.consume();continue;case F.ERROR_POP_DECL:if(e||n)return!0;if(0==this.To.length){this.actions=N;continue}case F.ERROR_POP:this.To.length>0&&this.To[this.To.length-1]==d.type&&this.To.pop(),0==this.To.length&&d.type==r.a.C_BRC&&(this.actions=N),c.consume();continue;case F.ERROR_SEMICOL:if(e||n)return!0;0==this.To.length&&(this.actions=N),c.consume();continue;case F.DONE:return l&&(c.consume(),h.Li()),!0;default:if(e||n)return!0;if(a)return!!this.Fo(r.a.C_PAR,d)&&(this.result=u.pop(),!0);if(l)return d.type==r.a.INVALID?h.error(d.text,d):h.error("E_CSS_SYNTAX",d),!1;if(this.actions===_&&c.bt()){c.reset(),this.actions=O,h.Ei();continue}if(this.actions!==D&&this.actions!==R&&this.actions!==L){d.type==r.a.INVALID?h.error(d.text,d):h.error("E_CSS_SYNTAX",d),this.Do()?this.actions=L:this.actions=R;continue}c.consume();continue}return!1}}class B extends w{constructor(t){super(null),this.scope=t}error(t,e){throw new Error(t)}Qr(){return this.scope}}function H(t,e,n,s,o){const a=h.c("parseStylesheet"),l=new z(N,t,e,n);let c=null;return o&&(c=function(t,e,n){const i=new z(A,t,e,n);return i.$o(Number.POSITIVE_INFINITY,!1,!1,!0,!1),i.result}(new r.b(o,e),e,n)),(c=l.Mo(s,c&&c.st()))&&(e.lo(c),e.yi()),a.loop(()=>{for(;!l.$o(100,!1,!1,!1,!1);){if(l.ko){const t=i.C(l.So,n);l.vo&&(e.lo(l.vo),e.yi());const s=h.c("parseStylesheet.import");return V(t,e,null,null).then(()=>{l.vo&&e.ki(),l.ko=!1,l.So=null,l.vo=null,s.finish(!0)}),s.result()}const t=a.Bt();if(t.Dt)return t}return h.d(!1)}).then(()=>{c&&e.ki(),a.finish(!0)}),a.result()}function $(t,e,n,i,s){return h.b("parseStylesheetFromText",o=>{H(new r.b(t,e),e,n,i,s).Mt(o)},(e,n)=>{a.b.warn(n,`Failed to parse stylesheet text: ${t}`),e.finish(!1)})}function V(t,e,n,i){return h.b("parseStylesheetFromURL",s=>{l.c(t).then(r=>{r.responseText?$(r.responseText,e,t,n,i).then(e=>{e||a.b.warn(`Failed to parse stylesheet from ${t}`),s.finish(!0)}):s.finish(!0)})},(e,n)=>{a.b.warn(n,"Exception while fetching and parsing:",t),e.finish(!0)})}function G(t,e,n){const i=new z(_,e,new B(t),n);return i.$o(Number.POSITIVE_INFINITY,!0,!1,!1,!1),i.result}function j(t,e,n){new z(S,t,e,n).$o(Number.POSITIVE_INFINITY,!1,!0,!1,!1)}const X={"z-index":!0,"column-count":!0,"flow-linger":!0,opacity:!0,page:!0,"flow-priority":!0,utilization:!0};function Y(t,e,n){return e.rt()?function(t,e,n){const i=e.evaluate(t);switch(typeof i){case"number":return X[n]?i==Math.round(i)?new s.g(i):new s.h(i):new s.i(i,"px");case"string":return i?G(e.scope,new r.b(i,null),""):s.o;case"boolean":return i?s.t._true:s.t._false;case"undefined":return s.o}throw new Error("E_UNEXPECTED")}(t,e.expr,n):e}},function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o}),n.d(e,"d",function(){return c}),n.d(e,"j",function(){return u}),n.d(e,"k",function(){return d}),n.d(e,"i",function(){return E}),n.d(e,"m",function(){return w}),n.d(e,"l",function(){return y}),n.d(e,"g",function(){return S}),n.d(e,"f",function(){return x}),n.d(e,"h",function(){return I}),n.d(e,"e",function(){return C});var i=n(6);class s{constructor(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i}}class r{constructor(t,e){this.x=t,this.y=e}}class o{constructor(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i}}class a{constructor(t,e,n,i){this.low=t,this.high=e,this.winding=n,this.Bo=i}}class l{constructor(t,e,n,i){this.y1=t,this.y2=e,this.x1=n,this.x2=i,this.left=null,this.right=null}}function h(t,e){return t.low.y-e.low.y||t.low.x-e.low.x}class c{constructor(t){this.points=t}Uo(t,e){const n=this.points,i=n.length;let s=n[i-1];for(let r=0;r<i;r++){const i=n[r];let o;o=s.y<i.y?new a(s,i,1,e):new a(i,s,-1,e),t.push(o),s=i}}Hr(t,e){const n=[];for(const i of this.points)n.push(new r(i.x+t,i.y+e));return new c(n)}}function u(t,e,n,i){const s=[];for(let o=0;o<20;o++){const a=2*o*Math.PI/20;s.push(new r(t+n*Math.sin(a),e+i*Math.cos(a)))}return new c(s)}function d(t,e,n,i){return new c([new r(t,e),new r(n,e),new r(n,i),new r(t,i)])}class f{constructor(t,e,n,i){this.x=t,this.winding=e,this.Bo=n,this.Go=i}}function p(t,e){const n=t.low.x+(t.high.x-t.low.x)*(e-t.low.y)/(t.high.y-t.low.y);if(isNaN(n))throw new Error("Bad intersection");return n}function g(t,e,n,s){let r,o,a,l;e.high.y<n&&i.b.warn("Error: inconsistent segment (1)"),e.low.y<=n?(r=p(e,n),o=e.winding):(r=e.low.x,o=0),e.high.y>=s?(a=p(e,s),l=e.winding):(a=e.high.x,l=0),r<a?(t.push(new f(r,o,e.Bo,-1)),t.push(new f(a,l,e.Bo,1))):(t.push(new f(a,l,e.Bo,-1)),t.push(new f(r,o,e.Bo,1)))}function m(t,e,n){const i=e+n,s=Array(i),r=Array(i);let o;for(o=0;o<=i;o++)s[o]=0,r[o]=0;const a=[];let l=!1;const h=t.length;for(let n=0;n<h;n++){const h=t[n];s[h.Bo]+=h.winding,r[h.Bo]+=h.Go;let c=!1;for(o=0;o<e;o++)if(s[o]&&!r[o]){c=!0;break}if(c)for(o=e;o<=i;o++)if(s[o]||r[o]){c=!1;break}l!=c&&(a.push(h.x),l=c)}return a}function b(t,e){return e?Math.floor(t/e)*e:t}function E(t){return new s(t.y1,-t.x2,t.y2,-t.x1)}function w(t){return new s(-t.y2,t.x1,-t.y1,t.x2)}function v(t){return new c(t.points.map(t=>(function(t){return new r(t.y,-t.x)})(t)))}function y(t,e,n,i,s,r){r&&(t=E(t),e=e.map(t=>v(t)),n=n.map(t=>v(t)));const o=e.length,a=n?n.length:0,c=[],u=[];let d,f,p;for(d=0;d<o;d++)e[d].Uo(u,d);for(d=0;d<a;d++)n[d].Uo(u,d+o);const w=u.length;u.sort(h);let y=0;for(;u[y].Bo>=o;)y++;let N=u[y].low.y;N>t.y1&&c.push(new l(t.y1,N,t.x2,t.x2));let S=0;const x=[];for(;S<w&&(p=u[S]).low.y<N;)p.high.y>N&&x.push(p),S++;for(;S<w||x.length>0;){let e=t.y2;const n=Math.min((I=Math.ceil(N+i),(C=s)?Math.ceil(I/C)*C:I),t.y2);for(f=0;f<x.length&&e>n;f++)(p=x[f]).low.x==p.high.x?p.high.y<e&&(e=Math.max(b(p.high.y,s),n)):p.low.x!=p.high.x&&(e=n);for(e>t.y2&&(e=t.y2);S<w&&(p=u[S]).low.y<e;)if(p.high.y<N)S++;else{if(!(p.low.y<n)){const t=b(p.low.y,s);t<e&&(e=t);break}p.low.y==p.high.y&&p.low.y==N||(x.push(p),e=n),S++}const r=[];for(f=0;f<x.length;f++)g(r,x[f],N,e);r.sort((t,e)=>t.x-e.x||t.Go-e.Go);const h=m(r,o,a);if(0==h.length)c.push(new l(N,e,t.x2,t.x2));else{let n=0,i=t.x1;for(f=0;f<h.length;f+=2){const e=Math.max(t.x1,h[f]),s=Math.min(t.x2,h[f+1])-e;s>n&&(n=s,i=e)}0==n?c.push(new l(N,e,t.x2,t.x2)):c.push(new l(N,e,Math.max(i,t.x1),Math.min(i+n,t.x2)))}if(e==t.y2)break;for(N=e,f=x.length-1;f>=0;f--)x[f].high.y<=e&&x.splice(f,1)}var I,C;return T(t,c),c}function T(t,e){let n=e.length-1,i=new l(t.y2,t.y2,t.x1,t.x2);for(;n>=0;){const t=i;((i=e[n]).y2-i.y1<1||i.x1==t.x1&&i.x2==t.x2)&&(t.y1=i.y1,e.splice(n,1),i=t),n--}}function N(t,e){let n=0,i=t.length;for(;n<i;){const s=Math.floor((n+i)/2);e>=t[s].y2?n=s+1:i=s}return n}function S(t,e){if(!t.length)return e;let n,i,r=e.y1;for(i=0;i<t.length&&!((n=t[i]).y2>e.y1&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i++)r=Math.max(r,n.y2);let o=r;for(;i<t.length&&!((n=t[i]).y1>=e.y2||n.x1-.1>e.x1||n.x2+.1<e.x2);i++)o=n.y2;return(o=i===t.length?e.y2:Math.min(o,e.y2))<=r?null:new s(e.x1,r,e.x2,o)}function x(t,e){if(!t.length)return e;let n,i,r=e.y2;for(i=t.length-1;i>=0&&(n=t[i],!(i===t.length-1&&n.y2<e.y2))&&!(n.y1<e.y2&&n.x1-.1<=e.x1&&n.x2+.1>=e.x2);i--)r=Math.min(r,n.y1);let o=Math.min(r,n.y2);for(;i>=0&&!((n=t[i]).y2<=e.y1||n.x1-.1>e.x1||n.x2+.1<e.x2);i--)o=n.y1;return r<=(o=Math.max(o,e.y1))?null:new s(e.x1,o,e.x2,r)}function I(t,e,n,i){let s=n.y1;const r=n.x2-n.x1,o=n.y2-n.y1;let a=N(e,s);for(;;){const l=s+o;if(l>t.y2)return!1;let h=t.x1,c=t.x2;for(let t=a;t<e.length&&e[t].y1<l;t++){const n=e[t];n.x1>h&&(h=n.x1),n.x2<c&&(c=n.x2)}if(h+r<=c||a>=e.length)return"left"==i?(n.x1=h,n.x2=h+r):(n.x1=c-r,n.x2=c),n.y2+=s-n.y1,n.y1=s,!0;s=e[a].y2,a++}}function C(t,e,n,i,s){for(i||(i=[new l(n.y1,n.y2,n.x1,n.x2)]);i.length>0&&i[0].y2<=t.y1;)i.shift();if(0==i.length)return;let r;i[0].y1<t.y1&&(i[0].y1=t.y1);const o=0==e.length?t.y1:e[e.length-1].y2;o<t.y2&&e.push(new l(o,t.y2,t.x1,t.x2));let a=N(e,i[0].y1);for(const n of i){if(a==e.length)break;for(e[a].y1<n.y1&&(r=e[a],a++,e.splice(a,0,new l(n.y1,r.y2,r.x1,r.x2)),r.y2=n.y1);a<e.length&&((r=e[a++]).y2>n.y2&&(e.splice(a,0,new l(n.y2,r.y2,r.x1,r.x2)),r.y2=n.y2),n.x1!=n.x2&&("left"==s?r.x1=Math.min(n.x2,t.x2):r.x2=Math.max(n.x1,t.x1)),r.y2!=n.y2););}T(t,e)}},function(t,e,n){"use strict";var i=n(7),s=n(0),r=n(11);function o(t,e){const n={};return Object.keys(t).forEach(i=>{const s=n[i]={},r=t[i];Object.keys(r).forEach(t=>{s[t]=r[t].map(t=>{const n=e?t.logical:t.physical,i=e?t.physical:t.logical;return{regexp:new RegExp(`(-?)${n}(-?)`),to:`$1${i}$2`}})})}),n}function a(t,e,n,i){const s=i[e];if(!s)throw new Error(`unknown writing-mode: ${e}`);const r=s[n||"ltr"];if(!r)throw new Error(`unknown direction: ${n}`);for(const e of r){const n=t.replace(e.regexp,e.to);if(n!==t)return n}return t}n(6);const l={"horizontal-tb":{ltr:[{logical:"inline-start",physical:"left"},{logical:"inline-end",physical:"right"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}],rtl:[{logical:"inline-start",physical:"right"},{logical:"inline-end",physical:"left"},{logical:"block-start",physical:"top"},{logical:"block-end",physical:"bottom"},{logical:"inline-size",physical:"width"},{logical:"block-size",physical:"height"}]},"vertical-rl":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"right"},{logical:"block-end",physical:"left"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]},"vertical-lr":{ltr:[{logical:"inline-start",physical:"top"},{logical:"inline-end",physical:"bottom"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}],rtl:[{logical:"inline-start",physical:"bottom"},{logical:"inline-end",physical:"top"},{logical:"block-start",physical:"left"},{logical:"block-end",physical:"right"},{logical:"inline-size",physical:"height"},{logical:"block-size",physical:"width"}]}},h=o(l,!0);const c=o(l,!1);var u=n(19),d=n(3),f=n(8),p=n(15);n.d(e,"a",function(){return g}),n.d(e,"g",function(){return m}),n.d(e,"h",function(){return b}),n.d(e,"b",function(){return E}),n.d(e,"d",function(){return v}),n.d(e,"c",function(){return y}),n.d(e,"e",function(){return T}),n.d(e,"f",function(){return S});const g=p.b.FloatReference;function m(t){switch(t){case"inline":return g.INLINE;case"column":return g.COLUMN;case"region":return g.REGION;case"page":return g.PAGE;default:throw new Error(`Unknown float-reference: ${t}`)}}function b(t){switch(t){case g.INLINE:return!1;case g.COLUMN:case g.REGION:case g.PAGE:return!0;default:throw new Error(`Unknown float-reference: ${t}`)}}class E{constructor(t,e,n,i,s,r){this.zo=t,this.Us=e,this.Ts=n,this.Ns=i,this.ls=s,this.Cs=r,this.order=null,this.id=null}Ho(){if(null===this.order)throw new Error("The page float is not yet added");return this.order}Vo(){if(!this.id)throw new Error("The page float is not yet added");return this.id}jo(t){return t.Xo(this.Vo())}Wo(t){return!1}}class w{constructor(){this.floats=[],this.Yo=0}Nn(){return this.Yo++}qo(t){return`pf${t}`}Ko(t){if(this.floats.findIndex(e=>f.u(e.zo,t.zo))>=0)throw new Error("A page float with the same source node is already registered");{const e=t.order=this.Nn();t.id=this.qo(e),this.floats.push(t)}}Zo(t){const e=this.floats.findIndex(e=>f.u(e.zo,t));return e>=0?this.floats[e]:null}Qo(t){const e=this.floats.findIndex(e=>e.id===t);return e>=0?this.floats[e]:null}}class v{constructor(t,e,n,i,s){this.Us=t,this.Ts=e,this.continuations=n,this.area=i,this.continues=s}Jo(t){return this.continuations.some(e=>e.float===t)}eh(t){for(let e=this.continuations.length-1;e>=0;e--){const n=this.continuations[e].float;if(!n.jo(t))return n}return null}jr(){return this.area.jr(null,null)}Xr(){return this.area.Xr()}Ho(){const t=this.continuations.map(t=>t.float);return Math.min.apply(null,t.map(t=>t.Ho()))}nh(t){return this.Ho()<t.Ho()}ih(t){t.forEach(t=>{this.continuations.push(t)})}sh(){const t=this.continuations[0].float.ls;return i.a(this.continuations.every(e=>e.float.ls===t)),t}}class y{constructor(t,e){this.float=t,this.zo=e}equals(t){return!!t&&(this===t||this.float===t.float&&f.u(this.zo,t.zo))}}class T{constructor(t,e,n,i,r,o,a){this.parent=t,this.Us=e,this.container=n,this.ls=i,this.rh=r,this.children=[],this.invalidated=!1,this.oh=[],this.hh=[],this.lh=[],this.ah={},this.uh=[],this.fh=[],this.locked=!1,t&&t.children.push(this),this.writingMode=o||t&&t.writingMode||s.t.horizontal_tb,this.direction=a||t&&t.direction||s.t.ltr,this.dh=t?t.dh:new w;const l=this.ph();this.gh=l?[].concat(l.uh):[]}mh(t){if(!this.parent)throw new Error(`No PageFloatLayoutContext for ${t}`);return this.parent}bh(t,e,n,i){let s=this.children.indexOf(t);s<0&&(s=this.children.length);for(let t=s-1;t>=0;t--){let s=this.children[t];if(s.Us===e&&s.ls===n&&f.u(s.rh,i))return s;if(s=s.bh(null,e,n,i))return s}return null}ph(){let t,e=this,n=this.parent;for(;n;){if(t=n.bh(e,this.Us,this.ls,this.rh))return t;e=n,n=n.parent}return null}wh(t){return t&&t!==this.Us?this.mh(t).wh(t):this.container}Eh(t){this.container=t,this.xh()}Ko(t){this.dh.Ko(t)}yh(t){return t===this.Us?this:this.mh(t).yh(t)}Zo(t){return this.dh.Zo(t)}forbid(t){const e=t.Vo(),n=t.Us;n===this.Us?this.oh.includes(e)||(this.oh.push(e),(new S).kh(t).forbid(t,this)):this.mh(n).forbid(t)}Sh(t){const e=t.Vo(),n=t.Us;return n===this.Us?this.oh.includes(e):this.mh(n).Sh(t)}Th(t,e){const n=t.Us;n!==this.Us?this.mh(n).Th(t,e):this.hh.includes(t)||(this.hh.push(t),this.hh.sort((t,e)=>t.Ho()-e.Ho())),e||this.invalidate()}Nh(t,e){const n=t.Us;if(n!==this.Us)this.mh(n).Nh(t,e);else{const n=this.hh.indexOf(t);if(n>=0){const t=this.hh.splice(n,1)[0],i=t.area&&t.area.element;i&&i.parentNode&&i.parentNode.removeChild(i),e||this.invalidate()}}}Ch(t){if(t.Us!==this.Us)return this.mh(t.Us).Ch(t);const e=this.hh.findIndex(e=>e.Jo(t));return e>=0?this.hh[e]:null}Ph(t){return!(!(this.hh.length>0)||t&&!this.hh.some(t))||!!this.parent&&this.parent.Ph(t)}Rh(t){return this.Ph(e=>e.continues&&e.sh()===t)}_h(t,e){this.ah[t.Vo()]=e}Ah(){const t=Object.assign({},this.ah);return this.children.reduce((t,e)=>Object.assign(t,e.Ah()),t)}Xo(t){if(this.Ih().some(e=>e.float.Vo()===t))return!0;const e=this.Ah()[t];return!!e&&!(!this.container||!this.container.element)&&this.container.element.contains(e)}Fh(t){const e=t.float;if(e.Us===this.Us){const n=this.uh.findIndex(t=>t.float===e);n>=0?this.uh.splice(n,1,t):this.uh.push(t)}else this.mh(e.Us).Fh(t)}Oh(t,e){if(!e&&t.Us!==this.Us)return this.mh(t.Us).Oh(t,!1);const n=t.Ho();return!!this.uh.some(e=>e.float.Ho()<n&&!t.Wo(e.float))||!!this.parent&&this.parent.Oh(t,!0)}Lh(t){const e=t.Ho();let n=null;if(this.hh.forEach(t=>{t.continuations.forEach(t=>{const i=t.float,s=i.Ho();s>e&&(!n||s>n.Ho())&&(n=i)})}),this.parent){const e=this.parent.Lh(t);e&&(!n||e.Ho()>n.Ho())&&(n=e)}return n}Ih(t){t=t||this.ls;let e=this.gh.filter(e=>!t||e.float.ls===t);return this.parent&&(e=this.parent.Ih(t).concat(e)),e.sort((t,e)=>t.float.Ho()-e.float.Ho())}Mh(t){t=t||this.ls;const e=this.uh.filter(e=>!t||e.float.ls===t);return this.parent?this.parent.Mh(t).concat(e):e}Dh(){let t=[];const e=[];for(let n=this.children.length-1;n>=0;n--){const i=this.children[n];e.includes(i.ls)||(e.push(i.ls),t=(t=t.concat(i.uh.map(t=>t.float))).concat(i.Dh()))}return t}$h(){if(this.Bh())return!0;for(let t=this.hh.length-1;t>=0;t--){const e=this.hh[t],n=e.eh(this);if(n)return this.locked?this.invalidate():(this.Nh(e),this.forbid(n),this.Uh(e.Ts)),!0}return!(this.Us!==g.REGION||!this.parent.locked)&&this.parent.$h()}Bh(){const t=this.Dh(),e=this.hh.reduce((t,e)=>t.concat(e.continuations.map(t=>t.float)),[]);e.sort((t,e)=>e.Ho()-t.Ho());for(const n of e){const e=n.Ho();if(t.some(t=>!n.Wo(t)&&e>t.Ho())){if(this.locked)this.invalidate();else{this.forbid(n);const t=this.Ch(n);i.a(t),this.Nh(t)}return!0}}return!1}finish(){if(!this.$h()){for(let t=this.uh.length-1;t>=0;t--)if(!this.uh[t].float.jo(this)){if(this.locked)return void this.invalidate();this.uh.splice(t,1)}this.gh.forEach(t=>{this.uh.findIndex(e=>t.equals(e))>=0||this.hh.some(e=>e.Jo(t.float))||this.uh.push(t)})}}Gh(t){return!!this.container&&!!t.container&&this.container.element===t.container.element}invalidate(){this.invalidated=!0,this.locked||(this.container&&(this.children.forEach(t=>{this.Gh(t)&&t.hh.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),this.container.clear()),this.children.forEach(t=>{t.fh.splice(0)}),this.children.splice(0),Object.keys(this.ah).forEach(t=>{delete this.ah[t]}))}zh(){const t=this.children.splice(0);return t.forEach(t=>{t.hh.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)})}),t}Hh(t){t.forEach(t=>{this.children.push(t),t.xh()})}Vh(){return this.invalidated||!!this.parent&&this.parent.Vh()}validate(){this.invalidated=!1}jh(t){return function(t,e,n){return a(t,e,n||null,c)}(t,this.writingMode.toString(),this.direction.toString())}Xh(t){return function(t,e,n){return a(t,e,n||null,h)}(t,this.writingMode.toString(),this.direction.toString())}Uh(t){const e=this.jh(t);if("block-end"===e||"inline-end"===e){let t=0;for(;t<this.hh.length;){const n=this.hh[t];this.jh(n.Ts)===e?this.Nh(n):t++}}}Wh(t){const e=t.Us;if(e!==this.Us)return void this.mh(e).Wh(t);const n=this.jh(t.Ts);if("block-end"===n||"snap-block"===n||"inline-end"===n){let e=0;for(;e<this.hh.length;){const i=this.hh[e],s=this.jh(i.Ts);(s===n||"snap-block"===n&&"block-end"===s)&&i.nh(t)?(this.lh.push(i),this.hh.splice(e,1)):e++}}}Yh(t){t===this.Us?(this.lh.forEach(t=>{this.Th(t,!0)}),this.lh.splice(0)):this.mh(t).Yh(t)}qh(t){t===this.Us?this.lh.splice(0):this.mh(t).qh(t)}Kh(t){return t===this.Us?this.lh.concat().sort((t,e)=>e.Ho()-t.Ho()):this.mh(t).Kh(t)}Zh(t,e,n,s){i.a(this.container);const r=this.jh(t),o=this.Xh(t),a=this.Qh(r,e,n,s);if(this.parent&&this.parent.container){const t=this.parent.Zh(o,e,n,s);switch(o){case"top":case"left":return Math.max(a,t);case"bottom":case"right":return Math.min(a,t);default:i.b("Should be unreachable")}}return a}Qh(t,e,n,s){i.a(this.container);const r=this.Jh(e,n,s);switch(t){case"block-start":return this.container.vertical?r.right:r.top;case"block-end":return this.container.vertical?r.left:r.bottom;case"inline-start":return this.container.vertical?r.top:r.left;case"inline-end":return this.container.vertical?r.bottom:r.right;default:throw new Error(`Unknown logical side: ${t}`)}}Jh(t,e,n){i.a(this.container);const s=this.container.ur,r=this.container.dr,o=this.container.Vr();let a={top:o.y1-r,left:o.x1-s,bottom:o.y2-r,right:o.x2-s,tl:0,el:0};function l(n,i,s){return"%"===n.unit?s*n.num/100:t.nl(n,i,e)}const h=this.hh;return h.length>0&&(a=h.reduce((t,e)=>{if(n&&!n(e,this))return t;const i=this.jh(e.Ts),s=e.area,r=e.continuations[0].float.Cs;let a=t.top,h=t.left,c=t.bottom,u=t.right,d=t.tl,f=t.el;switch(i){case"inline-start":s.vertical?a=Math.max(a,s.top+s.height):h=Math.max(h,s.left+s.width);break;case"block-start":s.vertical?(r&&s.left<u&&(d=l(r,s.il[0],o.x2-o.x1)),u=Math.min(u,s.left)):(r&&s.top+s.height>a&&(d=l(r,s.il[0],o.y2-o.y1)),a=Math.max(a,s.top+s.height));break;case"inline-end":s.vertical?c=Math.min(c,s.top):u=Math.min(u,s.left);break;case"block-end":s.vertical?(r&&s.left+s.width>h&&(f=l(r,s.il[0],o.x2-o.x1)),h=Math.max(h,s.left+s.width)):(r&&s.top<c&&(f=l(r,s.il[0],o.y2-o.y1)),c=Math.min(c,s.top));break;default:throw new Error(`Unknown logical float side: ${i}`)}return{top:a,left:h,bottom:c,right:u,tl:d,el:f}},a)),a.left+=s,a.right+=s,a.top+=r,a.bottom+=r,a}sl(t,e,n,s,o,a,l){if(e!==this.Us)return this.mh(e).sl(t,e,n,s,o,a,l);let h=this.jh(n);if("snap-block"===h){if(!l["block-start"]&&!l["block-end"])return null}else if(!l[h])return null;i.a(t.rl);let c=this.Zh("block-start",t.ol,t.rl),d=this.Zh("block-end",t.ol,t.rl),f=this.Zh("inline-start",t.ol,t.rl),p=this.Zh("inline-end",t.ol,t.rl);const g=t.vertical?t.ur:t.dr,m=t.vertical?t.dr:t.ur;function b(e,n){let i=e(t.bands,n);return i?(t.vertical&&(i=r.m(i)),c=t.vertical?Math.min(c,i.x2):Math.max(c,i.y1),d=t.vertical?Math.max(d,i.x1):Math.min(d,i.y2),!0):a}let E,w,v,y;if(c=t.vertical?Math.min(c,t.left+t.kr()+t.width+t.Sr()+g):Math.max(c,t.top+g),d=t.vertical?Math.max(d,t.left+g):Math.min(d,t.top+t.xr()+t.height+t.yr()+g),o){const e=t.vertical?r.i(new r.c(d,f,c,p)):new r.c(f,c,p,d);if(("block-start"===h||"snap-block"===h||"inline-start"===h)&&!b(r.g,e))return null;if(("block-end"===h||"snap-block"===h||"inline-end"===h)&&!b(r.f,e))return null;if(E=(v=(d-c)*t.Or())-t.vr()-t.Tr(),w=(y=p-f)-t.Nr()-t.Cr(),!a&&(E<=0||w<=0))return null}else{v=(E=t.gr)+t.vr()+t.Tr();const e=(d-c)*t.Or();if("snap-block"===h){if(null===s)h="block-start";else{const t=this.container.Vr();h=this.container.Or()*(s-(this.container.vertical?t.x2:t.y1))<=this.container.Or()*((this.container.vertical?t.x1:t.y2)-s-v)?"block-start":"block-end"}if(!l[h]){if(!l["block-end"])return null;h="block-end"}}if(!a&&e<v)return null;y=(w="inline-start"===h||"inline-end"===h?u.b(t.rl,t.element,[u.a.FIT_CONTENT_INLINE_SIZE])[u.a.FIT_CONTENT_INLINE_SIZE]:t.hl?t.ll():t.vertical?t.height:t.width)+t.Nr()+t.Cr();const n=p-f;if(!a&&n<y)return null}switch(c-=g,d-=g,f-=m,p-=m,h){case"inline-start":case"block-start":case"snap-block":t.Ur(f,w),t.Br(c,E);break;case"inline-end":case"block-end":t.Ur(p-y,w),t.Br(d-v*t.Or(),E);break;default:throw new Error(`unknown float direction: ${n}`)}return h}cl(){const t=this.hh.map(t=>t.jr());return this.parent?this.parent.cl().concat(t):t}xh(){const t=this.container.element&&this.container.element.parentNode;t&&this.hh.forEach(e=>{t.appendChild(e.area.element)})}al(){const t=this.wh().vertical;return this.hh.reduce((e,n)=>{const i=n.Xr();return t?Math.min(e,i.x1):Math.max(e,i.y2)},t?1/0:0)}ul(){const t=this.wh().vertical;return this.hh.filter(t=>"block-end"===t.Ts).reduce((e,n)=>{const i=n.Xr();return t?Math.max(e,i.x2):Math.min(e,i.y1)},t?0:1/0)}fl(t,e){function n(t){return e=>t.Xo(e.float.Vo())}function s(t,e){return t.continuations.some(n(e))}const r=e.Vr(),o=e.vertical?r.x1:r.y2;let a=this;for(;a;){if(a.uh.some(n(a)))return o;a=a.parent}i.a(e.rl);const l=this.Zh("block-start",e.ol,e.rl,s);return this.Zh("block-end",e.ol,e.rl,s)*e.Or()<o*e.Or()?o:l}dl(t,e,n){if(t.Us!==this.Us)return this.mh(t.Us).dl(t,e,n);const i={"block-start":!0,"block-end":!0,"inline-start":!0,"inline-end":!0};if(!n)return i;const s=this.jh(e),r=this.jh(n);let o;o="all"===r?["block-start","block-end","inline-start","inline-end"]:"both"===r?["inline-start","inline-end"]:"same"===r?"snap-block"===s?["block-start","block-end"]:[s]:[r];const a=t.Ho();function l(t){return e=>e.Ts===t&&e.Ho()<a}return o.forEach(t=>{switch(t){case"block-start":case"inline-start":i[t]=!function t(e,n){return e.children.some(e=>e.hh.some(l(n))||t(e,n))}(this,t);break;case"block-end":case"inline-end":i[t]=!function t(e,n){const i=e.parent;return!!i&&(i.hh.some(l(n))||t(i,n))}(this,t);break;default:throw new Error(`Unexpected side: ${t}`)}}),i}pl(){return(this.parent?this.parent.pl():[]).concat(this.fh)}gl(t,e){e===this.Us?this.fh.push(t):this.mh(e).gl(t,e)}ml(t){const e=t.ol,n=t.rl;i.a(n);let s=this,r=null;for(;s&&s.container;){const i=s.Jh(e,n);r?t.vertical?(i.right<r.right&&(r.right=i.right,r.tl=i.tl),i.left>r.left&&(r.left=i.left,r.el=i.el)):(i.top>r.top&&(r.top=i.top,r.tl=i.tl),i.bottom<r.bottom&&(r.bottom=i.bottom,r.el=i.el)):r=i,s=s.parent}const o=Math.max(r.tl,r.el);return(t.vertical?r.right-r.left:r.bottom-r.top)<=o}bl(){const t=this.wh().vertical;return this.hh.length?Math.max.apply(null,this.hh.map(e=>{const n=e.area;return t?n.width:n.height})):0}lock(){this.locked=!0}unlock(){this.locked=!1}wl(){return this.locked}}const N=[];class S{static register(t){N.push(t)}El(t){for(let e=N.length-1;e>=0;e--){const n=N[e];if(n.xl(t))return n}throw new Error(`No PageFloatLayoutStrategy found for ${t}`)}kh(t){for(let e=N.length-1;e>=0;e--){const n=N[e];if(n.yl(t))return n}throw new Error(`No PageFloatLayoutStrategy found for ${t}`)}}S.register(new class{xl(t){return b(t.Us)}yl(t){return!0}kl(t,e,n){let s=t.Us;i.a(t.Ts);const r=t.Ts,o=t.Ys();return n.Sl(s,t.columnSpan,t).Ot(n=>{s=n,i.a(e.ls);const a=new E(o,s,r,t.Ns,e.ls,t.Cs);return e.Ko(a),d.d(a)})}vl(t,e,n,i){const s=t[0].float;return new v(s.Us,e,t,n,i)}Ch(t,e){return e.Ch(t)}Tl(t,e,n){}forbid(t,e){}})},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return h}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return u});var i=n(0),s=n(9);const r={page:!0,left:!0,right:!0,recto:!0,verso:!0,column:!0,region:!0};function o(t){return!!r[t]}const a={avoid:!0,"avoid-page":!0,"avoid-column":!0,"avoid-region":!0};function l(t){return!!a[t]}function h(t,e){if(!t)return e;if(!e)return t;{const n=o(t),i=o(e);if(!n||!i)return i?e:n?t:l(e)?e:l(t)?t:e;switch(e){case"column":return t;case"region":return"column"===t?e:t;default:return e}}}function c(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return"any"}}function u(t){switch(t){case"left":case"right":case"recto":case"verso":return t;default:return null}}s.c.Kr("SIMPLE_PROPERTY",function(t){const e=t.name,n=t.value;switch(e){case"page-break-before":case"page-break-after":case"page-break-inside":return{name:e.replace(/^page-/,""),value:n===i.t.always?i.t.page:n,important:t.important};default:return t}})},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return l}),n.d(e,"f",function(){return h}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return u});var i=n(1),s=n(6),r=n(8);function o(t,e,n,r){const o=t.Fs;if(!o)return NaN;if(1==o.nodeType){if(t.after||!t.inline){const n=e.os(o);if(n.right>=n.left&&n.bottom>=n.top)return t.after?r?n.left:n.bottom:r?n.right:n.top}return NaN}{let a=NaN;const l=o.ownerDocument.createRange(),h=o.textContent.length;if(!h)return NaN;t.after&&(n+=h),n>=h&&(n=h-1),l.setStart(o,n),l.setEnd(o,n+1);let c=e.Nl(l);r&&i.m(document.body)&&(c=function(t,e,n){const i=n.ownerDocument.createRange();i.setStart(n,0),i.setEnd(n,n.textContent.length);const r=t.Nl(i),o=[];for(const t of e){let e;for(e=0;e<r.length;e++){const n=r[e];if(t.top>=n.top&&t.bottom<=n.bottom&&Math.abs(t.left-n.left)<1){o.push({top:t.top,left:n.left,bottom:t.bottom,right:n.right});break}}e==r.length&&(s.b.warn("Could not fix character box"),o.push(t))}return o}(e,c,o));let u=0;for(const t of c){const e=r?t.bottom-t.top:t.right-t.left;t.right>t.left&&t.bottom>t.top&&(isNaN(a)||e>u)&&(a=r?t.left:t.bottom,u=e)}return a}}function a(t,e,n){const i=e.rl.os(t),s=e.Cl(t);return n?i.width+s.left+s.right:i.height+s.top+s.bottom}function l(t){for(;t;){if(t.parentNode===t.ownerDocument)return!1;t=t.parentNode}return!0}function h(t,e){if(!t)return;let n;for(;(n=t.lastChild)!=e;)t.removeChild(n)}function c(t){return!!t.getAttribute(r.m)}function u(t){if(!t)return!1;const e=t.Fs;return!(!e||1!==e.nodeType)&&c(e)}},function(t,e,n){"use strict";var i,s,r,o,a,l;n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s}),n.d(e,"d",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return a}),n.d(e,"f",function(){return l}),(i||(i={})).Pl=function(t){return t&&"Block"===t.Rl},function(t){let e;!function(t){t.INLINE="inline",t.COLUMN="column",t.REGION="region",t.PAGE="page"}(e=t.FloatReference||(t.FloatReference={}))}(s||(s={})),(r||(r={}))._l=function(t){return t&&"AfterIfContinue"==t.Al},function(t){t.Il=function(t){return!!t&&("RepetitiveElementsOwner"===t.Rl||a.Fl(t))},t.Ol=function(t){return!!t&&("RepetitiveElementsOwner"===t.Al||a.Ll(t))}}(o||(o={})),function(t){t.Fl=function(t){return t&&"Table"===t.Rl},t.Ll=function(t){return t&&"TableRow"===t.Al}}(a||(a={})),function(t){let e,n;!function(t){t[t.IGNORE=0]="IGNORE",t[t.NEWLINE=1]="NEWLINE",t[t.PRESERVE=2]="PRESERVE"}(e=t.Whitespace||(t.Whitespace={})),function(t){t[t.NONE=0]="NONE",t[t.CONTENT=1]="CONTENT",t[t.ROOTLESS=2]="ROOTLESS",t[t.ROOTED=3]="ROOTED"}(n=t.ShadowType||(t.ShadowType={}))}(l||(l={}))},function(t,e,n){"use strict";var i,s=n(1),r=n(6),o=n(3),a=n(17),l='<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://www.pyroxy.com/ns/shadow">\n<head>\n<style><![CDATA[\n\n.footnote-content {\n  float: footnote;\n}\n\n.table-cell-container {\n  display: block;\n}\n\n]]></style>\n</head>\n<body>\n\n<s:template id="footnote"><s:content/><s:include class="footnote-content"/></s:template>\n\n<s:template id="table-cell"><div data-vivliostyle-flow-root="true" class="table-cell-container"><s:content/></div></s:template>\n\n</body>\n</html>\n';function h(t,e,n,s,a){const l=o.c("ajax"),h=new XMLHttpRequest,u=l.suspend(h),d={status:0,statusText:"",url:t,contentType:null,responseText:null,responseXML:null,Ml:null};h.open(n||"GET",t,!0),e&&(h.responseType=e),h.onreadystatechange=(()=>{if(4===h.readyState){if(d.status=h.status,d.statusText=h.statusText||404==h.status&&"Not Found"||"",200==d.status||0==d.status)if(e&&e!==i.DOCUMENT||!h.responseXML||"parsererror"==h.responseXML.documentElement.localName)if((!e||e===i.DOCUMENT)&&h.response instanceof HTMLDocument)d.responseXML=h.response,d.contentType=h.response.contentType;else{const n=h.response;e&&e!==i.TEXT||"string"!=typeof n?n?d.Ml="string"==typeof n?c([n]):n:r.b.warn("Unexpected empty success response for",t):d.responseText=n;const s=h.getResponseHeader("Content-Type");s&&(d.contentType=s.replace(/(.*);.*$/,"$1"))}else d.responseXML=h.responseXML,d.contentType=h.responseXML.contentType;u.schedule(d)}});try{s?(h.setRequestHeader("Content-Type",a||"text/plain; charset=UTF-8"),h.send(s)):(/^file:|^https?:\/\/[^\/]+\.githubusercontent\.com|\.opf$/.test(t)?/\/aozorabunko\/[^\/]+\/cards\/[^\/]+\/files\/[^\/.]+\.html$/.test(t)?h.overrideMimeType("text/html; charset=Shift_JIS"):/\.(html|htm)$/.test(t)?h.overrideMimeType("text/html; charset=UTF-8"):/\.(xhtml|xht|xml|opf)$/.test(t)?h.overrideMimeType("application/xml; charset=UTF-8"):/\.(txt|css)$/.test(t)?h.overrideMimeType("text/plain; charset=UTF-8"):h.overrideMimeType("text/html; charset=UTF-8"):/^data:,(<|%3C|%3c)/.test(t)?h.overrideMimeType("text/html; charset=UTF-8"):/^data:,/.test(t)&&h.overrideMimeType("text/plain; charset=UTF-8"),h.send(null))}catch(e){r.b.warn(e,`Error fetching ${t}`),u.schedule(d)}return l.result()}function c(t,e){const n=e||"application/octet-stream",i=window.WebKitBlobBuilder||window.MSBlobBuilder;if(i){const e=new i;for(let n=0;n<t.length;n++)e.append(t[n]);return e.getBlob(n)}return new Blob(t,{type:n})}function u(t){const e=o.c("readBlob"),n=new FileReader,i=e.suspend(n);return n.addEventListener("load",()=>{i.schedule(n.result)},!1),n.readAsArrayBuffer(t),e.result()}function d(t){return(window.URL||window.webkitURL).createObjectURL(t)}n.d(e,"b",function(){return i}),n.d(e,"c",function(){return h}),n.d(e,"e",function(){return c}),n.d(e,"g",function(){return u}),n.d(e,"d",function(){return d}),n.d(e,"a",function(){return f}),n.d(e,"f",function(){return g}),function(t){t.DEFAULT="",t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(i||(i={}));class f{constructor(t,e){this.parser=t,this.type=e,this.resources={},this.fetchers={}}load(t,e,n){t=s.I(t);const i=this.resources[t];return void 0!==i?o.d(i):this.fetch(t,e,n).get()}Dl(t,e,n){const i=this,r=o.c("fetch"),a=t.endsWith("?viv-toc-box");a&&(t=t.replace("?viv-toc-box",""));const c=s.C("user-agent.xml",s.D),u=!a&&t===c;return u&&(t=`data:application/xml,${encodeURIComponent(l)}`),h(t,i.type).then(s=>{if(s.status>=400&&e)throw new Error((n||`Failed to fetch required resource: ${t}`)+` (${s.status}${s.statusText?" "+s.statusText:""})`);a?(t+="?viv-toc-box",s.url+="?viv-toc-box"):u&&(s.url=t=c),i.parser(s,i).then(e=>{delete i.fetchers[t],i.resources[t]=e,r.finish(e)})}),r.result()}fetch(t,e,n){if(t=s.I(t),this.resources[t])return null;let i=this.fetchers[t];if(!i){const s=this;i=new a.a(()=>s.Dl(t,e,n),`Fetch ${t}`),s.fetchers[t]=i,i.start()}return i}get(t){return this.resources[s.I(t)]}delete(t){delete this.resources[s.I(t)]}}function p(t,e){const n=t.responseText;return o.d(n?s.H(n):null)}function g(){return new f(p,i.TEXT)}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"b",function(){return l});var i=n(1),s=n(6),r=n(3);class o{constructor(t,e){this.fetch=t,this.arrived=!1,this.resource=null,this.task=null,this.piggybacks=[],this.name=e}start(){if(!this.task){const t=this;this.task=r.a().wt().run(()=>{const e=r.c("Fetcher.run");return t.fetch().then(n=>{const i=t.piggybacks;if(t.arrived=!0,t.resource=n,t.task=null,t.piggybacks=[],i)for(let t=0;t<i.length;t++)try{i[t](n)}catch(t){s.b.error(t,"Error:")}e.finish(n)}),e.result()},this.name)}}piggyback(t){this.arrived?t(this.resource):this.piggybacks.push(t)}get(){return this.arrived?r.d(this.resource):(this.start(),this.task.join())}$l(){return this.arrived}}const a=t=>{if(0==t.length)return r.d(!0);if(1==t.length)return t[0].get().Lt(!0);const e=r.c("waitForFetches");let n=0;return e.loop(()=>{for(;n<t.length;){const e=t[n++];if(!e.$l())return e.get().Lt(!0)}return r.d(!1)}).then(()=>{e.finish(!0)}),e.result()};function l(t,e){let n=null,s=null;"img"==t.localName&&(n=t.getAttribute("width"),s=t.getAttribute("height"));const a=new o(()=>{const o=r.c("loadImage"),a=o.suspend(t);let l=!1;const h=e=>{l||(l=!0,"img"==t.localName&&(n||t.removeAttribute("width"),s||t.removeAttribute("height")),a.schedule(e?e.type:"timeout"))};return t.addEventListener("load",h,!1),t.addEventListener("error",h,!1),t.addEventListener("abort",h,!1),t.namespaceURI==i.a.SVG?(t.setAttributeNS(i.a.XLINK,"xlink:href",e),setTimeout(h,300)):t.src=e,o.result()},`loadElement ${e}`);return a.start(),a}},function(t,e,n){"use strict";n.d(e,"c",function(){return h}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return f});var i=n(22),s=n(24),r=n(14),o=n(9),a=n(3),l=n(15);class h{find(t){const e=o.b(o.a.RESOLVE_LAYOUT_PROCESSOR);for(let n=0;n<e.length;n++){const i=e[n](t);if(i)return i}throw new Error(`No processor found for a formatting context: ${t._t()}`)}}class c{layout(t,e,n){return e.Bl(t)?e.Ul(t):e.Gl(t)?e.zl(t):e.Hl(t)}Vl(t,e,n,s){return new i.b(t.copy(),e,n,s)}jl(t){return!1}Xl(t,e){return!1}Wl(t,e,n,i){if(!n.Fs)return;if(!n.Fs.parentNode)return;const s=n.Fs.parentNode;r.f(s,n.Fs),i&&s.removeChild(n.Fs)}Yl(t,e,n,i){const s=n||null!=e.Fs&&1==e.Fs.nodeType&&!e.after;return t.Wl(e,s),i&&(t.ql(e,!0),t.ol.Kl(s?e:e.parent)),a.d(!0)}}class u{constructor(t){this.parent=t,this.Rl="Block"}_t(){return"Block formatting context (BlockFormattingContext)"}Zl(t,e){return e}mh(){return this.parent}Ql(){}Jl(t){}}const d=new c,f=l.a.Pl;o.d(o.a.RESOLVE_FORMATTING_CONTEXT,(t,e,n,i,r,o)=>{const a=t.parent;return!a&&t.us?null:a&&t.us!==a.us?null:t.As||!t.us&&s.d(n,i,r,o)?new u(a?a.us:null):null}),o.d(o.a.RESOLVE_LAYOUT_PROCESSOR,t=>t instanceof u?d:null)},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var i,s=n(1);function r(t,e,n){const r={display:e.style.display,position:e.style.position,width:e.style.width,maxWidth:e.style.maxWidth,minWidth:e.style.minWidth,height:e.style.height,maxHeight:e.style.maxHeight,minHeight:e.style.minHeight},o=e.ownerDocument,a=e.parentNode,l=o.createElement("div");function h(n){return t.tc(e).getPropertyValue(n)}s.F(l,"position",r.position),a.insertBefore(l,e),l.appendChild(e),s.F(e,"width","auto"),s.F(e,"max-width","none"),s.F(e,"min-width","0"),s.F(e,"height","auto"),s.F(e,"max-height","none"),s.F(e,"min-height","0");const c=s.v("writing-mode"),u=(c?h(c[0]):null)||h("writing-mode"),d="vertical-rl"===u||"tb-rl"===u||"vertical-lr"===u||"tb-lr"===u,f=d?"height":"width",p=d?"width":"height";function g(){return s.F(e,"display","block"),s.F(e,"position","static"),h(f)}function m(){s.F(e,"display","inline-block"),s.F(l,f,"99999999px");const t=h(f);return s.F(l,f,""),t}function b(){s.F(e,"display","inline-block"),s.F(l,f,"0");const t=h(f);return s.F(l,f,""),t}function E(){const t=g(),e=b(),n=parseFloat(t);if(n<=parseFloat(e))return e;{const e=m();return n<=parseFloat(e)?t:e}}function w(){return h(p)}function v(){throw new Error("Getting fill-available block size is not implemented")}const y={};return n.forEach(t=>{let n;switch(t){case i.FILL_AVAILABLE_INLINE_SIZE:n=g();break;case i.MAX_CONTENT_INLINE_SIZE:n=m();break;case i.MIN_CONTENT_INLINE_SIZE:n=b();break;case i.FIT_CONTENT_INLINE_SIZE:n=E();break;case i.FILL_AVAILABLE_BLOCK_SIZE:n=v();break;case i.MAX_CONTENT_BLOCK_SIZE:case i.MIN_CONTENT_BLOCK_SIZE:case i.FIT_CONTENT_BLOCK_SIZE:n=w();break;case i.FILL_AVAILABLE_WIDTH:n=d?v():g();break;case i.FILL_AVAILABLE_HEIGHT:n=d?g():v();break;case i.MAX_CONTENT_WIDTH:n=d?w():m();break;case i.MAX_CONTENT_HEIGHT:n=d?m():w();break;case i.MIN_CONTENT_WIDTH:n=d?w():b();break;case i.MIN_CONTENT_HEIGHT:n=d?b():w();break;case i.FIT_CONTENT_WIDTH:n=d?w():E();break;case i.FIT_CONTENT_HEIGHT:n=d?E():w()}y[t]=parseFloat(n),s.F(e,"position",r.position),s.F(e,"display",r.display)}),s.F(e,"width",r.width),s.F(e,"max-width",r.maxWidth),s.F(e,"min-width",r.minWidth),s.F(e,"height",r.height),s.F(e,"max-height",r.maxHeight),s.F(e,"min-height",r.minHeight),a.insertBefore(e,l),a.removeChild(l),y}!function(t){t.FILL_AVAILABLE_INLINE_SIZE="fill-available inline size",t.FILL_AVAILABLE_BLOCK_SIZE="fill-available block size",t.FILL_AVAILABLE_WIDTH="fill-available width",t.FILL_AVAILABLE_HEIGHT="fill-available height",t.MAX_CONTENT_INLINE_SIZE="max-content inline size",t.MAX_CONTENT_BLOCK_SIZE="max-content block size",t.MAX_CONTENT_WIDTH="max-content width",t.MAX_CONTENT_HEIGHT="max-content height",t.MIN_CONTENT_INLINE_SIZE="min-content inline size",t.MIN_CONTENT_BLOCK_SIZE="min-content block size",t.MIN_CONTENT_WIDTH="min-content width",t.MIN_CONTENT_HEIGHT="min-content height",t.FIT_CONTENT_INLINE_SIZE="fit-content inline size",t.FIT_CONTENT_BLOCK_SIZE="fit-content block size",t.FIT_CONTENT_WIDTH="fit-content width",t.FIT_CONTENT_HEIGHT="fit-content height"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"c",function(){return h}),n.d(e,"e",function(){return u}),n.d(e,"b",function(){return f}),n.d(e,"a",function(){return p});var i=n(0),s=n(11),r=n(6);class o extends i.m{constructor(){super(),this.ec={}}$(t){return this.ec[t.name]=!0,t}Z(t){return this.S(t.values),t}}function a(t){if(t){const e=new o;try{return t.visit(e),e.ec}catch(t){r.b.warn(t,"toSet:")}}return{}}class l extends i.m{constructor(t){super(),this.value=t}X(t){return this.value=t.num,t}}function h(t,e){if(t){const n=new l(e);try{return t.visit(n),n.value}catch(t){r.b.warn(t,"toInt: ")}}return e}class c extends i.m{constructor(){super(),this.collect=!1,this.coords=[],this.name=null}U(t){return this.collect&&this.coords.push(t),null}V(t){return this.collect&&0==t.num&&this.coords.push(new i.i(0,"px")),null}Z(t){return this.S(t.values),null}et(t){return this.collect||(this.collect=!0,this.S(t.values),this.collect=!1,this.name=t.name.toLowerCase()),null}nc(t,e,n,i,r){if(this.coords.length>0){const o=[];switch(this.coords.forEach((t,e)=>{if("%"==t.unit){let s=e%2==0?n:i;3==e&&"circle"==this.name&&(s=Math.sqrt((n*n+i*i)/2)),o.push(t.num*s/100)}else o.push(t.num*r.at(t.unit,!1))}),this.name){case"polygon":if(o.length%2==0){const n=[];for(let i=0;i<o.length;i+=2)n.push(new s.b(t+o[i],e+o[i+1]));return new s.d(n)}break;case"rectangle":if(4==o.length)return s.k(t+o[0],e+o[1],t+o[0]+o[2],e+o[1]+o[3]);break;case"ellipse":if(4==o.length)return s.j(t+o[0],e+o[1],o[2],o[3]);break;case"circle":if(3==o.length)return s.j(t+o[0],e+o[1],o[2],o[2])}}return null}}function u(t,e,n,i,o,a){if(t){const s=new c;try{return t.visit(s),s.nc(e,n,i,o,a)}catch(t){r.b.warn(t,"toShape:")}}return s.k(e,n,e+i,n+o)}class d extends i.m{constructor(t){super(),this.reset=t,this.counters={},this.name=null}$(t){return this.name=t.toString(),this.reset?this.counters[this.name]=0:this.counters[this.name]=(this.counters[this.name]||0)+1,t}X(t){return this.name&&(this.counters[this.name]+=t.num-(this.reset?0:1)),t}Z(t){return this.S(t.values),t}}function f(t,e){const n=new d(e);try{t.visit(n)}catch(t){r.b.warn(t,"toCounters:")}return n.counters}class p extends i.d{constructor(t,e){super(),this.ic=t,this.transformer=e}Y(t){return new i.l(this.transformer.sc(t.url,this.ic))}}},function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"e",function(){return l}),n.d(e,"a",function(){return h}),n.d(e,"d",function(){return c}),n.d(e,"f",function(){return u}),n.d(e,"b",function(){return d});var i=n(1),s=n(0),r=n(5),o=n(8);const a=(new DOMParser).parseFromString(`<root xmlns="${i.a.SHADOW}"/>`,"text/xml"),l=["footnote-marker","first-5-lines","first-4-lines","first-3-lines","first-2-lines","first-line","first-letter","before","","after"],h="data-adapt-pseudo";function c(t){return t.getAttribute(h)||""}function u(t,e){t.setAttribute(h,e)}class d{constructor(t,e,n,i,s){this.element=t,this.style=e,this.styler=n,this.context=i,this.Yr=s,this.rc={}}oc(t,e){const n=c(t);this.styler&&n&&n.match(/after$/)&&(this.style=this.styler.oc(this.element,!0),this.styler=null);const i=r.u(this.style,"_pseudos")[n]||{};if(n.match(/^first-/)&&!i["x-first-pseudo"]){let t,e=1;"first-letter"==n?e=0:null!=(t=n.match(/^first-([0-9]+)-lines$/))&&(e=t[1]-0),i["x-first-pseudo"]=new r.c(new s.g(e),0)}return i}hc(t,e){const n=c(t);if(!this.rc[n]){this.rc[n]=!0;const i=e.content;i&&o.y(i)&&i.visit(new o.c(t,this.context,i,this.Yr))}}}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"b",function(){return l});var i=n(13),s=n(14),r=n(15);class o{lc(t){return a(this.cc(),t.ac())}uc(t){}cc(){return null}}function a(t,e){return{current:e.reduce((e,n)=>e+n.lc(t),0),minimum:e.reduce((e,n)=>e+n.fc(t),0)}}class l extends o{constructor(t,e,n,i){super(),this.position=t,this.dc=e,this.overflows=n,this.gr=i,this.gc=!1,this.edge=0,this.mc=n}bc(t,e){return this.wc(t),e<this.Ec()?null:t.xc(this)}Ec(){if(!this.gc)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");const t=this.yc()&&!this.mc;return(i.b(this.dc)?1:0)+(this.overflows&&!t?3:0)+(this.position.parent?this.position.parent.Bs:0)}kc(t){const e=t.Sc(this.position);this.edge=s.a(this.position,t.rl,0,t.vertical)+e,this.gc=!0}wc(t){this.gc||this.kc(t);const e=this.edge,n=this.lc(t);this.mc=t.vc(e+(t.vertical?-1:1)*n.minimum),this.overflows=this.position.overflow=t.vc(e+(t.vertical?-1:1)*n.current)}cc(){return this.position}yc(){const t=this.cc();if(!t||!t.parent)return!1;const{us:e}=t.parent;if(!r.c.Il(e))return!1;const n=e.Tc();return!!n&&n.Nc(t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"LayoutIteratorStrategy",function(){return l}),n.d(e,"LayoutIterator",function(){return h}),n.d(e,"EdgeSkipper",function(){return c}),n.d(e,"PseudoColumn",function(){return u});var i=n(13),s=n(22),r=n(30),o=n(3),a=n(8);class l{Cc(t){return{Pc:t,Rc:!1,break:!1}}_c(t){}Ac(t){}Ic(t){}Fc(t){}Oc(t){}Lc(t){}Mc(t){}Dc(t){}jl(t){}Xl(t){}finish(t){}}class h{constructor(t,e){this.strategy=t,this.ol=e}iterate(t){const e=this.strategy,n=e.Cc(t),i=o.c("LayoutIterator");return i.Ut(t=>{let i;for(;n.Pc;){const s=((i=n.Pc.Fs?1!==n.Pc.Fs.nodeType?a.p(n.Pc.Fs,n.Pc.whitespace)?n.Pc.after?e.Fc(n):e.Ic(n):n.Pc.after?e.Lc(n):e.Oc(n):n.Pc.inline?n.Pc.after?e.Dc(n):e.Mc(n):n.Pc.after?e.Xl(n):e.jl(n):n.Pc.after?e.Ac(n):e._c(n))&&i.Dt()?i:o.d(!0)).Ot(()=>n.break?o.d(null):this.ol.$c(n.Pc,n.Rc));if(s.Dt())return void s.then(e=>{n.break?t.zt():(n.Pc=e,t.Gt())});if(n.break)return void t.zt();n.Pc=s.get()}e.finish(n),t.zt()}).then(()=>{i.finish(n.Pc)}),i.result()}}class c extends l{constructor(t){super(),this.Bc=t}Uc(t){}Gc(t){}zc(t){}Cc(t){return{Pc:t,Rc:!!this.Bc&&t.after,break:!1,Bc:this.Bc,Hc:null,Vc:!1,jc:[],Xc:null}}Wc(t,e){const n=!t.Bc&&i.c(t.Hc);if(n){const n=t.Pc=t.jc[0]||t.Pc;n.Fs.parentNode.removeChild(n.Fs),e.Yc=t.Hc}return n}qc(t,e){const n=e.Kc(t.Xc,null,!0,t.Hc);return n&&(t.Pc=(t.Xc||t.Pc).modify(),t.Pc.overflow=!0),n}Zc(t,e,n){let i=t.Pc;const s=!e.Qc(i);return s&&(n.Kc(t.Xc,null,!1,t.Hc),(i=t.Pc=i.modify()).overflow=!0),s}Oc(t){t.Vc=!1}jl(t){return t.jc.push(t.Pc.copy()),t.Hc=i.d(t.Hc,t.Pc.breakBefore),t.Vc=!0,this.Uc(t)}Xl(t){let e,n;return(n=t.Vc?(n=(e=this.Gc(t))&&e.Dt()?e:o.d(!0)).Ot(()=>(t.break||(t.jc=[],t.Bc=!1,t.Rc=!1,t.Hc=null),o.d(!0))):(e=this.zc(t))&&e.Dt()?e:o.d(!0)).Ot(()=>(t.break||(t.Vc=!1,t.Xc=t.Pc.copy(),t.Hc=i.d(t.Hc,t.Pc.breakAfter)),o.d(!0)))}}class u{constructor(t,e,n){this.Jc=[],this.column=Object.create(t),this.column.element=e,this.column.ol=t.ol.clone(),this.column.ta=!1,this.column.ea=n.us,this.column.na=t;const i=this.column.Sc(n);this.column.ia=this.column.ia-i;const s=this;this.column.sa=function(t){return r.b.prototype.sa.call(this,t).Ot(t=>(s.Jc.push(t.copy()),o.d(t)))}}layout(t,e){return this.column.layout(t,e)}ra(t){const e=this.column.ra();if(t){const t=this.Jc[0].copy(),n=new s.b(t,null,t.overflow,0);if(n.bc(this.column,0),!e.Pc)return{oa:n,Pc:t}}return e}Yl(t,e,n){return this.column.Yl(t,e,n)}ha(t){this.column.ha(t)}la(t){const e=this.Jc[0];return e.Fs===t.Fs&&e.after===t.after&&e.ws===t.ws}ca(t){return a.u(t.Ys(),this.column.aa)}ua(){return this.column.element}fa(){return this.column}}},function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return h}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return u}),n.d(e,"a",function(){return d}),n.d(e,"b",function(){return f});var i=n(0);const s="data-vivliostyle-flow-root";function r(t){return"true"===t.getAttribute(s)}function o(t){const e=t.toString();let n;switch(e){case"inline-flex":n="flex";break;case"inline-grid":n="grid";break;case"inline-table":n="table";break;case"inline":case"table-row-group":case"table-column":case"table-column-group":case"table-header-group":case"table-footer-group":case"table-row":case"table-cell":case"table-caption":case"inline-block":n="block";break;default:n=e}return i.r(n)}function a(t){return t===i.t.absolute||t===i.t.fixed}function l(t,e,n,s){return t===i.t.none||(a(e)?(n=i.t.none,t=o(t)):(n&&n!==i.t.none||s)&&(t=o(t))),{display:t,position:e,float:n}}function h(t,e,n,s){return l(t,e,n,s).display===i.t.block}function c(t){switch(t.toString()){case"inline":case"inline-block":case"inline-list-item":case"inline-flex":case"inline-grid":case"ruby":case"inline-table":return!0;default:return!1}}function u(t){switch(t.toString()){case"ruby-base":case"ruby-text":case"ruby-base-container":case"ruby-text-container":return!0;default:return!1}}function d(t,e,n,s,r,o,l){return r=r||o||i.t.horizontal_tb,!!l||!!n&&n!==i.t.none||a(e)||t===i.t.inline_block||t===i.t.table_cell||t===i.t.table_caption||t==i.t.flex||(t===i.t.block||t===i.t.list_item)&&!!s&&s!==i.t.visible||!!o&&r!==o}function f(t){return t===i.t.relative||t===i.t.absolute||t===i.t.fixed}},function(t,e,n){"use strict";n.d(e,"c",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return l});var i=n(7);function s(t,e,n){return t-=n,0===e?0===t:t%e==0&&t/e>=0}class r{constructor(t){this.matchers=t}matches(){return this.matchers.some(t=>t.matches())}}class o{constructor(t){this.matchers=t}matches(){return this.matchers.every(t=>t.matches())}}class a{constructor(t,e,n){this.da=t,this.a=e,this.b=n}static pa(t,e,n){const i=a.ga;(!i[t]||i[t].priority<=n)&&(i[t]={Es:e,priority:n})}static ma(){a.ga={}}matches(){const t=a.ga[this.da];return null!=t&&null!=t.Es&&s(t.Es,this.a,this.b)}}a.ga={};class l{static Ue(t,e){const n=e.split("_");return"NFS"==n[0]?new a(t,parseInt(n[1],10),parseInt(n[2],10)):(i.b(`unknown view condition. condition=${e}`),null)}static Bn(t){return new o(t)}static $n(t){return new r(t)}}},function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"e",function(){return d}),n.d(e,"a",function(){return p}),n.d(e,"c",function(){return E}),n.d(e,"d",function(){return w});var i=n(7),s=n(1),r=n(14),o=n(25),a=n(21),l=n(3),h=n(8),c=n(15);const u=c.d._l,d=o.b.pa;let f;o.b.ma,Promise.resolve().then(n.bind(null,23)).then(t=>{f=t});class p{constructor(t,e){this.ys=t,this.styler=e}createElement(t,e){if(!f)throw new Error("layoututil module is required but not be imported.");const n=e.Fs.ownerDocument.createElement("div"),i=new f.PseudoColumn(t,n,e),r=i.fa().Yc;return i.fa().Yc=null,i.layout(this.ba(),!0).Ot(()=>{this.styler.rc["after-if-continues"]=!1,i.fa().Yc=r;const t=n.firstChild;return s.F(t,"display","block"),l.d(t)})}ba(){const t=a.c.createElementNS(s.a.XHTML,"div");a.f(t,"after-if-continues");const e=this.wa(t),n={steps:[{node:t,ds:e.type,ps:e,gs:null,bs:null}],ws:0,after:!1,xs:null};return new h.a(n)}wa(t){return new h.n(this.ys,t,null,null,null,c.f.ShadowType.ROOTED,this.styler)}}class g{constructor(t,e,n){this.Pc=t,this.Ds=e,this.Ea=n,this.Al="AfterIfContinue"}Qc(t,e,n){return!(e&&!t||t&&t.overflow)}xa(t){return!1}ya(t,e,n,i){}Yl(t,e){return this.Tc().ka(t)?this.Ds.createElement(e,this.Pc).Ot(t=>(this.Pc.Fs.appendChild(t),l.d(!0))):l.d(!0)}Tc(){return new m(this.Pc,this.Ea)}Sa(t){return t instanceof g&&this.Ds==t.Ds}va(){return 9}}class m{constructor(t,e){this.Pc=t,this.Ea=e}lc(t){return this.ka(t)?this.Ea:0}fc(t){return this.lc(t)}ka(t){if(!t)return!1;const e=t.ps?t.ps.owner:t.ys;if(e===this.Pc.ys)return!!t.after;for(let t=e.parentNode;t;t=t.parentNode)if(t===this.Pc.ys)return!0;return!1}}function b(t,e){if(!t||!t.Ds||t.after||e.Bl(t))return l.d(t);const n=t.Ds;return n.createElement(e,t).Ot(s=>{i.a(null!==t);const o=function(t,e,n){const i=t.Fs;i.appendChild(n);const s=r.b(n,e,t.vertical);return i.removeChild(n),s}(t,e,s);return e.Ta.push(new g(t,n,o)),l.d(t)})}function E(t,e){return t.Ot(t=>b(t,e))}function w(t,e){const n=l.c("processAfterIfContinuesOfAncestors");let i=t;return n.loop(()=>{if(null!==i){const t=b(i,e);return i=i.parent,t.Lt(!0)}return l.d(!1)}).then(()=>{n.finish(!0)}),n.result()}},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return l});var i=n(28),s=n.n(i);function r(t,e){return s()(t,e,0)}function o(t){return t.reduce((t,e)=>e[0]===s.a.DELETE?t:t+e[1],"")}function a(t,e){return h(t,e,1)}function l(t,e){return h(t,e,-1)}function h(t,e,n){let i=0,r=0;return t.some(t=>{for(let o=0;o<t[1].length;o++){switch(t[0]*n){case s.a.INSERT:i++;break;case s.a.DELETE:i--,r++;break;case s.a.EQUAL:r++}if(r>e)return!0}return!1}),Math.max(Math.min(e,r-1)+i,0)}},function(t,e){var n=-1,i=1,s=0;function r(t,e,h,c){if(t===e)return t?[[s,t]]:[];if(null!=h){var p=function(t,e,n){var i="number"==typeof n?{index:n,length:0}:n.Na,s="number"==typeof n?null:n.Ca,r=t.length,o=e.length;if(0===i.length&&(null===s||0===s.length)){var a=i.index,l=t.slice(0,a),h=t.slice(a),c=s?s.index:null,u=a+o-r;if((null===c||c===u)&&!(u<0||u>o)){var d=e.slice(0,u);if((v=e.slice(u))===h){var p=Math.min(a,u),g=l.slice(0,p),m=d.slice(0,p);if(g===m){var b=l.slice(p),E=d.slice(p);return f(g,b,E,h)}}}if(null===c||c===a){var w=a,v=(d=e.slice(0,w),e.slice(w));if(d===l){var y=Math.min(r-w,o-w),T=h.slice(h.length-y),N=v.slice(v.length-y);if(T===N)return f(l,b=h.slice(0,h.length-y),E=v.slice(0,v.length-y),T)}}}return i.length>0&&s&&0===s.length&&(g=t.slice(0,i.index),T=t.slice(i.index+i.length),!(o<(p=g.length)+(y=T.length))&&(m=e.slice(0,p),N=e.slice(o-y),g===m&&T===N))?f(g,b=t.slice(p,r-y),E=e.slice(p,o-y),T):null}(t,e,h);if(p)return p}var g=a(t,e),m=t.substring(0,g);g=l(t=t.substring(g),e=e.substring(g));var b=t.substring(t.length-g),E=function(t,e){var h;if(!t)return[[i,e]];if(!e)return[[n,t]];var c=t.length>e.length?t:e,u=t.length>e.length?e:t,d=c.indexOf(u);if(-1!==d)return h=[[i,c.substring(0,d)],[s,u],[i,c.substring(d+u.length)]],t.length>e.length&&(h[0][0]=h[2][0]=n),h;if(1===u.length)return[[n,t],[i,e]];var f=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function s(t,e,n){for(var i,s,r,o,h=t.substring(n,n+Math.floor(t.length/4)),c=-1,u="";-1!==(c=e.indexOf(h,c+1));){var d=a(t.substring(n),e.substring(c)),f=l(t.substring(0,n),e.substring(0,c));u.length<f+d&&(u=e.substring(c-f,c)+e.substring(c,c+d),i=t.substring(0,n-f),s=t.substring(n+d),r=e.substring(0,c-f),o=e.substring(c+d))}return 2*u.length>=t.length?[i,s,r,o,u]:null}var r,o,h,c,u,d=s(n,i,Math.ceil(n.length/4)),f=s(n,i,Math.ceil(n.length/2));return d||f?(r=f?d&&d[4].length>f[4].length?d:f:d,t.length>e.length?(o=r[0],h=r[1],c=r[2],u=r[3]):(c=r[0],u=r[1],o=r[2],h=r[3]),[o,h,c,u,r[4]]):null}(t,e);if(f){var p=f[0],g=f[1],m=f[2],b=f[3],E=f[4],w=r(p,m),v=r(g,b);return w.concat([[s,E]],v)}return function(t,e){for(var s=t.length,r=e.length,a=Math.ceil((s+r)/2),l=a,h=2*a,c=new Array(h),u=new Array(h),d=0;d<h;d++)c[d]=-1,u[d]=-1;c[l+1]=0,u[l+1]=0;for(var f=s-r,p=f%2!=0,g=0,m=0,b=0,E=0,w=0;w<a;w++){for(var v=-w+g;v<=w-m;v+=2){for(var y=l+v,T=(C=v===-w||v!==w&&c[y-1]<c[y+1]?c[y+1]:c[y-1]+1)-v;C<s&&T<r&&t.charAt(C)===e.charAt(T);)C++,T++;if(c[y]=C,C>s)m+=2;else if(T>r)g+=2;else if(p&&(x=l+f-v)>=0&&x<h&&-1!==u[x]){var N=s-u[x];if(C>=N)return o(t,e,C,T)}}for(var S=-w+b;S<=w-E;S+=2){for(var x=l+S,I=(N=S===-w||S!==w&&u[x-1]<u[x+1]?u[x+1]:u[x-1]+1)-S;N<s&&I<r&&t.charAt(s-N-1)===e.charAt(r-I-1);)N++,I++;if(u[x]=N,N>s)E+=2;else if(I>r)b+=2;else if(!p&&(y=l+f-S)>=0&&y<h&&-1!==c[y]){var C=c[y];if(T=l+C-y,C>=(N=s-N))return o(t,e,C,T)}}}return[[n,t],[i,e]]}(t,e)}(t=t.substring(0,t.length-g),e=e.substring(0,e.length-g));return m&&E.unshift([s,m]),b&&E.push([s,b]),function t(e,r){e.push([s,""]);for(var o,h=0,c=0,f=0,p="",g="";h<e.length;)if(h<e.length-1&&!e[h][1])e.splice(h,1);else switch(e[h][0]){case i:f++,g+=e[h][1],h++;break;case n:c++,p+=e[h][1],h++;break;case s:var m=h-f-c-1;if(r){if(m>=0&&d(e[m][1])){var b=e[m][1].slice(-1);if(e[m][1]=e[m][1].slice(0,-1),p=b+p,g=b+g,!e[m][1]){e.splice(m,1),h--;var E=m-1;e[E]&&e[E][0]===i&&(f++,g=e[E][1]+g,E--),e[E]&&e[E][0]===n&&(c++,p=e[E][1]+p,E--),m=E}}if(u(e[h][1])){b=e[h][1].charAt(0);e[h][1]=e[h][1].slice(1),p+=b,g+=b}}if(h<e.length-1&&!e[h][1]){e.splice(h,1);break}if(p.length>0||g.length>0){p.length>0&&g.length>0&&(0!==(o=a(g,p))&&(m>=0?e[m][1]+=g.substring(0,o):(e.splice(0,0,[s,g.substring(0,o)]),h++),g=g.substring(o),p=p.substring(o)),0!==(o=l(g,p))&&(e[h][1]=g.substring(g.length-o)+e[h][1],g=g.substring(0,g.length-o),p=p.substring(0,p.length-o)));var w=f+c;0===p.length&&0===g.length?(e.splice(h-w,w),h-=w):0===p.length?(e.splice(h-w,w,[i,g]),h=h-w+1):0===g.length?(e.splice(h-w,w,[n,p]),h=h-w+1):(e.splice(h-w,w,[n,p],[i,g]),h=h-w+2)}0!==h&&e[h-1][0]===s?(e[h-1][1]+=e[h][1],e.splice(h,1)):h++,f=0,c=0,p="",g=""}""===e[e.length-1][1]&&e.pop();var v=!1;for(h=1;h<e.length-1;)e[h-1][0]===s&&e[h+1][0]===s&&(e[h][1].substring(e[h][1].length-e[h-1][1].length)===e[h-1][1]?(e[h][1]=e[h-1][1]+e[h][1].substring(0,e[h][1].length-e[h-1][1].length),e[h+1][1]=e[h-1][1]+e[h+1][1],e.splice(h-1,1),v=!0):e[h][1].substring(0,e[h+1][1].length)==e[h+1][1]&&(e[h-1][1]+=e[h+1][1],e[h][1]=e[h][1].substring(e[h+1][1].length)+e[h+1][1],e.splice(h+1,1),v=!0)),h++;v&&t(e,r)}(E,c),E}function o(t,e,n,i){var s=t.substring(0,n),o=e.substring(0,i),a=t.substring(n),l=e.substring(i),h=r(s,o),c=r(a,l);return h.concat(c)}function a(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),s=i,r=0;n<s;)t.substring(r,s)==e.substring(r,s)?r=n=s:i=s,s=Math.floor((i-n)/2+n);return h(t.charCodeAt(s-1))&&s--,s}function l(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,i=Math.min(t.length,e.length),s=i,r=0;n<s;)t.substring(t.length-s,t.length-r)==e.substring(e.length-s,e.length-r)?r=n=s:i=s,s=Math.floor((i-n)/2+n);return c(t.charCodeAt(t.length-s))&&s--,s}function h(t){return t>=55296&&t<=56319}function c(t){return t>=56320&&t<=57343}function u(t){return c(t.charCodeAt(0))}function d(t){return h(t.charCodeAt(t.length-1))}function f(t,e,r,o){return d(t)||u(o)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[s,t],[n,e],[i,r],[s,o]])}function p(t,e,n){return r(t,e,n,!0)}p.INSERT=i,p.DELETE=n,p.EQUAL=s,t.exports=p},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(7),s=n(3);class r{constructor(){this.Pa=null,this.Ra=null}layout(t,e){return this._a(t,e),this.Aa(t,e)}Aa(t,e){const n=s.c("AbstractLayoutRetryer.tryLayout");this.Ql(t,e);const r=this.Ia(t);return r.Fa(t,e).then(s=>{let o=r.accept(s,e);(o=r.ya(s,this.Oa,e,o))?n.finish(s):(i.a(this.Oa),this.La(this.Oa),this.Jl(t,e),this.Aa(this.Oa,e).Mt(n))}),n.result()}_a(t,e){}La(t){const e=t.Fs||t.parent.Fs;let n,i;for(;n=e.lastChild;)e.removeChild(n);for(;i=e.nextSibling;)i.parentNode.removeChild(i)}Ql(t,e){this.Oa=t.copy(),this.Pa=[].concat(e.Ma),this.Da=[].concat(e.Ta),t.us&&(this.Ra=t.us.Ql())}Jl(t,e){e.Ma=this.Pa,e.Ta=this.Da,t.us&&t.us.Jl(this.Ra)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return N}),n.d(e,"b",function(){return I});var i=n(7),s=n(1),r=n(13),o=n(22),a=n(0),l=n(27),h=n(11),c=n(14),u=n(18),d=n(29),f=n(6),p=n(12),g=n(9),m=n(26),b=n(31),E=n(19),w=n(3),v=n(8),y=n(15);const T={img:!0,svg:!0,audio:!0,video:!0};class N{constructor(t){this.constraints=t}Qc(t){return this.constraints.every(e=>e.Qc(t))}}class S extends o.a{constructor(t,e){super(),this.$a=t,this.penalty=e,this.Ba=!1,this.Ua=null}bc(t,e){return e<this.Ec()?null:(this.Ba||(this.Ua=t.Ga(this,e>0),this.Ba=!0),this.Ua)}Ec(){return this.penalty}cc(){return this.Ba?this.Ua:this.$a[this.$a.length-1]}}function x(t){switch(t){case"ruby":case"inline-block":case"inline-flex":case"inline-grid":case"inline-list-item":case"inline-table":return!0}return!1}class I extends v.b{constructor(t,e,n,i,s){super(t),this.ol=e,this.rl=n,this.za=i,this.Ha=s,this.ea=null,this.Va=!1,this.ja=!1,this.Xa=0,this.Wa=0,this.Ya=0,this.qa=0,this.ia=0,this.box=null,this.Ka=null,this.bands=null,this.overflown=!1,this.Ma=null,this.Yc=null,this.Za=!0,this.Qa=0,this.Ja=0,this.tu=0,this.ta=!0,this.aa=null,this.Ta=[],this.na=null,this.eu=null,this.nu=NaN,this.last=t.lastChild,this.iu=t.ownerDocument,s.Eh(this)}su(){return this.vertical?this.Xa:this.Ya}ru(){return this.vertical?this.Wa:this.qa}ou(){return this.vertical?this.qa:this.Xa}hu(){return this.vertical?this.Ya:this.Wa}Bl(t){return!(!t.Ts||this.Va&&!t.parent)}lu(t){return this.ta&&!!t&&t.overflow}vc(t){return this.vertical?t<this.ia:t>this.ia}cu(){const t=this.Ha.cl();return this.exclusions.concat(t)}sa(t){const e=this,n=w.c("openAllViews"),s=t.steps;e.ol.au(e.element,e.ja);let r=s.length-1,o=null;return n.loop(()=>{for(;r>=0;){const n=o,i=s[r];if(o=v.v(i,n),r!==s.length-1||o.us||(o.us=e.ea),0==r&&(o.ws=e.uu(t),o.after=t.after,o.xs=t.xs,o.after))break;const a=e.ol.fu(o,0==r&&0==o.ws);if(r--,a.Dt())return a}return w.d(!1)}).then(()=>{i.a(o),n.finish(o)}),n.result()}uu(t){return t.xs?l.b(t.xs,t.ws):t.ws}du(t,e){if(t.Vs&&t.inline&&!t.after&&0==t.Vs.count&&1!=t.Fs.nodeType){const e=t.Fs.textContent.match(C);return this.ol.pu(t,e[0].length)}return w.d(t)}gu(t,e){const n=this;let i=!1;const s=w.c("buildViewToNextBlockEdge");return s.Ut(s=>{t.Fs&&!c.e(t)&&e.push(t.copy()),n.du(t,0).then(r=>{r!==t&&(t=r,c.e(t)||e.push(t.copy())),n.$c(t).then(e=>{(t=e)?(!i&&n.za.Qc(t)||(i=!0,(t=t.modify()).overflow=!0),n.Bl(t)&&!n.vertical?n.Ul(t).then(e=>{t=e,n.Ha.Vh()&&(t=null),t?s.Gt():s.zt()}):t.inline?s.Gt():s.zt()):s.zt()})})}).then(()=>{s.finish(t)}),s.result()}$c(t,e){const n=this.ol.$c(t,e);return m.c(n,this)}mu(t){if(!t.Fs)return w.d(t);let e=[];const n=t.ys,i=this,s=w.c("buildDeepElementView");return s.Ut(s=>{t.Fs&&t.inline&&!c.e(t)?e.push(t.copy()):(e.length>0&&i.bu(t,e),e=[]),i.du(t,0).then(r=>{const o=r;if(o!==t){let i=o;for(;i&&i.ys!=n;)i=i.parent;if(null==i)return t=o,void s.zt();c.e(o)||e.push(o.copy())}i.$c(o).then(e=>{(t=e)&&t.ys!=n?i.za.Qc(t)?s.Gt():((t=t.modify()).overflow=!0,i.ta?s.zt():s.Gt()):s.zt()})})}).then(()=>{e.length>0&&i.bu(t,e),s.finish(t)}),s.result()}wu(t,e,n,i){const r=this.iu.createElement("div");return this.vertical?(i>=this.height&&(i-=.1),s.F(r,"height",`${n}px`),s.F(r,"width",`${i}px`)):(n>=this.width&&(n-=.1),s.F(r,"width",`${n}px`),s.F(r,"height",`${i}px`)),s.F(r,"float",e),s.F(r,"clear",e),this.element.insertBefore(r,t),r}Eu(){let t=this.element.firstChild;for(;t;){const e=t.nextSibling;if(1==t.nodeType){const e=t,n=e.style.cssFloat;if("left"!=n&&"right"!=n)break;this.element.removeChild(e)}t=e}}xu(){const t=this.element.firstChild,e=this.bands,n=this.vertical?this.su():this.ou(),i=this.vertical?this.ru():this.hu();for(const s of e){const e=s.y2-s.y1;s.left=this.wu(t,"left",s.x1-n,e),s.right=this.wu(t,"right",i-s.x2,e)}}yu(t,e,n,i){let s;if(t&&c.c(t.Fs))return NaN;if(t&&t.after&&!t.inline&&(s=c.a(t,this.rl,0,this.vertical),!isNaN(s)))return s;let r=i-(t=e[n]).vs;for(;;){if(s=c.a(t,this.rl,r,this.vertical),!isNaN(s))return s;if(r>0)r--;else{if(--n<0)return this.Ya;1!=(t=e[n]).Fs.nodeType&&(r=t.Fs.textContent.length)}}}ku(t){if("number"==typeof t)return t;const e=t.match(/^(-?[0-9]*(\.[0-9]*)?)px$/);return e?parseFloat(e[0]):0}Cl(t){const e=this.rl.tc(t),n=new h.a(0,0,0,0);return e&&(n.left=this.ku(e.marginLeft),n.top=this.ku(e.marginTop),n.right=this.ku(e.marginRight),n.bottom=this.ku(e.marginBottom)),n}Su(t){const e=this.rl.tc(t),n=new h.a(0,0,0,0);return e&&(n.left=this.ku(e.borderLeftWidth)+this.ku(e.paddingLeft),n.top=this.ku(e.borderTopWidth)+this.ku(e.paddingTop),n.right=this.ku(e.borderRightWidth)+this.ku(e.paddingRight),n.bottom=this.ku(e.borderBottomWidth)+this.ku(e.paddingBottom)),n}vu(t){const e=this.rl.tc(t),n=new h.a(0,0,0,0);if(e){if("border-box"==e.boxSizing)return this.Cl(t);n.left=this.ku(e.marginLeft)+this.ku(e.borderLeftWidth)+this.ku(e.paddingLeft),n.top=this.ku(e.marginTop)+this.ku(e.borderTopWidth)+this.ku(e.paddingTop),n.right=this.ku(e.marginRight)+this.ku(e.borderRightWidth)+this.ku(e.paddingRight),n.bottom=this.ku(e.marginBottom)+this.ku(e.borderBottomWidth)+this.ku(e.paddingBottom)}return n}Tu(t,e){const n=this.rl.tc(t);n&&(e.marginLeft=this.ku(n.marginLeft),e.borderLeft=this.ku(n.borderLeftWidth),e.paddingLeft=this.ku(n.paddingLeft),e.marginTop=this.ku(n.marginTop),e.borderTop=this.ku(n.borderTopWidth),e.paddingTop=this.ku(n.paddingTop),e.marginRight=this.ku(n.marginRight),e.borderRight=this.ku(n.borderRightWidth),e.paddingRight=this.ku(n.paddingRight),e.marginBottom=this.ku(n.marginBottom),e.borderBottom=this.ku(n.borderBottomWidth),e.paddingBottom=this.ku(n.paddingBottom))}Nu(t,e){const n=this.rl.tc(t);n&&(e.width=this.ku(n.width),e.height=this.ku(n.height))}Hl(t){return this.mu(t)}Cu(t){const e=this,n=w.c("layoutFloat"),r=t.Fs,o=t.Ts;return s.F(r,"float","none"),s.F(r,"display","inline-block"),s.F(r,"vertical-align","top"),e.mu(t).then(a=>{const l=e.rl.os(r),c=e.Cl(r);let u=new h.c(l.left-c.left,l.top-c.top,l.right+c.right,l.bottom+c.bottom),d=e.Xa,f=e.Wa,p=t.parent;for(;p&&p.inline;)p=p.parent;if(p){const n=p.Fs.ownerDocument.createElement("div");n.style.left="0px",n.style.top="0px",e.vertical?(n.style.bottom="0px",n.style.width="1px"):(n.style.right="0px",n.style.height="1px"),p.Fs.appendChild(n);const i=e.rl.os(n);d=Math.max(e._r(i),d),f=Math.min(e.Ar(i),f),p.Fs.removeChild(n);const s=e.vertical?u.y2-u.y1:u.x2-u.x1;"left"==o?f=Math.max(f,d+s):d=Math.min(d,f-s),p.Fs.appendChild(t.Fs)}let g=new h.c(d,e.Or()*e.Ya,f,e.Or()*e.qa),m=u;e.vertical&&(m=h.i(u));const b=e.Or();if(m.y1<e.tu*b){const t=m.y2-m.y1;m.y1=e.tu*b,m.y2=m.y1+t}h.h(g,e.bands,m,o),e.vertical&&(u=h.m(m));const E=e.vu(r);let w;s.F(r,"width",`${u.x2-u.x1-E.left-E.right}px`),s.F(r,"height",`${u.y2-u.y1-E.top-E.bottom}px`),s.F(r,"position","absolute"),i.a(t.display),s.F(r,"display",t.display);let v=null;if(p&&(v=p.Is?p:p.Ks()),v){const t=v.Fs.ownerDocument.createElement("div");t.style.position="absolute",v.vertical?t.style.right="0":t.style.left="0",t.style.top="0",v.Fs.appendChild(t),w=e.rl.os(t),v.Fs.removeChild(t)}else w={left:e.ou()-e.paddingLeft,right:e.hu()+e.paddingRight,top:e.su()-e.paddingTop};(v?v.vertical:e.vertical)?s.F(r,"right",`${w.right-u.x2}px`):s.F(r,"left",`${u.x1-w.left}px`),s.F(r,"top",`${u.y1-w.top}px`),t.Os&&(t.Os.parentNode.removeChild(t.Os),t.Os=null);const y=e.vertical?u.x1:u.y2,T=e.vertical?u.x2:u.y1;e.vc(y)&&0!=e.Ma.length?((t=t.modify()).overflow=!0,n.finish(t)):(e.Eu(),g=new h.c(e.ou(),e.su(),e.hu(),e.ru()),e.vertical&&(g=h.i(g)),h.e(g,e.bands,m,null,o),e.xu(),"left"==o?e.Qa=y:e.Ja=y,e.tu=T,e.Pu(y),n.finish(a))}),n.result()}Ru(t,e,n,i,s,r){const o=this.Ha,a=o.wh(e),l=t.element;a.element.parentNode.appendChild(l),t.Va=!0,t.ur=a.ur,t.dr=a.dr,t.vertical=a.vertical,t.marginLeft=t.marginRight=t.marginTop=t.marginBottom=0,t.borderLeft=t.borderRight=t.borderTop=t.borderBottom=0,t.paddingLeft=t.paddingRight=t.paddingTop=t.paddingBottom=0,t.exclusions=(a.exclusions||[]).concat(),t.Za=!o.Ph(),t.pr=null;const h=a.Vr();t.$r(h.x1-a.ur,h.x2-h.x1),t.Dr(h.y1-a.dr,h.y2-h.y1),s.Tl(t,a,this),t.init();const c=!!o.sl(t,e,n,i,!0,!o.Ph(),r);return c?(t.Eu(),t.init()):a.element.parentNode.removeChild(l),c}_u(t,e,n,i,r){const o=this.element.ownerDocument.createElement("div");s.F(o,"position","absolute");const a=this.Ha.yh(t.Us),l=new p.e(null,p.a.COLUMN,null,this.Ha.ls,t.zo,null,null),h=a.wh(),c=new D(e,o,this.ol.clone(),this.rl,this.za,l,h);return l.Eh(c),this.Ru(c,t.Us,e,n,i,r)?c:null}Au(t,e,n,s,r,o,a){const l=this.Ha,h=a?a.continuations:[],c=(t=h.concat(t))[0].float,u=l.dl(c,e,n),d=this._u(c,e,o,r,u),f={Iu:d,Fu:null,Ou:null};if(!d)return w.d(f);const p=w.c("layoutSinglePageFloatFragment");let g=!1,m=0;return p.Ut(e=>{if(m>=t.length)return void e.zt();const n=t[m],i=new v.a(n.zo);d.layout(i,!0).then(t=>{f.Ou=t,!t||s?(m++,e.Gt()):(g=!0,e.zt())})}).then(()=>{if(!g){i.a(d);const n=l.sl(d,c.Us,e,o,!1,s,u);if(n){const e=r.vl(t,n,d,!!f.Ou);l.Th(e,!0),f.Fu=e}else g=!0}p.finish(f)}),p.result()}Lu(t,e,n,s){const r=this.Ha,o=t.float;function a(e,n){n?r.Nh(n,!0):e&&e.element.parentNode.removeChild(e.element),r.Yh(o.Us),r.Fh(t)}r.Wh(o);const l=w.c("layoutPageFloatInner"),h=this;return this.Au([t],o.Ts,o.Ns,!r.Ph(),e,n,s).then(t=>{const e=t.Iu,n=t.Fu,c=t.Ou;n?h.Mu(o.Us,[s]).then(t=>{if(t){if(i.a(n),r.Th(n),r.qh(o.Us),c){const t=new p.c(o,c.primary);r.Fh(t)}l.finish(!0)}else a(e,n),l.finish(!1)}):(a(e,n),l.finish(!1))}),l.result()}Mu(t,e){const n=this.Ha,i=n.Kh(t),s=[],r=[];let o=!1;const a=w.c("layoutStashedPageFloats"),l=this;let h=0;return a.Ut(t=>{if(h>=i.length)return void t.zt();const n=i[h];if(e.includes(n))return h++,void t.Gt();const a=(new p.f).kh(n.continuations[0].float);l.Au(n.continuations,n.Ts,null,!1,a,null).then(e=>{const n=e.Iu;n&&s.push(n);const i=e.Fu;i?(r.push(i),h++,t.Gt()):(o=!0,t.zt())})}).then(()=>{o?(r.forEach(t=>{n.Nh(t,!0)}),s.forEach(t=>{const e=t.element;e&&e.parentNode&&e.parentNode.removeChild(e)})):i.forEach(t=>{const e=t.area.element;e&&e.parentNode&&e.parentNode.removeChild(e)}),a.finish(!o)}),a.result()}Du(t){const e=t.Fs.parentNode,n=e.ownerDocument.createElement("span");n.setAttribute(v.m,"1"),"footnote"===t.Ts&&this.ol.$u(t,"footnote-call",n),e.appendChild(n),e.removeChild(t.Fs);const i=t.modify();return i.after=!0,i.Fs=n,i}Sl(t,e,n){const i=this,s=w.c("resolveFloatReferenceFromColumnSpan"),r=this.Ha,o=r.yh(p.a.REGION);return r.wh().width<o.wh().width&&t===p.a.COLUMN?e===a.t.auto?this.mu(n.copy()).then(e=>{const n=e.Fs;let r=E.b(i.rl,n,[E.a.MIN_CONTENT_INLINE_SIZE])[E.a.MIN_CONTENT_INLINE_SIZE];const o=i.Cl(n);i.vertical?r+=o.top+o.bottom:r+=o.left+o.right,r>i.width?s.finish(p.a.REGION):s.finish(t)}):e===a.t.all?s.finish(p.a.REGION):s.finish(t):s.finish(t),s.result()}Bu(t){const e=this,n=this.Ha,s=(new p.f).El(t);let r;const o=n.Zo(t.Ys());return(r=o?w.d(o):s.kl(t,n,this)).Ot(r=>{const o=v.x(t,0),a=e.Du(t),l=s.Ch(r,n),h=new p.c(r,o);if(l&&l.Jo(r))return n._h(r,a.Fs),w.d(a);if(n.Sh(r)||n.Oh(r))return n.Fh(h),n._h(r,a.Fs),w.d(a);if(e.eu)return w.d(null);{const t=c.a(a,e.rl,0,e.vertical);return e.vc(t)?w.d(a):e.Lu(h,s,t,l).Ot(t=>(i.a(r),t?w.d(null):(n._h(r,a.Fs),w.d(a))))}})}Uu(t,e,n,i){const r=e.createElement("span");r.style.visibility="hidden",r.style.verticalAlign="top",r.setAttribute(v.m,"1");const o=e.createElement("span");o.style.fontSize="0",o.style.lineHeight="0",o.textContent=" #",r.appendChild(o),r.style.display="block",r.style.textIndent="0",r.style.textAlign="left",n.insertBefore(r,t);const a=this.rl.os(o);r.style.textAlign="right";const l=this.rl.os(o);r.style.textAlign="",s.j(document.body)?r.style.display="inline":r.style.display="inline-block";const h=i?l.top-a.top:l.left-a.left,c=h>=1?`${h-1}px`:"100%";return i?r.style.paddingTop=c:r.style.paddingLeft=c,r}Gu(t,e,n,i,r,o){return function(t,e,n,i){if(s.k(document.body)){const r=_(t),o=e?n:n.previousSibling,a=o?o.textContent:"";if(a.charAt(a.length-1)===r){const t=n.ownerDocument,e=n.parentNode;s.l(document.body)?e.insertBefore(t.createTextNode(" "),i):e.insertBefore(t.createElement("wbr"),i)}}}(t,e,n,i),this.Uu(i,r,o,t.vertical)}zu(t,e,n){const i=this.rl.os(t),s=this.rl.os(e);n.vertical?(e.style.marginRight=`${s.right-i.right}px`,e.style.width="0px"):(e.style.marginTop=`${i.top-s.top}px`,e.style.height="0px"),e.setAttribute(v.m,"1")}ql(t,e){if(t.after&&!t.inline)return;if(e){let e="";for(let n=t.parent;n&&!e;n=n.parent)!n.inline&&n.Fs&&(e=n.Fs.style.textAlign);if("justify"!==e)return}const n=t.Fs,i=n.ownerDocument,s=e&&(t.after||1!=n.nodeType);let r=s?n.nextSibling:n;r&&!r.parentNode&&(r=null);const o=n.parentNode||t.parent&&t.parent.Fs;if(!o)return;const a=this.Gu(t,s,n,r,i,o);if(!e){const e=i.createElement("div");o.insertBefore(e,r),this.zu(a,e,t)}}Hu(t,e,n){const i=this,s=w.c("processLineStyling");let r=n.concat([]);n.splice(0,n.length);let o=0,a=t.Vs;return 0==a.count&&(a=a.outer),s.Ut(n=>{if(!a)return void n.zt();const s=i.Vu(r),l=a.count-o;if(s.length<=l)return void n.zt();const h=i.ju(r,s[l-1],!0);null!=h?i.Yl(h,!1,!1).then(()=>{o+=l,i.ol.pu(h,0).then(s=>{t=s,i.ql(t,!1),a=t.Vs,r=[],i.gu(t,r).then(t=>{e=t,n.Gt()})})}):n.zt()}).then(()=>{Array.prototype.push.apply(n,r),s.finish(e)}),s.result()}Xu(t){return!(2!=t.length&&this.Ma.length>0)&&t[0].ys==t[1].ys&&T[t[0].ys.localName]}Wu(t){let e=0,n=0;for(let i=t.length-1;i>=0;i--){const s=t[i];if(!s.after||!s.Fs||1!=s.Fs.nodeType)break;const r=this.Cl(s.Fs),o=this.vertical?-r.left:r.bottom;o>0?e=Math.max(e,o):n=Math.min(n,o)}return e-n}zl(t){const e=this,n=w.c("layoutBreakableBlock"),i=[];return e.gu(t,i).then(s=>{const r=i.length-1;if(r<0)return void n.finish(s);let a,l=e.yu(s,i,r,i[r].vs),h=!1;if(!s||!c.c(s.Fs)){const t=o.c(s,e.ac());h=e.vc(l+(e.vertical?-1:1)*t.minimum),e.vc(l+(e.vertical?-1:1)*t.current)&&!e.eu&&(e.eu=s)}null==s&&(l+=e.Wu(i)),e.Pu(l),(a=t.Vs?e.Hu(t,s,i):w.d(s)).then(t=>{e.bu(t,i),i.length>0&&(e.Yu(i),h&&!e.Xu(i)&&t&&((t=t.modify()).overflow=!0)),n.finish(t)})}),n.result()}bu(t,e){g.b(g.a.POST_LAYOUT_BLOCK).forEach(n=>{n(t,e,this)})}qu(t,e,n){const i=this.vertical?t-1:t+1;let s,r=0,o=e[0].vs,a=r,l=e.length-1,h=e[l].vs;for(;o<h;){s=o+Math.ceil((h-o)/2),a=r;let t=l;for(;a<t;){const n=a+Math.ceil((t-a)/2);e[n].vs>s?t=n-1:a=n}const c=this.yu(null,e,a,s);if(this.vertical?c<=i:c>=i){for(h=s-1;e[a].vs==s;)a--;l=a}else n&&this.Pu(c),o=s,r=a}return{Pc:e[a],index:o,Ku:a}}ju(t,e,n){const i=this.qu(e,t,!0);let s=i.Pc;const r=s.Fs;if(1!=r.nodeType){const e=r;s=this.Qu(s).Zu(e,s,i.index,t,i.Ku,n)}return this.Wl(s,!1),s}Qu(t){return g.b(g.a.RESOLVE_TEXT_NODE_BREAKER).reduce((e,n)=>n(t)||e,O.instance)}Ju(t,e){const n=[],i=t.ownerDocument.createRange();let s=!1,r=t,o=null,a=!1,l=!0;for(;l;){let t=!0;do{let n=null;r==e&&(l=1===e.nodeType&&!(!e.firstChild||s)),1!=r.nodeType?(a||(i.setStartBefore(r),a=!0),o=r):s?s=!1:c.d(r)?t=!a:"ruby"==r.localName||x(this.rl.tc(r).display)?((t=!a)&&(i.setStartBefore(r),a=!0,o=r),r.contains(e)&&(l=!1)):n=r.firstChild,n||(n=r.nextSibling)||(s=!0,n=r.parentNode),r=n}while(t&&l);if(a){i.setEndAfter(o);const t=this.rl.Nl(i);for(let e=0;e<t.length;e++)n.push(t[e]);a=!1}}return n}Vu(t){const e=[],n=this.Ju(t[0].Fs,t[t.length-1].Fs);n.sort(this.vertical?v.q:v.r);let i=0,r=0,o=0,a=0,l=0;const h=this.Or();for(;;){if(l<n.length){const t=n[l];let e=1;if(a>0){const n=Math.max(this.Fr(t),1);e=h*this.Pr(t)<h*i?h*(this.Rr(t)-i)/n:h*this.Rr(t)>h*r?h*(r-this.Pr(t))/n:1}if(0==a||e>=.6||e>=.2&&this._r(t)>=o-1){o=this.Ar(t),this.vertical?(i=0==a?t.right:Math.max(i,t.right),r=0==a?t.left:Math.min(r,t.left)):(i=0==a?t.top:Math.min(i,t.top),r=0==a?t.bottom:Math.max(r,t.bottom)),a++,l++;continue}}if(a>0&&(e.push(r),a=0),l>=n.length)break}return e.sort(s.B),this.vertical&&e.reverse(),e}Sc(t){let e=0;return t.Zs(t=>{if("clone"===t.Hs["box-decoration-break"]){i.a(t.Fs instanceof Element);const n=this.Su(t.Fs);e+=t.vertical?-n.left:n.bottom,"table"===t.display&&(e+=t.Rs)}}),e}tf(t){let e;return(e=t?t.lc(this):o.c(null,this.ac())).current}Ga(t,e){const n=this,i=t.$a;let r,o,a=i[0];for(;a.parent&&a.inline;)a=a.parent;e?(r=1,o=1):(r=Math.max((a.Hs.widows||2)-0,1),o=Math.max((a.Hs.orphans||2)-0,1));const l=n.Sc(a),h=this.Vu(i);let c=this.ia-l;const u=this.Or(),d=this.tf(t);c-=u*d;const f=this.ef(i);isNaN(f.edge)&&(f.edge=u*(1/0));let p=s.i(h.length,t=>{const e=h[t];return n.vertical?e<c||e<=f.edge:e>c||e>=f.edge});const g=p<=0;if(g&&(p=s.i(h.length,t=>n.vertical?h[t]<c:h[t]>c)),(p=Math.min(h.length-r,p))<o)return null;let m;if(c=h[p-1],m=g?f.nf:this.ju(t.$a,c,e)){const t=this.if(m);!isNaN(t)&&t<c&&(c=t),this.gr=u*(c-this.Ya)+d}return m}if(t){let e=t;do{e=e.parent}while(e&&e.inline);return e?((e=e.copy().modify()).after=!0,c.a(e,this.rl,0,this.vertical)):NaN}ef(t){const e=t.findIndex(t=>t.overflow);if(e<0)return{edge:NaN,nf:null};const n=t[e];return{edge:this.yu(null,t,e,n.vs),nf:n}}xc(t){return this.gr=t.gr+this.tf(t),t.position}Yl(t,e,n){i.a(t.us);let s=(new u.c).find(t.us).Yl(this,t,e,n);return s||(s=u.d.Yl(this,t,e,n)),s}ra(){let t=null,e=null,n=0,i=0;do{n=i,i=Number.MAX_VALUE;for(let s=this.Ma.length-1;s>=0&&!e;--s){e=(t=this.Ma[s]).bc(this,n);const r=t.Ec();r>n&&(i=Math.min(i,r))}}while(i>n&&!e&&this.Za);return{oa:e?t:null,Pc:e}}sf(t,e,n,i){if(this.Ha.Vh()||this.Yc||!e)return w.d(t);const s=this,r=w.c("doFinishBreak");let o=!1;if(!t){if(this.Za)return f.b.warn("Could not find any page breaks?!!"),s.rf(e).then(t=>{t?((t=t.modify()).overflow=!1,s.Yl(t,o,!0).then(()=>{r.finish(t)})):r.finish(t)}),r.result();t=n,o=!0,s.gr=i}return this.Yl(t,o,!0).then(()=>{r.finish(t)}),r.result()}Gl(t){if(t.after)return!0;switch(t.ys.namespaceURI){case s.a.SVG:return!1}return!t._s}hf(t){const e=t.toString();return""==e||"auto"==e||!!e.match(/^0+(.0*)?[^0-9]/)}lf(t,e){if(!t)return!1;if(c.c(t.Fs))return!1;let n=c.a(t,this.rl,0,this.vertical);const i=o.c(t,this.ac()),s=this.vc(n+(this.vertical?-1:1)*i.minimum);if(this.vc(n+(this.vertical?-1:1)*i.current)&&!this.eu)this.eu=t;else if(e){const t=n+this.Wu(e),s=this.ia-this.Or()*i.current;n=this.vertical?Math.min(n,Math.max(t,s)):Math.max(n,Math.min(t,s))}return this.Pu(n),s}Kc(t,e,n,i){if(!t)return!1;if(c.c(t.Fs))return!1;const s=this.lf(t,e);return!n&&s||this.cf(t,i,s),s}af(t){if(!t.Fs.parentNode)return!1;const e=this.Cl(t.Fs),n=t.Fs.ownerDocument.createElement("div");this.vertical?(n.style.bottom="0px",n.style.width="1px",n.style.marginRight=`${e.right}px`):(n.style.right="0px",n.style.height="1px",n.style.marginTop=`${e.top}px`),t.Fs.parentNode.insertBefore(n,t.Fs);let i=this.rl.os(n);const s=this.Pr(i),r=this.Or(),o=t.Ns;let a=-this.Or()*(1/0);switch("all"===o&&(a=this.Ha.fl(o,this)),o){case"left":a=r*Math.max(a*r,this.Qa*r);break;case"right":a=r*Math.max(a*r,this.Ja*r);break;default:a=r*Math.max(a*r,Math.max(this.Ja*r,this.Qa*r))}if(s*r>=a*r)return t.Fs.parentNode.removeChild(n),!1;{const o=Math.max(1,(a-s)*r);this.vertical?n.style.width=`${o}px`:n.style.height=`${o}px`,i=this.rl.os(n);const l=this.Rr(i);if(this.vertical){let t=l+e.right-a;t>0==e.right>=0&&(t+=e.right),n.style.marginLeft=`${t}px`}else{let t=a-(l+e.top);t>0==e.top>=0&&(t+=e.top),n.style.marginBottom=`${t}px`}return t.Os=n,!0}}uf(t){return!!u.e(t)||!!y.c.Il(t)}ff(t,e,n){const s=t.after?t.parent&&t.parent.us:t.us;if(s&&!this.uf(s))return w.d(t);const o=this,a=w.c("skipEdges");let l=!n&&e&&t&&t.after,h=n,c=null,d=[],f=[],p=!1;function g(){return!!n||!e&&r.c(h)}function m(){(t=d[0]||t).Fs.parentNode.removeChild(t.Fs),o.Yc=h}return a.Ut(n=>{for(;t;){i.a(t.us);const s=(new u.c).find(t.us);do{if(!t.Fs)break;if(t.inline&&1!=t.Fs.nodeType){if(v.p(t.Fs,t.whitespace))break;if(!t.after)return g()?m():o.Kc(c,null,!0,h)?(t=(o.ta&&c||t).modify()).overflow=!0:(t=t.modify()).breakBefore=h,void n.zt()}if(!t.after){if(s&&s.jl(t))break;if(t.Ns&&o.af(t)&&e&&0===o.Ma.length&&o.cf(t.copy(),h,!1),!o.uf(t.us)||y.c.Il(t.us)||o.Bl(t)||t._s)return d.push(t.copy()),h=r.d(h,t.breakBefore),g()?m():!o.Kc(c,null,!0,h)&&o.za.Qc(t)||((t=(o.ta&&c||t).modify()).overflow=!0),void n.zt()}if(1!=t.Fs.nodeType)break;const i=t.Fs.style;if(t.after){if(t.inline)break;if(s&&s.Xl(t,o.ta))break;if(p){if(g())return m(),void n.zt();d=[],e=!1,l=!1,h=null}p=!1,c=t.copy(),f.push(c),h=r.d(h,t.breakAfter),!i||o.hf(i.paddingBottom)&&o.hf(i.borderBottomWidth)||(f=[c])}else{if(d.push(t.copy()),h=r.d(h,t.breakBefore),!o.za.Qc(t)&&(o.Kc(c,null,!o.ta,h),(t=t.modify()).overflow=!0,o.ta))return void n.zt();const e=t.Fs.localName;if(T[e])return g()?m():o.Kc(c,null,!0,h)&&((t=(o.ta&&c||t).modify()).overflow=!0),void n.zt();!i||o.hf(i.paddingTop)&&o.hf(i.borderTopWidth)||(l=!1,f=[]),p=!0}}while(0);const a=o.$c(t,l);if(a.Dt())return void a.then(e=>{t=e,n.Gt()});t=a.get()}o.Kc(c,f,!o.ta,h)?c&&o.ta&&((t=c.modify()).overflow=!0):r.c(h)&&(o.Yc=h),n.zt()}).then(()=>{c&&(o.aa=c.Ys()),a.finish(t)}),a.result()}rf(t){let e=t.copy();const n=this,i=w.c("skipEdges");let s=null,o=!1;return i.Ut(i=>{for(;t;){do{if(!t.Fs)break;if(t.inline&&1!=t.Fs.nodeType){if(v.p(t.Fs,t.whitespace))break;if(!t.after)return r.c(s)&&(n.Yc=s),void i.zt()}if(!t.after&&(n.Bl(t)||t._s))return s=r.d(s,t.breakBefore),r.c(s)&&(n.Yc=s),void i.zt();if(1!=t.Fs.nodeType)break;const e=t.Fs.style;if(t.after){if(o){if(r.c(s))return n.Yc=s,void i.zt();s=null}o=!1,s=r.d(s,t.breakAfter)}else{s=r.d(s,t.breakBefore);const o=t.Fs.localName;if(T[o])return r.c(s)&&(n.Yc=s),void i.zt();if(e&&(!n.hf(e.paddingTop)||!n.hf(e.borderTopWidth)))return void i.zt()}o=!0}while(0);const e=n.ol.$c(t);if(e.Dt())return void e.then(e=>{t=e,i.Gt()});t=e.get()}e=null,i.zt()}).then(()=>{i.finish(e)}),i.result()}Ul(t){return p.h(t.Us)||"footnote"===t.Ts?this.Bu(t):this.Cu(t)}df(t,e,n){const s=this,r=w.c("layoutNext");return this.ff(t,e,n||null).then(n=>{if(!(t=n)||s.Yc||s.lu(t))r.finish(t);else{const n=t.us;i.a(n),(new u.c).find(n).layout(t,s,e).Mt(r)}}),r.result()}Wl(t,e){if(t)for(let n=t.parent;t;t=n,n=n?n.parent:null){const s=(n||t).us;i.a(s),(new u.c).find(s).Wl(this,n,t,e),e=!1}}pf(){const t=this.element.ownerDocument.createElement("div");t.style.position="absolute",t.style.top=`${this.paddingTop}px`,t.style.right=`${this.paddingRight}px`,t.style.bottom=`${this.paddingBottom}px`,t.style.left=`${this.paddingLeft}px`,this.element.appendChild(t);const e=this.rl.os(t);this.element.removeChild(t);const n=this.ur+this.left+this.kr(),i=this.dr+this.top+this.xr();this.box=new h.c(n,i,n+this.width,i+this.height),this.Xa=e?this.vertical?e.top:e.left:0,this.Wa=e?this.vertical?e.bottom:e.right:0,this.Ya=e?this.vertical?e.right:e.top:0,this.qa=e?this.vertical?e.left:e.bottom:0,this.Qa=this.Ya,this.Ja=this.Ya,this.tu=this.Ya,this.ia=this.qa,this.bands=h.l(this.box,[this.Gr()],this.cu(),8,this.br,this.vertical),this.xu()}init(){this.Ka=[],s.F(this.element,"width",`${this.width}px`),s.F(this.element,"height",`${this.height}px`),this.pf(),this.gr=0,this.overflown=!1,this.Yc=null,this.aa=null}cf(t,e,n){i.a(t.us);const s=t.copy(),r=(new u.c).find(t.us),o=this.Sc(s),a=r.Vl(s,e,n,this.gr+o);this.Ma.push(a)}Yu(t){const e=t[0].Bs,n=new S(t,e);this.Ma.push(n)}Pu(t){if(!isNaN(t)){const e=this.Or()*(t-this.Ya);this.gr=Math.max(e,this.gr)}}layout(t,e,n){if(this.Ka.push(t),t.primary.after&&(this.aa=t.primary),this.ta&&this.overflown)return w.d(t);if(this.gf())return t.primary.after&&1===t.primary.steps.length?w.d(null):w.d(t);const i=this,s=w.c("layout");return i.sa(t.primary).then(t=>{let r=null;if(t.Fs)r=t.copy();else{const t=e=>{e.Pc.Fs&&(r=e.Pc,i.ol.removeEventListener("nextInTree",t))};i.ol.addEventListener("nextInTree",t)}const o=new A(e,n);o.layout(t,i).then(t=>{i.sf(t,o.context.mf,r,o.bf).then(t=>{let e=null;(i.na?w.d(null):i.ha(t)).then(()=>{if(i.Ha.Vh())s.finish(null);else if(t){i.overflown=!0;const e=new v.a(t.Ys());s.finish(e)}else s.finish(null)})})})}),s.result()}gf(){return this.Ha.ml(this)}bl(){return this.Ha.bl()}ha(t){const e=w.c("doFinishBreakOfFragmentLayoutConstraints"),n=[].concat(this.Ta);n.sort((t,e)=>t.va()-e.va());let i=0;return e.loop(()=>i<n.length?n[i++].Yl(t,this).Lt(!0):w.d(!1)).then(()=>{e.finish(!0)}),e.result()}Fa(t,e,n){const i=this,s=w.c("doLayout");let r=null;return i.Ma=[],i.eu=null,s.Ut(s=>{for(;t;){let o=!0;if(i.df(t,e,n||null).then(a=>{if(e=!1,n=null,i.eu&&i.ta?(i.Yc=null,(t=i.eu).overflow=!0):t=a,i.Ha.Vh())s.zt();else if(i.Yc)s.zt();else if(t&&i.lu(t)){r=t;const e=i.ra();t=e.Pc,e.oa&&e.oa.uc(i),s.zt()}else o?o=!1:s.Gt()}),o)return void(o=!1)}i.gr+=i.tf(),s.zt()}).then(()=>{s.finish({Pc:t,mf:r})}),s.result()}wf(){const t=this.Ka;let e=this.element.lastChild;for(;e!=this.last;){const t=e.previousSibling;this.element===e.parentNode&&this.ol.Ef(e)||this.element.removeChild(e),e=t}this.Eu(),this.init();const n=this,i=w.c("redoLayout");let s=0,r=null,o=!0;return i.Ut(e=>{if(s<t.length){const i=t[s++];n.layout(i,o).then(t=>{o=!1,t?(r=t,e.zt()):e.Gt()})}else e.zt()}).then(()=>{i.finish(r)}),i.result()}xf(){const t=this.Ha.ul();t>0&&isFinite(t)&&(this.nu=this.Or()*(t-this.Ya-this.gr))}ac(){const t=[];for(let e=this;e;e=e.na)e.Ta.forEach(e=>{if(y.c.Ol(e)){const n=e.Tc();t.push(n)}if(m.b(e)){const n=e.Tc();t.push(n)}y.e.Ll(e)&&e.yf(this).forEach(e=>{t.push(e)})});return t}}const C=/^[^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527][^A-Za-z0-9_\u009E\u009F\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02AF\u037B-\u037D\u0386\u0388-\u0482\u048A-\u0527]*)?/;class O{Zu(t,e,n,i,s,r){if(e.after)e.ws=t.length;else{let i=n-e.vs;const s=t.data;(i=173==s.charCodeAt(i)?this.kf(t,s,i,e):this.Sf(t,s,i,e))>0&&(e=this.vf(e,i,t))}return e}kf(t,e,n,i){return t.replaceData(n,e.length-n,i.zs?"":_(i)),n+1}Sf(t,e,n,i){const r=e.charAt(n);n++;const o=e.charAt(n);return t.replaceData(n,e.length-n,!i.zs&&s.x(r)&&s.x(o)?_(i):""),n}vf(t,e,n){return(t=t.modify()).ws+=e,t.breakBefore=null,t}}function _(t){return t.Gs||t.parent&&t.parent.Gs||"-"}O.instance=new O;class A extends d.a{constructor(t,e){super(),this.Bc=t,this.Tf=null,this.bf=0,this.Nf=!1,this.context={mf:null},this.breakAfter=e||null}Ia(t){return new k(this.Bc,this.breakAfter,this.context)}_a(t,e){e.Ta=[],e.na||b.a()}La(t){super.La(t);let e=t;for(;e;){const t=e.Fs;t&&c.f(t.parentNode,t),e=e.parent}}Ql(t,e){super.Ql(t,e),this.Tf=e.Yc,this.bf=e.gr,this.Nf=e.overflown}Jl(t,e){super.Jl(t,e),e.Yc=this.Tf,e.gr=this.bf,e.overflown=this.Nf}}class k{constructor(t,e,n){this.Bc=t,this.breakAfter=e,this.context=n}Fa(t,e){const n=w.c("DefaultLayoutMode.doLayout");return m.d(t,e).then(()=>{e.Fa(t,this.Bc,this.breakAfter).then(t=>{this.context.mf=t.mf,n.finish(t.Pc)})}),n.result()}accept(t,e){return!(!e.Ha.Vh()&&!e.Yc)||e.Ta.length<=0||e.Ta.every(n=>n.Qc(t,this.context.mf,e))}ya(t,e,n,i){if(!i){const e=n.Ta.some(e=>e.xa(t));i=!e}return n.Ta.forEach(s=>{s.ya(i,t,e,n)}),i}}class D extends I{constructor(t,e,n,i,s,r,o){super(e,n,i,s,r),this.Ts=t,this.Cf=o,this.il=[],this.Pf=[],this.hl=!0}sa(t){return super.sa(t).Ot(t=>(t&&this.Rf(t),w.d(t)))}_f(t){const e=this.Cf.Vr(),n=e.x2-e.x1,i=e.y2-e.y1;function r(e,n){e.forEach(e=>{const i=s.t(t,e);if(i&&"%"===i.charAt(i.length-1)){const r=parseFloat(i),o=n*r/100;s.F(t,e,`${o}px`)}})}r(["width","max-width","min-width"],n),r(["height","max-height","min-height"],i),r(["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left"],this.vertical?i:n),["margin-top","margin-right","margin-bottom","margin-left"].forEach(e=>{"auto"===s.t(t,e)&&s.F(t,e,"0")})}Rf(t){for(;t.parent;)t=t.parent;i.a(1===t.Fs.nodeType);const e=t.Fs;if(this.il.push(e),this.hl&&this._f(e),this.Pf.push(this.Cl(e)),this.hl){const t=this.Ts;if(this.Cf.vertical){if("block-end"===t||"left"===t){const t=s.t(e,"height");""!==t&&"auto"!==t&&s.F(e,"margin-top","auto")}}else if("block-end"===t||"bottom"===t){const t=s.t(e,"width");""!==t&&"auto"!==t&&s.F(e,"margin-left","auto")}}}ll(){return Math.max.apply(null,this.il.map((t,e)=>{const n=this.rl.os(t),i=this.Pf[e];return this.vertical?i.top+n.height+i.bottom:i.left+n.width+i.right}))}}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return s});let i=[];function s(){i=[]}},function(t,e,n){"use strict";n.r(e);let i=!1;var s,r,o;!function(t){t.LTR="ltr",t.RTL="rtl"}(s||(s={})),function(t){t.LEFT="left",t.RIGHT="right"}(r||(r={})),function(t){t.LOADING="loading",t.INTERACTIVE="interactive",t.COMPLETE="complete"}(o||(o={}));const a={PageProgression:s,PageSide:r,ReadyState:o};var l=n(9),h=n(6);function c(){}function u(t,e,n){n||(n=this.Af.now());let i,s=this.timestamps[t];s||(s=this.timestamps[t]=[]);for(let t=s.length-1;t>=0&&(!(i=s[t])||i[e]);t--)i=null;i||(i={},s.push(i)),i[e]=n}function d(t,e){this.If(t,"start",e)}function f(t,e){this.If(t,"end",e)}const p={now:Date.now},g=new class{constructor(t){this.Af=t,this.timestamps={},this.If=c,this.registerStartTiming=this.registerStartTiming=c,this.registerEndTiming=this.registerEndTiming=c}Ff(t,e){u.call(this,t,"start",e)}Of(t,e){u.call(this,t,"end",e)}printTimings(){const t=this.timestamps;let e="";Object.keys(t).forEach(n=>{const i=t[n],s=i.length;for(let t=0;t<s;t++){const r=i[t];e+=n,s>1&&(e+=`(${t})`),e+=` => start: ${r.start}, end: ${r.end}, duration: ${r.end-r.start}\n`}}),h.b.info(e)}disable(){this.If=c,this.registerStartTiming=this.registerStartTiming=c,this.registerEndTiming=this.registerEndTiming=c}enable(){this.If=u,this.registerStartTiming=this.registerStartTiming=d,this.registerEndTiming=this.registerEndTiming=f}isEnabled(){return this.registerStartTiming===d}}(window&&window.performance||p);g.Ff("load_vivliostyle");const m={profiler:{registerStartTiming:g.registerStartTiming,registerEndTiming:g.registerEndTiming,printTimings:g.printTimings,disable:g.disable,enable:g.enable}};var b=n(7),E=n(1);function w(t){if(1==t.nodeType){const e=t.getAttribute("id");if(e&&e.match(/^[-a-zA-Z_0-9.\u007F-\uFFFF]+$/))return e}return null}function v(t){return`^${t}`}function y(t){return t.replace(/[\[\]\(\),=;^]/g,v)}function T(t){return t.substr(1)}function N(t){return t?t.replace(/\^[\[\]\(\),=;^]/g,T):t}function S(t){const e=[];do{const n=t.match(/^(\^,|[^,])*/),i=N(n[0]);if(!(t=t.substr(n[0].length+1))&&!e.length)return i;e.push(i)}while(t);return e}function x(t){const e={};for(;t;){const n=t.match(/^;([^;=]+)=(([^;]|\^;)*)/);if(!n)return e;e[n[1]]=S(n[2]),t=t.substr(n[0].length)}return e}class I{it(t){t.append("!")}Lf(t){return!1}}class C{constructor(t,e,n){this.index=t,this.id=e,this.Mf=n}it(t){t.append("/"),t.append(this.index.toString()),(this.id||this.Mf)&&(t.append("["),this.id&&t.append(this.id),this.Mf&&(t.append(";s="),t.append(this.Mf)),t.append("]"))}Lf(t){if(1!=t.node.nodeType)throw new Error("E_CFI_NOT_ELEMENT");const e=t.node,n=e.children,i=n.length;let s;const r=Math.floor(this.index/2)-1;if(r<0||0==i)s=e.firstChild,t.node=s||e;else{if(s=n[Math.min(r,i-1)],1&this.index){const e=s.nextSibling;e&&1!=e.nodeType?s=e:t.after=!0}t.node=s}if(this.id&&(t.after||this.id!=w(t.node)))throw new Error("E_CFI_ID_MISMATCH");return t.Mf=this.Mf,!0}}class O{constructor(t,e,n,i){this.offset=t,this.Df=e,this.$f=n,this.Mf=i}Lf(t){if(this.offset>0&&!t.after){let e=this.offset,n=t.node;for(;;){const t=n.nodeType;if(1==t)break;const i=n.nextSibling;if(3<=t&&t<=5){const t=n.textContent.length;if(e<=t)break;if(!i){e=t;break}e-=t}if(!i){e=0;break}n=i}t.node=n,t.offset=e}return t.Mf=this.Mf,!0}it(t){t.append(":"),t.append(this.offset.toString()),(this.Df||this.$f||this.Mf)&&(t.append("["),(this.Df||this.$f)&&(this.Df&&t.append(y(this.Df)),t.append(","),this.$f&&t.append(y(this.$f))),this.Mf&&(t.append(";s="),t.append(this.Mf)),t.append("]"))}}class _{constructor(){this.steps=null}Bf(t){let e=t.match(/^#?epubcfi\((.*)\)$/);if(!e)throw new Error("E_CFI_NOT_CFI");const n=e[1];let i=0;const s=[];for(;;){let t;switch(n.charAt(i)){case"/":{if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[([-a-zA-Z_0-9.\u007F-\uFFFF]+)(;([^\]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;const r=parseInt(e[1],10),o=e[3];t=x(e[4]),s.push(new C(r,o,E.g(t.s)));break}case":":{if(i++,!(e=n.substr(i).match(/^(0|[1-9][0-9]*)(\[((([^\];,]|\^[\];,])*)(,(([^\];,]|\^[\];,])*))?)(;([^]]|\^\])*)?\])?/)))throw new Error("E_CFI_NUMBER_EXPECTED");i+=e[0].length;const r=parseInt(e[1],10);let o=e[4];o&&(o=N(o));let a=e[7];a&&(a=N(a)),t=x(e[10]),s.push(new O(r,o,a,E.g(t.s)));break}case"!":i++,s.push(new I);break;case"~":case"@":case"":return void(this.steps=s);default:throw new Error("E_CFI_PARSE_ERROR")}}}navigate(t){const e={node:t.documentElement,offset:0,after:!1,Mf:null,ref:null};for(let t=0;t<this.steps.length;t++)if(!this.steps[t].Lf(e)){e.ref=new _,e.ref.steps=this.steps.slice(t+1);break}return e}trim(t,e){return t.replace(/\s+/g," ").match(e?/^[ -\uD7FF\uE000-\uFFFF]{0,8}/:/[ -\uD7FF\uE000-\uFFFF]{0,8}$/)[0].replace(/^\s/,"").replace(/\s$/,"")}Uf(t,e,n,i){const s=[];let r=t.parentNode,o="",a="";for(;t;){switch(t.nodeType){case 3:case 4:case 5:{const i=t.textContent,s=i.length;n?(e+=s,o||(o=i)):(e>s&&(e=s),n=!0,o=i.substr(0,e),a=i.substr(e)),t=t.previousSibling;continue}case 8:t=t.previousSibling;continue}break}for((e>0||o||a)&&(o=this.trim(o,!1),a=this.trim(a,!0),s.push(new O(e,o,a,i)),i=null);r&&r&&9!=r.nodeType;){const e=n?null:w(t);let o=n?1:0;for(;t;)1==t.nodeType&&(o+=2),t=t.previousSibling;s.push(new C(o,e,i)),i=null,t=r,r=r.parentNode,n=!1}s.reverse(),this.steps?(s.push(new I),this.steps=s.concat(this.steps)):this.steps=s}toString(){if(!this.steps)return"";const t=new E.d;t.append("epubcfi(");for(let e=0;e<this.steps.length;e++)this.steps[e].it(t);return t.append(")"),t.toString()}}var A=n(20),k=n(4);function D(t){const e={};return Object.keys(t).forEach(n=>{e[n]=Array.from(t[n])}),e}class L{constructor(t,e){this.Gf=t,this.resolved=e,this.zf=null,this.Zi=-1,this.Hf=-1}equals(t){return this===t||!!t&&this.Gf===t.Gf&&this.resolved===t.resolved&&this.Zi===t.Zi&&this.Hf===t.Hf}Vf(){return this.resolved}resolve(){this.resolved=!0}unresolve(){this.resolved=!1}}class R{constructor(t,e){this.jf=t,this.bo=e}Yn(t,e){t=this.jf.Wf.Xf(t,this.bo),this.jf.Yf[t]=e}qf(){return this.jf.qf()}}class P{constructor(t,e,n,i){this.jf=t,this.bo=e,this.te=n,this.Kf=i,this.styler=null}Zf(t){this.styler=t}Qf(t){const e=t.match(/^[^#]*#(.*)$/);return e?e[1]:null}Jf(t){let e=this.jf.Wf.sc(E.C(t,this.bo),this.bo);return"#"===e.charAt(0)&&(e=e.substring(1)),e}wn(t,e){const n=this,i=new k.t(this.Kf,()=>e(function(){const e=n.jf.ed[t];return e&&e.length?e[e.length-1]:null}()),`page-counter-${t}`);return this.jf.nd(t,function(t){return e(t[0])},i),i}xn(t,e){const n=this,i=new k.t(this.Kf,()=>e(n.jf.ed[t]||[]),`page-counters-${t}`);return this.jf.nd(t,e,i),i}sd(t,e,n){let i=this.jf.Yf[e];return!i&&n&&t&&(this.styler.rd(t),i=this.jf.Yf[e]),i||null}od(t){return this.jf.currentPage.Xi[t]?this.jf.ed:this.jf.hd[t]||null}kn(t,e,n){const i=this.Qf(t),s=this.Jf(t);let r=this.sd(i,s,!1);if(r&&r[e]){const t=r[e];return new k.f(this.te,n(t[t.length-1]||null))}const o=this;return new k.t(this.Kf,()=>{if(r=o.sd(i,s,!0)){if(r[e]){const t=r[e];return n(t[t.length-1]||null)}{const t=o.od(s);if(t){if(o.jf.ld(s),t[e]){const i=t[e];return n(i[i.length-1]||null)}return n(0)}return o.jf.ad(s,!1),"??"}}return o.jf.ad(s,!1),"??"},`target-counter-${e}-of-${t}`)}vn(t,e,n){const i=this.Qf(t),s=this.Jf(t),r=this;return new k.t(this.Kf,()=>{const t=r.od(s);if(t){r.jf.ld(s);const o=t[e]||[],a=r.sd(i,s,!0)[e]||[];return n(o.concat(a))}return r.jf.ad(s,!1),"??"},`target-counters-${e}-of-${t}`)}}class F{constructor(t){this.Wf=t,this.Yf={},this.hd={},this.ed={},this.ud={},this.fd=[],this.dd={},this.currentPage=null,this.pd=[],this.gd=[],this.md=[],this.bd={},this.wd={},this.Ed=[],this.ed.page=[0]}xd(t){return new R(this,t)}yd(t,e,n){return new P(this,t,e,n)}kd(t){this.currentPage=t}Sd(t,e){this.ed[t]?this.ed[t].push(e):this.ed[t]=[e]}vd(t){const e=this.ed.page;e&&e.length?e[e.length-1]=t:this.ed.page=[t]}Td(t,e){let n;this.ud=D(this.ed);const i=t["counter-reset"];if(i){const t=i.evaluate(e);t&&(n=A.b(t,!0))}if(n)for(const t in n)this.Sd(t,n[t]);let s;const r=t["counter-increment"];if(r){const t=r.evaluate(e);t&&(s=A.b(t,!1))}s?"page"in s||(s.page=1):(s={}).page=1;for(const t in s){this.ed[t]||this.Sd(t,0);const e=this.ed[t];e[e.length-1]+=s[t]}}Nd(t){this.fd.push(this.ed),this.ed=D(t)}Cd(){this.ed=this.fd.pop()}ld(t){const e=this.bd[t];let n=this.wd[t];n||(n=this.wd[t]=[]);let i=!1;for(let s=0;s<this.gd.length;){const r=this.gd[s];if(r.Gf===t){if(r.resolve(),this.gd.splice(s,1),e){const t=e.indexOf(r);t>=0&&e.splice(t,1)}n.push(r),i=!0}else s++}i||this.ad(t,!0)}ad(t,e){if(!this.pd.some(e=>e.Gf===t)){const n=new L(t,e);this.pd.push(n)}}Pd(t,e){const n=Object.keys(this.currentPage.Xi);if(n.length>0){const i=D(this.ed);n.forEach(n=>{this.hd[n]=i;const s=this.dd[n];if(s&&s.Hf<e){const t=this.wd[n];if(t){let e,i=this.bd[n];for(i||(i=this.bd[n]=[]);e=t.shift();)e.unresolve(),i.push(e)}}this.dd[n]={Zi:t,Hf:e}})}const i=this.ud;let s;for(;s=this.pd.shift();){let n;s.zf=i,s.Zi=t,s.Hf=e,s.Vf()?(n=this.wd[s.Gf])||(n=this.wd[s.Gf]=[]):(n=this.bd[s.Gf])||(n=this.bd[s.Gf]=[]),n.every(t=>!s.equals(t))&&n.push(s)}this.currentPage=null}Rd(t){let e=[];Object.keys(t.Xi).forEach(t=>{const n=this.bd[t];n&&(e=e.concat(n))}),e.sort((t,e)=>t.Zi-e.Zi||t.Hf-e.Hf);const n=[];let i=null;return e.forEach(t=>{i&&i.Zi===t.Zi&&i.Hf===t.Hf?i.refs.push(t):(i={Zi:t.Zi,Hf:t.Hf,zf:t.zf,refs:[t]},n.push(i))}),n}_d(t){this.md.push(this.gd),this.gd=t}Ad(){this.gd=this.md.pop()}nd(t,e,n){"pages"===t&&this.Ed.push({expr:n,format:e})}qf(){return this.Yr.bind(this)}Yr(t,e,n){if(this.Ed.findIndex(e=>e.expr===t)>=0){const i=n.createElement("span");return i.textContent=e,i.setAttribute(M,t.key),i}return null}Id(t){const e=t.root.querySelectorAll(`[${M}]`),n=this.ed.page[0];Array.from(e).forEach(t=>{const e=t.getAttribute(M),i=this.Ed.findIndex(t=>t.expr.key===e);b.a(i>=0),t.textContent=this.Ed[i].format([n])})}Fd(t){return new U(this,t)}}const M="data-vivliostyle-pages-counter";class U{constructor(t,e){this.jf=t,this.Hf=e}Qc(t){if(!t||t.after)return!0;const e=t.Fs;if(!e||1!==e.nodeType)return!0;const n=e.getAttribute("id")||e.getAttribute("name");if(!n)return!0;if(!this.jf.wd[n]&&!this.jf.bd[n])return!0;const i=this.jf.dd[n];return!i||this.Hf>=i.Hf}}var z=n(5),B=n(10),H=n(2),$=n(16),V=n(0),G=n(12),j=n(3),X=n(8);const Y=G.d;class K extends G.b{constructor(t,e,n,i,s){super(t,e,"block-end",null,n,s),this.$s=i}Wo(t){return!(t instanceof K)}}class W extends Y{constructor(t,e,n,i){super(t,"block-end",e,n,i)}Ho(){return 1/0}nh(t){return t instanceof K||this.Ho()<t.Ho()}}class Z{constructor(t){this.footnote=t}Qc(t){const e=t.Ys();return!X.u(e,this.footnote.zo)}}G.f.register(new class{xl(t){return"footnote"===t.Ts}yl(t){return t instanceof K}kl(t,e,n){let i=G.a.REGION;const s=e.yh(i);e.yh(G.a.PAGE).Gh(s)&&(i=G.a.PAGE);const r=t.Ys();b.a(e.ls);const o=new K(r,i,e.ls,t.$s,t.Cs);return e.Ko(o),j.d(o)}vl(t,e,n,i){const s=t[0].float;return new W(s.Us,t,n,i)}Ch(t,e){const n=e.yh(t.Us).hh.filter(t=>t instanceof W);return b.a(n.length<=1),n[0]||null}Tl(t,e,n){t.ja=!0,t.hl=!1;const i=t.element;b.a(i),t.vertical=n.ol.Od(e.vertical,n.ol.Pc&&"rtl"===n.ol.Pc.direction,i),t._f(i),n.Tu(i,t),n.Nu(i,t)}forbid(t,e){const n=t;switch(n.$s){case V.t.line:{const t=new Z(n);e.gl(t,n.Us);break}}}});var q=n(22),Q=n(14),J=n(18),tt=n(29),et=n(23),nt=n(26),it=n(31),st=n(15);class rt{constructor(t,e){this.parent=t,this.Ld=e,this.Rl="RepetitiveElementsOwner",this.tn=!1,this.Md=null}_t(){return"Repetitive elements owner formatting context (RepetitiveElementsOwnerFormattingContext)"}Zl(t,e){return e}mh(){return this.parent}Tc(){return this.Md}Dd(t){const e=this.$d(t);return e?e.Fs:null}$d(t){do{if(!t.Qs(this)&&t.ys===this.Ld)return t}while(t=t.parent);return null}Bd(t){this.Md||it.b.some(t=>t.root===this.Ld&&(this.Md=t.elements,!0))||(this.Md=new ot(t,this.Ld),it.b.push({root:this.Ld,elements:this.Md}))}Ql(){}Jl(t){}}class ot{constructor(t,e){this.vertical=t,this.Ud=e,this.Gd=null,this.zd=null,this.Hd=null,this.Vd=null,this.jd=null,this.Xd=null,this.Wd=0,this.Yd=0,this.qd=!1,this.Kd=!1,this.Zd=!0,this.Qd=!0,this.Jd=!1,this.tp=null,this.ep=null,this.np=[],this.ip=[],this.sp=!1}rp(t){this.jd||(this.jd=X.x(t,0),this.Gd=t.ys,this.Hd=t.Fs)}hp(t){this.Xd||(this.Xd=X.x(t,0),this.zd=t.ys,this.Vd=t.Fs)}lp(t){this.Hd&&(this.Wd=Q.b(this.Hd,t,this.vertical),this.Hd=null),this.Vd&&(this.Yd=Q.b(this.Vd,t,this.vertical),this.Vd=null)}cp(){this.qd=this.Kd=!1,this.Zd=!0,this.Qd=!0}ap(t,e,n){return!this.jd||this.qd?j.d(!0):this.up(this.jd,t,e,n)}fp(t,e,n){return!this.Xd||this.Kd?j.d(!0):this.up(this.Xd,t,e,n)}up(t,e,n,i){const s=e.Fs.ownerDocument,r=e.Fs,o=s.createElement("div");r.appendChild(o);const a=new et.PseudoColumn(i,o,e),l=a.fa().Yc;return a.fa().Yc=null,this.dp=!0,a.layout(new X.a(t),!0).Ot(()=>(this.dp=!1,r.removeChild(o),this.pp(o,r,n),a.fa().Yc=l,j.d(!0)))}pp(t,e,n){if(e)for(;t.firstChild;){const i=t.firstChild;t.removeChild(i),i.setAttribute(X.m,"1"),n?e.insertBefore(i,n):e.appendChild(i)}}lc(t){let e=0;return t&&!this.ka(t)?e:((!this.Kd||t&&this.gp(t))&&(e+=this.Yd),this.qd||(e+=this.Wd),e)}fc(t){let e=0;return t&&!this.ka(t)?e:(t&&this.gp(t)&&(e+=this.Yd),this.Qd||(e+=this.Wd),e)}gp(t){return this.mp(t,this.ip,e=>this.bp(this.ep,t,!1))}ka(t){return this.mp(t,this.np,e=>this.bp(this.Ud,t,!0))}mp(t,e,n){const i=e.filter(e=>e.Pc.ys===t.ys&&e.Pc.after===t.after);if(i.length>0)return i[0].result;{const i=n(t);return e.push({Pc:t,result:i}),i}}bp(t,e,n){const i=[];for(let n=t;n;n=n.parentNode){if(e.ys===n)return e.after;i.push(n)}for(let t=e.ys;t;t=t.parentNode){const e=i.indexOf(t);if(e>=0)return!!n&&0===e;for(let e=t;e;e=e.previousElementSibling)if(i.includes(e))return!0}return e.after}Nc(t){return t&&this.tp===t.ys}wp(){return!!(!this.Kd&&this.Zd&&this.Xd||!this.qd&&this.Qd&&this.jd)}Ep(){!this.Kd&&this.Zd&&this.Xd?this.Kd=!0:!this.qd&&this.Qd&&this.jd&&(this.qd=!0)}xp(){this.qd=!1,this.Qd=!1}yp(){this.Kd=!1,this.Zd=!1}kp(){return!!this.jd}Sp(){return!!this.Xd}vp(t){return this.Gd===t}Tp(t){return this.zd===t}}class at{constructor(t){this.us=t}accept(t,e){return!!t}ya(t,e,n,i){const s=this.us.Tc();return s&&(b.a(n.rl),s.Jd||(s.lp(n),s.Jd=!0)),i}}class lt{constructor(t){this.us=t}accept(t,e){return!0}ya(t,e,n,i){return i}}class ht extends at{constructor(t,e){super(t),this.processor=e}Fa(t,e){return this.processor.Np(t,e)}accept(t,e){return!1}}class ct extends lt{constructor(t,e){super(t),this.processor=e}Fa(t,e){return t.Qs(this.us)||t.after||e.Ta.unshift(new ut(t)),this.processor.Fa(t,e)}}class ut{constructor(t){this.Al="RepetitiveElementsOwner";const e=gt(t.us);this.Pc=e.$d(t)}Qc(t,e,n){const i=this.Tc();return!(i&&!Q.c(this.Pc.Fs)&&i.wp()&&(e&&!t||t&&t.overflow))}xa(t){const e=this.Tc();return!!e&&!!e.wp()&&(e.Ep(),!0)}ya(t,e,n,i){const s=this.Tc();s&&t&&i.ta&&(null==e||s.gp(e))&&s.yp()}Yl(t,e){const n=gt(this.Pc.us),i=this.Tc();if(!i)return j.d(!0);const s=this.Pc;return function(t,e,n){const i=t.Tc();if(i){const s=t.$d(e);if(s.Fs){const t=s.Fs.firstChild;return i.ap(s,t,n)}}return j.d(!0)}(n,s,e).Ot(()=>(function(t,e,n){const i=t.Tc();if(i&&!i.Kd){const s=t.$d(e);if(s.Fs)return i.fp(s,null,n)}return j.d(!0)})(n,s,e).Ot(()=>(i.cp(),j.d(!0))))}Tc(){return gt(this.Pc.us).Tc()}Sa(t){return t instanceof ut&&gt(this.Pc.us)===gt(t.Pc.us)}va(){return 10}}class dt extends tt.a{constructor(t,e){super(),this.us=t,this.processor=e}Ia(t){const e=this.us.Tc();return t.Qs(this.us)||e.Jd?(t.Qs(this.us)||t.after||e&&e.xp(),new ct(this.us,this.processor)):new ht(this.us,this.processor)}}class ft extends et.EdgeSkipper{constructor(t,e){super(),this.us=t,this.column=e}jl(t){const e=this.us,n=t.Pc,i=e.Tc();if(n.parent&&e.Ld===n.parent.ys){switch(n.Ls){case"header":if(!i.kp())return i.rp(n),j.d(!0);n.Ls="none";break;case"footer":if(!i.Sp())return i.hp(n),j.d(!0);n.Ls="none"}i.tp||(i.tp=n.ys)}return et.EdgeSkipper.prototype.jl.call(this,t)}Xl(t){const e=this.us,n=t.Pc;return n.ys===e.Ld&&(e.Tc().ep=t.Xc&&t.Xc.ys,t.break=!0),"header"===n.Ls||"footer"===n.Ls?j.d(!0):et.EdgeSkipper.prototype.Xl.call(this,t)}}function pt(t,e){t&&function(t,e){for(let n=t;n;n=n.parent){const t=n.us;t&&t instanceof rt&&!n.Qs(t)&&e(t,n)}}(t.after?t.parent:t,(t,n)=>{st.e.Fl(t)||e.Ta.push(new ut(n))})}function gt(t){return b.a(t instanceof rt),t}const mt=new class extends J.b{layout(t,e,n){if(e.Bl(t))return e.Ul(t);const i=gt(t.us);return i.Dd(t)?(n&&pt(t.parent,e),t.Qs(i)?J.b.prototype.layout.call(this,t,e,n):new dt(i,this).layout(t,e)):e.mu(t)}jl(t){const e=function(t){const e=t.us;return e&&e instanceof rt?e:null}(t).Tc();return!!e&&(e.dp||!e.vp(t.ys)&&!e.Tp(t.ys)||t.Fs.parentNode.removeChild(t.Fs),!1)}Np(t,e){gt(t.us);const n=j.c("BlockLayoutProcessor.doInitialLayout");return this.Cp(t,e).Mt(n),n.result()}Cp(t,e){const n=gt(t.us),i=new ft(n,e);return new et.LayoutIterator(i,e.ol).iterate(t)}Fa(t,e){const n=gt(t.us),i=j.c("doLayout"),s=e.ol.$c(t,!1);return nt.c(s,e).then(t=>{let s=t;i.Ut(t=>{for(;s;){let i=!0;if(e.df(s,!1).then(r=>{s=r,e.Ha.Vh()?t.zt():e.Yc?t.zt():s&&e.lu(s)?t.zt():s&&s.after&&s.ys==n.Ld?t.zt():i?i=!1:t.Gt()}),i)return void(i=!1)}t.zt()}).then(()=>{i.finish(s)})}),i.result()}Yl(t,e,n,i){return J.b.prototype.Yl.call(this,t,e,n,i)}Wl(t,e,n,i){J.b.prototype.Wl(t,e,n,i)}};l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,t=>t instanceof rt&&!st.e.Fl(t)?mt:null);class bt{constructor(t,e){this.rowIndex=t,this.ys=e,this.cells=[]}Pp(t){this.cells.push(t)}Rp(){return Math.min.apply(null,this.cells.map(t=>t.height))}}class Et{constructor(t,e,n){this.rowIndex=t,this._p=e,this.height=0,this.Ap=null,this.Ip=n,this.colSpan=n.colSpan||1,this.rowSpan=n.rowSpan||1}Fp(t){this.height=t}Op(t){this.Ap=t}}class wt{constructor(t,e,n){this.rowIndex=t,this._p=e,this.cell=n}}class vt{constructor(t,e,n){this.column=t,this.Lp=n,this.empty=!1,this.Mp=new et.PseudoColumn(t,e,n)}ra(){const t=this.Lp.Fs,e=this.Lp.verticalAlign;"middle"!==e&&"bottom"!==e||E.F(t,"vertical-align","top");const n=this.Mp.ra(!0);return E.F(t,"vertical-align",e),n}}class yt{constructor(t,e){this.Fs=t,this.side=e}}class Tt extends q.b{constructor(t,e,n,i){super(t,e,n,i),this.Dp=null,this.rowIndex=null,this.us=t.us}bc(t,e){const n=super.bc(t,e);return e<this.Ec()?null:this.$p().every(t=>!!t.Pc)?n:null}Ec(){let t=super.Ec();return this.$p().forEach(e=>{t+=e.oa.Ec()}),t}$p(){if(!this.Dp){this.us;const t=this.Bp();this.Dp=t.map(t=>t.ra())}return this.Dp}Up(){return null!=this.rowIndex?this.rowIndex:this.rowIndex=this.us.Gp(this.position.ys)}Bp(){return this.us.zp(this.Up()).map(this.us.Hp,this.us)}}class Nt extends q.a{constructor(t,e,n){super(),this.rowIndex=t,this.Vp=e,this.us=n,this.Dp=null}bc(t,e){if(e<this.Ec())return null;const n=this.Bp(),i=this.$p(),s=i.every(t=>!!t.Pc)&&i.some((t,e)=>{const i=n[e].Mp,s=t.Pc;return!i.la(s)&&!i.ca(s)});return this.Vp.overflow=i.some(t=>t.Pc&&t.Pc.overflow),s?this.Vp:null}Ec(){const t=this.us,e=t.jp(this.rowIndex);let n=0;return t.Xp(e)||(n+=10),this.$p().forEach(t=>{n+=t.oa.Ec()}),n}$p(){if(!this.Dp){const t=this.Bp();this.Dp=t.map(t=>t.ra())}return this.Dp}Bp(){return this.us.Wp(this.rowIndex).map(this.us.Hp,this.us)}}class St extends rt{constructor(t,e){super(t,e),this.Yp=e,this.Rl="Table",this.vertical=!1,this.columnCount=-1,this.qp=0,this.captions=[],this.Kp=null,this.Zp=null,this.Ps=0,this.rows=[],this.slots=[],this.Qp=[],this.Jp=null,this.tg=[],this.Md=null}_t(){return"Table formatting context (Table.TableFormattingContext)"}Zl(t,e){if(!e)return e;switch(t.display){case"table-row":return 0===this.tg.length;case"table-cell":return!this.tg.some(e=>e.eg.steps[0].node===t.ys);default:return e}}mh(){return this.parent}ng(){this.Qp=[]}ig(t,e){this.rows[t]=e}sg(t){let e=this.slots[t];return e||(e=this.slots[t]=[]),e}Pp(t,e){let n=this.rows[t];n||(this.ig(t,new bt(t,null)),n=this.rows[t]),b.a(n),n.Pp(e);const i=t+e.rowSpan;let s=this.sg(t),r=0;for(;s[r];)r++;for(;t<i;t++){s=this.sg(t);for(let n=r;n<r+e.colSpan;n++){const i=s[n]=new wt(t,n,e);e.Ap||e.Op(i)}}}jp(t){const e=this.rows[t];return b.a(e),e}Gp(t){return this.rows.findIndex(e=>t===e.ys)}rg(t,e,n){let i=this.Qp[t];i||(i=this.Qp[t]=[]),i[e]=n}Wp(t){return this.sg(t).reduce((t,e)=>e.cell!==t[t.length-1]?t.concat(e.cell):t,[])}zp(t){return this.Wp(t).filter(e=>e.rowIndex+e.rowSpan-1>t)}Hp(t){return this.Qp[t.rowIndex]&&this.Qp[t.rowIndex][t._p]}Xp(t){return t.Rp()>this.qp/2}og(){return this.columnCount<0&&(this.columnCount=Math.max.apply(null,this.rows.map(t=>t.cells.reduce((t,e)=>t+e.colSpan,0)))),this.columnCount}hg(t){this.rows.forEach(e=>{e.cells.forEach(e=>{const n=t.os(e.Ip);e.Ip=null,e.Fp(this.vertical?n.width:n.height)})})}lg(t){if(!t)return null;let e=null,n=0,i=0;t:for(n=0;n<this.Qp.length;n++)if(this.Qp[n])for(i=0;i<this.Qp[n].length;i++)if(this.Qp[n][i]&&t===this.Qp[n][i].Mp.fa()){e=this.rows[n].cells[i];break t}if(!e)return null;for(;n<this.slots.length;n++)for(;i<this.slots[n].length;i++){const t=this.slots[n][i];if(t.cell===e)return{rowIndex:t.rowIndex,_p:t._p}}return null}cg(t){const e=[];return this.slots.reduce((n,i,s)=>{if(s>=t.rowIndex)return n;const r=this.Hp(i[t._p].cell);return!r||e.includes(r)?n:(this.ag(r.Mp.fa(),n),e.push(r),n)},[])}ug(){const t=[];return this.rows.forEach(e=>{e.cells.forEach((e,n)=>{t[n]||(t[n]={collected:[],elements:[]});const i=t[n],s=this.Hp(e);s&&!i.collected.includes(s)&&(this.ag(s.Mp.fa(),i.elements),i.collected.push(s))})}),[new xt(t.map(t=>t.elements))]}ag(t,e){t.Ta.forEach(t=>{if(st.c.Ol(t)){const n=t.Tc();e.push(n)}st.e.Ll(t)&&t.yf(null).forEach(t=>{e.push(t)})})}Ql(){return[].concat(this.tg)}Jl(t){this.tg=t}}class xt{constructor(t){this.fg=t}lc(t){return this.dg(t,t=>t.current)}fc(t){return this.dg(t,t=>t.minimum)}dg(t,e){let n=0;return this.fg.forEach(i=>{const s=q.c(t,i);n=Math.max(n,e(s))}),n}}function It(t){return b.a(t instanceof St),t}function Ct(t){return function(t){return"table-row-group"===t||"table-header-group"===t||"table-footer-group"===t}(t)||function(t){return"table"===t||"inline-table"===t}(t)}function Ot(t,e,n){const i=t.Pc,s=i.display,r=i.parent?i.parent.display:null;let o=!1;if("inline-table"===r&&!(i.us instanceof St))for(let t=i.parent;t;t=t.parent)if(t.us instanceof St){o=t.us===e;break}return o||"table-row"===s&&!Ct(r)||"table-cell"===s&&"table-row"!==r&&!Ct(r)||i.us instanceof St&&i.us!==e?n.mu(i).Ot(e=>(t.Pc=e,j.d(!0))):null}class _t extends et.EdgeSkipper{constructor(t,e){super(),this.us=t,this.column=e,this.rowIndex=-1,this._p=0,this.pg=!1,this.$a=[],this.gg=!1}jl(t){const e=this.us,n=Ot(t,e,this.column);if(n)return n;this.mg(t);const i=t.Pc,s=i.display,r=e.Tc();switch(s){case"table":e.Ps=i.Ps;break;case"table-caption":{const t=new yt(i.Fs,i.captionSide);e.captions.push(t);break}case"table-header-group":return r.kp()||(this.gg=!0,r.rp(i)),j.d(!0);case"table-footer-group":return r.Sp()||(this.gg=!0,r.hp(i)),j.d(!0);case"table-row":this.gg||(this.pg=!0,this.rowIndex++,b.a(i.ys),this._p=0,e.ig(this.rowIndex,new bt(this.rowIndex,i.ys)),r.tp||(r.tp=i.ys))}return super.jl(t)}Xl(t){const e=this.us,n=t.Pc,i=n.display,s=this.column.rl;if(this.mg(t),n.ys===e.Yp){const i=s.tc(e.Dd(n));e.qp=parseFloat(i[e.vertical?"height":"width"]),e.Tc().ep=t.Xc&&t.Xc.ys,t.break=!0}else switch(i){case"table-header-group":case"table-footer-group":if(this.gg)return this.gg=!1,j.d(!0);break;case"table-row":this.gg||(e.Jp=n.Fs,this.pg=!1);break;case"table-cell":if(!this.gg){this.pg||(this.rowIndex++,this._p=0,this.pg=!0);const t=n.Fs;e.Pp(this.rowIndex,new Et(this.rowIndex,this._p,t)),this._p++}}return super.Xl(t)}Oc(t){this.bg(t)}Lc(t){this.bg(t)}Mc(t){this.bg(t)}Dc(t){this.bg(t)}bg(t){const e=t.Pc;e&&e.Fs&&!Q.e(e)&&this.$a.push(e.clone())}mg(t){this.$a.length>0&&this.column.bu(t.Pc,this.$a),this.$a=[]}}class At extends et.EdgeSkipper{constructor(t,e){super(!0),this.us=t,this.column=e,this.pg=!1,this.wg=-1,this.Eg=0,this.xg=e.ta,e.ta=!1}yg(){this.column.ta=this.xg}kg(t){const e=this.us.Zp;b.a(e);let n=0;for(let i=0;i<t.colSpan;i++)n+=e[t.Ap._p+i];return n+this.us.Ps*(t.colSpan-1)}Sg(t,e,n){const i=t.rowIndex,s=t._p,r=t.colSpan,o=e.Fs;e.verticalAlign,r>1&&(E.F(o,"box-sizing","border-box"),E.F(o,this.us.vertical?"height":"width",`${this.kg(t)}px`));const a=o.ownerDocument.createElement("div");o.appendChild(a);const l=new vt(this.column,a,e);return this.us.rg(i,s,l),1===n.primary.steps.length&&n.primary.after&&(l.empty=!0),l.Mp.layout(n,!0).Lt(!0)}vg(t){const e=this.us.tg[0];return!!e&&e.cell.Ap._p===t}Tg(){const t=this.us.tg;if(0===t.length)return[];const e=[];let n=0;do{const i=t[n],s=i.cell.rowIndex;if(s<this.wg){let r=e[s];r||(r=e[s]=[]),r.push(i),t.splice(n,1)}else n++}while(n<t.length);return e}Ng(t){const e=this.us,n=this.Tg(),i=n.reduce(t=>t+1,0);if(0===i)return j.d(!0);const s=this.column.ol,r=t.Pc;r.Fs.parentNode.removeChild(r.Fs);const o=j.c("layoutRowSpanningCellsFromPreviousFragment");let a=j.d(!0),l=0;const h=[];return n.forEach(t=>{a=a.Ot(()=>{const n=X.v(t[0].eg.steps[1],r.parent);return s.fu(n,!1).Ot(()=>{let r=j.d(!0),o=0;function a(t){for(;o<t;){if(!h.includes(o)){const t=n.Fs.ownerDocument.createElement("td");E.F(t,"padding","0"),n.Fs.appendChild(t)}o++}}return t.forEach(t=>{r=r.Ot(()=>{const e=t.cell;a(e.Ap._p);const r=t.eg,c=X.v(r.steps[0],n);return c.ws=r.ws,c.after=r.after,c.Es=r.steps[0].Es+1,s.fu(c,!1).Ot(()=>{const n=t.Cg;for(let t=0;t<e.colSpan;t++)h.push(o+t);return o+=e.colSpan,this.Sg(e,c,n).Ot(()=>(c.Fs.rowSpan=e.rowIndex+e.rowSpan-this.wg+i-l,j.d(!0)))})})}),r.Ot(()=>(a(e.og()),l++,j.d(!0)))})})}),a.then(()=>{s.fu(r,!0,t.Rc).then(()=>{o.finish(!0)})}),o.result()}Pg(t){if(this.Rg||this._g)return j.d(!0);const e=t.Pc,n=this.us;return this.wg<0?(b.a(e.ys),this.wg=n.Gp(e.ys)):this.wg++,this.Eg=0,this.pg=!0,this.Ng(t).Ot(()=>(this.Ag(),this.column.Kc(t.Xc,null,!0,t.Hc)&&0===n.zp(this.wg-1).length&&(this.yg(),e.overflow=!0,t.break=!0),j.d(!0)))}Ag(){this.us.jp(this.wg).cells.forEach(t=>{const e=this.us.tg[t._p];if(e&&e.cell.Ap._p==t.Ap._p){const t=e.eg.steps[0],n=this.column.ol.xmldoc.Ig(t.node);nt.e(n,t.Es+1,1)}})}Fg(t){if(this.Rg||this._g)return j.d(!0);const e=t.Pc;this.pg||(this.wg<0?this.wg=0:this.wg++,this.Eg=0,this.pg=!0);const n=this.us.jp(this.wg).cells[this.Eg],i=e.copy().modify();i.after=!0,t.Pc=i;const s=j.c("startTableCell");let r;if(this.vg(n.Ap._p)){const t=this.us.tg.shift();e.Es=t.eg.steps[0].Es+1,r=j.d(t.Cg)}else r=this.column.$c(e,t.Rc).Ot(t=>{t.Fs&&e.Fs.removeChild(t.Fs);const n=X.x(t,0);return j.d(new X.a(n))});return r.then(i=>{b.a(e),this.Sg(n,e,i).then(()=>{this.Xl(t),this.Eg++,s.finish(!0)})}),s.result()}Uc(t){const e=Ot(t,It(this.us),this.column);if(e)return e;const n=t.Pc,i=this.us.Tc(),s=n.display;return"table-header-group"===s&&i&&i.vp(n.ys)?(this.Rg=!0,j.d(!0)):"table-footer-group"===s&&i&&i.Tp(n.ys)?(this._g=!0,j.d(!0)):"table-row"===s?this.Pg(t):"table-cell"===s?this.Fg(t):j.d(!0)}zc(t){const e=t.Pc;if("table-row"===e.display&&(this.pg=!1,!this.Rg&&!this._g)){const t=e.copy().modify();t.after=!1;const n=new Nt(this.wg,t,this.us);this.column.Ma.push(n)}return j.d(!0)}Xl(t){const e=t.Pc,n=this.us.Tc(),i=e.display;if("table-header-group"===i?n&&!n.dp&&n.vp(e.ys)?(this.Rg=!1,e.Fs.parentNode.removeChild(e.Fs)):E.F(e.Fs,"display","table-row-group"):"table-footer-group"===i&&(n&&!n.dp&&n.Tp(e.ys)?(this._g=!1,e.Fs.parentNode.removeChild(e.Fs)):E.F(e.Fs,"display","table-row-group")),i&&At.Og[i])e.Fs.parentNode.removeChild(e.Fs);else{if(e.ys!==this.us.Yp)return super.Xl(t);e.overflow=this.column.lf(e,null),this.yg(),t.break=!0}return j.d(!0)}}At.Og={"table-caption":!0,"table-column-group":!0,"table-column":!0};const kt=[];class Dt{Lg(t,e){const n=It(t.us),i=new _t(n,e);return new et.LayoutIterator(i,e.ol).iterate(t)}Mg(t,e,n,i){const s=t.ownerDocument,r=s.createElement("tr"),o=[];for(let t=0;t<e;t++){const t=s.createElement("td");r.appendChild(t),o.push(t)}t.parentNode.insertBefore(r,t.nextSibling);const a=o.map(t=>{const e=i.os(t);return n?e.height:e.width});return t.parentNode.removeChild(r),a}Dg(t){const e=[];let n=t.firstElementChild;for(;n;)"colgroup"===n.localName&&e.push(n),n=n.nextElementSibling;return e}$g(t){const e=[];return t.forEach(t=>{let n=t.span;t.removeAttribute("span");let i=t.firstElementChild;for(;i;){if("col"===i.localName){let s=i.span;for(i.removeAttribute("span"),n-=s;s-- >1;){const n=i.cloneNode(!0);t.insertBefore(n,i),e.push(n)}e.push(i)}i=i.nextElementSibling}for(;n-- >0;)i=t.ownerDocument.createElement("col"),t.appendChild(i),e.push(i)}),e}Bg(t,e,n,i){if(t.length<n){const s=i.ownerDocument.createElement("colgroup");e.push(s);for(let e=t.length;e<n;e++){const e=i.ownerDocument.createElement("col");s.appendChild(e),t.push(e)}}}Ug(t,e,n){const i=t.vertical,s=t.Jp;if(!s)return;b.a(s),t.Jp=null;const r=s.ownerDocument.createDocumentFragment(),o=t.og();if(!(o>0))return void(t.Kp=r);const a=t.Zp=this.Mg(s,o,i,n.rl),l=this.Dg(e),h=this.$g(l);this.Bg(h,l,o,e),h.forEach((t,e)=>{E.F(t,i?"height":"width",`${a[e]}px`)}),l.forEach(t=>{r.appendChild(t.cloneNode(!0))}),t.Kp=r}Np(t,e){const n=It(t.us);n.vertical=t.vertical,n.Bd(t.vertical),b.a(t.ys);const i=function(t){const e=kt.findIndex(e=>e.root===t),n=kt[e];return n?n.Gg:null}(t.ys);!function(t){const e=kt.findIndex(e=>e.root===t);e>=0&&kt.splice(e,1)}(t.ys);const s=j.c("TableLayoutProcessor.doInitialLayout"),r=t.copy();return this.Lg(t,e).then(o=>{const a=o.Fs,l=e.rl.os(a);let h=e.vertical?l.left:l.bottom;if(h+=(e.vertical?-1:1)*q.c(t,e.ac()).current,!(e.vc(h)||i&&i.zg))return e.Ma.push(new Pt(r)),void s.finish(o);this.Ug(n,a,e),n.hg(e.rl),s.finish(null)}),s.result()}Hg(t,e,n){const i=t.captions;i.forEach((t,s)=>{t&&(e.insertBefore(t.Fs,n),"top"===t.side&&(i[s]=null))})}Vg(t,e,n){t.Kp&&0===this.Dg(e).length&&e.insertBefore(t.Kp.cloneNode(!0),n)}jg(t,e){if(t.Kp&&e){const t=this.Dg(e);t&&t.forEach(t=>{e.removeChild(t)})}}Fa(t,e){const n=It(t.us),i=n.Dd(t),s=i.firstChild;this.Hg(n,i,s),this.Vg(n,i,s);const r=new At(n,e),o=new et.LayoutIterator(r,e.ol),a=j.c("TableFormattingContext.doLayout");return o.iterate(t).Mt(a),a.result()}layout(t,e,n){const i=It(t.us);return i.Dd(t)?(n&&pt(t.parent,e),new Lt(i,this).layout(t,e)):e.mu(t)}Vl(t,e,n,i){return new Tt(t,e,n,i)}jl(t){return!1}Xl(t,e){return!1}Yl(t,e,n,i){const s=It(e.us);if("table-row"===e.display){b.a(e.ys);const n=s.Gp(e.ys);let i;if(s.tg=[],(i=e.after?s.zp(n):s.Wp(n)).length){const r=j.c("TableLayoutProcessor.finishBreak");let o=0;return r.Ut(t=>{if(o===i.length)return void t.zt();const e=i[o++],r=s.Hp(e),a=r.ra().Pc;b.a(a);const l=r.Lp,h=l.Ys(),c=new X.a(a.Ys());s.tg.push({eg:h,Cg:c,cell:e});const u=l.Fs;r.column.ol.Kl(r.Lp),n<e.rowIndex+e.rowSpan-1&&(u.rowSpan=n-e.rowIndex+1),r.empty?t.Gt():r.Mp.Yl(a,!1,!0).then(()=>{b.a(r),function(t,e,n){const i=e.Tc();if(!i)return;const s=e.vertical,r=t.column,o=t.Mp.ua(),a=t.Lp.Fs,l=r.rl.os(a),h=r.Su(a);if(s){const t=l.right-r.ia-i.lc(n)-h.right;E.F(o,"max-width",`${t}px`)}else{const t=r.ia-i.lc(n)-l.top-h.top;E.F(o,"max-height",`${t}px`)}E.F(o,"overflow","hidden")}(r,s,a),t.Gt()})}).then(()=>{t.Wl(e,!1),t.ol.Kl(e),s.ng(),r.finish(!0)}),r.result()}}return s.ng(),J.d.Yl(t,e,n,i)}Wl(t,e,n,i){J.b.prototype.Wl(t,e,n,i)}}class Lt extends tt.a{constructor(t,e){super(),this.Xg=t,this.processor=e}Ia(t){const e=this.Xg.Tc();return e&&e.Jd?(t.ys!==this.Xg.Yp||t.after||e&&e.xp(),new Mt(this.Xg,this.processor)):new Rt(this.Xg,this.processor)}La(t){super.La(t);const e=this.Xg.Dd(t);this.processor.jg(this.Xg,e)}Jl(t,e){super.Jl(t,e),this.Xg.ng()}}class Rt extends at{constructor(t,e){super(t),this.processor=e}Fa(t,e){return this.processor.Np(t,e)}}class Pt extends q.b{constructor(t){super(t,null,t.overflow,0)}Ec(){if(!this.gc)throw new Error("EdgeBreakPosition.prototype.updateEdge not called");return(this.overflows?3:0)+(this.position.parent?this.position.parent.Bs:0)}uc(t){t.Ta.push(new Ft(this.position.ys))}}class Ft{constructor(t){this.Wg=t,this.Al="EntireTable"}Qc(t,e,n){return b.a(!t.overflow),!1}xa(t){return!0}ya(t,e,n,i){b.a(e.ys),kt.push({root:e.ys,Gg:{zg:!0}})}Yl(t,e){return j.d(!0)}Sa(t){return t instanceof Ft&&t.Wg===this.Wg}va(){return 0}}class Mt extends lt{constructor(t,e){super(t),this.processor=e}Fa(t,e){const n=this.us.Tc();if(n&&!n.gp(t)){const n=new Ut(t);e.Ta.some(t=>n.Sa(t))||e.Ta.unshift(n)}return this.processor.Fa(t,e)}}class Ut extends ut{constructor(t){super(t),this.Al="TableRow",this.Yg=[]}Qc(t,e,n){const i=this.Tc();return!(i&&!n.na&&!Q.c(this.Pc.Fs)&&i.wp()&&(e&&!t||t&&t.overflow))}xa(t){const e=It(this.Pc.us);return!!this.qg(t,e).some(e=>e.constraints.some(e=>e.xa(t)))||super.xa(t)}ya(t,e,n,i){const s=It(this.Pc.us);if(this.Yg=this.qg(e,s),this.Yg.forEach(e=>{e.constraints.forEach(s=>{s.ya(t,e.oa,n,i)})}),!t){const t=s.Dd(this.Pc);(new Dt).jg(s,t),this.Kg(n)}super.ya(t,e,n,i)}Yl(t,e){It(this.Pc.us);const n=j.c("finishBreak"),i=this.Yg.reduce((t,e)=>t.concat(e.constraints.map(t=>({constraint:t,oa:e.oa}))),[]);let s=0;return n.loop(()=>{if(s<i.length){const t=i[s++];return t.constraint.Yl(t.oa,e).Lt(!0)}return j.d(!1)}).then(()=>{n.finish(!0)}),n.result().Ot(()=>super.Yl(t,e))}Kg(t){if(t&&"table-row"===t.display&&t.Fs)for(;t.Fs.previousElementSibling;){const e=t.Fs.previousElementSibling;e.parentNode&&e.parentNode.removeChild(e)}}qg(t,e){return this.Zg(t,e).map(t=>({constraints:t.fragment.Mp.fa().Ta,oa:t.oa}))}Zg(t,e){let n=Number.MAX_VALUE;t&&"table-row"===t.display&&(b.a(t.ys),n=e.Gp(t.ys)+1),n=Math.min(e.Qp.length,n);const i=[];for(let t=0;t<n;t++)e.Qp[t]&&e.Qp[t].forEach(t=>{t&&i.push({fragment:t,oa:t.ra().Pc})});return i}yf(t){const e=It(this.Pc.us),n=e.lg(t);return n?e.cg(n):e.ug()}Sa(t){return t instanceof Ut&&It(this.Pc.us)===It(t.Pc.us)}}const zt=new Dt;l.d(l.a.RESOLVE_FORMATTING_CONTEXT,function(t,e,n,i,s,r){if(!e)return null;if(n===V.t.table){const e=t.parent;return new St(e?e.us:null,t.ys)}return null}),l.d(l.a.RESOLVE_LAYOUT_PROCESSOR,function(t){return t instanceof St?zt:null});var Bt=n(13);function Ht(t){return t.reduce((t,e)=>t+e,0)/t.length}class $t{constructor(t,e){this.Qg=t,this.penalty=e}}function Vt(t){return t.vertical?t.width:t.height}function Gt(t,e){t.vertical?t.width=e:t.height=e}class jt{constructor(t,e,n){this.Jg=t,this.tm=e,this.nm=n,this.im=Vt(t)}sm(t){const e=this,n=j.c("ColumnBalancer#balanceColumns");e.rm(t),e.om(t),e.Jg.clear();const i=[e.hm(t)];return n.Ut(t=>{e.lm(i)?(e.am(i),e.tm().then(n=>{e.om(n),e.Jg.clear(),n?(i.push(e.hm(n)),t.Gt()):t.zt()})):t.zt()}).then(()=>{const t=i.reduce((t,e)=>e.penalty<t.penalty?e:t,i[0]);e.um(t.Qg),e.fm(),n.finish(t.Qg)}),n.result()}hm(t){const e=this.dm(t);return new $t(t,e)}rm(t){}fm(){Gt(this.Jg,this.im)}om(t){const e=this.nm.zh();t&&(t.pm=e)}um(t){const e=this.Jg.element;t.columns.forEach(t=>{e.appendChild(t.element)}),b.a(t.pm),this.nm.Hh(t.pm)}}const Xt=1;function Yt(t){const e=t[t.length-1];if(0===e.penalty)return!1;const n=t[t.length-2];if(n&&e.penalty>=n.penalty)return!1;const i=e.Qg.columns;return Math.max.apply(null,i.map(t=>t.gr))>Math.max.apply(null,i.map(t=>t.bl()))+Xt}function Kt(t,e){const n=t[t.length-1].Qg.columns,i=Math.max.apply(null,n.map(t=>isNaN(t.nu)?t.gr:t.gr-t.nu+Xt))-Xt;i<Vt(e)?Gt(e,i):Gt(e,Vt(e)-1)}class Wt extends jt{constructor(t,e,n,i){super(n,t,e),this.columnCount=i,this.gm=null,this.bm=!1}rm(t){const e=t.columns.reduce((t,e)=>t+e.gr,0);Gt(this.Jg,e/this.columnCount),this.gm=t.position}wm(t){return this.gm?this.gm.Js(t):null===t}dm(t){if(!this.wm(t.position))return 1/0;const e=t.columns;return Zt(e)?1/0:Math.max.apply(null,e.map(t=>t.gr))}lm(t){if(1===t.length)return!0;if(this.bm)return Yt(t);{const e=t[t.length-1];return this.wm(e.Qg.position)&&!Zt(e.Qg.columns)?(this.bm=!0,!0):Vt(this.Jg)<this.im}}am(t){if(this.bm)Kt(t,this.Jg);else{const t=Math.min(this.im,Vt(this.Jg)+.1*this.im);Gt(this.Jg,t)}}}function Zt(t){if(t.length<=1)return!1;const e=t[t.length-1].gr;return t.slice(0,t.length-1).every(t=>e>t.gr)}class qt extends jt{constructor(t,e,n){super(n,t,e)}dm(t){return t.columns.every(t=>0===t.gr)?1/0:function(t){const e=Ht(t);return Ht(t.map(t=>{const n=t-e;return n*n}))}(t.columns.filter(t=>!t.Yc).map(t=>t.gr))}lm(t){return Yt(t)}am(t){Kt(t,this.Jg)}}var Qt=n(24);class Jt{constructor(t,e,n){this.Em=t,this.xm=e,this.ym=n}}class te{constructor(){this.map=[]}km(){return 0==this.map.length?0:this.map[this.map.length-1].xm}Sm(){return 0==this.map.length?0:this.map[this.map.length-1].ym}vm(t){if(0==this.map.length)this.map.push(new Jt(t,t,t));else{const e=this.map[this.map.length-1],n=e.ym+t-e.xm;e.xm==e.Em?(e.xm=t,e.Em=t,e.ym=n):this.map.push(new Jt(t,t,n))}}Tm(t){0==this.map.length?this.map.push(new Jt(t,0,0)):this.map[this.map.length-1].xm=t}Nm(t){const e=this,n=E.i(this.map.length,n=>t<=e.map[n].xm),i=this.map[n];return i.ym-Math.max(0,i.Em-t)}Cm(t){const e=this,n=E.i(this.map.length,n=>t<=e.map[n].ym),i=this.map[n];return i.Em-(i.ym-t)}}class ee{constructor(t,e,n,i,s,r,o,a){if(this.context=t,this.style=e,this.offset=n,this.tn=i,this.nr=s,this.Pm=r,this.Rm=o,this._m=a,this.Am=null,this.Im=null,this.Fm={},this.Om=null,this.Lm=null,this.breakBefore=null,this.ls=s.ls,this.Mm()){const i=e._pseudos;if(i&&i.before){const e=new ee(t,i.before,n,!1,s,this.Dm(),o,!0),r=e.$m("content");X.y(r)&&(this.Om=e,this.breakBefore=e.breakBefore)}}this.breakBefore=Bt.d(this.Bm("before"),this.breakBefore),this.Rm&&Bt.c(this.breakBefore)&&(s.breakBefore=Bt.d(s.breakBefore,this.breakBefore))}Um(t,e,n){if(this.Mm()){const i=this.style._pseudos;if(i&&i.after){const s=new ee(this.context,i.after,t,!1,this.nr,e,n,!0),r=s.$m("content");X.y(r)&&(this.Lm=s)}}}$m(t,e){if(!(t in this.Fm)){const n=this.style[t];this.Fm[t]=n?n.evaluate(this.context,t):e||null}return this.Fm[t]}Gm(){return this.$m("display",V.t.inline)}Dm(){if(null===this.Am){const t=this.Gm(),e=this.$m("position"),n=this.$m("float");this.Am=Qt.d(t,e,n,this.tn)}return this.Am}Mm(){return null===this.Im&&(this.Im=this._m&&this.Gm()!==V.t.none),this.Im}Bm(t){let e=null;if(this.Dm()){const n=this.$m(`break-${t}`);n&&(e=n.toString())}return e}}class ne{constructor(t){this.context=t,this.stack=[],this.Pm=!0,this.Rm=!0,this.zm=[]}empty(){return 0===this.stack.length}Hm(){return this.stack[this.stack.length-1]}Vm(){const t=this.Hm();return t?t.nr.ls:null}jm(){return this.stack.every(t=>t.Gm()!==V.t.none)}push(t,e,n,i){const s=this.Hm();i&&s&&i.ls!==s.ls&&this.zm.push({Pm:this.Pm,Rm:this.Rm});const r=i||s.nr,o=this.Rm||!!i,a=this.jm(),l=new ee(this.context,t,e,n,r,o||this.Pm,o,a);return this.stack.push(l),this.Pm=l.Mm()?!l.Om&&l.Dm():this.Pm,this.Rm=l.Mm()?!l.Om&&o:this.Rm,l}Xm(t){const e=this.Hm();if((this.Pm||this.Rm)&&e.Mm()){const n=e.$m("white-space",V.t.normal).toString(),i=X.z(n);b.a(null!==i),X.p(t,i)||(this.Pm=!1,this.Rm=!1)}}pop(t){const e=this.stack.pop();if(e.Um(t,this.Pm,this.Rm),this.Rm&&e.Lm){const t=e.Lm.Bm("before");e.nr.breakBefore=Bt.d(e.nr.breakBefore,t)}const n=this.Hm();if(n)if(n.ls===e.ls)e.Mm()&&(this.Pm=this.Rm=!1);else{const t=this.zm.pop();this.Pm=t.Pm,this.Rm=t.Rm}return e}Wm(t){if(!t.Pm)return t.offset;let e=this.stack.length-1,n=this.stack[e];for(n===t&&(e--,n=this.stack[e]);e>=0;){if(n.ls!==t.ls)return t.offset;if(!n.Pm)return n.offset;if(n.tn)return n.offset;t=n,n=this.stack[--e]}throw new Error("No block start offset found!")}}class ie{constructor(t,e,n,i,s,r,o,a){this.xmldoc=t,this.scope=n,this.context=i,this.Ym=s,this.Jn=r,this.Cn=o,this.qm={},this.Km={},this.flows={},this.Zm=[],this.Qm=null,this.Jm=null,this.tb=null,this.primary=!0,this.eb=[],this.nb=!1,this.ib=!1,this.sb={},this.rb=!0,this.root=t.root,this.ob=e,this.last=this.root,this.cascade=e.Tn(i,o,a,t.lang),this.hb=new te;const l=t.Ig(this.root);this.lb=l,this.cb=new ne(i),this.hb.vm(l);const h=this.ab(this.root);switch(this.cascade.Xn(this.root,h,l),this.ub(h,!1),this.root.namespaceURI){case E.a.XHTML:case E.a.FB2:this.rb=!1}this.eb.push(!0),this.Km={},this.Km[`e${l}`]=h,this.lb++,this.fb(-1)}pb(t,e,n){const i=t[n];return i&&i.evaluate(this.context)!==e[n]}gb(t,e){for(const n in e){const i=t[n];if(i)this.qm[n]=i,delete t[n];else{const t=e[n];t&&(this.qm[n]=new z.c(t,B.c))}}}ub(t,e){if(["writing-mode","direction"].forEach(n=>{!t[n]||e&&this.qm[n]||(this.qm[n]=t[n])}),!this.nb){const e=this.pb(t,this.Jn.mb,"background-color")?t["background-color"].evaluate(this.context):null,n=this.pb(t,this.Jn.mb,"background-image")?t["background-image"].evaluate(this.context):null;(e&&e!==V.t.inherit||n&&n!==V.t.inherit)&&(this.gb(t,this.Jn.mb),this.nb=!0)}if(!this.ib)for(let e=0;e<se.length;e++)if(this.pb(t,this.Jn.bb,se[e])){this.gb(t,this.Jn.bb),this.ib=!0;break}if(!e){const e=t["font-size"];if(e){const t=e.evaluate(this.context);let n=t.num;switch(t.unit){case"em":case"rem":n*=this.context.ce;break;case"ex":n*=this.context.ce*k.G.ex/k.G.em;break;case"%":n*=this.context.ce/100;break;default:{const e=k.G[t.unit];e&&(n*=e)}}this.context.re=n}}}wb(){let t=0;for(;!this.rb&&(t+=5e3,this.Eb(t,0)!=Number.POSITIVE_INFINITY););return this.qm}ab(t){if(t.style instanceof CSSStyleDeclaration){const e=t.getAttribute("style");if(e)return z.E(this.scope,this.Jn,this.xmldoc.url,e)}return{}}xb(){return this.lb}fb(t){if(t>=this.lb)return;const e=this.context,n=this.xmldoc.Ig(this.root);if(t<n){const t=this.oc(this.root,!1);b.a(t);const i=z.s(t,"flow-into"),s=i?i.evaluate(e,"flow-into").toString():"body",r=this.yb(s,t,this.root,n);this.cb.empty()&&this.cb.push(t,n,!0,r)}let i=this.xmldoc.kb(t),s=this.xmldoc.Sb(i,0,!1);if(!(s>=this.lb))for(;;){if(1!=i.nodeType)s+=i.textContent.length;else{const t=i,n=this.oc(t,!1),r=n["flow-into"];if(r){const i=r.evaluate(e,"flow-into").toString();this.yb(i,n,t,s)}s++}if(s>=this.lb)break;let t=i.firstChild;if(null==t)for(;!(t=i.nextSibling);)if((i=i.parentNode)===this.root)return;i=t}}Tb(t){this.Qm=t;for(let t=0;t<this.Zm.length;t++)this.Qm.Nb(this.Zm[t],this.flows[this.Zm[t].ls])}Cb(t){this.Jm=t;let e=0;for(;null!=this.Jm&&(e+=5e3,this.Eb(e,0)!=Number.POSITIVE_INFINITY););}rd(t){if(!t)return;this.tb=t;let e=0;for(;this.tb&&(e+=5e3,this.Eb(e,0)!==Number.POSITIVE_INFINITY););this.tb=null}yb(t,e,n,i){let s=0,r=Number.POSITIVE_INFINITY,o=!1,a=!1,l=!1;const h=e["flow-options"];if(h){const t=A.d(h.evaluate(this.context,"flow-options"));o=!!t.exclusive,a=!!t.static,l=!!t.last}const c=e["flow-linger"];c&&(r=A.c(c.evaluate(this.context,"flow-linger"),Number.POSITIVE_INFINITY));const u=e["flow-priority"];u&&(s=A.c(u.evaluate(this.context,"flow-priority"),0));const d=this.sb[i]||null;let f=this.flows[t];if(!f){const e=this.cb.Vm();f=this.flows[t]=new X.f(t,e)}const p=new X.g(t,n,i,s,r,o,a,l,d);return this.Zm.push(p),this.Jm==t&&(this.Jm=null),this.Qm&&this.Qm.Nb(p,f),p}Pb(t,e,n){if(Bt.c(t)){const t=this.flows[n].as;(0===t.length||t[t.length-1]<e)&&t.push(e)}const i=this.sb[e];this.sb[e]=Bt.d(i,t)}Eb(t,e){let n,i=-1;if(t<=this.lb&&(i=(n=this.hb.Nm(t))+e)<this.hb.Sm())return this.hb.Cm(i);if(null==this.last)return Number.POSITIVE_INFINITY;const s=this.context;for(;;){let r=this.last.firstChild;if(null==r)for(;;){if(1==this.last.nodeType){this.cascade.Qn(this.last),this.primary=this.eb.pop();const t=this.cb.pop(this.lb);let e=null;if(t.Lm){const n=t.Lm.Bm("before");this.Pb(n,t.Lm.Pm?this.cb.Wm(t):t.Lm.offset,t.ls),e=t.Lm.Bm("after")}e=Bt.d(e,t.Bm("after")),this.Pb(e,this.lb,t.ls)}if(r=this.last.nextSibling)break;if(this.last=this.last.parentNode,this.last===this.root)return this.last=null,t<this.lb&&(i<0&&(i=(n=this.hb.Nm(t))+e),i<=this.hb.Sm())?this.hb.Cm(i):Number.POSITIVE_INFINITY}if(this.last=r,1!=this.last.nodeType)this.lb+=this.last.textContent.length,this.cb.Xm(this.last),this.primary?this.hb.vm(this.lb):this.hb.Tm(this.lb);else{const r=this.last,o=this.ab(r);this.eb.push(this.primary),this.cascade.Xn(r,o,this.lb);const a=r.getAttribute("id")||r.getAttributeNS(E.a.XML,"id");let l;a&&a===this.tb&&(this.tb=null),this.rb||"body"!=r.localName||r.parentNode!=this.root||(this.ub(o,!0),this.rb=!0);const h=o["flow-into"];if(h){const t=h.evaluate(s,"flow-into").toString(),e=this.yb(t,o,r,this.lb);this.primary=!!this.Ym[t],l=this.cb.push(o,this.lb,r===this.root,e)}else l=this.cb.push(o,this.lb,r===this.root);const c=this.cb.Wm(l);if(this.Pb(l.breakBefore,c,l.ls),l.Om){const t=l.Om.Bm("after");this.Pb(t,l.Om.Pm?c:l.offset,l.ls)}if(this.primary&&l.Gm()===V.t.none&&(this.primary=!1),this.Km[`e${this.lb}`]=o,this.lb++,this.primary?this.hb.vm(this.lb):this.hb.Tm(this.lb),t<this.lb&&(i<0&&(i=(n=this.hb.Nm(t))+e),i<=this.hb.Sm()))return this.hb.Cm(i)}}}oc(t,e){let n=this.xmldoc.Ig(t);const i=`e${n}`;return e&&(n=this.xmldoc.Sb(t,0,!0)),this.lb<=n&&this.Eb(n,0),this.Km[i]}hc(t,e){}}const se=["column-count","column-width","column-fill"];var re,oe="NUM = POS_NUM | ZERO | NEGATIVE;\nNNEG_NUM = POS_NUM | ZERO;\nINT = POS_INT | ZERO | NEGATIVE;\nNNEG_INT = POS_INT | ZERO;\nPERCENTAGE = POS_PERCENTAGE | ZERO | NEGATIVE;\nSTRICT_PERCENTAGE = POS_PERCENTAGE | ZERO_PERCENTAGE | NEGATIVE;\nNNEG_PERCENTAGE = POS_PERCENTAGE | ZERO;\nLENGTH = POS_LENGTH | ZERO | NEGATIVE;\nNNEG_LENGTH = POS_LENGTH | ZERO | NEGATIVE;\nPLENGTH = LENGTH | PERCENTAGE;\nPPLENGTH = POS_LENGTH | ZERO | POS_PERCENTAGE;\nALENGTH = LENGTH | auto;\nAPLENGTH = PLENGTH | auto;\nPAPLENGTH = PPLENGTH | auto;\nANGLE = POS_ANGLE | ZERO | NEGATIVE;\nLENGTH_OR_NUM = LENGTH | NUM;\nANGLE_OR_NUM = ANGLE | NUM;\nSCOLOR = HASHCOLOR | aliceblue: #F0F8FF | antiquewhite: #FAEBD7 | aqua: #00FFFF | aquamarine: #7FFFD4 | azure: #F0FFFF |\n    beige: #F5F5DC | bisque: #FFE4C4 | black: #000000 | blanchedalmond: #FFEBCD | blue: #0000FF | blueviolet: #8A2BE2 | brown: #A52A2A |\n    burlywood: #DEB887 | cadetblue: #5F9EA0 | chartreuse: #7FFF00 | chocolate: #D2691E | coral: #FF7F50 | cornflowerblue: #6495ED |\n    cornsilk: #FFF8DC | crimson: #DC143C | cyan: #00FFFF | darkblue: #00008B | darkcyan: #008B8B | darkgoldenrod: #B8860B |\n    darkgray: #A9A9A9 | darkgreen: #006400 | darkgrey: #A9A9A9 | darkkhaki: #BDB76B | darkmagenta: #8B008B | darkolivegreen: #556B2F |\n    darkorange: #FF8C00 | darkorchid: #9932CC | darkred: #8B0000 | darksalmon: #E9967A | darkseagreen: #8FBC8F | darkslateblue: #483D8B |\n    darkslategray: #2F4F4F | darkslategrey: #2F4F4F | darkturquoise: #00CED1 | darkviolet: #9400D3 | deeppink: #FF1493 |\n    deepskyblue: #00BFFF | dimgray: #696969 | dimgrey: #696969 | dodgerblue: #1E90FF | firebrick: #B22222 | floralwhite: #FFFAF0 |\n    forestgreen: #228B22 | fuchsia: #FF00FF | gainsboro: #DCDCDC | ghostwhite: #F8F8FF | gold: #FFD700 | goldenrod: #DAA520 |\n    gray: #808080 | green: #008000 | greenyellow: #ADFF2F | grey: #808080 | honeydew: #F0FFF0 | hotpink: #FF69B4 | indianred: #CD5C5C |\n    indigo: #4B0082 | ivory: #FFFFF0 | khaki: #F0E68C | lavender: #E6E6FA | lavenderblush: #FFF0F5 | lawngreen: #7CFC00 |\n    lemonchiffon: #FFFACD | lightblue: #ADD8E6 | lightcoral: #F08080 | lightcyan: #E0FFFF | lightgoldenrodyellow: #FAFAD2 |\n    lightgray: #D3D3D3 | lightgreen: #90EE90 | lightgrey: #D3D3D3 | lightpink: #FFB6C1 | lightsalmon: #FFA07A | lightseagreen: #20B2AA |\n    lightskyblue: #87CEFA | lightslategray: #778899 | lightslategrey: #778899 | lightsteelblue: #B0C4DE | lightyellow: #FFFFE0 |\n    lime: #00FF00 | limegreen: #32CD32 | linen: #FAF0E6 | magenta: #FF00FF | maroon: #800000 | mediumaquamarine: #66CDAA |\n    mediumblue: #0000CD | mediumorchid: #BA55D3 | mediumpurple: #9370DB | mediumseagreen: #3CB371 | mediumslateblue: #7B68EE |\n    mediumspringgreen: #00FA9A | mediumturquoise: #48D1CC | mediumvioletred: #C71585 | midnightblue: #191970 | mintcream: #F5FFFA |\n    mistyrose: #FFE4E1 | moccasin: #FFE4B5 | navajowhite: #FFDEAD | navy: #000080 | oldlace: #FDF5E6 | olive: #808000 |\n    olivedrab: #6B8E23 | orange: #FFA500 | orangered: #FF4500 | orchid: #DA70D6 | palegoldenrod: #EEE8AA | palegreen: #98FB98 |\n    paleturquoise: #AFEEEE | palevioletred: #DB7093 | papayawhip: #FFEFD5 | peachpuff: #FFDAB9 | peru: #CD853F | pink: #FFC0CB |\n    plum: #DDA0DD | powderblue: #B0E0E6 | purple: #800080 | rebeccapurple: #663399 | red: #FF0000 | rosybrown: #BC8F8F | royalblue: #4169E1 |\n    saddlebrown: #8B4513 | salmon: #FA8072 | sandybrown: #F4A460 | seagreen: #2E8B57 | seashell: #FFF5EE | sienna: #A0522D |\n    silver: #C0C0C0 | skyblue: #87CEEB | slateblue: #6A5ACD | slategray: #708090 | slategrey: #708090 | snow: #FFFAFA |\n    springgreen: #00FF7F | steelblue: #4682B4 | tan: #D2B48C | teal: #008080 | thistle: #D8BFD8 | tomato: #FF6347 |\n    turquoise: #40E0D0 | violet: #EE82EE | wheat: #F5DEB3 | white: #FFFFFF | whitesmoke: #F5F5F5 | yellow: #FFFF00 |\n    yellowgreen: #9ACD32 | transparent | currentcolor;\nRGBCOLOR = rgb(INT{3}) | rgb(STRICT_PERCENTAGE{3});\nRGBACOLOR = rgba(NUM{4}) | rgba(STRICT_PERCENTAGE{3} NUM);\nHSLCOLOR = hsl(NUM PERCENTAGE{2});\nHSLACOLOR = hsl(NUM PERCENTAGE{2} NUM);\nCOLOR = SCOLOR | RGBCOLOR | RGBACOLOR | HSLCOLOR | HSLACOLOR;\nBG_POSITION_TERM = PLENGTH | left | center | right | top | bottom;\nSIDE_OR_CORNER =  [left | right] || [top | bottom];\nCOLOR_STOP = SPACE(COLOR [PERCENTAGE | LENGTH]?);\nLINEAR_GRADIENT = linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |\n                  repeating-linear-gradient([ANGLE | SPACE(to SIDE_OR_CORNER)]? COLOR_STOP+) |;\nGRADIENT_EXTENT = closest-corner | closest-side | farthest-corner | farthest-side;\nGRADIENT_POSITION = at BG_POSITION_TERM{1,4};\nGRADIENT_SHAPE = SPACE(circle LENGTH? GRADIENT_POSITION?) | SPACE(ellipse PLENGTH{2}? GRADIENT_POSITION?)| SPACE([circle | ellipse] GRADIENT_EXTENT? GRADIENT_POSITION?);\nRADIAL_GRADIENT = radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+) |\n                  repeating-radial-gradient([GRADIENT_SHAPE | SPACE(GRADIENT_POSITION)]? COLOR_STOP+);\nURI_OR_NONE = URI | none;\nIMAGE =  URI | LINEAR_GRADIENT | RADIAL_GRADIENT | none;\nazimuth = ANGLE | [[ left-side | far-left | left | center-left | center | center-right | right | far-right | right-side ] || behind ] | leftwards | rightwards;\nbackground-attachment = COMMA( [scroll | fixed | local]+ );\nbackground-color = COLOR;\nbackground-image = COMMA( IMAGE+ );\nbackground-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\nbackground-repeat = COMMA( [repeat | repeat-x | repeat-y | no-repeat]+ );\nborder-collapse = collapse | separate;\nBORDER_SIDE_COLOR = COLOR;\nBORDER_SIDE_STYLE = none | hidden | dotted | dashed | solid | double | groove | ridge | inset | outset;\nBORDER_SIDE_WIDTH = thin: 1px | medium: 3px | thick: 5px | NNEG_LENGTH;\nborder-spacing = LENGTH LENGTH?;\nborder-top-color = BORDER_SIDE_COLOR;\nborder-right-color = BORDER_SIDE_COLOR;\nborder-bottom-color = BORDER_SIDE_COLOR;\nborder-left-color = BORDER_SIDE_COLOR;\nborder-top-style = BORDER_SIDE_STYLE;\nborder-right-style = BORDER_SIDE_STYLE;\nborder-bottom-style = BORDER_SIDE_STYLE;\nborder-left-style = BORDER_SIDE_STYLE;\nborder-top-width = BORDER_SIDE_WIDTH;\nborder-right-width = BORDER_SIDE_WIDTH;\nborder-bottom-width = BORDER_SIDE_WIDTH;\nborder-left-width = BORDER_SIDE_WIDTH;\nBORDER_RADIUS = PLENGTH{1,2};\nborder-top-left-radius = BORDER_RADIUS;\nborder-top-right-radius = BORDER_RADIUS;\nborder-bottom-right-radius = BORDER_RADIUS;\nborder-bottom-left-radius = BORDER_RADIUS;\nborder-image-source = IMAGE;\nborder-image-slice = [NUM | PERCENTAGE]{1,4} || fill; /* relaxed */\nborder-image-width = [NUM | PLENGTH | auto]{1,4};\nborder-image-outset = [NUM | LENGTH]{1,4};\nborder-image-repeat = [ stretch | repeat | round | space ]{1,2};\nbottom = APLENGTH;\ncaption-side = top | bottom;\nclear = none | left | right | top | bottom | both | all | same;\nclip = rect(ALENGTH{4}) | rect(SPACE(ALENGTH{4})) | auto;\ncolor = COLOR;\nLIST_STYLE_TYPE = disc | circle | square | decimal | decimal-leading-zero | lower-roman |\n    upper-roman | lower-greek | lower-latin | upper-latin | armenian | georgian | lower-alpha |\n    upper-alpha | russian | upper-russian | lower-russian | cjk-ideographic | trad-chinese-informal |\n    hebrew | none;\nTYPE_OR_UNIT_IN_ATTR = string | color | url | integer | number | length | angle | time | frequency;\nATTR = attr(SPACE(IDENT TYPE_OR_UNIT_IN_ATTR?) [ STRING | IDENT | COLOR | INT | NUM | PLENGTH | ANGLE | POS_TIME | FREQUENCY]?);\nCONTENT = normal | none |\n    [ STRING | URI | counter(IDENT LIST_STYLE_TYPE?) |\n    counters(IDENT STRING LIST_STYLE_TYPE?) | ATTR |\n    target-counter([ STRING | URI ] IDENT LIST_STYLE_TYPE?) |\n    target-counter(ATTR IDENT LIST_STYLE_TYPE?) |\n    target-counters([ STRING | URI ] IDENT STRING LIST_STYLE_TYPE?) |\n    target-counters(ATTR IDENT STRING LIST_STYLE_TYPE?) |\n    open-quote | close-quote | no-open-quote | no-close-quote ]+;\ncontent = CONTENT;\nCOUNTER = [ IDENT INT? ]+ | none;\ncounter-increment = COUNTER;\ncounter-reset = COUNTER;\ncounter-set = COUNTER;\ncue-after = URI_OR_NONE;\ncue-before = URI_OR_NONE;\ncursor = COMMA(URI* [ auto | crosshair | default | pointer | move | e-resize | ne-resize | nw-resize |\n    n-resize | se-resize | sw-resize | s-resize | w-resize | text | wait | help | progress ]);\ndirection = ltr | rtl;\ndisplay = inline | block | list-item | inline-block | table | inline-table | table-row-group |\n    table-header-group | table-footer-group | table-row | table-column-group | table-column |\n    table-cell | table-caption | none | oeb-page-head | oeb-page-foot | flex | inline-flex |\n    ruby | ruby-base | ruby-text | ruby-base-container | ruby-text-container | run-in | compact | marker;\nelevation = ANGLE | below | level | above | higher | lower;\nempty-cells = show | hide;\nFAMILY = SPACE(IDENT+) | STRING;\nFAMILY_LIST = COMMA( FAMILY+ );\nfont-family = FAMILY_LIST;\nfont-size = xx-small | x-small | small | medium | large | x-large | xx-large | larger | smaller | PPLENGTH | POS_NUM;\nfont-style = normal | italic | oblique;\nfont-variant = normal | small-caps;\nfont-weight = normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900;\nheight = PAPLENGTH | POS_NUM ;\nleft = APLENGTH;\nletter-spacing = normal | LENGTH_OR_NUM;\nline-height = normal | POS_NUM | PPLENGTH;\nlist-style-image = IMAGE;\nlist-style-position = inside | outside;\nlist-style-type = LIST_STYLE_TYPE;\nmargin-right = APLENGTH;\nmargin-left = APLENGTH;\nmargin-top = APLENGTH;\nmargin-bottom = APLENGTH;\nNPLENGTH = none | PLENGTH;\nmax-height = NPLENGTH;\nmax-width = NPLENGTH;\nmin-height = auto | PLENGTH;\nmin-width = auto | PLENGTH;\norphans = POS_INT;\noutline-offset = LENGTH;\noutline-color = COLOR | invert;\noutline-style = BORDER_SIDE_STYLE;\noutline-width = BORDER_SIDE_WIDTH;\noverflow = visible | hidden | scroll | auto;\npadding-right = PPLENGTH;\npadding-left = PPLENGTH;\npadding-top = PPLENGTH;\npadding-bottom = PPLENGTH;\nPAGE_BREAK = auto | always | avoid | left | right | recto | verso;\npage-break-after = PAGE_BREAK;\npage-break-before = PAGE_BREAK;\npage-break-inside = avoid | auto;\nPAUSE = POS_TIME | ZERO | POS_PERCENTAGE;\npause-after = PAUSE;\npause-before = PAUSE;\npitch-range = NUM;\npitch = FREQUENCY | x-low | low | medium | high | x-high;\nplay-during = [URI [ mix || repeat ]?] | auto | none;\nposition = static | relative | absolute | fixed;\nquotes = [STRING STRING]+ | none;\nrichness = NUM;\nright = APLENGTH;\nspeak-header = once | always;\nspeak-numeral = digits | continuous;\nspeak-punctuation = code | none;\nspeech-rate = NUM | x-slow | slow | medium | fast | x-fast | faster | slower;\nstress = NUM;\ntable-layout = auto | fixed;\ntext-align = left | right | center | justify | start | end;\ntext-decoration = none | [ underline || overline || line-through || blink ];\ntext-indent = PLENGTH;\ntext-transform = capitalize | uppercase | lowercase | none;\ntop = APLENGTH;\nvertical-align = baseline | sub | super | top | text-top | middle | bottom | text-bottom | PLENGTH;\nvisibility = visible | hidden | collapse;\nvoice-family = FAMILY_LIST;\nvolume = NUM | PERCENTAGE | silent | x-soft | soft | medium | loud | x-loud;\nwhite-space = normal | pre | nowrap | pre-wrap | pre-line;\nwidows = POS_INT;\nwidth = PAPLENGTH | POS_NUM ;\nword-spacing = normal | LENGTH_OR_NUM;\nz-index = auto | INT;\n\n[epub,moz,ms,webkit]hyphens = auto | manual | none;\n[webkit]hyphenate-character = auto | STRING;\n\n/* css-logical */\nmargin-block-start = APLENGTH;\nmargin-block-end = APLENGTH;\nmargin-inline-start = APLENGTH;\nmargin-inline-end = APLENGTH;\npadding-block-start = APLENGTH;\npadding-block-end = APLENGTH;\npadding-inline-start = APLENGTH;\npadding-inline-end = APLENGTH;\nborder-block-start-color = BORDER_SIDE_COLOR;\nborder-block-end-color = BORDER_SIDE_COLOR;\nborder-inline-start-color = BORDER_SIDE_COLOR;\nborder-inline-end-color = BORDER_SIDE_COLOR;\nborder-block-start-style = BORDER_SIDE_STYLE;\nborder-block-end-style = BORDER_SIDE_STYLE;\nborder-inline-start-style = BORDER_SIDE_STYLE;\nborder-inline-end-style = BORDER_SIDE_STYLE;\nborder-block-start-width = BORDER_SIDE_WIDTH;\nborder-block-end-width = BORDER_SIDE_WIDTH;\nborder-inline-start-width = BORDER_SIDE_WIDTH;\nborder-inline-end-width = BORDER_SIDE_WIDTH;\nblock-start = APLENGTH;\nblock-end = APLENGTH;\ninline-start = APLENGTH;\ninline-end = APLENGTH;\nblock-size = PAPLENGTH | POS_NUM;\ninline-size = PAPLENGTH | POS_NUM;\nmax-block-size = NPLENGTH;\nmax-inline-size = NPLENGTH;\nmin-block-size = auto | PLENGTH;\nmin-inline-size = auto | PLENGTH;\n\nSHAPE = auto | rectangle( PLENGTH{4} ) |  ellipse( PLENGTH{4} ) |  circle( PLENGTH{3} ) |\n    polygon( SPACE(PLENGTH+)+ );\n[epubx]shape-inside = SHAPE;\n[epubx,webkit]shape-outside = SHAPE;\n[epubx,ms]wrap-flow = auto | both | start | end | maximum | clear | around /* epub al */;\n\nTRANSFORM_FUNCTION = matrix(NUM{6}) | translate(PLENGTH{1,2}) | translateX(PLENGTH) | translateY(PLENGTH) |\n scale(NUM{1,2}) | scaleX(NUM) | scaleY(NUM) | rotate(ANGLE) | skewX(ANGLE) | skewY(ANGLE);\n[epub,ms]transform = none | TRANSFORM_FUNCTION+;\n[epub,ms]transform-origin = [[[ top | bottom | left | right] PLENGTH?] | center | PLENGTH]{1,2}; /* relaxed */\n\nBOX = border-box | padding-box | content-box;\nSHADOW = SPACE(inset || LENGTH{2,4} || COLOR); /* relaxed */\n[webkit]background-size = COMMA( SPACE( [PLENGTH | auto ]{1,2} | cover | contain)+ );\n[webkit]background-origin = COMMA( BOX+ );\n[webkit]background-clip = COMMA( BOX+ );\n[webkit]box-shadow = none | COMMA( SHADOW+ );\ntext-shadow = none |  COMMA( SHADOW+ );\n[webkit]box-decoration-break = slice | clone;\nFILTER_FUNCTION = blur(LENGTH) | brightness(NUM | PERCENTAGE) | contrast(NUM | PERCENTAGE) | drop-shadow(SPACE(LENGTH{2,3} COLOR?))\n                | grayscale(NUM | PERCENTAGE) | hue-rotate(ANGLE) | invert(NUM | PERCENTAGE) | opacity(NUM | PERCENTAGE)\n                | saturate(NUM | PERCENTAGE) | sepia(NUM | PERCENTAGE);\nFILTER_FUNCTION_LIST = FILTER_FUNCTION+;\n[webkit]filter = none | FILTER_FUNCTION_LIST;\n\nopacity = NUM;\n\n[moz,webkit]column-width = LENGTH | auto;\n[moz,webkit]column-count = INT | auto;\n[moz,webkit]column-gap = LENGTH | normal;\n[moz,webkit]column-rule-color = COLOR;\n[moz,webkit]column-rule-style = BORDER_SIDE_STYLE;\n[moz,webkit]column-rule-width = BORDER_SIDE_WIDTH;\nBREAK = auto | avoid | avoid-page | page | left | right | recto | verso | avoid-column | column | avoid-region | region;\nbreak-before = BREAK;\nbreak-after = BREAK;\nbreak-inside = auto | avoid | avoid-page | avoid-column | avoid-region;\n[webkit]column-span = none | auto | all;\n[moz]column-fill = auto | balance | balance-all;\n\nsrc = COMMA([SPACE(URI format(STRING+)?) | local(FAMILY)]+); /* for font-face */\n\n[epubx,webkit]flow-from = IDENT;\n[epubx,webkit]flow-into = IDENT;\n[epubx]flow-linger = INT | none;\n[epubx]flow-priority = INT;\n[epubx]flow-options = none | [ exclusive || last || static ];\n[epubx]page = INT | auto;\n[epubx]min-page-width = LENGTH;\n[epubx]min-page-height = LENGTH;\n[epubx]required = true | false;\n[epubx]enabled = true | false;\n[epubx]conflicting-partitions = COMMA(IDENT+);\n[epubx]required-partitions = COMMA(IDENT+);\n[epubx]snap-height = LENGTH | none;\n[epubx]snap-width = LENGTH | none;\n[epubx]flow-consume = all | some;\n[epubx]utilization = NUM;\n[epubx]text-zoom = font-size | scale;\n\n[adapt]template = URI_OR_NONE;\n[adapt]behavior = IDENT;\n\n/* CSS Fonts */\nfont-size-adjust = none | NNEG_NUM;\n[webkit]font-kerning = auto | normal | none;\nfont-variant-east-asian = normal | [[ jis78 | jis83 | jis90 | jis04 | simplified | traditional ] || [ full-width | proportional-width ] || ruby];\nfont-feature-settings = COMMA( SPACE( STRING [ on | off | INT ]? )+ );\nfont-stretch = normal | wider | narrower | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded;\n\n/* CSS Images */\nimage-resolution = RESOLUTION;\nobject-fit = fill | contain | cover | none | scale-down;\nobject-position = COMMA( SPACE(BG_POSITION_TERM{1,4})+ ); /* relaxed */\n\n/* CSS Paged Media */\nPAGE_SIZE = a5 | a4 | a3 | b5 | b4 | jis-b5 | jis-b4 | letter | legal | ledger;\nbleed = auto | LENGTH;\nmarks = none | [ crop || cross ];\nsize = POS_LENGTH{1,2} | auto | [ PAGE_SIZE || [ portrait | landscape ] ];\n\n/* CSS Page Floats */\nfloat-reference = inline | column | region | page;\nfloat = block-start | block-end | inline-start | inline-end | snap-block | snap-inline | left | right | top | bottom | none | footnote;\nfloat-min-wrap-block = PPLENGTH;\n\n/* CSS Ruby */\nruby-align = start | center | space-between | space-around;\nruby-position = over | under | inter-character;\n\n/* CSS Size Adjust */\n[moz,ms]text-size-adjust = auto | none | POS_PERCENTAGE;\n\n/* CSS Text */\n[ms,webkit]line-break = auto | loose | normal | strict;\noverflow-wrap = normal | break-word;\n[moz]tab-size = NNEG_INT | NNEG_LENGTH;\n[moz,ms]text-align-last = auto | start | end | left | right | center | justify;\n[ms]text-justify = auto | none | inter-word | inter-character | inter-ideograph /* specified in UA stylesheet for IE */;\n[ms]word-break = normal | keep-all | break-all | break-word;\n[ms]word-wrap = normal | break-word;\n\n/* CSS Text Decoration */\n[webkit]text-decoration-color = COLOR;\n[webkit]text-decoration-line = none | [ underline || overline || line-through || blink ];\n[webkit]text-decoration-skip = none | [ objects || spaces || ink || edges || box-decoration ];\n[webkit]text-decoration-style = solid | double | dotted | dashed | wavy;\n[epub,webkit]text-emphasis-color = COLOR;\n[webkit]text-emphasis-position = [ over | under ] [ right | left ];\n[epub,webkit]text-emphasis-style = none | [[ filled | open ] || [ dot | circle | double-circle | triangle | sesame ]] | STRING;\n[ms,webkit]text-underline-position = auto | [ under || [ left | right ]];\n\n/* CSS Transforms */\n[ms,webkit]backface-visibility = visible | hidden;\n\n/* CSS UI */\nbox-sizing = content-box | padding-box | border-box;\n[ms]text-overflow = [clip | ellipsis | STRING]{1,2};\n\n/* CSS Writing Modes */\n[webkit]text-combine = none | horizontal;\n[epub,ms]text-combine-horizontal = none | all | [ digits POS_INT? ]; /* relaxed */\ntext-combine-upright = none | all | [ digits POS_INT? ]; /* relaxed */\n[epub,webkit]text-orientation = mixed | upright | sideways-right | sideways-left | sideways | use-glyph-orientation /* the following values are kept for backward-compatibility */ | vertical-right | rotate-right | rotate-left | rotate-normal | auto;\nunicode-bidi = normal | embed | isolate | bidi-override | isolate-override | plaintext;\n[epub,webkit]writing-mode = horizontal-tb | vertical-rl | lr-tb | rl-tb | tb-rl | lr | rl | tb;\n\n/* CSS Flex box */\nFLEX_BASIS = content | PAPLENGTH;\nflex-direction = row | row-reverse | column | column-reverse;\nflex-wrap = nowrap | wrap | wrap-reverse;\norder = INT;\nflex-grow = NNEG_NUM;\nflex-shrink = NNEG_NUM;\nflex-basis = FLEX_BASIS;\nflex = none | [ [ NNEG_NUM NNEG_NUM? ] || FLEX_BASIS ];\njustify-content = flex-start | flex-end | center | space-between | space-around;\nalign-items = flex-start | flex-end | center | baseline | stretch;\nalign-self = auto | flex-start | flex-end | center | baseline | stretch;\nalign-content = flex-start | flex-end | center | space-between | space-around | stretch;\n\n/* Pointer Events */\n[ms]touch-action = auto | none | [ pan-x || pan-y ] | manipulation;\n\n/* SVG 2 */\nOPACITY_VALUE = NUM | PERCENTAGE;\nDASH_ARRAY = COMMA( SPACE( [ LENGTH | PERCENTAGE | NUM ]+ )+ );\nPAINT = none | child | child(INT) | COLOR | SPACE( URI [none | COLOR]? ) | context-fill | context-stroke;\ncolor-interpolation = auto | sRGB | linearRGB;\ncolor-rendering = auto | optimizeSpeed | optimizeQuality;\nfill = PAINT;\nfill-opacity = OPACITY_VALUE;\nfill-rule = nonzero | evenodd;\nglyph-orientation-vertical = auto | NUM | ANGLE;\nimage-rendering = auto | optimizeSpeed | optimizeQuality | crisp-edges | pixelated;\nmarker-start = none | URI;\nmarker-mid = none | URI;\nmarker-end = none | URI;\npointer-events = bounding-box | visiblePainted | visibleFill | visibleStroke | visible | painted | fill | stroke | all | none;\npaint-order = normal | [ fill || stroke || markers ];\nshape-rendering = auto | optimizeSpeed | crispEdges | geometricPrecision;\nstop-color = COLOR;\nstop-opacity = OPACITY_VALUE;\nstroke = PAINT;\nstroke-dasharray = none | DASH_ARRAY;\nstroke-dashoffset = PERCENTAGE | LENGTH_OR_NUM;\nstroke-linecap = butt | round | square;\nstroke-linejoin = miter | round | bevel;\nstroke-miterlimit = NUM;\nstroke-opacity = OPACITY_VALUE;\nstroke-width = PERCENTAGE | LENGTH_OR_NUM;\ntext-anchor = start | middle | end;\ntext-rendering = auto | optimizeSpeed | optimizeLegibility | geometricPrecision;\nvector-effect = none | SPACE( [ non-scaling-stroke | non-scaling-size | non-rotation | fixed-position ]+ [ viewport | screen ]? );\n\n/* SVG 1.1 */\nalignment-baseline = auto | baseline | before-edge | text-before-edge | middle | central | after-edge | text-after-edge | ideographic | alphabetic | hanging | mathematical;\nbaseline-shift = baseline | sub | super | PERCENTAGE | LENGTH_OR_NUM;\ndominant-baseline = auto | use-script | no-change | reset-size | ideographic | alphabetic | hanging | mathematical | central | middle | text-after-edge | text-before-edge;\nmask = none | URI;\n\n/* css-masking-1 */\nSHAPE_RADIUS = PLENGTH | closest-side | farthest-side;\nFILL_RULE = nonzero | evenodd;\nSHAPE_BOX = BOX | margin-box;\nGEOMETRY_BOX = SHAPE_BOX | fill-box | stroke-box | view-box;\nBASIC_SHAPE =\n    inset( SPACE( PLENGTH{1,4} [ round PLENGTH{1,4} [ SLASH PLENGTH{1,4} ]? ]? ) )\n  | circle(  SPACE( [SHAPE_RADIUS]?    [at BG_POSITION_TERM{1,4}]? ) )\n  | ellipse( SPACE( SHAPE_RADIUS{2}? [at BG_POSITION_TERM{1,4}]? ) )\n  | polygon( FILL_RULE? COMMA( SPACE( PLENGTH{2} )+ )+ );\n[webkit]clip-path = none | URI | [ BASIC_SHAPE || GEOMETRY_BOX ];\nclip-rule = nonzero | evenodd;\n\n/* filters */\nflood-color = COLOR;\nflood-opacity = OPACITY_VALUE;\nlighting-color = COLOR;\n\n/* compositing-1 */\nBLEND_MODE = normal | multiply | screen | overlay | darken | lighten | color-dodge | color-burn | hard-light | soft-light | difference | exclusion | hue | saturation | color | luminosity;\nmix-blend-mode = BLEND_MODE;\nisolation = auto | isolate;\nbackground-blend-mode = COMMA( BLEND_MODE+ );\n\n/* CSS GCPM */\nfootnote-policy = auto | line;\n\n[viv]repeat-on-break = auto | none | header | footer;\n\nDEFAULTS\n\nbackground-attachment: scroll;\nbackground-color: transparent;\nbackground-image: none;\nbackground-repeat: repeat;\nbackground-position: 0% 0%;\nbackground-clip: border-box;\nbackground-origin: padding-box;\nbackground-size: auto;\nborder-top-color: currentColor;\nborder-right-color: currentColor;\nborder-bottom-color: currentColor;\nborder-left-color: currentColor;\nborder-top-style: none;\nborder-right-style: none;\nborder-bottom-style: none;\nborder-left-style: none;\nborder-top-width: 3px;\nborder-right-width: 3px;\nborder-bottom-width: 3px;\nborder-left-width: 3px;\nborder-top-left-radius: 0;\nborder-top-right-radius: 0;\nborder-bottom-right-radius: 0;\nborder-bottom-left-radius: 0;\nborder-image-source: none;\nborder-image-slice: 100%;\nborder-image-width: 1;\nborder-image-outset: 0;\nborder-image-repeat: stretch;\ncolumn-count: auto;\ncolumn-gap: normal;\ncolumn-width: auto;\ncolumn-rule-color: currentColor;\ncolumn-rule-style: none;\ncolumn-rule-width: 3px;\ncolumn-fill: balance;\noutline-color: currentColor;\noutline-style: none;\noutline-width: 3px;\nflex-direction: row;\nflex-wrap: nowrap;\nfont-family: serif;\nfont-style: normal;\nfont-size: medium;\nfont-variant: normal;\nfont-weight: normal;\nfont-stretch: normal;\nline-height: normal;\nlist-style-image: none;\nlist-style-position: outside;\nlist-style-type: disc;\nmargin-bottom: auto;\nmargin-left: auto;\nmargin-right: auto;\nmargin-top: auto;\npadding-bottom: auto;\npadding-left: auto;\npadding-right: auto;\npadding-top: auto;\ntext-emphasis-color: currentColor;\ntext-emphasis-style: none;\nmarker-start: none;\nmarker-mid: none;\nmarker-end: none;\n\n\nSHORTHANDS\n\nbackground = COMMA background-image [background-position [ / background-size ]] background-repeat\n     background-attachment [background-origin background-clip] background-color; /* background-color is a special case, see the code */\nborder-top = border-top-width border-top-style border-top-color;\nborder-right = border-right-width border-right-style border-right-color;\nborder-bottom = border-bottom-width border-bottom-style border-bottom-color;\nborder-left = border-left-width border-left-style border-left-color;\nborder-width = INSETS border-top-width border-right-width border-bottom-width border-left-width;\nborder-style = INSETS border-top-style border-right-style border-bottom-style border-left-style;\nborder-color = INSETS border-top-color border-right-color border-bottom-color border-left-color;\nborder = border-width border-style border-color;\nborder-image = border-image-source border-image-slice [ / border-image-width [ / border-image-outset ] ]\n     border-image-repeat;\nborder-radius = INSETS_SLASH border-top-left-radius border-top-right-radius\n     border-bottom-right-radius border-bottom-left-radius;\n[moz,webkit]columns = column-width column-count;\n[moz,webkit]column-rule = column-rule-width column-rule-style column-rule-color;\nflex-flow = flex-direction flex-wrap;\noeb-column-number = column-count;\noutline = outline-width outline-style outline-color;\nlist-style = list-style-type list-style-position list-style-image;\nmargin = INSETS margin-top margin-right margin-bottom margin-left;\npadding = INSETS padding-top padding-right padding-bottom padding-left;\npause = INSETS pause-before pause-after;\nfont = FONT font-style font-variant font-weight font-stretch /* font-size line-height font-family are special-cased */;\n[epub,webkit]text-emphasis = text-emphasis-style text-emphasis-color;\nmarker = INSETS marker-start marker-mid marker-end;\n\n/* css-logical */\nmargin-block = INSETS margin-block-start margin-block-end;\nmargin-inline = INSETS margin-inline-start margin-inline-end;\npadding-block = INSETS padding-block-start padding-block-end;\npadding-inline = INSETS padding-inline-start padding-inline-end;\nborder-block-width = INSETS border-block-start-width border-block-end-width;\nborder-block-style = INSETS border-block-start-style border-block-end-style;\nborder-block-color = INSETS border-block-start-color border-block-end-color;\nborder-inline-width = INSETS border-inline-start-width border-inline-end-width;\nborder-inline-style = INSETS border-inline-start-style border-inline-end-style;\nborder-inline-color = INSETS border-inline-start-color border-inline-end-color;\nborder-block = border-block-width border-block-style border-block-color;\nborder-inline = border-inline-width border-inline-style border-inline-color;\nborder-block-start = border-block-start-width border-block-start-style border-block-start-color;\nborder-block-end = border-block-end-width border-block-end-style border-block-end-color;\nborder-inline-start = border-inline-start-width border-inline-start-style border-inline-start-color;\nborder-inline-end = border-inline-end-width border-inline-end-style border-inline-end-color;\ninset-block-start = block-start;\ninset-block-end = block-end;\ninset-inline-start = inline-start;\ninset-inline-end = inline-end;\ninset-block = INSETS block-start block-end;\ninset-inline = INSETS inline-start inline-end;\n\n/* old names  */\n[adapt,webkit]margin-before = margin-block-start;\n[adapt,webkit]margin-after = margin-block-end;\n[adapt,webkit]margin-start = margin-inline-start;\n[adapt,webkit]margin-end = margin-inline-end;\n[adapt,webkit]padding-before = padding-block-start;\n[adapt,webkit]padding-after = padding-block-end;\n[adapt,webkit]padding-start = padding-inline-start;\n[adapt,webkit]padding-end = padding-inline-end;\n[adapt,webkit]border-before-color = border-block-start-color;\n[adapt,webkit]border-after-color = border-block-end-color;\n[adapt,webkit]border-start-color = border-inline-start-color;\n[adapt,webkit]border-end-color = border-inline-end-color;\n[adapt,webkit]border-before-style = border-block-start-style;\n[adapt,webkit]border-after-style = border-block-end-style;\n[adapt,webkit]border-start-style = border-inline-start-style;\n[adapt,webkit]border-end-style = border-inline-end-style;\n[adapt,webkit]border-before-width = border-block-start-width;\n[adapt,webkit]border-after-width = border-block-end-width;\n[adapt,webkit]border-start-width = border-inline-start-width;\n[adapt,webkit]border-end-width = border-inline-end-width;\n[adapt,webkit]before = block-start;\n[adapt,webkit]after = block-end;\n[adapt,webkit]start = inline-start;\n[adapt,webkit]end = inline-end;\n";class ae{constructor(t){this.validator=t,this.success=null,this.failure=null,this.code=0}Rb(){return 0!=this.code}_b(){this.code=-1}Ab(){return-1==this.code}Ib(){this.code=-2}Fb(){return-2==this.code}Ob(t){this.code=2*t+1}Lb(){return this.code>0&&this.code%2!=0}Mb(t){this.code=2*t+2}Db(){return this.code>0&&this.code%2==0}$b(){return Math.floor((this.code-1)/2)}}class le{constructor(t,e){this.where=t,this.success=e,this.what=-1}}!function(t){t[t.FOLLOW=1]="FOLLOW",t[t.OPTIONAL=2]="OPTIONAL",t[t.REPEATED=3]="REPEATED",t[t.ALTERNATE=4]="ALTERNATE"}(re||(re={}));class he{constructor(){this.nodes=[],this.connections=[],this.match=[],this.nomatch=[],this.error=[],this.Bb=!0}connect(t,e){for(let n=0;n<t.length;n++)this.connections[t[n]].what=e;t.splice(0,t.length)}clone(){const t=new he;for(let e=0;e<this.nodes.length;e++){const n=this.nodes[e],i=new ae(n.validator);i.code=n.code,t.nodes.push(i)}for(let e=0;e<this.connections.length;e++){const n=this.connections[e],i=new le(n.where,n.success);i.what=n.what,t.connections.push(i)}return t.match.push(...this.match),t.nomatch.push(...this.nomatch),t.error.push(...this.error),t}Ub(t,e,n){const i=this.nodes.length,s=new ae(xe);n>=0?e?s.Ob(n):s.Mb(n):e?s._b():s.Ib(),this.nodes.push(s),this.connect(t,i);const r=new le(i,!0),o=new le(i,!1);t.push(this.connections.length),this.connections.push(o),t.push(this.connections.length),this.connections.push(r)}Gb(){const t=[this.match,this.nomatch,this.error];for(let e=0;e<t.length;e++)this.Ub(t[e],!1,-1)}zb(){if(this.nodes.length)throw new Error("invalid call");this.Ub(this.match,!0,-1)}Hb(t){this.Ub(this.match,!1,t)}Vb(t){if(this.nodes.length)throw new Error("invalid call");const e=new ae(xe);e.Ob(t),this.nodes.push(e);const n=new le(0,!0),i=new le(0,!1);this.nomatch.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)}jb(t){const e=this.nodes.length;this.nodes.push(new ae(t));const n=new le(e,!0),i=new le(e,!1);this.connect(this.match,e),this.Bb?(this.nomatch.push(this.connections.length),this.Bb=!1):this.error.push(this.connections.length),this.connections.push(i),this.match.push(this.connections.length),this.connections.push(n)}Xb(){return 1==this.nodes.length&&!this.nodes[0].Rb()}Wb(){return this.Xb()&&this.nodes[0].validator instanceof Ne}Yb(t,e){if(0==t.nodes.length)return;const n=this.nodes.length;if(e==re.ALTERNATE&&1==n&&t.Wb()&&this.Wb())return void(this.nodes[0].validator=this.nodes[0].validator.combine(t.nodes[0].validator));for(let e=0;e<t.nodes.length;e++)this.nodes.push(t.nodes[e]);e==re.ALTERNATE?(this.Bb=!0,this.connect(this.nomatch,n)):this.connect(this.match,n);const i=this.connections.length;for(let e=0;e<t.connections.length;e++){const i=t.connections[e];i.where+=n,i.what>=0&&(i.what+=n),this.connections.push(i)}for(let e=0;e<t.match.length;e++)this.match.push(t.match[e]+i);if(e==re.REPEATED&&this.connect(this.match,n),e==re.OPTIONAL||e==re.REPEATED)for(let e=0;e<t.nomatch.length;e++)this.match.push(t.nomatch[e]+i);else if(this.Bb){for(let e=0;e<t.nomatch.length;e++)this.nomatch.push(t.nomatch[e]+i);this.Bb=t.Bb}else for(let e=0;e<t.nomatch.length;e++)this.error.push(t.nomatch[e]+i);for(let e=0;e<t.error.length;e++)this.error.push(t.error[e]+i);t.nodes=null,t.connections=null}finish(t,e){const n=this.nodes.length;this.nodes.push(t),this.nodes.push(e),this.connect(this.match,n),this.connect(this.nomatch,n+1),this.connect(this.error,n+1);for(const t of this.connections)t.success?this.nodes[t.where].success=this.nodes[t.what]:this.nodes[t.where].failure=this.nodes[t.what];for(let t=0;t<n;t++)if(null==this.nodes[t].failure||null==this.nodes[t].success)throw new Error("Invalid validator state");return this.nodes[0]}}const ce=1,ue=2,de=4,fe=8,pe=16,ge=32,me=64,be=128,Ee=256,we=512,ve=1024,ye=2048;class Te extends V.m{constructor(){super()}qb(t,e){const n=t[e].visit(this);return n?[n]:null}}class Ne extends Te{constructor(t,e,n){super(),this.allowed=t,this.idents=e,this.units=n}T(t){return this.allowed&ce?t:null}R(t){return this.allowed&ye?t:null}_(t){return this.allowed&ue?t:null}$(t){return this.idents[t.name.toLowerCase()]||(this.allowed&de?t:null)}U(t){return 0!=t.num||this.allowed&we?t.num<0&&!(this.allowed&Ee)?null:this.units[t.unit]?t:null:"%"==t.unit&&this.allowed&ve?t:null}V(t){return 0==t.num?this.allowed&we?t:null:t.num<=0&&!(this.allowed&Ee)?null:this.allowed&pe?t:null}X(t){if(0==t.num)return this.allowed&we?t:null;if(t.num<=0&&!(this.allowed&Ee))return null;if(this.allowed&(ge|pe))return t;return this.idents[`${t.num}`]||null}W(t){return this.allowed&me?t:null}Y(t){return this.allowed&be?t:null}Z(t){return null}tt(t){return null}et(t){return null}nt(t){return 2046&this.allowed?t:null}combine(t){const e={},n={};for(const t in this.idents)e[t]=this.idents[t];for(const n in t.idents)e[n]=t.idents[n];for(const t in this.units)n[t]=this.units[t];for(const e in t.units)n[e]=t.units[e];return new Ne(this.allowed|t.allowed,e,n)}}const Se={},xe=new Ne(0,Se,Se);class Ie extends Te{constructor(t){super(),this.Kb=new ae(null),this.Zb=new ae(null),this.first=t.finish(this.Kb,this.Zb)}Qb(t,e,n){let i=e?[]:t,s=this.first,r=n,o=null,a=null;for(;s!==this.Kb&&s!==this.Zb;){if(r>=t.length){s=s.failure;continue}const l=t[r];let h=l;if(s.Rb()){let t=!0;s.Ab()?(o?o.push(a):o=[a],a=[]):s.Fb()?a=o.length>0?o.pop():null:s.Db()?a[s.$b()]="taken":t=null==a[s.$b()],s=t?s.success:s.failure}else{if(0==r&&!e&&s.validator instanceof Ce&&this instanceof Ce){if(h=new V.j(t).visit(s.validator)){r=t.length,s=s.success;continue}}else if(0==r&&!e&&s.validator instanceof Oe&&this instanceof Ce){if(h=new V.b(t).visit(s.validator)){r=t.length,s=s.success;continue}}else h=l.visit(s.validator);if(!h){s=s.failure;continue}if(h!==l&&t===i){i=[];for(let e=0;e<r;e++)i[e]=t[e]}t!==i&&(i[r-n]=h),r++,s=s.success}}return s===this.Kb&&(e?i.length>0:r==t.length)?i:null}Jb(t){let e=null,n=this.first;for(;n!==this.Kb&&n!==this.Zb;)t?n.Rb()?n=n.success:(e=t.visit(n.validator))?(t=null,n=n.success):n=n.failure:n=n.failure;return n===this.Kb?e:null}T(t){return this.Jb(t)}R(t){return this.Jb(t)}_(t){return this.Jb(t)}$(t){return this.Jb(t)}U(t){return this.Jb(t)}V(t){return this.Jb(t)}X(t){return this.Jb(t)}W(t){return this.Jb(t)}Y(t){return this.Jb(t)}Z(t){return null}tt(t){return null}et(t){return this.Jb(t)}nt(t){return null}}class Ce extends Ie{constructor(t){super(t)}Z(t){const e=this.Qb(t.values,!1,0);return e===t.values?t:e?new V.j(e):null}tt(t){let e=this.first,n=!1;for(;e;){if(e.validator instanceof Oe){n=!0;break}e=e.failure}if(n){const e=this.Qb(t.values,!1,0);return e===t.values?t:e?new V.b(e):null}return null}qb(t,e){return this.Qb(t,!0,e)}}class Oe extends Ie{constructor(t){super(t)}Z(t){return this.Jb(t)}tt(t){const e=this.Qb(t.values,!1,0);return e===t.values?t:e?new V.b(e):null}qb(t,e){let n,i=this.first;for(;i!==this.Zb;){if(n=i.validator.qb(t,e))return n;i=i.failure}return null}}class _e extends Ie{constructor(t,e){super(e),this.name=t}Jb(t){return null}et(t){if(t.name.toLowerCase()!=this.name)return null;const e=this.Qb(t.values,!1,0);return e===t.values?t:e?new V.e(t.name,e):null}}class Ae{tw(t,e,n){return e}success(t,e){}}class ke extends Ae{constructor(t,e){super(),this.name=e,this.validator=t.validators[this.name]}tw(t,e,n){if(n.values[this.name])return e;const i=this.validator.qb(t,e);if(i){const t=i.length,s=t>1?new V.j(i):i[0];return this.success(s,n),e+t}return e}success(t,e){e.values[this.name]=t}}class De extends ke{constructor(t,e){super(t,e[0]),this.names=e}success(t,e){for(let n=0;n<this.names.length;n++)e.values[this.names[n]]=t}}class Le extends Ae{constructor(t,e){super(),this.nodes=t,this.slash=e}tw(t,e,n){const i=e;if(this.slash){if(t[e]!=V.w)return i;if(++e==t.length)return i}let s=this.nodes[0].tw(t,e,n);if(s==e)return i;e=s;for(let i=1;i<this.nodes.length&&e<t.length&&(s=this.nodes[i].tw(t,e,n))!=e;i++)e=s;return e}}class Re extends V.m{constructor(){super(...arguments),this.syntax=null,this.ew=null,this.error=!1,this.values={},this.Jn=null}nw(t){this.Jn=t}iw(t){return new ke(this.Jn,t)}clone(){const t=new this.constructor;return t.syntax=this.syntax,t.ew=this.ew,t.Jn=this.Jn,t}init(t,e){this.syntax=t,this.ew=e}finish(t,e){if(!this.error){for(const n of this.ew)e.Ri(n,this.values[n]||this.Jn.sw[n],t);return!0}return!1}rw(t,e){for(const n of this.ew)e.Ri(n,V.t.inherit,t)}Qb(t){return this.error=!0,0}Jb(t){return this.Qb([t]),null}T(t){return this.Jb(t)}_(t){return this.Jb(t)}$(t){return this.Jb(t)}U(t){return this.Jb(t)}V(t){return this.Jb(t)}X(t){return this.Jb(t)}W(t){return this.Jb(t)}Y(t){return this.Jb(t)}Z(t){return this.Qb(t.values),null}tt(t){return this.error=!0,null}et(t){return this.Jb(t)}nt(t){return this.error=!0,null}}class Pe extends Re{constructor(){super()}Qb(t){let e=0,n=0;for(;e<t.length;){const i=this.syntax[n].tw(t,e,this);if(i>e)e=i,n=0;else if(++n==this.syntax.length){this.error=!0;break}}return e}}class Fe extends Re{constructor(){super()}Qb(t){if(t.length>this.syntax.length||0==t.length)return this.error=!0,0;for(let e=0;e<this.syntax.length;e++){let n=e;for(;n>=t.length;)n=1==n?0:n-2;if(this.syntax[e].tw(t,n,this)!=n+1)return this.error=!0,0}return t.length}ow(){return new De(this.Jn,this.ew)}}const Me={SIMPLE:Pe,INSETS:Fe,INSETS_SLASH:class extends Re{constructor(){super()}Qb(t){let e=t.length;for(let n=0;n<t.length;n++)if(t[n]===V.w){e=n;break}if(e>this.syntax.length||0==t.length)return this.error=!0,0;for(let n=0;n<this.syntax.length;n++){let i,s=n;for(;s>=e;)s=1==s?0:s-2;if(e+1<t.length)for(i=e+n+1;i>=t.length;)i-=i==e+2?1:2;else i=s;const r=[t[s],t[i]];if(2!=this.syntax[n].tw(r,0,this))return this.error=!0,0}return t.length}},COMMA:class extends Pe{constructor(){super()}hw(t,e){for(const n of this.ew){const i=e[n]||this.Jn.sw[n];let s=t[n];s||(s=[],t[n]=s),s.push(i)}}tt(t){const e={};for(let n=0;n<t.values.length;n++)if(this.values={},t.values[n]instanceof V.b?this.error=!0:(t.values[n].visit(this),this.hw(e,this.values),this.values["background-color"]&&n!=t.values.length-1&&(this.error=!0)),this.error)return null;this.values={};for(const t in e)this.values[t]="background-color"==t?e[t].pop():new V.b(e[t]);return null}},FONT:class extends Pe{constructor(){super()}init(t,e){super.init(t,e),this.ew.push("font-family","line-height","font-size")}Qb(t){let e=super.Qb(t);if(e+2>t.length)return this.error=!0,e;this.error=!1;const n=this.Jn.validators;if(!t[e].visit(n["font-size"]))return this.error=!0,e;if(this.values["font-size"]=t[e++],t[e]===V.w){if(++e+2>t.length)return this.error=!0,e;if(!t[e].visit(n["line-height"]))return this.error=!0,e;this.values["line-height"]=t[e++]}const i=e==t.length-1?t[e]:new V.j(t.slice(e,t.length));return i.visit(n["font-family"])?(this.values["font-family"]=i,t.length):(this.error=!0,e)}tt(t){if(t.values[0].visit(this),this.error)return null;const e=[this.values["font-family"]];for(let n=1;n<t.values.length;n++)e.push(t.values[n]);const n=new V.b(e);return n.visit(this.Jn.validators["font-family"])?this.values["font-family"]=n:this.error=!0,null}$(t){const e=this.Jn.lw[t.name];if(e)for(const t in e)this.values[t]=e[t];else this.error=!0;return null}}};class Ue{constructor(){this.validators={},this.prefixes={},this.sw={},this.cw={},this.lw={},this.shorthands={},this.bb={},this.mb={}}aw(t,e){let n;if(e.type==H.a.NUMERIC)n=new V.i(e.num,e.text);else if(e.type==H.a.HASH)n=B.h(e.text);else{if(e.type!=H.a.IDENT)throw new Error("unexpected replacement");n=V.r(e.text)}if(t.Wb()){const e=t.nodes[0].validator.idents;for(const t in e)e[t]=n;return t}throw new Error("unexpected replacement")}uw(t,e){const n=new he;if("||"==t){for(let t=0;t<e.length;t++){const i=new he;i.Vb(t),i.Yb(e[t],re.FOLLOW),i.Hb(t),n.Yb(i,0==t?re.FOLLOW:re.ALTERNATE)}const t=new he;return t.zb(),t.Yb(n,re.REPEATED),t.Gb(),t}{let i;switch(t){case" ":i=re.FOLLOW;break;case"|":case"||":i=re.ALTERNATE;break;default:throw new Error("unexpected op")}for(let t=0;t<e.length;t++)n.Yb(e[t],0==t?re.FOLLOW:i);return n}}fw(t,e,n){const i=new he;for(let n=0;n<e;n++)i.Yb(t.clone(),re.FOLLOW);if(n==Number.POSITIVE_INFINITY)i.Yb(t,re.REPEATED);else for(let s=e;s<n;s++)i.Yb(t.clone(),re.OPTIONAL);return i}primitive(t){const e=new he;return e.jb(t),e}dw(t,e){let n;switch(t){case"COMMA":n=new Oe(e);break;case"SPACE":n=new Ce(e);break;default:n=new _e(t.toLowerCase(),e)}return this.primitive(n)}pw(){this.cw.HASHCOLOR=this.primitive(new Ne(me,Se,Se)),this.cw.POS_INT=this.primitive(new Ne(ge,Se,Se)),this.cw.POS_NUM=this.primitive(new Ne(pe,Se,Se)),this.cw.POS_PERCENTAGE=this.primitive(new Ne(fe,Se,{"%":V.o})),this.cw.NEGATIVE=this.primitive(new Ne(Ee,Se,Se)),this.cw.ZERO=this.primitive(new Ne(we,Se,Se)),this.cw.ZERO_PERCENTAGE=this.primitive(new Ne(ve,Se,Se)),this.cw.POS_LENGTH=this.primitive(new Ne(fe,Se,{em:V.o,ex:V.o,ch:V.o,rem:V.o,vw:V.o,vh:V.o,vi:V.o,vb:V.o,vmin:V.o,vmax:V.o,pvw:V.o,pvh:V.o,pvi:V.o,pvb:V.o,pvmin:V.o,pvmax:V.o,cm:V.o,mm:V.o,in:V.o,px:V.o,pt:V.o,pc:V.o,q:V.o})),this.cw.POS_ANGLE=this.primitive(new Ne(fe,Se,{deg:V.o,grad:V.o,rad:V.o,turn:V.o})),this.cw.POS_TIME=this.primitive(new Ne(fe,Se,{s:V.o,ms:V.o})),this.cw.FREQUENCY=this.primitive(new Ne(fe,Se,{Hz:V.o,kHz:V.o})),this.cw.RESOLUTION=this.primitive(new Ne(fe,Se,{dpi:V.o,dpcm:V.o,dppx:V.o})),this.cw.URI=this.primitive(new Ne(be,Se,Se)),this.cw.IDENT=this.primitive(new Ne(de,Se,Se)),this.cw.STRING=this.primitive(new Ne(ue,Se,Se)),this.cw.SLASH=this.primitive(new Ne(ye,Se,Se));const t={"font-family":V.r("sans-serif")};this.lw.caption=t,this.lw.icon=t,this.lw.menu=t,this.lw["message-box"]=t,this.lw["small-caption"]=t,this.lw["status-bar"]=t}gw(t){return!!t.match(/^[A-Z_0-9]+$/)}mw(t,e){let n=t.token();if(n.type==H.a.EOF)return null;const i={"":!0};if(n.type==H.a.O_BRK){do{if(t.consume(),(n=t.token()).type!=H.a.IDENT)throw new Error("Prefix name expected");i[n.text]=!0,t.consume(),n=t.token()}while(n.type==H.a.COMMA);if(n.type!=H.a.C_BRK)throw new Error("']' expected");t.consume(),n=t.token()}if(n.type!=H.a.IDENT)throw new Error("Property name expected");if(2==e?"SHORTHANDS"==n.text:"DEFAULTS"==n.text)return t.consume(),null;const s=n.text;if(t.consume(),2!=e){if(t.token().type!=H.a.EQ)throw new Error("'=' expected");this.gw(s)||(this.prefixes[s]=i)}else if(t.token().type!=H.a.COLON)throw new Error("':' expected");return s}bw(t){for(;;){const e=this.mw(t,1);if(!e)return;let n=[];const i=[];let s,r="",o=!0;const a=this,l=()=>{if(0==n.length)throw new Error("No values");return 1==n.length?n[0]:a.uw(r,n)},h=t=>{if(o)throw new Error(`'${t}': unexpected`);if(r&&r!=t)throw new Error(`mixed operators: '${t}' and '${r}'`);r=t,o=!0};let c=null;for(;!c;){t.consume();let e=t.token();switch(e.type){case H.a.IDENT:if(o||h(" "),this.gw(e.text)){const t=this.cw[e.text];if(!t)throw new Error(`'${e.text}' unexpected`);n.push(t.clone())}else{const t={};t[e.text.toLowerCase()]=V.r(e.text),n.push(this.primitive(new Ne(0,t,Se)))}o=!1;break;case H.a.INT:{const t={};t[`${e.num}`]=new V.g(e.num),n.push(this.primitive(new Ne(0,t,Se))),o=!1;break}case H.a.BAR:h("|");break;case H.a.BAR_BAR:h("||");break;case H.a.O_BRK:o||h(" "),i.push({vals:n,op:r,b:"["}),r="",n=[],o=!0;break;case H.a.FUNC:o||h(" "),i.push({vals:n,op:r,b:"(",fn:e.text}),r="",n=[],o=!0;break;case H.a.C_BRK:{s=l();const t=i.pop();if("["!=t.b)throw new Error("']' unexpected");(n=t.vals).push(s),r=t.op,o=!1;break}case H.a.C_PAR:{s=l();const t=i.pop();if("("!=t.b)throw new Error("')' unexpected");(n=t.vals).push(this.dw(t.fn,s)),r=t.op,o=!1;break}case H.a.COLON:if(o)throw new Error("':' unexpected");t.consume(),n.push(this.aw(n.pop(),t.token()));break;case H.a.QMARK:if(o)throw new Error("'?' unexpected");n.push(this.fw(n.pop(),0,1));break;case H.a.STAR:if(o)throw new Error("'*' unexpected");n.push(this.fw(n.pop(),0,Number.POSITIVE_INFINITY));break;case H.a.PLUS:if(o)throw new Error("'+' unexpected");n.push(this.fw(n.pop(),1,Number.POSITIVE_INFINITY));break;case H.a.O_BRC:{if(t.consume(),(e=t.token()).type!=H.a.INT)throw new Error("<int> expected");const i=e.num;let s=i;if(t.consume(),(e=t.token()).type==H.a.COMMA){if(t.consume(),(e=t.token()).type!=H.a.INT)throw new Error("<int> expected");s=e.num,t.consume(),e=t.token()}if(e.type!=H.a.C_BRC)throw new Error("'}' expected");n.push(this.fw(n.pop(),i,s));break}case H.a.SEMICOL:if(c=l(),i.length>0)throw new Error(`unclosed '${i.pop().b}'`);break;default:throw new Error("unexpected token")}}t.consume(),this.gw(e)?this.cw[e]=c:c.Xb()?this.validators[e]=c.nodes[0].validator:this.validators[e]=new Ce(c)}}ww(t){for(;;){const e=this.mw(t,2);if(!e)return;const n=[];for(;;){t.consume();const e=t.token();if(e.type==H.a.SEMICOL){t.consume();break}switch(e.type){case H.a.IDENT:n.push(V.r(e.text));break;case H.a.NUM:n.push(new V.h(e.num));break;case H.a.INT:n.push(new V.g(e.num));break;case H.a.NUMERIC:n.push(new V.i(e.num,e.text));break;default:throw new Error("unexpected token")}}this.sw[e]=n.length>1?new V.j(n):n[0]}}Ew(t){for(;;){const e=this.mw(t,3);if(!e)return;let n,i=t.gt(1);i.type==H.a.IDENT&&Me[i.text]?(n=new Me[i.text],t.consume()):n=new Pe,n.nw(this);let s=!1,r=[],o=!1;const a=[],l=[];for(;!s;)switch(t.consume(),(i=t.token()).type){case H.a.IDENT:if(this.validators[i.text])r.push(n.iw(i.text)),l.push(i.text);else{if(!(this.shorthands[i.text]instanceof Fe))throw new Error(`'${i.text}' is neither a simple property nor an inset shorthand`);{const t=this.shorthands[i.text];r.push(t.ow()),l.push(...t.ew)}}break;case H.a.SLASH:if(r.length>0||o)throw new Error("unexpected slash");o=!0;break;case H.a.O_BRK:a.push({slash:o,syntax:r}),r=[],o=!1;break;case H.a.C_BRK:{const t=new Le(r,o),e=a.pop();r=e.syntax,o=e.slash,r.push(t);break}case H.a.SEMICOL:s=!0,t.consume();break;default:throw new Error("unexpected token")}n.init(r,l),this.shorthands[e]=n}}parse(t){const e=new H.b(t,null);this.bw(e),this.ww(e),this.Ew(e),this.mb=this.xw(["background"]),this.bb=this.xw(["margin","border","padding","columns","column-gap","column-rule","column-fill"])}xw(t){const e={};for(const n of t){const t=this.shorthands[n],i=t?t.ew:[n];for(const t of i){const n=this.sw[t];n?e[t]=n:h.b.warn("Unknown property in makePropSet:",t)}}return e}Ni(t,e,n,i){let s="";const r=t,o=(t=t.toLowerCase()).match(/^-([a-z]+)-([-a-z0-9]+)$/);o&&(s=o[1],t=o[2]);const a=this.prefixes[t];if(!a||!a[s])return void i.Pi(r,e);const l=this.validators[t];if(l){const s=e===V.t.inherit||e.rt()?e:e.visit(l);s?i.Ri(t,s,n):i.Ci(r,e)}else{const s=this.shorthands[t].clone();e===V.t.inherit?s.rw(n,i):(e.visit(s),s.finish(n,i)||i.Ci(r,e))}}}function ze(){const t=new Ue;return t.pw(),t.parse(oe),t}var Be=n(17);const He={"font-style":V.t.normal,"font-variant":V.t.normal,"font-weight":V.t.normal},$e=`OTTO${(new Date).valueOf()}`;let Ve=1;function Ge(t,e){const n={};for(const i in t)n[i]=z.s(t,i).evaluate(e,i);return function(t){for(const e in He)t[e]||(t[e]=He[e])}(n),n}class je{constructor(t){this.properties=t,this.yw=[],this.blobs=[],this.kw=function(t){const e=new E.d;for(const n in He)e.append(" "),e.append(t[n].toString());return e.toString()}(this.properties),this.src=this.properties.src?this.properties.src.toString():null;const e=this.properties["font-family"];this.family=e?e.stringValue():null}Sw(t){return this.kw==t.kw}Tw(t,e){const n=new E.d;n.append("@font-face {\n  font-family: "),n.append(this.family),n.append(";\n  ");for(const t in He)n.append(t),n.append(": "),this.properties[t].it(n,!0),n.append(";\n  ");if(e){n.append('src: url("');const t=$.d(e);n.append(t),this.yw.push(t),this.blobs.push(e),n.append('")')}else n.append("src: "),n.append(t);return n.append(";\n}\n"),n.toString()}}class Xe{constructor(t){this.deobfuscator=t,this.Nw={}}Cw(t,e){const n=t.family,i=this.Nw[n],s=e.family;if(i){if(i!=s)throw new Error(`E_FONT_FAMILY_INCONSISTENT ${t.family}`)}else this.Nw[n]=s}Pw(t){if(t instanceof V.b){const e=t.values,n=[];for(const t of e){const e=this.Nw[t.stringValue()];e&&n.push(V.r(e)),n.push(t)}return new V.b(n)}{const e=this.Nw[t.stringValue()];return e?new V.b([V.r(e),t]):t}}}class Ye{constructor(t,e,n){this.head=t,this.body=e,this.Rw={},this._w=0,this.Aw=n||"Fnt_"}Iw(t,e){const n=t.family;let i=e.Nw[n];return i||(i=this.Aw+ ++this._w,e.Nw[n]=i,i)}Fw(t,e,n){const i=j.c("initFont"),s=this,r=t.src,o={};for(const e in He)o[e]=t.properties[e];const a=s.Iw(t,n);o["font-family"]=V.r(a);const l=new je(o),c=s.body.ownerDocument.createElement("span");c.textContent="M";const u=(new Date).valueOf()+1e3,d=s.head.ownerDocument.createElement("style"),f=$e+Ve++;d.textContent=l.Tw("",$.e([f])),s.head.appendChild(d),s.body.appendChild(c),c.style.visibility="hidden",c.style.fontFamily=a;for(const t in He)E.F(c,t,o[t].toString());const p=c.getBoundingClientRect(),g=p.right-p.left,m=p.bottom-p.top;d.textContent=l.Tw(r,e),h.b.info("Starting to load font:",r);let b=!1;return i.loop(()=>{const t=c.getBoundingClientRect(),e=t.right-t.left,n=t.bottom-t.top;return g!=e||m!=n?(b=!0,j.d(!1)):(new Date).valueOf()>u?j.d(!1):i.sleep(10)}).then(()=>{b?h.b.info("Loaded font:",r):h.b.warn("Failed to load font:",r),s.body.removeChild(c),i.finish(l)}),i.result()}Ow(t,e){const n=t.src;let i=this.Rw[n];const s=this;return i?i.piggyback(i=>{const s=i;s.Sw(t)?(e.Cw(t,s),h.b.warn("Found already-loaded font:",n)):h.b.warn("E_FONT_FACE_INCOMPATIBLE",t.src)}):(i=new Be.a(()=>{const i=j.c("loadFont"),r=e.deobfuscator?e.deobfuscator(n):null;return r?$.c(n,$.b.BLOB).then(n=>{n.Ml?r(n.Ml).then(n=>{s.Fw(t,n,e).Mt(i)}):i.finish(null)}):s.Fw(t,null,e).Mt(i),i.result()},`loadFont ${n}`),this.Rw[n]=i,i.start()),i}Lw(t,e){const n=[];for(const i of t)i.src&&i.family?n.push(this.Ow(i,e)):h.b.warn("E_FONT_FACE_INVALID");return Be.c(n)}}var Ke=n(30);let We=1;class Ze{constructor(t,e,n,i,s){this.name=e,this.Mw=n,this.classes=i,this.parent=s,this.specified={},this.children=[],this.Dw=null,this.index=0,this._scope=t,this.key=`p${We++}`,s&&(this.index=s.children.length,s.children.push(this))}get scope(){return this._scope}Tn(t){throw new Error("E_UNEXPECTED_CALL")}clone(t){throw new Error("E_UNEXPECTED_CALL")}$w(t){const e=this.specified,n=t.specified;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}Bw(t){for(let e=0;e<this.children.length;e++)this.children[e].clone({parent:t})}}class qe extends Ze{constructor(t){super(t,null,null,[],null),this.specified.width=new z.c(V.q,0),this.specified.height=new z.c(V.p,0)}}class Qe extends k.m{constructor(t,e){super(t,function(t,e){const i=t.match(/^([^.]+)\.([^.]+)$/);if(i){const t=n.Dw.Uw[i[1]];if(t){const n=this.Gw(t);if(n)return e?n.zw(i[2]):n.Hw(i[2])}}return null}),this.Dw=e;const n=this}}class Je extends Ze{constructor(t,e,n,i,s,r,o){super(t,e,n,i,s),this.condition=r,this.specificity=o,this.Uw={},t instanceof Qe||(this._scope=new Qe(t,this)),this.Dw=this,this.specified.width=new z.c(V.q,0),this.specified.height=new z.c(V.p,0),this.specified["wrap-flow"]=new z.c(V.t.auto,0),this.specified.position=new z.c(V.t.relative,0),this.specified.overflow=new z.c(V.t.visible,0)}Tn(t){return new mn(t,this)}clone(t){const e=new Je(this.scope,this.name,t.Mw||this.Mw,this.classes,this.parent,this.condition,this.specificity);return this.$w(e),this.Bw(e),e}Vw(){this.scope.Dw=this}}class tn extends Ze{constructor(t,e,n,i,s){super(t,e,n,i,s),this.Dw=s.Dw,e&&(this.Dw.Uw[e]=this.key),this.specified["wrap-flow"]=new z.c(V.t.auto,0)}Tn(t){return new bn(t,this)}clone(t){const e=new tn(t.parent.scope,this.name,this.Mw,this.classes,t.parent);return this.$w(e),this.Bw(e),e}}class en extends Ze{constructor(t,e,n,i,s){super(t,e,n,i,s),this.Dw=s.Dw,e&&(this.Dw.Uw[e]=this.key)}Tn(t){return new En(t,this)}clone(t){const e=new en(t.parent.scope,this.name,this.Mw,this.classes,t.parent);return this.$w(e),this.Bw(e),e}}function nn(t,e,n){return e&&e!==V.t.auto?e.st(t,n):null}function sn(t,e,n){return e&&e!==V.t.auto?e.st(t,n):t.zero}function rn(t,e,n){return e?e===V.t.auto?null:e.st(t,n):t.zero}function on(t,e,n,i){return e&&n!==V.t.none?e.st(t,i):t.zero}function an(t,e,n){return e?e===V.t._true?t._true:e===V.t._false?t._false:e.st(t,t.zero):n}class ln{constructor(t,e){this.jw=t,this.Xw=e,this.cascaded={},this.style={},this.Ww=null,this.Yw=null,this.children=[],this.qw=!1,this.Kw=!1,this.Zw=!1,this.Qw=!1,this.Jw=0,this.tE=0,this.eE=null,this.nE={},this.iE={},this.vertical=!1,this.rtl=!1,this.sE=!1,t&&t.children.push(this)}reset(){this.Jw=0,this.tE=0}rE(t,e){const n=this.Hw(t),i=this.Hw(e);if(!n||!i)throw new Error("E_INTERNAL");return k.C(this.Xw.scope,n,i)}Hw(t){let e=this.nE[t];if(e)return e;const n=this.style[t];switch(n&&(e=n.st(this.Xw.scope,this.Xw.scope.zero)),t){case"margin-left-edge":e=this.Hw("left");break;case"margin-top-edge":e=this.Hw("top");break;case"margin-right-edge":e=this.rE("border-right-edge","margin-right");break;case"margin-bottom-edge":e=this.rE("border-bottom-edge","margin-bottom");break;case"border-left-edge":e=this.rE("margin-left-edge","margin-left");break;case"border-top-edge":e=this.rE("margin-top-edge","margin-top");break;case"border-right-edge":e=this.rE("padding-right-edge","border-right-width");break;case"border-bottom-edge":e=this.rE("padding-bottom-edge","border-bottom-width");break;case"padding-left-edge":e=this.rE("border-left-edge","border-left-width");break;case"padding-top-edge":e=this.rE("border-top-edge","border-top-width");break;case"padding-right-edge":e=this.rE("right-edge","padding-right");break;case"padding-bottom-edge":e=this.rE("bottom-edge","padding-bottom");break;case"left-edge":e=this.rE("padding-left-edge","padding-left");break;case"top-edge":e=this.rE("padding-top-edge","padding-top");break;case"right-edge":e=this.rE("left-edge","width");break;case"bottom-edge":e=this.rE("top-edge","height")}if(!e){let n;if("extent"==t)n=this.vertical?"width":"height";else if("measure"==t)n=this.vertical?"height":"width";else{const e=this.vertical?z.m:z.l;n=t;for(const t in e)n=n.replace(t,e[t])}n!=t&&(e=this.Hw(n))}return e&&(this.nE[t]=e),e}zw(t){let e=this.iE[t];if(e)return e;switch(t){case"columns":{const t=this.Xw.scope,n=new k.A(t,0),i=this.Hw("column-count"),s=this.Hw("column-width"),r=this.Hw("column-gap");e=k.P(t,k.N(t,new k.d(t,"min",[n,i]),k.C(t,s,r)),r);break}}return e&&(this.iE[t]=e),e}oE(){const t=this.Xw.scope,e=this.style;let n=an(t,e.enabled,t._true);const i=nn(t,e.page,t.zero);if(i){const e=new k.s(t,"page-number");n=k.D(t,n,new k.i(t,i,e))}const s=nn(t,e["min-page-width"],t.zero);s&&(n=k.D(t,n,new k.j(t,new k.s(t,"page-width"),s)));const r=nn(t,e["min-page-height"],t.zero);r&&(n=k.D(t,n,new k.j(t,new k.s(t,"page-height"),r))),n=this.hE(n),e.enabled=new V.c(n)}hE(t){return t}lE(){const t=this.Xw.scope,e=this.style,n=this.jw?this.jw.style.width.st(t,null):null;let i=nn(t,e.left,n),s=nn(t,e["margin-left"],n);const r=on(t,e["border-left-width"],e["border-left-style"],n),o=sn(t,e["padding-left"],n);let a=nn(t,e.width,n),l=nn(t,e["max-width"],n);const h=sn(t,e["padding-right"],n),c=on(t,e["border-right-width"],e["border-right-style"],n);let u=nn(t,e["margin-right"],n),d=nn(t,e.right,n);const f=k.C(t,r,o),p=k.C(t,r,h);if(i&&d&&a){let e=k.P(t,n,k.C(t,a,k.C(t,k.C(t,i,f),p)));s?u?d=k.P(t,e,u):u=k.P(t,e,k.C(t,d,s)):(e=k.P(t,e,d),u?s=k.P(t,e,u):u=s=k.N(t,e,new k.f(t,.5)))}else{s||(s=t.zero),u||(u=t.zero),i||d||a||(i=t.zero),i||a?i||d?a||d||(a=this.Ww,this.qw=!0):i=t.zero:(a=this.Ww,this.qw=!0);const r=k.P(t,n,k.C(t,k.C(t,s,f),k.C(t,u,p)));this.qw&&(l||(l=k.P(t,r,i||d)),this.vertical||!nn(t,e["column-width"],null)&&!nn(t,e["column-count"],null)||(a=l,this.qw=!1)),i?a?d||(d=k.P(t,r,k.C(t,i,a))):a=k.P(t,r,k.C(t,i,d)):i=k.P(t,r,k.C(t,d,a))}const g=sn(t,e["snap-width"]||(this.jw?this.jw.style["snap-width"]:null),n);e.left=new V.c(i),e["margin-left"]=new V.c(s),e["border-left-width"]=new V.c(r),e["padding-left"]=new V.c(o),e.width=new V.c(a),e["max-width"]=new V.c(l||a),e["padding-right"]=new V.c(h),e["border-right-width"]=new V.c(c),e["margin-right"]=new V.c(u),e.right=new V.c(d),e["snap-width"]=new V.c(g)}cE(){const t=this.Xw.scope,e=this.style,n=this.jw?this.jw.style.width.st(t,null):null,i=this.jw?this.jw.style.height.st(t,null):null;let s=nn(t,e.top,i),r=nn(t,e["margin-top"],n);const o=on(t,e["border-top-width"],e["border-top-style"],n),a=sn(t,e["padding-top"],n);let l=nn(t,e.height,i),h=nn(t,e["max-height"],i);const c=sn(t,e["padding-bottom"],n),u=on(t,e["border-bottom-width"],e["border-bottom-style"],n);let d=nn(t,e["margin-bottom"],n),f=nn(t,e.bottom,i);const p=k.C(t,o,a),g=k.C(t,u,c);if(s&&f&&l){let e=k.P(t,i,k.C(t,l,k.C(t,k.C(t,s,p),g)));r?d?f=k.P(t,e,r):d=k.P(t,e,k.C(t,f,r)):(e=k.P(t,e,f),d?r=k.P(t,e,d):d=r=k.N(t,e,new k.f(t,.5)))}else{r||(r=t.zero),d||(d=t.zero),s||f||l||(s=t.zero),s||l?s||f?l||f||(l=this.Yw,this.Kw=!0):s=t.zero:(l=this.Yw,this.Kw=!0);const n=k.P(t,i,k.C(t,k.C(t,r,p),k.C(t,d,g)));this.Kw&&(h||(h=k.P(t,n,s||f)),this.vertical&&(nn(t,e["column-width"],null)||nn(t,e["column-count"],null))&&(l=h,this.Kw=!1)),s?l?f||(f=k.P(t,n,k.C(t,s,l))):l=k.P(t,n,k.C(t,f,s)):s=k.P(t,n,k.C(t,f,l))}const m=sn(t,e["snap-height"]||(this.jw?this.jw.style["snap-height"]:null),n);e.top=new V.c(s),e["margin-top"]=new V.c(r),e["border-top-width"]=new V.c(o),e["padding-top"]=new V.c(a),e.height=new V.c(l),e["max-height"]=new V.c(h||l),e["padding-bottom"]=new V.c(c),e["border-bottom-width"]=new V.c(u),e["margin-bottom"]=new V.c(d),e.bottom=new V.c(f),e["snap-height"]=new V.c(m)}aE(){const t=this.Xw.scope,e=this.style,n=nn(t,e[this.vertical?"height":"width"],null);let i=nn(t,e["column-width"],n),s=nn(t,e["column-count"],null),r=function(t,e,n){return e&&e!==V.t.normal?e.st(t,null):null}(t,e["column-gap"]);r||(r=new k.x(t,1,"em")),i&&!s&&(s=new k.d(t,"floor",[k.H(t,k.C(t,n,r),k.C(t,i,r))]),s=new k.d(t,"max",[t.one,s])),s||(s=t.one),i=k.P(t,k.H(t,k.C(t,n,r),s),r),e["column-width"]=new V.c(i),e["column-count"]=new V.c(s),e["column-gap"]=new V.c(r)}depends(t,e,n){return this.style[t].st(this.Xw.scope,null).depend(e,n)}init(t){t.uE(this.Xw.key,this);const e=this.Xw.scope,n=this.style,i=this,s=this.jw?this.jw.fE(t):null,r=z.n(this.cascaded,t,s,!1,null);this.vertical=z.z(r,t,!!this.jw&&this.jw.vertical),this.rtl=z.y(r,t,!!this.jw&&this.jw.rtl),z.k(r,n,this.vertical,this.rtl,(t,e)=>e.value),this.Ww=new k.t(e,()=>i.Jw,"autoWidth"),this.Yw=new k.t(e,()=>i.tE,"autoHeight"),this.lE(),this.cE(),this.aE(),this.oE()}dE(t,e){let n=this.style[e];return n&&(n=B.i(t,n,e)),n}pE(t,e){let n=this.style[e];return n&&(n=B.i(t,n,e)),V.x(n,t)}gE(t,e){const n=z.t(this.cascaded,e);if(n){const e=[];for(let i=0;i<n.length;i++){const s=n[i].evaluate(t,"");s&&s!==V.o&&e.push(s)}if(e.length)return e}return null}fE(t){const e=this.gE(t,"region-id");if(e){const t=[];for(let n=0;n<e.length;n++)t[n]=e[n].toString();return t}return null}mE(t,e,n,i){this.bE(t,e.element,n,i)}bE(t,e,n,i){let s=this.dE(t,n);s&&(s.ot()&&k.O(s.unit)&&(s=V.n(s,t)),"font-family"===n&&(s=i.Pw(s)),E.F(e,n,s.toString()))}wE(t,e,n,i){const s=this.dE(t,n);s&&i.push(new X.d(e.element,n,s))}EE(t,e){const n=this.pE(t,"left"),i=this.pE(t,"margin-left"),s=this.pE(t,"padding-left"),r=this.pE(t,"border-left-width"),o=this.pE(t,"width");e.$r(n,o),E.F(e.element,"margin-left",`${i}px`),E.F(e.element,"padding-left",`${s}px`),E.F(e.element,"border-left-width",`${r}px`),e.marginLeft=i,e.borderLeft=r,e.paddingLeft=s}xE(t,e){const n=this.pE(t,"right"),i=this.pE(t,"snap-height"),s=this.pE(t,"margin-right");let r=this.pE(t,"padding-right");const o=this.pE(t,"border-right-width");if(E.F(e.element,"margin-right",`${s}px`),E.F(e.element,"padding-right",`${r}px`),E.F(e.element,"border-right-width",`${o}px`),e.marginRight=s,e.borderRight=o,this.vertical&&i>0){const t=n+e.Sr(),s=t-Math.floor(t/i)*i;s>0&&(e.wr=i-s,r+=e.wr)}e.paddingRight=r,e.mr=i}yE(t,e){const n=this.pE(t,"snap-height"),i=this.pE(t,"top"),s=this.pE(t,"margin-top");let r=this.pE(t,"padding-top");const o=this.pE(t,"border-top-width");if(e.top=i,e.marginTop=s,e.borderTop=o,e.br=n,!this.vertical&&n>0){const t=i+e.xr(),s=t-Math.floor(t/n)*n;s>0&&(e.Er=n-s,r+=e.Er)}e.paddingTop=r,E.F(e.element,"top",`${i}px`),E.F(e.element,"margin-top",`${s}px`),E.F(e.element,"padding-top",`${r}px`),E.F(e.element,"border-top-width",`${o}px`)}kE(t,e){const n=this.pE(t,"margin-bottom"),i=this.pE(t,"padding-bottom"),s=this.pE(t,"border-bottom-width"),r=this.pE(t,"height")-e.Er;E.F(e.element,"height",`${r}px`),E.F(e.element,"margin-bottom",`${n}px`),E.F(e.element,"padding-bottom",`${i}px`),E.F(e.element,"border-bottom-width",`${s}px`),e.height=r-e.Er,e.marginBottom=n,e.borderBottom=s,e.paddingBottom=i}SE(t,e){this.vertical?this.xE(t,e):this.yE(t,e)}vE(t,e){this.vertical?this.EE(t,e):this.kE(t,e)}TE(t,e){this.vertical?(this.yE(t,e),this.kE(t,e)):(this.xE(t,e),this.EE(t,e))}NE(t,e){E.F(e.element,"border-top-width","0px");let n=this.pE(t,"max-height");this.Zw?e.Dr(0,n):(this.yE(t,e),n-=e.Er,e.height=n,E.F(e.element,"height",`${n}px`))}CE(t,e){E.F(e.element,"border-left-width","0px");let n=this.pE(t,"max-width");if(this.Qw)e.$r(0,n);else{this.xE(t,e),n-=e.wr,e.width=n;const i=this.pE(t,"right");E.F(e.element,"right",`${i}px`),E.F(e.element,"width",`${n}px`)}}PE(t,e,n,i,s){this.jw&&this.vertical==this.jw.vertical||E.F(e.element,"writing-mode",this.vertical?"vertical-rl":"horizontal-tb"),(this.vertical?this.qw:this.Kw)?this.vertical?this.CE(t,e):this.NE(t,e):(this.SE(t,e),this.vE(t,e)),(this.vertical?this.Kw:this.qw)?this.vertical?this.NE(t,e):this.CE(t,e):this.TE(t,e);for(let n=0;n<hn.length;n++)this.mE(t,e,hn[n],i)}RE(t,e,n,i){for(let n=0;n<un.length;n++)this.mE(t,e,un[n],i)}_E(t,e,n){for(let i=0;i<dn.length;i++)this.bE(t,e,dn[i],n)}AE(t,e,n,i,s,r,o){this.vertical?this.Jw=e.gr+e.wr:this.tE=e.gr+e.Er;const a=(this.vertical||!i)&&this.Kw,l=(!this.vertical||!i)&&this.qw;let h=null;if((l||a)&&(l&&E.F(e.element,"width","auto"),a&&E.F(e.element,"height","auto"),h=r.os(i?i.element:e.element),l&&(this.Jw=Math.ceil(h.right-h.left-e.paddingLeft-e.borderLeft-e.paddingRight-e.borderRight),this.vertical&&(this.Jw+=e.wr)),a&&(this.tE=h.bottom-h.top-e.paddingTop-e.borderTop-e.paddingBottom-e.borderBottom,this.vertical||(this.tE+=e.Er))),(this.vertical?this.Kw:this.qw)&&this.TE(t,e),(this.vertical?this.qw:this.Kw)&&((this.vertical?this.Qw:this.Zw)&&this.SE(t,e),this.vE(t,e)),s>1){const n=this.pE(t,"column-rule-width"),i=this.dE(t,"column-rule-style"),r=this.dE(t,"column-rule-color");if(n>0&&i&&i!=V.t.none&&r!=V.t.transparent){const o=this.pE(t,"column-gap"),a=this.vertical?e.height:e.width,l=this.vertical?"border-top":"border-left";for(let t=1;t<s;t++){const h=(a+o)*t/s-o/2+e.paddingLeft-n/2,c=e.height+e.paddingTop+e.paddingBottom,u=e.element.ownerDocument.createElement("div");E.F(u,"position","absolute"),E.F(u,this.vertical?"left":"top","0px"),E.F(u,this.vertical?"top":"left",`${h}px`),E.F(u,this.vertical?"height":"width","0px"),E.F(u,this.vertical?"width":"height",`${c}px`),E.F(u,l,`${n}px ${i.toString()}${r?` ${r.toString()}`:""}`),e.element.insertBefore(u,e.element.firstChild)}}}for(let n=0;n<cn.length;n++)this.mE(t,e,cn[n],o);for(let i=0;i<fn.length;i++)this.wE(t,e,fn[i],n.ji)}IE(t,e){const n=this.cascaded,i=this.Xw.specified;for(const t in i)z.x(t)&&z.F(n,t,z.s(i,t));if(this.Xw.Mw==pn)for(const t in e)(t.match(/^background-/)||"writing-mode"==t)&&(n[t]=e[t]);if("layout-host"==this.Xw.Mw)for(const t in e)t.match(/^background-/)||"writing-mode"==t||(n[t]=e[t]);t.Gn(this.Xw.classes,null,n),n.content&&(n.content=n.content._e(new z.e(t,null,t.gn))),this.init(t.context);for(const n of this.Xw.children)n.Tn(this).IE(t,e);t.Zn()}FE(t){this.qw&&(this.Qw=this.depends("right",this.Ww,t)||this.depends("margin-right",this.Ww,t)||this.depends("border-right-width",this.Ww,t)||this.depends("padding-right",this.Ww,t)),this.Kw&&(this.Zw=this.depends("top",this.Yw,t)||this.depends("margin-top",this.Yw,t)||this.depends("border-top-width",this.Yw,t)||this.depends("padding-top",this.Yw,t));for(const e of this.children)e.FE(t)}}const hn=["border-left-style","border-right-style","border-top-style","border-bottom-style","border-left-color","border-right-color","border-top-color","border-bottom-color","outline-style","outline-color","outline-width","overflow","visibility"],cn=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius","border-image-source","border-image-slice","border-image-width","border-image-outset","border-image-repeat","background-attachment","background-color","background-image","background-repeat","background-position","background-clip","background-origin","background-size","opacity","z-index","background-blend-mode","isolation","mix-blend-mode","filter"],un=["color","font-family","font-size","font-style","font-weight","font-variant","line-height","letter-spacing","text-align","text-decoration","text-indent","text-transform","white-space","word-spacing","font-feature-settings","font-kerning","font-size-adjust","font-variant-east-asian","font-stretch","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-shadow","text-underline-position"],dn=["width","height","image-resolution","object-fit","object-position"],fn=["transform","transform-origin"],pn="background-host";class gn extends ln{constructor(t){super(null,t)}IE(t,e){super.IE(t,e),this.children.sort((t,e)=>e.Xw.specificity-t.Xw.specificity||t.Xw.index-e.Xw.index)}}class mn extends ln{constructor(t,e){super(t,e),this.eE=this}hE(t){const e=this.Xw.Dw;return e.condition&&(t=k.D(e.scope,t,e.condition)),t}OE(t,e,n){}}class bn extends ln{constructor(t,e){super(t,e),this.eE=t.eE}}class En extends ln{constructor(t,e){super(t,e),this.eE=t.eE}LE(t,e,n){let i=null;if(e instanceof V.f&&(i=[e]),e instanceof V.b&&(i=e.values),i){const e=this.Xw.scope;for(let s=0;s<i.length;s++)if(i[s]instanceof V.f){const r=k.M(i[s].name,"enabled");let o=new k.s(e,r);n&&(o=new k.w(e,o)),t=k.D(e,t,o)}}return t}hE(t){const e=this.Xw.scope,n=this.style,i=an(e,n.required,e._false)!==e._false;if(i||this.Kw){const i=function(t,e,n){return e?e.st(t,t.zero):new k.f(t,"body")}(e,n["flow-from"]),s=new k.d(e,"has-content",[i]);t=k.D(e,t,s)}if(t=this.LE(t,n["required-partitions"],!1),t=this.LE(t,n["conflicting-partitions"],!0),i){const n=this.eE.style.enabled;let i=n?n.st(e,null):e._true;i=k.D(e,i,t),this.eE.style.enabled=new V.c(i)}return t}PE(t,e,n,i,s){E.F(e.element,"overflow","hidden"),super.PE(t,e,n,i,s)}}class wn extends B.f{constructor(t,e,n,i){super(t,e,!1),this.target=n,this.Jn=i}property(t,e,n){this.Jn.Ni(t,e,n,this)}Pi(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}Ci(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Ri(t,e,n){this.target.specified[t]=new z.c(e,n?B.d:B.e)}}class vn extends wn{constructor(t,e,n,i){super(t,e,n,i)}}class yn extends wn{constructor(t,e,n,i){super(t,e,n,i),n.specified.width=new z.c(V.s,0),n.specified.height=new z.c(V.s,0)}fo(t,e,n){const i=new en(this.scope,t,e,n,this.target),s=new vn(this.scope,this.owner,i,this.Jn);this.owner.Fi(s)}do(t,e,n){const i=new tn(this.scope,t,e,n,this.target),s=new yn(this.scope,this.owner,i,this.Jn);this.owner.Fi(s)}}class Tn extends wn{constructor(t,e,n,i){super(t,e,n,i)}fo(t,e,n){const i=new en(this.scope,t,e,n,this.target),s=new vn(this.scope,this.owner,i,this.Jn);this.owner.Fi(s)}do(t,e,n){const i=new tn(this.scope,t,e,n,this.target),s=new yn(this.scope,this.owner,i,this.Jn);this.owner.Fi(s)}}var Nn=n(19);function Sn(t){let e=t["writing-mode"];e=e&&e.value;let n=t.direction;return n=n&&n.value,e===V.t.vertical_lr||e!==V.t.vertical_rl&&n!==V.t.rtl?s.LTR:s.RTL}const xn={a5:{width:new V.i(148,"mm"),height:new V.i(210,"mm")},a4:{width:new V.i(210,"mm"),height:new V.i(297,"mm")},a3:{width:new V.i(297,"mm"),height:new V.i(420,"mm")},b5:{width:new V.i(176,"mm"),height:new V.i(250,"mm")},b4:{width:new V.i(250,"mm"),height:new V.i(353,"mm")},"jis-b5":{width:new V.i(182,"mm"),height:new V.i(257,"mm")},"jis-b4":{width:new V.i(257,"mm"),height:new V.i(364,"mm")},letter:{width:new V.i(8.5,"in"),height:new V.i(11,"in")},legal:{width:new V.i(8.5,"in"),height:new V.i(14,"in")},ledger:{width:new V.i(11,"in"),height:new V.i(17,"in")}},In=new V.i(.24,"pt"),Cn=new V.i(3,"mm"),On=new V.i(10,"mm"),_n=new V.i(13,"mm");function An(t){const e={width:V.q,height:V.p,bleed:V.u,ME:V.u},n=t.size;if(n&&n.value!==V.t.auto){const t=n.value;let i,s;if(t.ct()?(i=t.values[0],s=t.values[1]):(i=t,s=null),i.ot())e.width=i,e.height=s||i;else{const t=i.name&&xn[i.name.toLowerCase()];t&&(s&&s===V.t.landscape?(e.width=t.height,e.height=t.width):(e.width=t.width,e.height=t.height))}}const i=t.marks;i&&i.value!==V.t.none&&(e.ME=_n);const s=t.bleed;if(s&&s.value!==V.t.auto)s.value&&s.value.ot()&&(e.bleed=s.value);else if(i){let t=!1;(t=i.value.ct()?i.value.values.some(t=>t===V.t.crop):i.value===V.t.crop)&&(e.bleed=new V.i(6,"pt"))}return e}function kn(t,e){const n={},i=t.bleed.num*e.at(t.bleed.unit,!1),s=t.ME.num*e.at(t.ME.unit,!1),r=i+s,o=t.width;o===V.q?e.pref.defaultPaperSize?n.Yt=e.pref.defaultPaperSize.width*e.at("px",!1):n.Yt=(e.pref.Ht?Math.floor(e.ee/2)-e.pref.pageBorder:e.ee)-2*r:n.Yt=o.num*e.at(o.unit,!1);const a=t.height;return a===V.p?e.pref.defaultPaperSize?n.qt=e.pref.defaultPaperSize.height*e.at("px",!1):n.qt=e.ne-2*r:n.qt=a.num*e.at(a.unit,!1),n.bleed=i,n.ME=s,n.DE=r,n}function Dn(t,e,n){const i=t.createElementNS(E.a.SVG,"svg");return i.setAttribute("width",e),i.setAttribute("height",n),i.style.position="absolute",i}function Ln(t,e,n){n=n||"polyline";const i=t.createElementNS(E.a.SVG,n);return i.setAttribute("stroke","black"),i.setAttribute("stroke-width",e),i.setAttribute("fill","none"),i}var Rn,Pn;!function(t){t.TOP_LEFT="top left",t.TOP_RIGHT="top right",t.BOTTOM_LEFT="bottom left",t.BOTTOM_RIGHT="bottom right"}(Rn||(Rn={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right"}(Pn||(Pn={}));const Fn=(()=>{const t={width:!0,height:!0,"block-size":!0,"inline-size":!0,margin:!0,padding:!0,border:!0,outline:!0,"outline-width":!0,"outline-style":!0,"outline-color":!0};return["left","right","top","bottom","before","after","start","end","block-start","block-end","inline-start","inline-end"].forEach(e=>{t[`margin-${e}`]=!0,t[`padding-${e}`]=!0,t[`border-${e}-width`]=!0,t[`border-${e}-style`]=!0,t[`border-${e}-color`]=!0}),t})();var Mn;!function(t){t.START="start",t.CENTER="center",t.END="end"}(Mn||(Mn={}));const Un={"top-left-corner":{order:1,$E:!0,BE:!1,UE:!0,GE:!0,zE:null},"top-left":{order:2,$E:!0,BE:!1,UE:!1,GE:!1,zE:Mn.START},"top-center":{order:3,$E:!0,BE:!1,UE:!1,GE:!1,zE:Mn.CENTER},"top-right":{order:4,$E:!0,BE:!1,UE:!1,GE:!1,zE:Mn.END},"top-right-corner":{order:5,$E:!0,BE:!1,UE:!1,GE:!0,zE:null},"right-top":{order:6,$E:!1,BE:!1,UE:!1,GE:!0,zE:Mn.START},"right-middle":{order:7,$E:!1,BE:!1,UE:!1,GE:!0,zE:Mn.CENTER},"right-bottom":{order:8,$E:!1,BE:!1,UE:!1,GE:!0,zE:Mn.END},"bottom-right-corner":{order:9,$E:!1,BE:!0,UE:!1,GE:!0,zE:null},"bottom-right":{order:10,$E:!1,BE:!0,UE:!1,GE:!1,zE:Mn.END},"bottom-center":{order:11,$E:!1,BE:!0,UE:!1,GE:!1,zE:Mn.CENTER},"bottom-left":{order:12,$E:!1,BE:!0,UE:!1,GE:!1,zE:Mn.START},"bottom-left-corner":{order:13,$E:!1,BE:!0,UE:!0,GE:!1,zE:null},"left-bottom":{order:14,$E:!1,BE:!1,UE:!0,GE:!1,zE:Mn.END},"left-middle":{order:15,$E:!1,BE:!1,UE:!0,GE:!1,zE:Mn.CENTER},"left-top":{order:16,$E:!1,BE:!1,UE:!0,GE:!1,zE:Mn.START}},zn=(()=>{const t=Un;return Object.keys(t).sort((e,n)=>t[e].order-t[n].order)})(),Bn="vivliostyle-page-rule-master",Hn="_marginBoxes";class $n extends Je{constructor(t,e,n){super(t,null,Bn,[],e,null,0),this.HE={};const i=An(n),s=new Vn(this.scope,this,n,i);this.VE=s.key,this.jE(n),this.XE(n,i)}jE(t){const e=t[Hn];if(e){const n=this;zn.forEach(i=>{e[i]&&(n.HE[i]=new Gn(n.scope,n,i,t))})}}XE(t,e){this.specified.position=new z.c(V.t.relative,0),this.specified.width=new z.c(e.width,0),this.specified.height=new z.c(e.height,0);for(const e in t)Fn[e]||"background-clip"===e||(this.specified[e]=t[e])}Tn(t){return new jn(t,this)}}class Vn extends en{constructor(t,e,n,i){super(t,null,null,[],e),this.WE=i,this.specified["z-index"]=new z.c(new V.g(0),0),this.XE(n)}XE(t){this.specified["flow-from"]=new z.c(V.r("body"),0),this.specified.position=new z.c(V.t.absolute,0),this.specified.overflow=new z.c(V.t.visible,0);for(const e in Fn)Fn.hasOwnProperty(e)&&(this.specified[e]=t[e])}Tn(t){return new Wn(t,this)}}class Gn extends en{constructor(t,e,n,i){super(t,null,null,[],e),this.YE=n,this.XE(i)}XE(t){const e=t[Hn][this.YE];for(const n in t){const i=t[n],s=e[n];(z.v[n]||s&&s.value===V.t.inherit)&&(this.specified[n]=i)}for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];n&&n.value!==V.t.inherit&&(this.specified[t]=n)}}Tn(t){return new Zn(t,this)}}class jn extends mn{constructor(t,e){super(t,e),this.qE=null,this.KE={}}IE(t,e){const n=this.cascaded;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(t){case"writing-mode":case"direction":n[t]=e[t]}super.IE(t,e)}lE(){const t=this.style;t.left=V.u,t["margin-left"]=V.u,t["border-left-width"]=V.u,t["padding-left"]=V.u,t["padding-right"]=V.u,t["border-right-width"]=V.u,t["margin-right"]=V.u,t.right=V.u}cE(){const t=this.style;t.top=V.u,t["margin-top"]=V.u,t["border-top-width"]=V.u,t["padding-top"]=V.u,t["padding-bottom"]=V.u,t["border-bottom-width"]=V.u,t["margin-bottom"]=V.u,t.bottom=V.u}ZE(t){this.qE=t;const e=this.style;e.width=new V.c(t.QE),e.height=new V.c(t.JE),e["padding-left"]=new V.c(t.marginLeft),e["padding-right"]=new V.c(t.marginRight),e["padding-top"]=new V.c(t.marginTop),e["padding-bottom"]=new V.c(t.marginBottom)}OE(t,e,n){const i=e.Qi,s={start:this.qE.marginLeft,end:this.qE.marginRight,extent:this.qE.QE},r={start:this.qE.marginTop,end:this.qE.marginBottom,extent:this.qE.JE};this.tx(i.top,!0,s,t,n),this.tx(i.bottom,!0,s,t,n),this.tx(i.left,!1,r,t,n),this.tx(i.right,!1,r,t,n)}tx(t,e,n,i,s){const r=Mn.START,o=Mn.CENTER,a=Mn.END,l=this.Xw.scope,h={},c={},u={};for(const n in t){const i=Un[n];if(i){const r=t[n],o=this.KE[n],a=new Xn(r,o.style,e,l,s);h[i.zE]=r,c[i.zE]=o,u[i.zE]=a}}const d={start:n.start.evaluate(i),end:n.end.evaluate(i),extent:n.extent.evaluate(i)};let f=this.nx(u,d.extent),p=!1;const g={};Object.keys(h).forEach(t=>{const r=t,o=nn(l,c[r].style[e?"max-width":"max-height"],n.extent);if(o){const t=o.evaluate(i);if(f[r]>t){const n=u[r]=new Kn(h[r],c[r].style,e,l,s,t);g[r]=n.ix(),p=!0}}}),p&&(f=this.nx(u,d.extent),p=!1,[r,o,a].forEach(t=>{f[t]=g[t]||f[t]}));const m={};Object.keys(h).forEach(t=>{const r=t,o=nn(l,c[r].style[e?"min-width":"min-height"],n.extent);if(o){const t=o.evaluate(i);if(f[r]<t){const n=u[r]=new Kn(h[r],c[r].style,e,l,s,t);m[r]=n.ix(),p=!0}}}),p&&(f=this.nx(u,d.extent),[r,o,a].forEach(t=>{f[t]=m[t]||f[t]}));const b=d.start+d.extent,E=d.start+(d.start+d.extent);[r,o,a].forEach(t=>{const n=f[t];if(n){const i=h[t];let s=0;switch(t){case r:s=e?i.left:i.top;break;case o:s=(E-n)/2;break;case a:s=b-n}e?i.$r(s,n-i.kr()-i.Sr()):i.Dr(s,n-i.xr()-i.yr())}})}nx(t,e){const n=t[Mn.START],i=t[Mn.CENTER],s=t[Mn.END],r={};if(i){const t=[n,s].filter(t=>t),o=t.length?new Yn(t):null,a=this.sx(i,o,e);a.xSize&&(r[Mn.CENTER]=a.xSize);const l=(e-(a.xSize||i.ix()))/2;n&&n.ox()&&(r[Mn.START]=l),s&&s.ox()&&(r[Mn.END]=l)}else{const t=this.sx(n,s,e);t.xSize&&(r[Mn.START]=t.xSize),t.ySize&&(r[Mn.END]=t.ySize)}return r}sx(t,e,n){const i={xSize:null,ySize:null};if(t&&e)if(t.ox()&&e.ox()){const s=t.hx(),r=e.hx();if(s>0&&r>0){const o=s+r;if(o<n)i.xSize=n*s/o;else{const r=t.lx(),a=r+e.lx();a<n?i.xSize=r+(n-a)*(s-r)/(o-a):a>0&&(i.xSize=n*r/a)}i.xSize>0&&(i.ySize=n-i.xSize)}else s>0?i.xSize=n:r>0&&(i.ySize=n)}else t.ox()?i.xSize=Math.max(n-e.ix(),0):e.ox()&&(i.ySize=Math.max(n-t.ix(),0));else t?t.ox()&&(i.xSize=n):e&&e.ox()&&(i.ySize=n);return i}PE(t,e,n,i,s){super.PE(t,e,n,i,s),e.element.setAttribute("data-vivliostyle-page-box",!0)}}class Xn{constructor(t,e,n,i,s){this.container=t,this.ax=n,this.rl=s,this.size=null,this.ux=!nn(i,e[n?"width":"height"],new k.x(i,0,"px"))}ox(){return this.ux}gx(){if(!this.size){const t=this.ax?[Nn.a.MAX_CONTENT_WIDTH,Nn.a.MIN_CONTENT_WIDTH]:[Nn.a.MAX_CONTENT_HEIGHT,Nn.a.MIN_CONTENT_HEIGHT];this.size=Nn.b(this.rl,this.container.element,t)}return this.size}hx(){const t=this.gx();return this.ax?this.container.kr()+t[Nn.a.MAX_CONTENT_WIDTH]+this.container.Sr():this.container.xr()+t[Nn.a.MAX_CONTENT_HEIGHT]+this.container.yr()}lx(){const t=this.gx();return this.ax?this.container.kr()+t[Nn.a.MIN_CONTENT_WIDTH]+this.container.Sr():this.container.xr()+t[Nn.a.MIN_CONTENT_HEIGHT]+this.container.yr()}ix(){return this.ax?this.container.kr()+this.container.width+this.container.Sr():this.container.xr()+this.container.height+this.container.yr()}}class Yn{constructor(t){this.params=t}ox(){return this.params.some(t=>t.ox())}hx(){const t=this.params.map(t=>t.hx());return Math.max.apply(null,t)*t.length}lx(){const t=this.params.map(t=>t.lx());return Math.max.apply(null,t)*t.length}ix(){const t=this.params.map(t=>t.ix());return Math.max.apply(null,t)*t.length}}class Kn extends Xn{constructor(t,e,n,i,s,r){super(t,e,n,i,s),this.mx=r}ox(){return!1}hx(){return this.ix()}lx(){return this.ix()}ix(){return this.ax?this.container.kr()+this.mx+this.container.Sr():this.container.xr()+this.mx+this.container.yr()}}class Wn extends En{constructor(t,e){super(t,e),this.QE=null,this.JE=null,this.marginTop=null,this.marginRight=null,this.marginBottom=null,this.marginLeft=null}IE(t,e){const n=this.cascaded;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(t.match(/^column.*$/)||t.match(/^background-/))&&(n[t]=e[t]);super.IE(t,e),this.jw.ZE({QE:this.QE,JE:this.JE,marginTop:this.marginTop,marginRight:this.marginRight,marginBottom:this.marginBottom,marginLeft:this.marginLeft})}lE(){const t=this.bx({start:"left",end:"right",extent:"width"});this.QE=t.wx,this.marginLeft=t.Ex,this.marginRight=t.xx}cE(){const t=this.bx({start:"top",end:"bottom",extent:"height"});this.JE=t.wx,this.marginTop=t.Ex,this.marginBottom=t.xx}bx(t){const e=this.style,n=this.Xw.WE,i=this.Xw.scope,s=t.start,r=t.end,o=t.extent,a=n[o].st(i,null);let l=nn(i,e[o],a),h=nn(i,e[`margin-${s}`],a),c=nn(i,e[`margin-${r}`],a);const u=sn(i,e[`padding-${s}`],a),d=sn(i,e[`padding-${r}`],a),f=on(i,e[`border-${s}-width`],e[`border-${s}-style`],a),p=on(i,e[`border-${r}-width`],e[`border-${r}-style`],a);let g=k.P(i,a,k.C(i,k.C(i,f,u),k.C(i,p,d)));return l?(g=k.P(i,g,l),h||c?h?c=k.P(i,g,h):h=k.P(i,g,c):c=h=k.N(i,g,new k.f(i,.5))):(h||(h=i.zero),c||(c=i.zero),l=k.P(i,g,k.C(i,h,c))),e[s]=new V.c(h),e[r]=new V.c(c),e[`margin-${s}`]=V.u,e[`margin-${r}`]=V.u,e[`padding-${s}`]=new V.c(u),e[`padding-${r}`]=new V.c(d),e[`border-${s}-width`]=new V.c(f),e[`border-${r}-width`]=new V.c(p),e[o]=new V.c(l),e[`max-${o}`]=new V.c(l),{wx:k.P(i,a,k.C(i,h,c)),Ex:h,xx:c}}PE(t,e,n,i,s){super.PE(t,e,n,i,s),n.Vi=e.element,t.oe=parseFloat(n.Vi.style.width),t.he=parseFloat(n.Vi.style.height)}}class Zn extends En{constructor(t,e){super(t,e),this.sE=!0;const n=e.YE;this.yx=Un[n],t.KE[n]=this}PE(t,e,n,i,s){this.kx(t,e.element),super.PE(t,e,n,i,s)}kx(t,e){E.F(e,"display","flex");const n=this.dE(t,"vertical-align");let i=null;n===V.r("middle")?i="center":n===V.r("top")?i="flex-start":n===V.r("bottom")&&(i="flex-end"),i&&(E.F(e,"flex-flow",this.vertical?"row":"column"),E.F(e,"justify-content",i))}zE(t,e){const n=this.style,i=this.Xw.scope,s=t.start,r=t.end,o=t.extent,a="left"===s,l=a?e.QE:e.JE,h=nn(i,n[o],l),c=a?e.marginLeft:e.marginTop;if(this.yx.zE===Mn.START)n[s]=new V.c(c);else if(h){const t=sn(i,n[`margin-${s}`],l),e=sn(i,n[`margin-${r}`],l),o=sn(i,n[`padding-${s}`],l),a=sn(i,n[`padding-${r}`],l),u=on(i,n[`border-${s}-width`],n[`border-${s}-style`],l),d=on(i,n[`border-${r}-width`],n[`border-${r}-style`],l),f=k.C(i,h,k.C(i,k.C(i,o,a),k.C(i,k.C(i,u,d),k.C(i,t,e))));switch(this.yx.zE){case Mn.CENTER:n[s]=new V.c(k.C(i,c,k.H(i,k.P(i,l,f),new k.f(i,2))));break;case Mn.END:n[s]=new V.c(k.P(i,k.C(i,c,l),f))}}}Sx(t,e){const n=this.style,i=this.Xw.scope,s=t.inside,r=t.outside,o=t.extent,a=e[`margin${r.charAt(0).toUpperCase()}${r.substring(1)}`],l=rn(i,n[`margin-${s}`],a),h=rn(i,n[`margin-${r}`],a),c=sn(i,n[`padding-${s}`],a),u=sn(i,n[`padding-${r}`],a),d=on(i,n[`border-${s}-width`],n[`border-${s}-style`],a),f=on(i,n[`border-${r}-width`],n[`border-${r}-style`],a),p=nn(i,n[o],a);let g=null;function m(t){if(g)return g;g={extent:p?p.evaluate(t):null,vx:l?l.evaluate(t):null,Tx:h?h.evaluate(t):null};const e=a.evaluate(t);let n=0;return[d,c,u,f].forEach(e=>{e&&(n+=e.evaluate(t))}),(null===g.vx||null===g.Tx)&&n+g.extent+g.vx+g.Tx>e&&(null===g.vx&&(g.vx=0),null===g.Tx&&(g.Tx=0)),null!==g.extent&&null!==g.vx&&null!==g.Tx&&(g.Tx=null),null===g.extent&&null!==g.vx&&null!==g.Tx?g.extent=e-n-g.vx-g.Tx:null!==g.extent&&null===g.vx&&null!==g.Tx?g.vx=e-n-g.extent-g.Tx:null!==g.extent&&null!==g.vx&&null===g.Tx?g.Tx=e-n-g.extent-g.vx:null===g.extent?(g.vx=g.Tx=0,g.extent=e-n):g.vx=g.Tx=(e-n-g.extent)/2,g}n[o]=new V.c(new k.t(i,function(){const t=m(this).extent;return null===t?0:t},o)),n[`margin-${s}`]=new V.c(new k.t(i,function(){const t=m(this).vx;return null===t?0:t},`margin-${s}`)),n[`margin-${r}`]=new V.c(new k.t(i,function(){const t=m(this).Tx;return null===t?0:t},`margin-${r}`)),"left"===s?n.left=new V.c(k.C(i,e.marginLeft,e.QE)):"top"===s&&(n.top=new V.c(k.C(i,e.marginTop,e.JE)))}lE(){const t=this.jw.qE;this.yx.UE?this.Sx({inside:"right",outside:"left",extent:"width"},t):this.yx.GE?this.Sx({inside:"left",outside:"right",extent:"width"},t):this.zE({start:"left",end:"right",extent:"width"},t)}cE(){const t=this.jw.qE;this.yx.$E?this.Sx({inside:"bottom",outside:"top",extent:"height"},t):this.yx.BE?this.Sx({inside:"top",outside:"bottom",extent:"height"},t):this.zE({start:"top",end:"bottom",extent:"height"},t)}AE(t,e,n,i,s,r,o){super.AE(t,e,n,i,s,r,o);const a=n.Qi,l=this.Xw.YE,h=this.yx;h.UE||h.GE?h.$E||h.BE||(h.UE?a.left[l]=e:h.GE&&(a.right[l]=e)):h.$E?a.top[l]=e:h.BE&&(a.bottom[l]=e)}}class qn{constructor(t,e,n,i,s){this.Nx=t,this.Kf=e,this.Cx=n,this.context=i,this.Px=s,this.Rx={},this._x()}_x(){const t=this.Kf,e=new k.s(t,"page-number"),n=new k.i(t,new k.q(t,e,new k.f(t,2)),t.zero);t.Zt("recto-page",new k.w(t,n)),t.Zt("verso-page",n),(this.context.Ax||Sn(this.Px))===s.LTR?(t.Zt("left-page",n),t.Zt("right-page",new k.w(t,n))):(t.Zt("left-page",new k.w(t,n)),t.Zt("right-page",n))}Ix(){const t={};return this.Nx.Gn([],"",t),this.Nx.Zn(),t}Fx(t,e){const n=t.Xw;if(0===Object.keys(e).length)return n.Vw(),t;const i=this.Ox(e,n);let s=this.Rx[i];return s||(s=n.Mw===pn?this.Lx(e):this.Mx(e,n),this.Rx[i]=s),s.Xw.Vw(),s}Ox(t,e){const n=this.Dx(t);return`${e.key}^${n}`}Dx(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];let s;s=i instanceof z.c?`${i.value}`:this.Dx(i),e.push(n+s+(i.priority||""))}return e.sort().join("^")}Lx(t){const e=new $n(this.Kf,this.Cx.Xw,t).Tn(this.Cx);return e.IE(this.Nx,this.Px),e.FE(this.context),e}Mx(t,e){const n=e.clone({Mw:Bn}),i=n.specified,s=t.size;if(s){const e=An(t),n=s.priority;i.width=z.i(this.context,i.width,new z.c(e.width,n)),i.height=z.i(this.context,i.height,new z.c(e.height,n))}["counter-reset","counter-increment"].forEach(e=>{i[e]&&(t[e]=i[e])});const r=n.Tn(this.Cx);return r.IE(this.Nx,this.Px),r.FE(this.context),r}}class Qn extends z.d{constructor(t){super(),this.$x=t}apply(t){t.An===this.$x&&this.chained.apply(t)}ve(){return 3}Ge(t){return this.chained&&t.He(t.pagetypes,this.$x,this.chained),!0}}class Jn extends z.d{constructor(t){super(),this.scope=t}apply(t){1===new k.s(this.scope,"page-number").evaluate(t.context)&&this.chained.apply(t)}ve(){return 2}}class ti extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"left-page").evaluate(t.context)&&this.chained.apply(t)}ve(){return 1}}class ei extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"right-page").evaluate(t.context)&&this.chained.apply(t)}ve(){return 1}}class ni extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"recto-page").evaluate(t.context)&&this.chained.apply(t)}ve(){return 1}}class ii extends z.d{constructor(t){super(),this.scope=t}apply(t){new k.s(this.scope,"verso-page").evaluate(t.context)&&this.chained.apply(t)}ve(){return 1}}class si extends z.a{constructor(t,e){super(t,e,null,null,null)}apply(t){!function(t,e,n,i,s){z.B(t,e,n,i,null,null,null);const r=n[Hn];if(r){const n=z.q(e,Hn);for(const e in r)if(r.hasOwnProperty(e)){let s=n[e];s||(s={},n[e]=s),z.B(t,s,r[e],i,null,null,null)}}}(t.context,t.currentStyle,this.style,this.specificity)}}class ri extends z.b{constructor(t,e,n,i,s){super(t,e,null,n,null,i,!1),this.Bx=s,this.Ux=[],this.Gx="",this.zx=[]}ro(){this.Ei()}hi(t,e){b.a(e),this.Gx=e,e&&(this.chain.push(new Qn(e)),this.specificity+=65536)}ci(t,e){switch(e&&this.oi(`E_INVALID_PAGE_SELECTOR :${t}(${e.join("")})`),this.zx.push(`:${t}`),t.toLowerCase()){case"first":this.chain.push(new Jn(this.scope)),this.specificity+=256;break;case"left":this.chain.push(new ti(this.scope)),this.specificity+=1;break;case"right":this.chain.push(new ei(this.scope)),this.specificity+=1;break;case"recto":this.chain.push(new ni(this.scope)),this.specificity+=1;break;case"verso":this.chain.push(new ii(this.scope)),this.specificity+=1;break;default:this.oi(`E_INVALID_PAGE_SELECTOR :${t}`)}}Hx(){let t;t=this.Gx||this.zx.length?[this.Gx].concat(this.zx.sort()):null,this.Ux.push({selectors:t,specificity:this.specificity}),this.Gx="",this.zx=[]}bi(){this.Hx(),super.bi()}yi(){this.Hx(),super.yi()}Ri(t,e,n){if(("bleed"===t||"marks"===t)&&!this.Ux.some(t=>null===t.selectors))return;super.Ri(t,e,n);const i=z.s(this.ti,t),s=this.Bx;if("bleed"===t||"marks"===t)s[""]||(s[""]={}),Object.keys(s).forEach(e=>{z.F(s[e],t,i)});else if("size"===t){const e=s[""];this.Ux.forEach(n=>{let r=new z.c(i.value,i.priority+n.specificity);const o=n.selectors?n.selectors.join(""):"";let a=s[o];if(a){const e=z.s(a,t);r=e?z.i(null,r,e):r,z.F(a,t,r)}else a=s[o]={},z.F(a,t,r),e&&["bleed","marks"].forEach(t=>{e[t]&&z.F(a,t,e[t])},this)})}}ii(t){this.cascade.He(this.cascade.pagetypes,"*",t)}Ti(t){return new si(this.ti,t)}oo(t){const e=z.q(this.ti,Hn);let n=e[t];n||(n={},e[t]=n);const i=new oi(this.scope,this.owner,this.Jn,n);this.owner.Fi(i)}}class oi extends B.f{constructor(t,e,n,i){super(t,e,!1),this.Jn=n,this.Vx=i}property(t,e,n){this.Jn.Ni(t,e,n,this)}Ci(t,e){this.report(`E_INVALID_PROPERTY_VALUE ${t}: ${e.toString()}`)}Pi(t,e){this.report(`E_INVALID_PROPERTY ${t}: ${e.toString()}`)}Ri(t,e,n){const i=n?this._i():this.Ai(),s=new z.c(e,i);z.F(this.Vx,t,s)}}var ai=n(27),li=n(25),hi=n(21);const ci=(t,e,n)=>t.replace(/[uU][rR][lL]\(\s*"((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"\r\n])+)"/gm,(t,i)=>`url("${n.sc(i,e)}"`).replace(/[uU][rR][lL]\(\s*'((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^'\r\n])+)'/gm,(t,i)=>`url('${n.sc(i,e)}'`).replace(/[uU][rR][lL]\(\s*((\\([^0-9a-fA-F]+|[0-9a-fA-F]+\s*)|[^"'\r\n\)\s])+)/gm,(t,i)=>`url(${n.sc(i,e)}`),ui={},di={"text-indent":"0px","margin-top":"0px","padding-top":"0px","border-top-width":"0px","border-top-style":"none","border-top-color":"transparent","border-top-left-radius":"0px","border-top-right-radius":"0px"},fi={"text-indent":"0px","margin-right":"0px","padding-right":"0px","border-right-width":"0px","border-right-style":"none","border-right-color":"transparent","border-top-right-radius":"0px","border-bottom-right-radius":"0px"},pi={"margin-top":"0px"},gi={"margin-right":"0px"};class mi extends E.c{constructor(t,e,n,i,s,r,o,a,l,h,c,u,d){super(),this.ls=t,this.context=e,this.viewport=n,this.styler=i,this.jx=s,this.xmldoc=r,this.Xx=o,this.Wx=a,this.Yx=l,this.page=h,this.qx=c,this.Kx=u,this.Wf=d,this.Pc=null,this.Zx=null,this.ja=!1,this.ys=null,this.ws=0,this.Fs=null,this.document=n.document,this.Yr=i.Cn.qf()}clone(){return new mi(this.ls,this.context,this.viewport,this.styler,this.jx,this.xmldoc,this.Xx,this.Wx,this.Yx,this.page,this.qx,this.Kx,this.Wf)}Qx(t,e,n,i,s,r,o,a){const l=this.Jx(n,this.jx,this.ja,this.Pc,r);if(!l)return a;const h=[],c=hi.c.createElementNS(E.a.SHADOW,"root");let u=c;for(const t of hi.e){let n;if(t){if(!l[t])continue;if(!("footnote-marker"!=t||e&&this.ja))continue;if(t.match(/^first-/)){const t=i.display;if(!t||t===V.t.inline)continue}if("before"===t||"after"===t){const e=l[t].content;if(!e||e===V.t.normal||e===V.t.none)continue}h.push(t),n=hi.c.createElementNS(E.a.XHTML,"span"),hi.f(n,t)}else n=hi.c.createElementNS(E.a.SHADOW,"content");u.appendChild(n),t.match(/^first-/)&&(u=n)}if(!h.length)return a;const d=new hi.b(t,n,s,r,this.Yr);return new X.n(t,c,null,o,a,X.o.ROOTLESS,d)}Jx(t,e,n,i,s){const r=z.u(t,"_pseudos");if(!r)return null;const o={};for(const t in r){const i=o[t]={};z.C(i,r[t],s),z.D(i,s,r[t]),z.o(r[t],e,n,(t,e)=>{z.C(i,e,s),z.p(e,t=>{z.C(i,t,s)})})}return o}ty(t,e,n,i,s){const r=this,o=j.c("createRefShadow");return r.xmldoc.store.load(t).then(a=>{const l=a;if(l){const o=l.ey(t);if(o){const t=r.Yx.ny(l);s=new X.n(n,o,l,i,s,e,t)}}o.finish(s)}),o.result()}iy(t,e,n,i,s,r,o){const a=this,l=j.c("createShadows"),h=i.template;let c;if(h instanceof V.l){const e=h.url;c=a.ty(e,X.o.ROOTLESS,t,o,null)}else c=j.d(null);return c.then(h=>{let c=null;if(t.namespaceURI==E.a.SHADOW&&"include"==t.localName){let e=t.getAttribute("href"),n=null;e?n=o?o.xmldoc:a.xmldoc:o&&(e=o.owner.namespaceURI==E.a.XHTML?o.owner.getAttribute("href"):o.owner.getAttributeNS(E.a.XLINK,"href"),n=o.ks?o.ks.xmldoc:a.xmldoc),e&&(e=E.C(e,n.url),c=a.ty(e,X.o.ROOTED,t,o,h))}null==c&&(c=j.d(h));let u=null;c.then(e=>{if(i.display===V.t.table_cell){const n=E.C("user-agent.xml#table-cell",E.D);u=a.ty(n,X.o.ROOTLESS,t,o,e)}else u=j.d(e)}),u.then(h=>{h=a.Qx(t,e,n,i,s,r,o,h),l.finish(h)})}),l.result()}au(t,e){this.Zx=t,this.ja=e}sy(t,e,n,i){const s=this.context,r=z.n(n,s,this.jx,this.ja,this.Pc);t=z.z(r,s,t),e=z.y(r,s,e);const o=this;z.k(r,i,t,e,(t,e)=>{let n=e.evaluate(s,t);return"font-family"==t&&(n=o.Xx.Pw(n)),n});const a=i.position,l=i.float,h=Qt.c(i.display||V.t.inline,a,l,this.ys===this.xmldoc.root);return["display","position","float"].forEach(t=>{h[t]&&(i[t]=h[t])}),t}oy(t){let e=this.Pc.ys;const n=[];let i=null,s=this.Pc.ps,r=-1;for(;e&&1==e.nodeType;){const t=s&&s.root==e;if(!t||s.type==X.o.ROOTLESS){const t=(s?s.styler:this.styler).oc(e,!1);n.push(t),i=i||E.u(e)}t?(e=s.owner,s=s.ks):(e=e.parentNode,r++)}const o=0===r,a=this.context.at("em",o),l={"font-size":new z.c(new V.i(a,"px"),0)},h=new z.g(l,this.context);for(let t=n.length-1;t>=0;--t){const e=n[t],i=[];for(const t in e)z.w(t)&&i.push(t);i.sort(V.v);for(const t of i){h.Oe(t);const n=z.s(e,t);n.value!==V.t.inherit&&(l[t]=n._e(h))}}for(const e in t)z.w(e)||(l[e]=t[e]);return{lang:i,ti:l}}hy(t){return t=E.C(t,this.xmldoc.url),this.Kx[t]||t}ly(){this.Pc.lang=E.u(this.Pc.ys)||this.Pc.parent&&this.Pc.parent.lang||this.Pc.lang}ay(t){const e=z.r().filter(e=>t[e]);if(e.length){let n=this.Pc.Hs;if(this.Pc.parent){n=this.Pc.Hs={};for(const t in this.Pc.parent.Hs)n[t]=this.Pc.parent.Hs[t]}e.forEach(e=>{const i=t[e];if(i){if(i instanceof V.g)n[e]=i.num;else if(i instanceof V.f)n[e]=i.name;else if(i instanceof V.i){const t=i;switch(t.unit){case"dpi":case"dpcm":case"dppx":n[e]=t.num*k.G[t.unit]}}else n[e]=i;delete t[e]}})}}uy(t,e,n,i,s,r){const o=l.b(l.a.RESOLVE_FORMATTING_CONTEXT);for(let a=0;a<o.length;a++){const l=o[a](t,e,n,i,s,r);if(l)return void(t.us=l)}}py(t,e){const n=this;let i=!0;const s=j.c("createElementView");let r=n.ys;const o=n.Pc.ps?n.Pc.ps.styler:n.styler;let a=o.oc(r,!1);if(!n.Pc.ps){const t=this.xmldoc.Ig(r);li.b.pa(t,n.Pc.Es,0)}const l={};if(!n.Pc.parent){const t=n.oy(a);a=t.ti,n.Pc.lang=t.lang}const h=a["float-reference"]&&G.g(a["float-reference"].value.toString());if(n.Pc.parent&&h&&G.h(h)){const t=n.oy(a);a=t.ti,n.Pc.lang=t.lang}n.Pc.vertical=n.sy(n.Pc.vertical,"rtl"===n.Pc.direction,a,l),o.hc(r,l),this.ay(l),this.ly(),l.direction&&(n.Pc.direction=l.direction.toString());const c=l["flow-into"];if(c&&c.toString()!=n.ls)return s.finish(!1),s.result();let u=l.display;if(u===V.t.none)return s.finish(!1),s.result();const d=null==n.Pc.parent;return n.Pc._s=u===V.t.flex,n.iy(r,d,a,l,o,n.context,n.Pc.ps).then(c=>{n.Pc.gs=c;const f=l.position;let p=l.float,g=l.clear;const m=n.Pc.vertical?V.t.vertical_rl:V.t.horizontal_tb,b=n.Pc.parent?n.Pc.parent.vertical?V.t.vertical_rl:V.t.horizontal_tb:m,w=Qt.e(r);n.Pc.As=Qt.a(u,f,p,l.overflow,m,b,w),n.Pc.Is=Qt.b(f),!n.Pc.qs()||p===V.t.footnote||h&&G.h(h)||(p=null,g=null);let v=p===V.t.left||p===V.t.right||p===V.t.top||p===V.t.bottom||p===V.t.inline_start||p===V.t.inline_end||p===V.t.block_start||p===V.t.block_end||p===V.t.snap_block||p===V.t.footnote;p&&(delete l.float,p===V.t.footnote&&(n.ja?(v=!1,l.display=V.t.block):l.display=V.t.inline)),g&&(g===V.t.inherit&&n.Pc.parent&&n.Pc.parent.Ns&&(g=V.r(n.Pc.parent.Ns)),g!==V.t.left&&g!==V.t.right&&g!==V.t.top&&g!==V.t.bottom&&g!==V.t.both&&g!==V.t.all&&g!==V.t.same||(delete l.clear,l.display&&l.display!=V.t.inline&&(n.Pc.Ns=g.toString())));const y=u===V.t.list_item&&l["ua-list-item-count"];if((v||l["break-inside"]&&l["break-inside"]!==V.t.auto)&&n.Pc.Bs++,u&&u!==V.t.inline&&Qt.f(u)&&n.Pc.Bs++,n.Pc.inline=!v&&!u||Qt.f(u)||Qt.g(u),n.Pc.display=u?u.toString():"inline",n.Pc.Ts=v?p.toString():null,n.Pc.Us=h||G.a.INLINE,n.Pc.Cs=l["float-min-wrap-block"]||null,n.Pc.columnSpan=l["column-span"],!n.Pc.inline){const t=l["break-after"];t&&(n.Pc.breakAfter=t.toString());const e=l["break-before"];e&&(n.Pc.breakBefore=e.toString())}n.Pc.verticalAlign=l["vertical-align"]&&l["vertical-align"].toString()||"baseline",n.Pc.captionSide=l["caption-side"]&&l["caption-side"].toString()||"top";const T=l["border-collapse"];if(!T||T===V.r("separate")){const t=l["border-spacing"];let e,i;t&&(t.ct()?(e=t.values[0],i=t.values[1]):e=i=t,e.ot()&&(n.Pc.Ps=V.x(e,n.context)),i.ot()&&(n.Pc.Rs=V.x(i,n.context)))}n.Pc.$s=l["footnote-policy"];const N=l["x-first-pseudo"];if(N){const t=n.Pc.parent?n.Pc.parent.Vs:null;n.Pc.Vs=new X.e(t,N.num)}n.Pc.inline||n.gy(r,a,o,n.context);const S=l["white-space"];if(S){const t=X.z(S.toString());null!==t&&(n.Pc.whitespace=t)}const x=l["hyphenate-character"];x&&x!==V.t.auto&&(n.Pc.Gs=x.str);const I=l["word-break"],C=l["overflow-wrap"]||["word-wrap"];n.Pc.zs=I===V.t.break_all||C===V.t.break_word,n.uy(n.Pc,t,u,f,p,d),n.Pc.parent&&n.Pc.parent.us&&(t=n.Pc.parent.us.Zl(n.Pc,t)),n.Pc.inline||(n.Pc.Ls=n.my(l),n.by(r,o));let O=!1,_=null;const A=[];let k,D=r.namespaceURI,L=r.localName;if(D==E.a.XHTML)"html"==L||"body"==L||"script"==L||"link"==L||"meta"==L?L="div":"vide_"==L?L="video":"audi_"==L?L="audio":"object"==L&&(O=!!n.qx),r.getAttribute(hi.a)&&a.content&&a.content.value&&a.content.value.url&&(L="img");else if(D==E.a.epub)L="span",D=E.a.XHTML;else if(D==E.a.FB2){if(D=E.a.XHTML,"image"==L){L="div";const t=r.getAttributeNS(E.a.XLINK,"href");if(t&&"#"==t.charAt(0)){const e=n.xmldoc.ey(t);if(e){_=n.createElement(D,"img");const t=`data:${e.getAttribute("content-type")||"image/jpeg"};base64,${e.textContent.replace(/[ \t\n\t]/g,"")}`;A.push(Be.b(_,t))}}}else L=bi[L];L||(L=n.Pc.inline?"span":"div")}else if(D==E.a.NCX)if(D=E.a.XHTML,"ncx"==L||"navPoint"==L)L="div";else if("navLabel"==L){L="span";const t=r.parentNode;if(t){let e=null;for(let n=t.firstChild;n;n=n.nextSibling){if(1!=n.nodeType)continue;const t=n;if(t.namespaceURI==E.a.NCX&&"content"==t.localName){e=t.getAttribute("src");break}}e&&(L="a",(r=r.ownerDocument.createElementNS(D,"a")).setAttribute("href",e))}}else L="span";else D==E.a.SHADOW?(D=E.a.XHTML,L=n.Pc.inline?"span":"div"):O=!!n.qx;if(y)t?L="li":(L="div",u=V.t.block,l.display=u);else if("body"==L||"li"==L)L="div";else if("q"==L)L="span";else if("a"==L){const t=l["hyperlink-processing"];t&&"normal"!=t.toString()&&(L="span")}if(l.behavior&&"none"!=l.behavior.toString()&&n.qx&&(O=!0),r.dataset&&"true"===r.getAttribute("data-math-typeset")&&(O=!0),O){const t=n.Pc.parent?n.Pc.parent.Fs:null;k=n.qx(r,t,l)}else k=j.d(null);k.then(o=>{o?O&&(i="true"==o.getAttribute("data-adapt-process-children")):o=n.createElement(D,L),"a"==L&&o.addEventListener("click",n.page.Ji,!1),_&&(n.$u(n.Pc,"inner",_),o.appendChild(_)),"iframe"==o.localName&&o.namespaceURI==E.a.XHTML&&function(t){t.addEventListener("load",()=>{t.contentWindow.navigator.epubReadingSystem={name:"adapt",version:"0.1",layoutStyle:"paginated",hasFeature:function(t,e){switch(t){case"mouse-events":return!0}return!1}}},!1)}(o);const a=n.Pc.Hs["image-resolution"],h=[],c=l.width,u=l.height,d=r.getAttribute("width"),f=r.getAttribute("height"),p=c===V.t.auto||!c&&!d,g=u===V.t.auto||!u&&!f;if(r.namespaceURI!=E.a.FB2||"td"==L){const e=r.attributes,i=e.length;let s=null;for(let r=0;r<i;r++){const i=e[r],a=i.namespaceURI;let l=i.localName,c=i.nodeValue;if(a){if("http://www.w3.org/2000/xmlns/"==a)continue;a==E.a.XLINK&&"href"==l&&(c=n.hy(c))}else{if(l.match(/^on/))continue;if("style"==l)continue;if(("id"==l||"name"==l)&&t){c=n.Wf.Xf(c,n.xmldoc.url),o.setAttribute(l,c),n.page.rs(o,c);continue}if("src"==l||"href"==l||"poster"==l?(c=n.hy(c),"href"===l&&(c=n.Wf.sc(c,n.xmldoc.url))):"srcset"==l&&(c=c.split(",").map(t=>n.hy(t.trim())).join(",")),"poster"===l&&"video"===L&&D===E.a.XHTML&&p&&g){const t=new Image,e=Be.b(t,c);A.push(e),h.push({image:t,element:o,fetcher:e})}}if(D==E.a.SVG&&/^[A-Z\-]+$/.test(l)&&(l=l.toLowerCase()),n.wy(l)&&(c=ci(c,n.xmldoc.url,n.Wf)),a){const t=ui[a];t&&(l=`${t}:${l}`)}"src"!=l||a||"img"!=L&&"input"!=L||D!=E.a.XHTML?"href"==l&&"image"==L&&D==E.a.SVG&&a==E.a.XLINK?n.page.fetchers.push(Be.b(o,c)):a?o.setAttributeNS(a,l,c):o.setAttribute(l,c):s=c}if(s){const t="input"===L?new Image:o,e=Be.b(t,s);t!==o&&(o.src=s),p||g?(p&&g&&a&&1!==a&&h.push({image:t,element:o,fetcher:e}),A.push(e)):n.page.fetchers.push(e)}}delete l.content;const m=l["list-style-image"];if(m&&m instanceof V.l){const t=m.url;A.push(Be.b(new Image,t))}if(n.Ey(l),n.xy(o,l),!n.Pc.inline){let i=null;if(t?e&&(i=n.Pc.vertical?gi:pi):i="clone"!==n.Pc.Hs["box-decoration-break"]?n.Pc.vertical?fi:di:n.Pc.vertical?gi:pi,i)for(const t in i)E.F(o,t,i[t])}y&&o.setAttribute("value",l["ua-list-item-count"].stringValue()),n.Fs=o,A.length?Be.c(A).then(()=>{a>0&&n.yy(h,a,l,n.Pc.vertical),s.finish(i)}):s.Bt().then(()=>{s.finish(i)})})}),s.result()}gy(t,e,n,i){const s=this.Jx(e,this.jx,this.ja,this.Pc,i);if(s&&s["after-if-continues"]&&s["after-if-continues"].content){const s=new hi.b(t,e,n,i,this.Yr);this.Pc.Ds=new nt.a(t,s)}}wy(t){return mi.SVG_URL_ATTRIBUTES.includes(t.toLowerCase())}yy(t,e,n,i){const s=this;t.forEach(t=>{if("load"===t.fetcher.get().get()){const r=t.image;let o=r.width/e,a=r.height/e;const l=t.element;if(o>0&&a>0)if(n["box-sizing"]===V.t.border_box&&(n["border-left-style"]!==V.t.none&&(o+=V.x(n["border-left-width"],s.context)),n["border-right-style"]!==V.t.none&&(o+=V.x(n["border-right-width"],s.context)),n["border-top-style"]!==V.t.none&&(a+=V.x(n["border-top-width"],s.context)),n["border-bottom-style"]!==V.t.none&&(a+=V.x(n["border-bottom-width"],s.context))),e>1){const t=n["max-width"]||V.t.none,e=n["max-height"]||V.t.none;if(t===V.t.none&&e===V.t.none)E.F(l,"max-width",`${o}px`);else if(t!==V.t.none&&e===V.t.none)E.F(l,"width",`${o}px`);else if(t===V.t.none&&e!==V.t.none)E.F(l,"height",`${a}px`);else{b.a(t.ot()),b.a(e.ot());const n=t,r=e;"%"!==n.unit?E.F(l,"max-width",`${Math.min(o,V.x(n,s.context))}px`):"%"!==r.unit?E.F(l,"max-height",`${Math.min(a,V.x(r,s.context))}px`):i?E.F(l,"height",`${a}px`):E.F(l,"width",`${o}px`)}}else if(e<1){const t=n["min-width"]||V.u,e=n["min-height"]||V.u;b.a(t.ot()),b.a(t.ot());const r=t,h=e;0===r.num&&0===h.num?E.F(l,"min-width",`${o}px`):0!==r.num&&0===h.num?E.F(l,"width",`${o}px`):0===r.num&&0!==h.num?E.F(l,"height",`${a}px`):"%"!==r.unit?E.F(l,"min-width",`${Math.max(o,V.x(r,s.context))}px`):"%"!==h.unit?E.F(l,"min-height",`${Math.max(a,V.x(h,s.context))}px`):i?E.F(l,"height",`${a}px`):E.F(l,"width",`${o}px`)}}})}Ey(t){const e=this;l.b(l.a.PREPROCESS_ELEMENT_STYLE).forEach(n=>{n(e.Pc,t)})}by(t,e){for(let n=t.firstChild;n;n=n.nextSibling){if(1!==n.nodeType)continue;const t={},i=e.oc(n,!1);if(this.sy(this.Pc.vertical,"rtl"===this.Pc.direction,i,t),!this.my(t))continue;if(this.Pc.us instanceof rt&&!this.Pc.Qs(this.Pc.us))return;const s=this.Pc.parent,r=s&&s.us;return this.Pc.us=new rt(r,this.Pc.ys),void this.Pc.us.Bd(this.Pc.vertical)}}my(t){let e=t["repeat-on-break"];return e!==V.t.none&&(e===V.t.auto&&(e=t.display===V.t.table_header_group?V.t.header:t.display===V.t.table_footer_group?V.t.footer:V.t.none),e&&e!==V.t.none)?e.toString():null}ky(){const t=this,e=j.c("createTextNodeView");return this.Sy().then(()=>{const n=t.ws||0,i=ai.d(t.Pc.xs).substr(n);t.Fs=document.createTextNode(i),e.finish(!0)}),e.result()}Sy(){if(null!=this.Pc.xs)return j.d(!0);const t=this;let e,n=e=t.ys.textContent;const i=j.c("preprocessTextContent"),s=l.b(l.a.PREPROCESS_TEXT_CONTENT);let r=0;return i.loop(()=>r>=s.length?j.d(!1):s[r++](t.Pc,n).Ot(t=>(n=t,j.d(!0)))).then(()=>{t.Pc.xs=ai.a(e,n),i.finish(!0)}),i.result()}vy(t,e){const n=this,i=j.c("createNodeView");let s,r=!0;return 1==n.ys.nodeType?s=n.py(t,e):8==n.ys.nodeType?(n.Fs=null,s=j.d(!0)):s=n.ky(),s.then(t=>{if(r=t,n.Pc.Fs=n.Fs,n.Fs){const t=n.Pc.parent?n.Pc.parent.Fs:n.Zx;t&&t.appendChild(n.Fs)}i.finish(r)}),i.result()}fu(t,e,n){return this.Pc=t,t?(this.ys=t.ys,this.ws=t.ws):(this.ys=null,this.ws=-1),this.Fs=null,this.Pc?this.vy(e,!!n):j.d(!0)}Ty(t){if(null==t.ps||"content"!=t.ys.localName||t.ys.namespaceURI!=E.a.SHADOW)return t;const e=t.vs,n=t.ps,i=t.parent;let s,r,o;n.Ss?(o=n.Ss,s=n.root,(r=n.type)==X.o.ROOTLESS&&(s=s.firstChild)):(o=n.ks,s=n.owner.firstChild,r=X.o.ROOTLESS);const a=t.ys.nextSibling;if(a?(t.ys=a,t.js()):t.bs?t=t.bs:s?t=null:(t=t.parent.modify()).after=!0,s){const n=new X.k(s,i,e);return n.ps=o,n.ds=r,n.bs=t,n}return t.vs=e,t}Ny(t){let e=t.vs+1;if(t.after){if(!t.parent)return null;if(t.ds!=X.o.ROOTED){const n=t.ys.nextSibling;if(n)return(t=t.modify()).vs=e,t.ys=n,t.js(),this.Ty(t)}return t.bs?((t=t.bs.modify()).vs=e,t):((t=t.parent.modify()).vs=e,t.after=!0,t)}{if(t.gs){let n=t.gs.root;if(t.gs.type==X.o.ROOTLESS&&(n=n.firstChild),n){const i=new X.k(n,t,e);return i.ps=t.gs,i.ds=t.gs.type,this.Ty(i)}}const n=t.ys.firstChild;return n?this.Ty(new X.k(n,t,e)):(1!=t.ys.nodeType&&(e+=ai.d(t.xs).length-1-t.ws),(t=t.modify()).vs=e,t.after=!0,t)}}Cy(t,e,n){const i=z.s(e,"hyperlink-processing");if(!i)return!1;const s=i.evaluate(this.context,"hyperlink-processing");return!!s&&s.toString()==n}$c(t,e){let n=this.Ny(t);if(!n||n.after)return j.d(n);const i=j.c("nextInTree");return this.fu(n,!0,e).then(t=>{n.Fs&&t||((n=n.modify()).after=!0,n.Fs||(n.inline=!0)),this.dispatchEvent({type:"nextInTree",Pc:n}),i.finish(n)}),i.result()}Py(t){if(t instanceof V.b){const e=t.values;for(let t=0;t<e.length;t++)this.Py(e[t])}else if(t instanceof V.l){const e=t.url;this.page.fetchers.push(Be.b(new Image,e))}}xy(t,e){const n=e["background-image"];n&&this.Py(n);const i=e.position===V.t.relative;for(const n in e){if(Ei[n])continue;let s=e[n];(s=s.visit(new A.a(this.xmldoc.url,this.Wf))).ot()&&k.O(s.unit)&&(s=V.n(s,this.context)),X.s[n]||i&&X.t[n]?this.page.ji.push(new X.d(t,n,s)):E.F(t,n,s.toString())}}$u(t,e,n){if(t.after)return;const i=this.ys;let s=(t.ps?t.ps.styler:this.styler).oc(i,!1);const r=z.u(s,"_pseudos");if(!r)return;if(!(s=r[e]))return;const o={};t.vertical=this.sy(t.vertical,"rtl"===t.direction,s,o);const a=o.content;X.y(a)&&(a.visit(new X.c(n,this.context,a,this.Yr)),delete o.content),this.xy(n,o)}pu(t,e){const n=j.c("peelOff"),i=t.Vs;let s=t.ws;const r=t.after;if(e>0){const n=t.Fs.textContent;t.Fs.textContent=n.substr(0,e),s+=e}else if(!r&&t.Fs&&0==s){const e=t.Fs.parentNode;e&&e.removeChild(t.Fs)}const o=t.vs+e,a=[];for(;t.Vs===i;)a.push(t),t=t.parent;let l=a.pop(),h=l.bs;const c=this;return n.loop(()=>{for(;a.length>0;){l=a.pop(),t=new X.k(l.ys,t,o),0==a.length&&(t.ws=s,t.after=r),t.ds=l.ds,t.ps=l.ps,t.gs=l.gs,t.bs=l.bs?l.bs:h,h=null;const e=c.fu(t,!1);if(e.Dt())return e}return j.d(!1)}).then(()=>{n.finish(t)}),n.result()}createElement(t,e){return t==E.a.XHTML?this.document.createElement(e):this.document.createElementNS(t,e)}Od(t,e,n){const i={},s=z.u(this.Wx,"_pseudos");if(t=this.sy(t,e,this.Wx,i),s&&s.before){const i={},r=this.createElement(E.a.XHTML,"span");hi.f(r,"before"),n.appendChild(r),this.sy(t,e,s.before,i),delete i.content,this.xy(r,i)}return delete i.content,this.xy(n,i),t}Kl(t){t&&t.Zs(t=>{const e=t.Hs["box-decoration-break"];if(!e||"slice"===e){const e=t.Fs;b.a(e instanceof Element),t.vertical?(E.F(e,"padding-left","0"),E.F(e,"border-left","none"),E.F(e,"border-top-left-radius","0"),E.F(e,"border-bottom-left-radius","0")):(E.F(e,"padding-bottom","0"),E.F(e,"border-bottom","none"),E.F(e,"border-bottom-left-radius","0"),E.F(e,"border-bottom-right-radius","0"))}})}nl(t,e,n){const i=t.num,s=t.unit;if(k.J(s)){let i=e;for(;i&&1!==i.nodeType;)i=i.parentNode;b.a(i);const s=parseFloat(n.tc(i)["font-size"]);return b.a(this.context),z.j(t,s,this.context).num}{const e=this.context.at(s,!1);return e?i*e:t}}Ry(t,e){if(t.ps){if(!e.ps)return!1;const n=1===t.node.nodeType?t.node:t.node.parentElement,i=1===e.node.nodeType?e.node:e.node.parentElement;return t.ps.owner===e.ps.owner&&hi.d(n)===hi.d(i)}return t.node===e.node}_y(t,e){return t.ws===e.ws&&t.after==e.after&&t.steps.length===e.steps.length&&t.steps.every((t,n)=>{const i=e.steps[n];return this.Ry(t,i)})}Ef(t){return!!hi.d(t)}}mi.SVG_URL_ATTRIBUTES=["color-profile","clip-path","cursor","filter","marker","marker-start","marker-end","marker-mid","fill","stroke","mask"];const bi={a:"a",sub:"sub",sup:"sup",table:"table",tr:"tr",td:"td",th:"th",code:"code",body:"div",p:"p",v:"p",date:"p",emphasis:"em",strong:"strong",style:"span",strikethrough:"del"},Ei={"box-decoration-break":!0,"float-min-wrap-block":!0,"float-reference":!0,"flow-into":!0,"flow-linger":!0,"flow-options":!0,"flow-priority":!0,"footnote-policy":!0,page:!0};class wi{constructor(t){this.Ay=t.Ay,this.window=t.window}Iy(t,e){const n=e.left,i=e.top;return{left:t.left-n,top:t.top-i,right:t.right-n,bottom:t.bottom-i,width:t.width,height:t.height}}Nl(t){const e=t.getClientRects(),n=this.Ay.getBoundingClientRect();return Array.from(e).map(t=>this.Iy(t,n))}os(t){const e=t.getBoundingClientRect(),n=this.Ay.getBoundingClientRect();return this.Iy(e,n)}tc(t){return this.window.getComputedStyle(t,null)}}class vi{constructor(t,e,n,i,s){this.window=t,this.fontSize=e,this.document=t.document,this.root=n||this.document.body;let r=this.root.firstElementChild;r||((r=this.document.createElement("div")).setAttribute("data-vivliostyle-outer-zoom-box","true"),this.root.appendChild(r));let o=r.firstElementChild;o||((o=this.document.createElement("div")).setAttribute("data-vivliostyle-spread-container","true"),r.appendChild(o));let a=r.nextElementSibling;a||((a=this.document.createElement("div")).setAttribute("data-vivliostyle-layout-box","true"),this.root.appendChild(a)),this.Fy=r,this.Oy=o,this.Ay=a;const l=new wi(this).tc(this.root);this.width=i||parseFloat(l.width)||t.innerWidth,this.height=s||parseFloat(l.height)||t.innerHeight}Ly(){E.F(this.Fy,"width",""),E.F(this.Fy,"height",""),E.F(this.Oy,"width",""),E.F(this.Oy,"height",""),E.F(this.Oy,"transform","")}zoom(t,e,n){E.F(this.Fy,"width",`${t*n}px`),E.F(this.Fy,"height",`${e*n}px`),E.F(this.Oy,"width",`${t}px`),E.F(this.Oy,"height",`${e}px`),E.F(this.Oy,"transform",`scale(${n})`)}clear(){const t=this.root;for(;t.lastChild;)t.removeChild(t.lastChild)}}const yi="data-adapt-eloff";class Ti{constructor(t,e,n){this.store=t,this.url=e,this.document=n,this.lang=null,this.My=-1,this.lb=1,this.root=n.documentElement;let i=null,s=null;if(this.root.namespaceURI==E.a.XHTML){for(let t=this.root.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t;if(e.namespaceURI==E.a.XHTML)switch(e.localName){case"head":s=e;break;case"body":i=e}}this.lang=this.root.getAttribute("lang")}else if(this.root.namespaceURI==E.a.FB2){s=this.root;for(let t=this.root.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t;e.namespaceURI==E.a.FB2&&"body"==e.localName&&(i=e)}const t=this.doc().child("FictionBook").child("description").child("title-info").child("lang").textContent();t.length>0&&(this.lang=t[0])}else if(this.root.namespaceURI==E.a.SSE)for(let t=this.root.firstElementChild;t;t=t.nextElementSibling){const e=t.localName;"meta"===e?s=t:"body"===e&&(i=t)}this.body=i,this.head=s,this.last=this.root,this.last.setAttribute(yi,"0")}doc(){return new Oi([this.document])}Ig(t){const e=t.getAttribute(yi);if(e)return parseInt(e,10);let n=this.lb,i=this.last;for(;i!=t;){let t=i.firstChild;if(!t)for(;!(t=i.nextSibling);)if(null==(i=i.parentNode))throw new Error("Internal error");i=t,1==t.nodeType?(t.setAttribute(yi,n.toString()),++n):n+=t.textContent.length}return this.lb=n,this.last=t,n-1}Sb(t,e,n){let i=0,s=t,r=null;if(1==s.nodeType){if(!n)return this.Ig(s)}else{if(i=e,!(r=s.previousSibling))return s=s.parentNode,i+=1,this.Ig(s)+i;s=r}for(;;){for(;s.lastChild;)s=s.lastChild;if(1==s.nodeType)break;if(i+=s.textContent.length,!(r=s.previousSibling)){s=s.parentNode;break}s=r}return i+=1,this.Ig(s)+i}Dy(){return this.My<0&&(this.My=this.Sb(this.root,0,!0)),this.My}kb(t){let e;const n=this;let i=this.root;for(;;){if((e=this.Ig(i))>=t)return i;const s=i.children;if(!s)break;const r=E.i(s.length,e=>{const i=s[e];return n.Ig(i)>t});if(0==r)break;i=s[r-1]}let s=e+1,r=i,o=r.firstChild||r.nextSibling,a=null;for(;;){if(o){if(1==o.nodeType)break;if(a=r=o,(s+=o.textContent.length)>t)break}else if(!(r=r.parentNode))break;o=r.nextSibling}return a||i}$y(t){const e=t.getAttribute("id");e&&!this.By[e]&&(this.By[e]=t);const n=t.getAttributeNS(E.a.XML,"id");n&&!this.By[n]&&(this.By[n]=t);for(let e=t.firstElementChild;e;e=e.nextElementSibling)this.$y(e)}ey(t){const e=t.match(/([^#]*)#(.+)$/);if(!e||e[1]&&e[1]!=this.url)return null;const n=e[2];let i=this.document.getElementById(n);return!i&&this.document.getElementsByName&&(i=this.document.getElementsByName(n)[0]),i||(this.By||(this.By={},this.$y(this.document.documentElement)),i=this.By[n]),i}}var Ni;function Si(t,e,n){const i=n||new DOMParser;let s;try{s=i.parseFromString(t,e)}catch(t){}if(!s)return null;{const t=s.documentElement,e="parsererror";if(t.localName===e)return null;for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(n.localName===e)return null}return s}function xi(t,e){let n=t.responseXML;if(!n){const e=new DOMParser,i=t.responseText;if(i){const s=function(t){const e=t.contentType;if(e){const t=Object.keys(Ni);for(let n=0;n<t.length;n++)if(Ni[t[n]]===e)return e;if(e.match(/\+xml$/))return Ni.APPLICATION_XML}const n=t.url.match(/\.([^.\/]+)$/);if(n)switch(n[1]){case"html":case"htm":return Ni.TEXT_HTML;case"xhtml":case"xht":return Ni.APPLICATION_XHTML_XML;case"svg":case"svgz":return Ni.IMAGE_SVG_XML;case"opf":case"xml":return Ni.APPLICATION_XML}return null}(t);if((n=Si(i,s||Ni.APPLICATION_XML,e))&&!s){const t=n.documentElement;"html"!==t.localName.toLowerCase()||t.namespaceURI?"svg"===t.localName.toLowerCase()&&n.contentType!==Ni.IMAGE_SVG_XML&&(n=Si(i,Ni.IMAGE_SVG_XML,e)):n=Si(i,Ni.TEXT_HTML,e)}n||(n=Si(i,Ni.TEXT_HTML,e))}}const i=n?new Ti(e,t.url,n):null;return j.d(i)}!function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML_XML="application/xhtml_xml",t.IMAGE_SVG_XML="image/svg+xml"}(Ni||(Ni={}));class Ii{constructor(t){this.fn=t}check(t){return this.fn(t)}Uy(t,e){const n=this;return new Ii(i=>n.check(i)&&1==i.nodeType&&i.getAttribute(t)==e)}Gy(t,e){const n=this;return new Ii(i=>{if(!n.check(i))return!1;let s=new Oi([i]);return s=s.child(t),e&&(s=s.predicate(e)),s.size()>0})}}const Ci=new Ii(t=>!0);class Oi{constructor(t){this.nodes=t}zy(){return this.nodes}size(){return this.nodes.length}predicate(t){const e=[];for(const n of this.nodes)t.check(n)&&e.push(n);return new Oi(e)}Hy(t){const e=[],n=t=>{e.push(t)};for(let e=0;e<this.nodes.length;e++)t(this.nodes[e],n);return new Oi(e)}forEach(t){const e=[];for(let n=0;n<this.nodes.length;n++)e.push(t(this.nodes[n]));return e}Vy(t){const e=[];for(let n=0;n<this.nodes.length;n++){const i=t(this.nodes[n]);null!=i&&e.push(i)}return e}child(t){return this.Hy((e,n)=>{for(let i=e.firstChild;i;i=i.nextSibling)1==i.nodeType&&i.localName==t&&n(i)})}jy(){return this.Hy((t,e)=>{for(let n=t.firstChild;n;n=n.nextSibling)1==n.nodeType&&e(n)})}attribute(t){return this.Vy(e=>1==e.nodeType?e.getAttribute(t):null)}textContent(){return this.forEach(t=>t.textContent)}}var _i='@namespace html "http://www.w3.org/1999/xhtml";\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nhtml|body, fb2|body {\n  hyphens: -epubx-expr(pref-hyphenate?"auto":"manual");\n}\n\n@-adapt-footnote-area {\n  display: block;\n  margin-block-start: 0.5em;\n  margin-block-end: 0.5em;\n}\n\n@-adapt-footnote-area ::before {\n  display: block;\n  border-block-start-width: 1px;\n  border-block-start-style: solid;\n  border-block-start-color: black;\n  margin-block-end: 0.4em;\n  margin-inline-start: 0;\n  margin-inline-end: 60%;\n}\n\n/* default page master */\n@-epubx-page-master :background-host {\n  @-epubx-partition :layout-host {\n    -epubx-flow-from: body;\n    top: -epubx-expr(header.margin-bottom-edge);\n    bottom: -epubx-expr(page-height - footer.margin-top-edge);\n    left: 0px;\n    right: 0px;\n    column-width: 25em;\n  }\n  @-epubx-partition footer :oeb-page-foot {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-foot;\n    bottom: 0px;\n    left: 0px;\n    right: 0px;\n  }\n  @-epubx-partition header :oeb-page-head {\n    writing-mode: horizontal-tb;\n    -epubx-flow-from: oeb-page-head;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n  }\n}\n\n@page {\n  @top-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @top-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @top-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @top-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @left-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @left-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @left-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @right-top {\n    text-align: center;\n    vertical-align: top;\n  }\n  @right-middle {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @right-bottom {\n    text-align: center;\n    vertical-align: bottom;\n  }\n  @bottom-left-corner {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-left {\n    text-align: left;\n    vertical-align: middle;\n  }\n  @bottom-center {\n    text-align: center;\n    vertical-align: middle;\n  }\n  @bottom-right {\n    text-align: right;\n    vertical-align: middle;\n  }\n  @bottom-right-corner {\n    text-align: left;\n    vertical-align: middle;\n  }\n}\n\n@media print {\n  @page {\n    margin: 10%;\n  }\n}\n';const Ai=new Be.a(()=>{const t=j.c("uaStylesheetBase"),e=ze(),n=E.C("user-agent-base.css",E.D),i=new z.b(null,null,null,null,null,e,!0);return i.xi(B.g.USER_AGENT),z.G(i.cascade),B.k('@namespace html "http://www.w3.org/1999/xhtml";\n\nhtml|html, html|address, html|blockquote, html|body, html|dd, html|div,\nhtml|dl, html|dt, html|fieldset, html|form, html|frame, html|frameset,\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|noframes,\nhtml|ol, html|p, html|ul, html|center, html|dir, html|hr, html|menu, html|pre,\nhtml|article, html|section, html|nav, html|aside, html|hgroup, html|footer, html|header,\nhtml|figure, html|figcaption, html|main {\n   display: block;\n   unicode-bidi: normal;\n}\nhtml|li {\n  display: list-item;\n}\nhtml|head {\n  display: none !important;\n}\nhtml|table {\n  display: table;\n}\nhtml|tr {\n  display: table-row;\n}\nhtml|thead {\n  display: table-header-group;\n  break-after: avoid;\n}\nhtml|tbody {\n  display: table-row-group;\n}\nhtml|tfoot {\n  display: table-footer-group;\n  break-before: avoid;\n}\nhtml|col {\n  display: table-column;\n}\nhtml|colgroup {\n  display: table-column-group;\n}\nhtml|td, html|th {\n  display: table-cell;\n}\nhtml|caption {\n  display: table-caption;\n  text-align: center;\n}\nhtml|th {\n  font-weight: bolder;\n  text-align: center;\n}\nhtml|script {\n  display: none;\n}\nhtml|body {\n  margin: 8px;\n}\nhtml|h1 {\n  font-size: 2em;\n  margin-block-start: 0.67em;\n  margin-block-end: 0.67em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h2 {\n  font-size: 1.5em;\n  margin-block-start: 0.75em;\n  margin-block-end: 0.75em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h3 {\n  font-size: 1.17em;\n  margin-block-start: 0.83em;\n  margin-block-end: 0.83em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h4, html|p, html|blockquote, html|ul, html|fieldset,\nhtml|form, html|ol, html|dl, html|dir, html|menu, html|h5, html|h6 {\n  margin-block-start: 1em;\n  margin-block-end: 1em;\n  margin-inline-start: 0em;\n  margin-inline-end: 0em;\n}\nhtml|h5 {\n  font-size: .83em;\n}\nhtml|h6 {\n  font-size: .75em;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6, html|b, html|strong {\n  font-weight: bolder;\n}\nhtml|h1, html|h2, html|h3, html|h4, html|h5, html|h6 {\n  break-after: avoid;\n}\nhtml|blockquote {\n  margin-block-start: 0px;\n  margin-block-end: 0px;\n  margin-inline-start: 40px;\n  margin-inline-end: 40px;\n}\nhtml|i, html|cite, html|em, html|var, html|address {\n  font-style: italic;\n}\nhtml|pre, html|tt, html|code, html|kbd, html|samp {\n  font-family: monospace;\n}\nhtml|pre {\n  white-space: pre;\n}\nhtml|button, html|textarea, html|input, html|select {\n  display: inline-block;\n}\nhtml|big {\n  font-size: 1.17em;\n}\nhtml|small, html|sub, html|sup {\n  font-size: .83em;\n}\nhtml|sub {\n  vertical-align: sub;\n}\nhtml|sup {\n  vertical-align: super;\n}\nhtml|table {\n  border-spacing: 2px;\n}\nhtml|thead, html|tbody, html|tfoot {\n  vertical-align: middle;\n}\n/* for XHTML tables without tbody */\nhtml|table > html|tr {\n  vertical-align: middle;\n}\nhtml|td, html|th {\n  vertical-align: inherit;\n}\nhtml|s, html|strike, html|del {\n  text-decoration: line-through;\n}\nhtml|hr {\n  border: 1px inset;\n}\nhtml|ol, html|ul, html|dir, html|menu, html|dd {\n  margin: 0px;\n  margin-inline-start: 40px;\n}\nhtml|ol {\n  list-style-type: decimal;\n}\nhtml|ol html|ul, html|ul html|ol, html|ul html|ul, html|ol html|ol {\n  margin-top: 0;\n  margin-bottom: 0;\n}\nhtml|u, html|ins {\n  text-decoration: underline;\n}\nhtml|center {\n  text-align: center;\n}\nhtml|q:before {\n  content: open-quote;\n}\nhtml|q:after {\n  content: close-quote;\n}\n\nhtml|audio, html|video {\n  break-inside: avoid;\n}\n\nhtml|ruby {\n  display: ruby;\n}\nhtml|rp {\n  display: none;\n}\nhtml|rbc {\n  display: ruby-base-container;\n}\nhtml|rtc {\n  display: ruby-text-container;\n}\nhtml|rb {\n  display: ruby-base;\n  white-space: nowrap;\n}\nhtml|rt {\n  display: ruby-text;\n}\nhtml|ruby, html|rb, html|rt, html|rbc, html|rtc {\n  unicode-bidi: isolate;\n}\n\nhtml|rtc, html|rt {\n  font-variant-east-asian: ruby;\n  text-emphasis: none;\n  white-space: nowrap;\n  line-height: 1;\n}\n\nhtml|rtc:lang(zh), html|rt:lang(zh) {\n  ruby-align: center;\n}\n\nhtml|rtc, html|rt {\n  font-size: 50%;\n}\n\nhtml|rtc:lang(zh-TW), html|rt:lang(zh-TW) {\n  font-size: 30%;\n}\n\nhtml|rtc > html|rt, html|rtc > html|rt:lang(zh-TW) {\n  font-size: 100%;\n}\n\n/* Bidi settings */\nhtml|bdo[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: bidi-override;\n}\nhtml|bdo[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: bidi-override;\n}\nhtml|*[dir="ltr"] {\n  direction: ltr;\n  unicode-bidi: embed;\n}\nhtml|*[dir="rtl"] {\n  direction: rtl;\n  unicode-bidi: embed;\n}\n\n/*------------------ epub-specific ---------------------*/\n\n@namespace epub "http://www.idpf.org/2007/ops";\n\nhtml|a[epub|type="noteref"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n}\n\nhtml|a[epub|type="noteref"]:href-epub-type(footnote) {\n  -adapt-template: url(user-agent.xml#footnote);\n  text-decoration: none;\n}\n\nhtml|aside[epub|type="footnote"] {\n  display: none;\n}\n\nhtml|aside[epub|type="footnote"]:footnote-content {\n  display: block;\n  margin: 0.25em;\n  font-size: 1.2em;\n  line-height: 1.2;\n}\n\nepub|trigger {\n  display: none;\n}\n\nepub|switch {\n  display: inline;\n}\n\nepub|default {\n  display: inline;\n}\n\nepub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] {\n  display: inline;\n}\n\nepub|case[required-namespace::supported] ~ epub|case {\n  display: none;\n}\n\nepub|case[required-namespace::supported] ~ epub|default {\n  display: none;\n}\n\n/*--------------- ncx and toc ----------------------*/\n\n@namespace ncx "http://www.daisy.org/z3986/2005/ncx/";\n\nncx|ncx {\n  display: block;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n\nncx|content {\n  display: none;\n}\n\nbody > * {\n  -adapt-behavior: body-child;\n}\n\n[role=doc-toc], [role=directory], nav, .toc, #toc,\n#table-of-contents, #contents {\n  -adapt-behavior: toc-root;\n}\n\n[role=doc-toc] a,\n[role=directory] a,\nnav a,\n.toc a,\n#toc a,\nncx|navLabel {\n  -adapt-behavior: toc-node-anchor;\n}\n\n[role=doc-toc] li,\n[role=directory] li,\nnav li,\n.toc li,\n#toc li,\nncx|navPoint {\n  -adapt-behavior: toc-node;\n}\n\n[role=doc-toc] li > *:first-child,\n[role=directory] li > *:first-child,\nnav li > *:first-child,\n.toc li > *:first-child,\n#toc li > *:first-child {\n  -adapt-behavior: toc-node-first-child;\n}\n\n[role=doc-toc] ol,\n[role=directory] ol,\nnav ol,\n.toc ol,\n#toc ol,\n[role=doc-toc] ul,\n[role=directory] ul,\nnav ul,\n.toc ul,\n#toc ul,\nol[role=doc-toc],\nol[role=directory],\nol.toc,\nol#toc,\nul[role=doc-toc],\nul[role=directory],\nul.toc,\nul#toc {\n  -adapt-behavior: toc-container;\n}\n\n/*---------------- fb2 ---------------------*/\n\n@namespace fb2 "http://www.gribuser.ru/xml/fictionbook/2.0";\n\nfb2|FictionBook {\n  display: block;\n}\n\nfb2|body {\n  font-family: serif;\n  margin: 8px;\n  column-width: 25em;\n}\n\nfb2|a {\n  line-height: 0.1;\n  vertical-align: super;\n  font-size: 0.7em;\n}\n\nfb2|sub {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|sup {\n  line-height: 0.1;\n  font-size: 0.7em;\n}\n\nfb2|table {\n  display: table;\n  font-size: 0.8em;\n  font-family: sans-serif;\n  margin: 0.5em;\n  border-collapse: collapse;\n  border: 1px solid black;\n}\n\nfb2|td {\n  border: 1px solid black;\n  padding: 0.3em;\n}\n\nfb2|th {\n  font-weight: bold;\n  text-align: center;\n  border: 1px solid black;\n  background-color: #CEE;\n  padding: 0.3em;\n}\n\nfb2|code {\n  font-family: monospace;\n}\n\nfb2|p {\n  display: block;\n  margin: 0px;\n  text-indent: 1.5em;\n  text-align: justify;\n}\n\nfb2|title fb2|p {\n  margin: 0px 0px 0.5em 0px;\n  text-indent: 0px;\n  text-align: inherit;\n}\n\nfb2|title {\n  font-size: 2.2em;\n  font-weight: bold;\n  break-inside: avoid;\n  break-after: avoid;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n  display: block;\n}\n\nfb2|section {\n  display: block;\n}\n\nfb2|section fb2|title {\n  font-size: 1.8em;\n  text-align: center;\n  margin: 1em 0px 0.5em 0px;\n}\n\nfb2|section fb2|section fb2|title {\n  font-size: 1.5em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.5625em;\n}\n\nfb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.3em;\n  text-align: left;\n  margin: 1em 0px 0.5em 1.923em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.2em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.083em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  font-size: 1.1em;\n  text-align: left;\n  margin: 1em 0px 0.5em 2.272em;\n}\n\nfb2|section fb2|section fb2|section fb2|section fb2|section fb2|section fb2|title {\n  text-align: left;\n  margin: 1em 0px 0.5em 2.5em;\n}\n\nfb2|epigraph {\n  text-align: left;\n  font-style: italic;\n  margin: 1em 1em 2em 30%;\n  display: block;\n}\n\nfb2|image {\n  text-align: center;\n  padding: 3px;\n}\n\nfb2|image::inner {\n  max-width: 95%;\n}\n\nfb2|image::after {\n  display: block;\n  content: attr(title);\n}\n\nfb2|v {\n  text-indent: -1em;\n  padding-left: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|poem {\n  margin: 0.5em 0px 0.5em 2em;\n  display: block;\n}\nfb2|date {\n  margin: 0.5em 0px 0.5em 50%;\n  font-style: italic;\n  display: block;\n}\nfb2|stanza {\n  margin: 0.5em 0px;\n  break-inside: avoid;\n  display: block;\n}\nfb2|empty-line {\n  height: 1em;\n  margin: 0px;\n  display: block;\n}\nfb2|cite {\n  margin: 0.5em 0px 0.5em 1em;\n  font-size: 0.95em;\n  display: block;\n}\nfb2|subtitle {\n  text-indent: 0px;\n  text-align: center;\n  font-style: italic;\n  font-weight: bold;\n  margin: 0.5em 2em;\n  break-inside: avoid;\n  break-after: avoid;\n  display: block;\n}\nfb2|annotation {\n  margin: 1em 0px 1em 2em;\n  text-indent: 0px;\n  font-style: italic;\n  display: block;\n}\nfb2|text-author {\n  text-indent: 0px;\n  margin: 0.2em 0px 0px 3em;\n  display: block;\n}\nfb2|emphasis {\n  font-style: italic;\n}\nfb2|strong {\n  font-weight: bold;\n}\nfb2|strikethrough {\n  text-decoration: line-through;\n}\nfb2|*.italic {\n  font-style: italic;\n}\nfb2|*.bold {\n  font-weight: bold;\n}\n\nfb2|binary, fb2|description, fb2|stylesheet {\n  display: none;\n}\n\nfb2|a[type="note"] {\n  font-size: 0.75em;\n  vertical-align: super;\n  line-height: 0.01;\n  text-decoration: none;\n  -adapt-template: url(user-agent.xml#footnote);\n}\n\nfb2|body[name="notes"] {\n  display: none;\n}\n\nfb2|body[name="notes"] fb2|title {\n  display: inline;\n  vertical-align: super;\n  line-height: 0.01;\n  text-align: left;\n  font-size: 0.75em;\n  font-weight: bold;\n  margin: 0px;\n}\n\nfb2|body[name="notes"] fb2|p {\n  text-indent: 0px;\n  display: inline;  /* for now */\n}\n\nfb2|body[name="notes"] fb2|p + fb2|p {\n  display: block;\n}\n\nfb2|body[name="notes"] fb2|section {\n  text-indent: 0px;\n  line-height: 1.2;\n  font-size: 1.2em;\n}\n',i,n,null,null).Mt(t),t.result()},"uaStylesheetBaseFetcher");class ki{constructor(t,e,n,i,s,r,o,a,l,h){this.store=t,this.te=e,this.Kf=n,this.cascade=i,this.Xy=s,this.Wy=r,this.Yy=o,this.qy=a,this.Ky=l,this.Bx=h,this.Zy=t.Zy,this.Jn=t.Jn,this.Kf.Jt("has-content",function(t){t=t;const e=this.Qy,n=e.ar(t);return this.Jy(e.cr(t))&&e.sr(t,this.tk)&&!!n&&!this.ek(n)}),this.Kf.Zt("page-number",new k.t(this.Kf,function(){return this.nk+this.Qy.page},"page-number"))}ik(t,e,n,i){if(this.Ky.length){const s=new k.g(this.te,t,e,n),r=z.A(s,this.Ky),o=r.width,a=r.height,l=r["text-zoom"];let h=1;if(o&&a||l){const r=k.G.em;if((l?l.evaluate(s,"text-zoom"):null)===V.t.scale&&(h=r/n,n=r,t*=h,e*=h),o&&a){const t=V.x(o.evaluate(s,"width"),s),e=V.x(a.evaluate(s,"height"),s);if(t>0&&e>0)return{width:i&&i.Ht?2*(t+i.pageBorder):t,height:e,fontSize:n}}}}return{width:t,height:e,fontSize:n}}}class Di extends k.g{constructor(t,e,n,i,s,r,o,a,l,h,c,u){super(t.te,i.width,i.height,i.fontSize),this.style=t,this.xmldoc=e,this.viewport=i,this.rl=s,this.sk=r,this.qx=o,this.Kx=a,this.nk=l,this.Wf=h,this.jf=c,this.Ym={body:!0},this.Cx=null,this.styler=null,this.rk=null,this.Qy=null,this.hk=null,this.tk=0,this.lk={},this.ck=null,this.ak={},this.Ax=null,this.uk={},this.fk=0,this.dk=0,this.lang=e.lang||n,this.faces=new Xe(this.style.Zy),this.pk=new G.e(null,null,null,null,null,null,null),this.Ax=u||null;for(const e in t.qy){const n=t.qy[e],i=z.s(n,"flow-consume");i&&(i.evaluate(this,"flow-consume")==V.t.all?this.Ym[e]=!0:delete this.Ym[e])}}init(){const t=this,e=j.c("StyleInstance.init"),n=t.jf.xd(t.xmldoc.url),i=t.jf.yd(t.xmldoc.url,t.style.te,t.style.Kf);t.styler=new ie(t.xmldoc,t.style.cascade,t.style.te,t,this.Ym,t.style.Jn,n,i),i.Zf(t.styler),t.styler.Tb(t),t.rk={},t.rk[t.xmldoc.url]=t.styler;const s=t.styler.wb();t.Ax||(t.Ax=Sn(s));const r=this.style.Xy;this.Cx=new gn(r);const o=this.style.cascade.Tn(t,n,i,this.lang);this.Cx.IE(o,s),this.Cx.FE(t),this.ck=new qn(o,this.style.Kf,this.Cx,t,s);const a=[];for(const e of t.style.Wy){if(e.condition&&!e.condition.evaluate(t))continue;const n=Ge(e.properties,t),i=new je(n);a.push(i)}t.sk.Lw(a,t.faces).Mt(e);const l=t.style.Bx;return Object.keys(l).forEach(t=>{const e=kn(An(l[t]),this);this.uk[t]={width:e.Yt+2*e.DE,height:e.qt+2*e.DE}}),e.result()}ny(t){let e=this.rk[t.url];if(!e){const n=this.style.store.gk(t),i=new k.g(n.te,this.Yt(),this.qt(),this.ce),s=this.jf.xd(t.url),r=this.jf.yd(t.url,n.te,n.Kf);e=new ie(t,n.cascade,n.te,i,this.Ym,n.Jn,s,r),this.rk[t.url]=e}return e}uE(t,e){this.lk[t]=e}Gw(t){return this.lk[t]}Nb(t,e){const n=this.Qy;if(n){n.flows[t.ls]?e=n.flows[t.ls]:n.flows[t.ls]=e;let i=n.rr[t.ls];i||(i=new X.i,n.rr[t.ls]=i);const s=X.w(t.element),r=new X.a(s),o=new X.h(r,t);i.positions.push(o)}}mk(t){let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.positions.length;n++){const i=t.positions[n].er.primary;let s=i.steps[0].node,r=i.ws,o=i.after,a=0;for(;s.ownerDocument!=this.xmldoc.document;)a++,s=i.steps[a].node,o=!1,r=0;const l=this.xmldoc.Sb(s,r,o);l<e&&(e=l)}return e}bk(t,e){if(!t)return 0;let n=Number.POSITIVE_INFINITY;for(const i in this.Ym){let s=t.rr[i];if(e||s&&0!=s.positions.length||!this.Qy||(this.styler.Cb(i),s=this.Qy.rr[i],t!=this.Qy&&s&&(s=s.clone(),t.rr[i]=s)),s){const t=this.mk(s);t<n&&(n=t)}}return n}wk(t){h.b.debug("Location - page",this.Qy.page),h.b.debug("  current:",t),h.b.debug("  lookup:",this.tk);for(const t in this.Qy.rr){const e=this.Qy.rr[t];for(const n of e.positions)h.b.debug("  Chunk",`${t}:`,n.nr.startOffset)}}Jy(t){switch(t){case"left":case"right":case"recto":case"verso":return new k.s(this.style.Kf,`${t}-page`).evaluate(this);default:return!0}}Ek(t){for(const e in t.rr){const n=t.rr[e];if(n&&n.positions.length>0){const t=n.positions[0].nr;if(this.mk(n)===t.startOffset){const t=n.positions[0].nr.breakBefore,e=Bt.e(n.ir);n.ir=Bt.a(Bt.d(e,t))}}}}xk(t){const e=this,n=this.Qy,i=this.bk(n);if(i==Number.POSITIVE_INFINITY)return null;const s=this.Cx.children;let r;for(let o=0;o<s.length;o++){if((r=s[o]).Xw.Mw===Bn)continue;let a=1;const l=r.dE(e,"utilization");l&&l.ht()&&(a=l.num);const h=e.at("em",!1),c=e.Yt()*e.qt(),u=Math.ceil(a*c/(h*h));this.tk=this.styler.Eb(i,u),b.a(n),this.Ek(n),this.hk=n.clone(),this.yk(),e.ue(this.style.Kf);const d=r.dE(e,"enabled");if(!d||d===V.t._true)return this.ck.Fx(r,t)}throw new Error("No enabled page masters")}ek(t){const e=this.hk.flows,n=e[t.ls].cs;if(n){const i=t.startOffset,s=e[n].as;if(!s.length||i<s[0])return!1;const r=E.i(s.length,t=>s[t]>i)-1,o=s[r],a=this.hk.rr[n],l=this.mk(a);return!(o<l)&&(l<o||!this.Jy(a.ir))}return!1}kk(t,e){const n=this.Qy.flows[e];n.us||(n.us=new J.a(null)),t.ea=n.us}Sk(t){const e=t.Ha,n=e.Ih(),i=j.c("layoutDeferredPageFloats");let s=!1,r=0;return i.Ut(i=>{if(r===n.length)return void i.zt();const o=n[r++],a=o.float,l=(new G.f).kh(a),h=l.Ch(a,e);if(!h||!h.Jo(a))return e.Sh(a)||e.Oh(a)?(e.Fh(o),void i.zt()):void t.Lu(o,l,null,h).then(t=>{if(!t)return void i.zt();const n=e.parent.Vh();n?i.zt():(e.Vh()&&!n&&(s=!0,e.validate()),i.Gt())});i.Gt()}).then(()=>{s&&e.invalidate(),i.finish(!0)}),i.result()}vk(t,e){if(t.Ha.Mh().length>0){if(t.aa){let n;return e?(n=e.clone()).primary=t.aa:n=new X.a(t.aa),n}return b.a("column.lastAfterPosition === null"),null}return null}Tk(t,e){const n=this.Qy.rr[e];if(!n||!this.Jy(n.ir))return j.d(!0);n.ir="any",this.kk(t,e),t.init(),this.Ym[e]&&t.bands.length>0&&(t.Za=!1);const i=this,s=j.c("layoutColumn");return this.Sk(t).then(()=>{if(t.Ha.Vh())return void s.finish(!0);const r=[],o=[];let a=!0;s.Ut(s=>{if(t.Ha.Rh(e))s.zt();else{for(;n.positions.length-o.length>0;){let e=0;for(;o.includes(e);)e++;let l=n.positions[e];if(l.nr.startOffset>i.tk||i.ek(l.nr))break;for(let t=e+1;t<n.positions.length;t++){if(o.includes(t))continue;const s=n.positions[t];if(s.nr.startOffset>i.tk||i.ek(s.nr))break;s.nr.fs(l.nr)&&(l=s,e=t)}const h=l.nr;let c=!0;if(t.layout(l.er,a,n.breakAfter).then(u=>{if(t.Ha.Vh())s.zt();else{if(a=!1,l.nr.repeated&&(null===u||h.exclusive)&&r.push(e),h.exclusive)return o.push(e),void s.zt();{const a=!!u||!!t.Yc,h=i.vk(t,u);if(t.Yc&&h?(l.er=h,n.breakAfter=t.Yc,t.Yc=null):(o.push(e),(u||h)&&(l.er=u||h,r.push(e)),t.Yc&&(n.ir=Bt.a(t.Yc))),a)return void s.zt()}t.Za=!1,c?c=!1:s.Gt()}}),c)return void(c=!1)}s.zt()}}).then(()=>{if(!t.Ha.Vh()){n.positions=n.positions.filter((t,e)=>r.includes(e)||!o.includes(e)),"column"===n.breakAfter&&(n.breakAfter=null),t.xf();const e=t.Ha.al();t.Pu(e)}s.finish(!0)})}),s.result()}Fd(t){const e=this.Qy.page-1,n=this.jf.Fd(e);return new Ke.a([n].concat(t.pl()))}Nk(t,e,n,i,s,r,o,a,l,h,c,u,d,f){const p=this,g=t.vertical?t.qw&&t.Qw:t.Kw&&t.Zw,m=s.element,b=new G.e(a,G.a.COLUMN,null,o,null,null,null),w=p.Qy.clone(),v=j.c("createAndLayoutColumn");let y;return v.Ut(t=>{const v=p.Fd(b);if(l>1){const t=p.viewport.document.createElement("div");if(E.F(t,"position","absolute"),m.appendChild(t),(y=new Ke.b(t,d,p.rl,v,b)).Za=f,y.vertical=s.vertical,y.br=s.br,y.mr=s.mr,s.vertical){const t=r*(c+h)+s.paddingTop;y.$r(s.paddingLeft,s.width),y.Dr(t,c)}else{const t=r*(c+h)+s.paddingLeft;y.Dr(s.paddingTop,s.height),y.$r(t,c)}y.ur=e,y.dr=n}else(y=new Ke.b(m,d,p.rl,v,b)).Mr(s);y.exclusions=g?[]:i.concat(),y.pr=u,b.Eh(y),y.width>=0?p.Tk(y,o).then(()=>{b.Vh()||b.finish(),y.Ha.Vh()&&!a.Vh()?(y.Ha.validate(),p.Qy=w.clone(),y.element!==m&&m.removeChild(y.element),t.Gt()):t.zt()}):(b.finish(),t.zt())}).then(()=>{v.finish(y)}),v.result()}Ck(t,e,n){(e instanceof Wn||e instanceof mn&&!(e instanceof jn))&&t.Eh(n)}Pk(t,e,n,i){b.a(e instanceof En);const s=e.dE(this,"writing-mode")||null,r=e.dE(this,"direction")||null;return new G.e(t,G.a.REGION,n,i,null,s,r)}Rk(t,e,n,i,s,r,o,a,l){const h=this,c=h.Qy.clone(),u=h.Pk(r,e,o,a);let d=!0;function f(){return h.Qy=c.clone(),h._k(t,e,n,i,s,r,u,o,a,l,d).Ot(t=>t?j.d({columns:t,position:h.Qy}):j.d(null))}return f().Ot(t=>{if(!t)return j.d(null);if(l<=1)return j.d(t.columns);const n=e.dE(h,"column-fill")||V.t.balance,i=h.Qy.rr[a];b.a(i);const s=function(t,e,n,i,s,r,o){if(e===V.t.auto)return null;{const a=0===o.positions.length,l=r[r.length-1],h=!(!l||!l.Yc);return a||h?new Wt(n,i,s,t):e===V.t.balance_all?new qt(n,i,s):(b.a(e===V.t.balance),null)}}(l,n,f,u,o,t.columns,i);return s?(d=!1,r.lock(),u.lock(),s.sm(t).Ot(t=>(r.unlock(),r.validate(),u.unlock(),h.Qy=t.position,j.d(t.columns)))):j.d(t.columns)})}_k(t,e,n,i,s,r,o,a,l,h,c){const u=this,d=j.c("layoutFlowColumns"),f=u.Qy.clone(),p=e.pE(u,"column-gap"),g=h>1?e.pE(u,"column-width"):a.width,m=e.fE(u),b=e.dE(u,"shape-inside"),E=A.e(b,0,0,a.width,a.height,u),w=new mi(l,u,u.viewport,u.styler,m,u.xmldoc,u.faces,u.style.Yy,u,t,u.qx,u.Kx,this.Wf);let v=0,y=null,T=[];return d.Ut(t=>{u.Nk(e,n,i,s,a,v++,l,o,h,p,g,E,w,c).then(e=>r.Vh()?(T=null,void t.zt()):(!(e.Yc&&"column"!==e.Yc)&&v!==h||o.Vh()||o.finish(),o.Vh()?(v=0,u.Qy=f.clone(),o.validate(),void(o.wl()?(T=null,t.zt()):t.Gt())):(y=e,T[v-1]=y,y.Yc&&"column"!=y.Yc&&(v=h,"region"!=y.Yc&&(u.ak[l]=!0)),void(v<h?t.Gt():t.zt()))))}).then(()=>{d.finish(T)}),d.result()}Jg(t,e,n,i,s,r,o){const a=this;e.reset();const l=e.dE(a,"enabled");if(l&&l!==V.t._true)return j.d(!0);const h=j.c("layoutContainer"),c=e.dE(a,"wrap-flow")===V.t.auto,u=e.dE(a,"flow-from"),d=a.viewport.document.createElement("div"),f=e.dE(a,"position");E.F(d,"position",f?f.name:"absolute"),n.insertBefore(d,n.firstChild);let p,g=new X.b(d);g.vertical=e.vertical,g.exclusions=r,e.PE(a,g,t,a.faces,a.rl),g.ur=i,g.dr=s,i+=g.left+g.marginLeft+g.borderLeft,s+=g.top+g.marginTop+g.borderTop,this.Ck(o,e,g);let m=!1;if(u&&u.lt())if(a.ak[u.toString()])o.Vh()||e.AE(a,g,t,null,1,a.rl,a.faces),p=j.d(!0);else{const n=j.c("layoutContainer.inner"),l=u.toString(),h=e.pE(a,"column-count");a.Rk(t,e,i,s,r,o,g,l,h).then(i=>{if(!o.Vh()){const n=i[0];b.a(n),n.element===d&&(g=n),g.gr=Math.max.apply(null,i.map(t=>t.gr)),e.AE(a,g,t,n,h,a.rl,a.faces);const s=a.Qy.rr[l];s&&"region"===s.breakAfter&&(s.breakAfter=null)}n.finish(!0)}),p=n.result()}else{const i=e.dE(a,"content");if(i&&X.y(i)){let n="span";i.url&&(n="img");const s=a.viewport.document.createElement(n);i.visit(new X.c(s,a,i,a.jf.qf())),d.appendChild(s),"img"==n&&e._E(a,s,a.faces),e.RE(a,g,t,a.faces)}else e.sE&&(n.removeChild(d),m=!0);m||e.AE(a,g,t,null,1,a.rl,a.faces),p=j.d(!0)}return p.then(()=>{if(o.Vh())return void h.finish(!0);if(!e.Kw||Math.floor(g.gr)>0){if(!m&&!c){const t=e.dE(a,"shape-outside"),n=g.jr(t,a);r.push(n)}}else if(0==e.children.length)return n.removeChild(d),void h.finish(!0);let l=e.children.length-1;h.loop(()=>{for(;l>=0;){const n=e.children[l--],h=a.Jg(t,n,d,i,s,r,o);if(h.Dt())return h.Ot(()=>j.d(!o.Vh()));if(o.Vh())break}return j.d(!1)}).then(()=>{h.finish(!0)})}),h.result()}Ak(){const t=this.Qy.page;for(const e in this.Qy.rr){const n=this.Qy.rr[e];for(let e=n.positions.length-1;e>=0;e--){const i=n.positions[e];i.nr.startPage>=0&&i.nr.startPage+i.nr.linger-1<=t&&n.positions.splice(e,1)}}}yk(){const t=this.Qy.page;for(const e in this.Qy.rr){const n=this.Qy.rr[e];for(let e=n.positions.length-1;e>=0;e--){const i=n.positions[e];i.nr.startPage<0&&i.nr.startOffset<this.tk&&(i.nr.startPage=t)}}}Ik(t){for(const e in this.Ym){const n=t.rr[e];if(n&&n.positions.length>0)return!1}return!0}Fk(t,e){const n=this,i=t.container===t.Hi;n.ak={},e?(n.Qy=e.clone(),n.styler.fb(e.or)):(n.Qy=new X.j,n.styler.fb(-1)),this.lang&&t.Hi.setAttribute("lang",this.lang),(e=n.Qy).page++,n.ue(n.style.Kf),n.hk=e.clone();const s=i?{}:n.ck.Ix(),o=n.xk(s);if(!o)return j.d(null);let a=0;if(!i){t.es(o.Xw.specified.width.value===V.q),t.ss(o.Xw.specified.height.value===V.p),n.jf.kd(t),n.jf.Td(s,n);const e=kn(An(s),this);n.Ok(e,t),function(t,e,n,i){let s=!1,r=!1;const o=t.marks;if(o){const t=o.value;t.ct()?t.values.forEach(t=>{t===V.t.crop?s=!0:t===V.t.cross&&(r=!0)}):t===V.t.crop?s=!0:t===V.t.cross&&(r=!0)}if(!s&&!r)return;const a=n.container,l=a.ownerDocument;b.a(l);const h=e.bleed,c=V.x(In,i),u=V.x(Cn,i),d=V.x(On,i);if(h){const e=t["background-color"];e&&e.value&&(n.Hi.style.backgroundColor=e.value.stringValue())}s&&Object.keys(Rn).forEach(t=>{const e=Rn[t],n=function(t,e,n,i,s,r){let o=i;o<=s+2*k.G.mm&&(o=s+i/2);const a=Math.max(i,o),l=s+a+n/2,h=Dn(t,l,l);let c=[[0,s+i],[i,s+i],[i,s+i-o]],u=c.map(t=>[t[1],t[0]]);e!==Rn.TOP_RIGHT&&e!==Rn.BOTTOM_RIGHT||(c=c.map(t=>[s+a-t[0],t[1]]),u=u.map(t=>[s+a-t[0],t[1]])),e!==Rn.BOTTOM_LEFT&&e!==Rn.BOTTOM_RIGHT||(c=c.map(t=>[t[0],s+a-t[1]]),u=u.map(t=>[t[0],s+a-t[1]]));const d=Ln(t,n);d.setAttribute("points",c.map(t=>t.join(",")).join(" ")),h.appendChild(d);const f=Ln(t,n);return f.setAttribute("points",u.map(t=>t.join(",")).join(" ")),h.appendChild(f),e.split(" ").forEach(t=>{h.style[t]=`${r}px`}),h}(l,e,c,d,h,u);a.appendChild(n)}),r&&Object.keys(Pn).forEach(t=>{const e=Pn[t],n=function(t,e,n,i,s){const r=2*i;let o,a;e===Pn.TOP||e===Pn.BOTTOM?(o=r,a=i):(o=i,a=r);const l=Dn(t,o,a),h=Ln(t,n);h.setAttribute("points",`0,${a/2} ${o},${a/2}`),l.appendChild(h);const c=Ln(t,n);c.setAttribute("points",`${o/2},0 ${o/2},${a}`),l.appendChild(c);const u=Ln(t,n,"circle");let d;switch(u.setAttribute("cx",o/2),u.setAttribute("cy",a/2),u.setAttribute("r",i/4),l.appendChild(u),e){case Pn.TOP:d=Pn.BOTTOM;break;case Pn.BOTTOM:d=Pn.TOP;break;case Pn.LEFT:d=Pn.RIGHT;break;case Pn.RIGHT:d=Pn.LEFT}return Object.keys(Pn).forEach(t=>{const n=Pn[t];n===e?l.style[n]=`${s}px`:n!==d&&(l.style[n]="0",l.style[`margin-${n}`]="auto")}),l}(l,e,c,d,u);a.appendChild(n)})}(s,e,t,this),a=e.ME+e.bleed}const l=!i&&o.dE(n,"writing-mode")||V.t.horizontal_tb;this.le=l!=V.t.horizontal_tb;const h=o.dE(n,"direction")||V.t.ltr,c=new G.e(n.pk,G.a.PAGE,null,null,null,l,h),u=j.c("layoutNextPage");return u.Ut(e=>{n.Jg(t,o,t.Hi,a,a,[],c).then(()=>{c.Vh()||c.finish(),c.Vh()?(n.Qy=n.hk.clone(),c.validate(),e.Gt()):e.zt()})}).then(()=>{if(o.OE(n,t,n.rl),!i){const i=new k.s(o.Xw.scope,"left-page");t.side=i.evaluate(n)?r.LEFT:r.RIGHT,n.Ak(),e=n.Qy,Object.keys(e.rr).forEach(t=>{const i=e.rr[t],s=i.breakAfter;!s||"page"!==s&&n.Jy(s)||(i.breakAfter=null)})}n.Qy=n.hk=null,e.or=n.styler.xb();const s=n.style.store.Lk(n.xmldoc);t.finish(s,n.rl),n.Ik(e)&&(e=null),u.finish(e)}),u.result()}Ok(t,e){this.ie=t.Yt,this.se=t.qt,this.dk=t.Yt+2*t.DE,this.fk=t.qt+2*t.DE,e.container.style.width=`${this.dk}px`,e.container.style.height=`${this.fk}px`,e.Hi.style.left=`${t.ME}px`,e.Hi.style.right=`${t.ME}px`,e.Hi.style.top=`${t.ME}px`,e.Hi.style.bottom=`${t.ME}px`,e.Hi.style.padding=`${t.bleed}px`,e.Hi.style.paddingTop=`${t.bleed+.01}px`}}class Li extends z.b{constructor(t,e,n,i){super(t.te,t,e,n,i,t.Jn,!n),this.Mk=t,this.Dk=!1}ao(){}uo(t,e,n){const i=new Je(this.Mk.Kf,t,e,n,this.Mk.Xy,this.condition,this.owner.Ai());this.Mk.Fi(new Tn(i.scope,this.Mk,i,this.Jn))}ho(t){let e=t.expr;null!=this.condition&&(e=k.D(this.scope,this.condition,e)),this.Mk.Fi(new Li(this.Mk,e,this,this.regionId))}io(){this.Mk.Fi(new z.f(this.scope,this.owner))}Jr(){const t={};this.Mk.Wy.push({properties:t,condition:this.condition}),this.Mk.Fi(new z.h(this.scope,this.owner,null,t,this.Mk.Jn))}co(t){let e=this.Mk.qy[t];e||(e={},this.Mk.qy[t]=e),this.Mk.Fi(new z.h(this.scope,this.owner,null,e,this.Mk.Jn))}no(){const t={};this.Mk.Ky.push(t),this.Mk.Fi(new z.h(this.scope,this.owner,this.condition,t,this.Mk.Jn))}eo(t){let e=this.Mk.Yy;if(t){const n=z.q(e,"_pseudos");(e=n[t])||(e={},n[t]=e)}this.Mk.Fi(new z.h(this.scope,this.owner,null,e,this.Mk.Jn))}so(){this.Dk=!0,this.Ei()}ro(){const t=new ri(this.Mk.Kf,this.Mk,this,this.Jn,this.Mk.Bx);this.Mk.Fi(t),t.ro()}yi(){if(z.b.prototype.yi.call(this),this.Dk){this.Dk=!1;const t=`R${this.Mk.$k++}`;this.special("region-id",V.r(t)),this.ki();const e=new Li(this.Mk,this.condition,this,t);this.Mk.Fi(e),e.yi()}}}function Ri(t){let e=t.getAttribute("content");if(!e)return"";const n={};let i;for(;null!=(i=e.match(/^,?\s*([-A-Za-z_.][-A-Za-z_0-9.]*)\s*=\s*([-+A-Za-z_0-9.]*)\s*/));)e=e.substr(i[0].length),n[i[1]]=i[2];const s=n.width-0,r=n.height-0;return s&&r?`@-epubx-viewport{width:${s}px;height:${r}px;}`:""}class Pi extends B.a{constructor(t){super(),this.Jn=t,this.$k=0,this.Wy=[],this.Yy={},this.qy={},this.Ky=[],this.Bx={},this.te=new k.m(null),this.Kf=new k.m(this.te),this.Xy=new qe(this.te),this.Bk=new Li(this,null,null,null),this.slave=this.Bk}error(t,e){h.b.warn("CSS parser:",t)}}function Fi(t,e){return e.Uk(t)}class Mi extends $.a{constructor(t){super(Fi,$.b.DOCUMENT),this.Zy=t,this.Gk={},this.zk={},this.Hk={},this.Vk={},this.Jn=null,this.styleSheets=[],this.jk=!1}init(t,e){this.Xk(t,e);const n=E.C("user-agent.xml",E.D),i=j.c("OPSDocStore.init");return this.Jn=ze(),Ai.get().then(()=>{this.load(n).then(()=>{this.jk=!0,i.finish(!0)})}),i.result()}gk(t){return this.Hk[t.url]}Lk(t){return this.Vk[t.url]}Xk(t,e){this.Wk(),t&&t.forEach(this.Yk,this),e&&e.forEach(this.qk,this)}Wk(){this.styleSheets.splice(0)}Yk(t){let e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:B.g.AUTHOR,classes:null,media:null})}qk(t){let e=t.url;e&&(e=E.C(E.n(e),E.h)),this.styleSheets.push({url:e,text:t.text,flavor:B.g.USER,classes:null,media:null})}Uk(t){const e=j.c("OPSDocStore.load"),n=this,i=t.url,s=i.endsWith("?viv-toc-box");return xi(t,n).then(t=>{if(!t)return void e.finish(null);if(n.jk){const e=l.b(l.a.PREPROCESS_SINGLE_DOCUMENT);for(let n=0;n<e.length;n++)try{e[n](t.document)}catch(t){h.b.warn("Error during single document preprocessing:",t)}}const r=[],o=t.document.getElementsByTagNameNS(E.a.epub,"trigger");for(let t=0;t<o.length;t++){const e=o[t],n=e.getAttributeNS(E.a.EV,"observer"),i=e.getAttributeNS(E.a.EV,"event"),s=e.getAttribute("action"),a=e.getAttribute("ref");n&&i&&s&&a&&r.push({observer:n,event:i,action:s,ref:a})}n.Vk[i]=r;const a=[],c=E.C("user-agent-page.css",E.D);a.push({url:c,text:_i,flavor:B.g.USER_AGENT,classes:null,media:null});const u=t.head;if(!s&&u)for(let t=u.firstChild;t;t=t.nextSibling){if(1!=t.nodeType)continue;const e=t,n=e.namespaceURI,s=e.localName;if(n==E.a.XHTML)if("style"==s){const t=e.getAttribute("class"),n=e.getAttribute("media"),s=e.getAttribute("title");a.push({url:i,text:e.textContent,flavor:B.g.AUTHOR,classes:s?t:null,media:n})}else if("link"==s){const t=e.getAttribute("rel"),n=e.getAttribute("class"),s=e.getAttribute("media");if("stylesheet"==t||"alternate stylesheet"==t&&n){let t=e.getAttribute("href");t=E.C(t,i);const r=e.getAttribute("title");a.push({url:t,text:null,classes:r?n:null,media:s,flavor:B.g.AUTHOR})}}else"meta"==s&&"viewport"==e.getAttribute("name")&&a.push({url:i,text:Ri(e),flavor:B.g.AUTHOR,classes:null,media:null});else if(n==E.a.FB2)"stylesheet"==s&&"text/css"==e.getAttribute("type")&&a.push({url:i,text:e.textContent,flavor:B.g.AUTHOR,classes:null,media:null});else if(n==E.a.SSE&&"property"===s){const t=e.getElementsByTagName("name")[0];if(t&&"stylesheet"===t.textContent){const t=e.getElementsByTagName("value")[0];if(t){const e=E.C(t.textContent,i);a.push({url:e,text:null,classes:null,media:null,flavor:B.g.AUTHOR})}}}}if(!s)for(let t=0;t<n.styleSheets.length;t++)a.push(n.styleSheets[t]);let d="";for(let t=0;t<a.length;t++)d+=a[t].url,d+="^",a[t].text&&(d+=a[t].text),d+="^";let f=n.Gk[d];if(f)return n.Hk[i]=f,void e.finish(t);let p=n.zk[d];p||(p=new Be.a(()=>{const t=j.c("fetchStylesheet");let e=0;const i=new Pi(n.Jn);return t.loop(()=>{if(e<a.length){const t=a[e++];return i.xi(t.flavor),null!==t.text?B.k(t.text,i,t.url,t.classes,t.media).Lt(!0):B.l(t.url,i,t.classes,t.media)}return j.d(!1)}).then(()=>{const e=i.Bk.finish();f=new ki(n,i.te,i.Kf,e,i.Xy,i.Wy,i.Yy,i.qy,i.Ky,i.Bx),n.Gk[d]=f,delete n.zk[d],t.finish(f)}),t.result()},`FetchStylesheet ${i}`),n.zk[d]=p,p.start()),p.get().then(s=>{n.Hk[i]=s,e.finish(t)})}),e.result()}}function Ui(t){return String.fromCharCode(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}function zi(t){return(255&t.charCodeAt(0))<<24|(255&t.charCodeAt(1))<<16|(255&t.charCodeAt(2))<<8|255&t.charCodeAt(3)}function Bi(t){const e=new E.d;e.append(t);let n=55-t.length&63;for(e.append("");n>0;)n--,e.append("\0");e.append("\0\0\0\0"),e.append(Ui(8*t.length)),t=e.toString();const i=[1732584193,4023233417,2562383102,271733878,3285377520],s=[];let r;for(let e=0;e<t.length;e+=64){for(r=0;r<16;r++)s[r]=zi(t.substr(e+4*r,4));for(;r<80;r++){const t=s[r-3]^s[r-8]^s[r-14]^s[r-16];s[r]=t<<1|t>>>31}let n,o=i[0],a=i[1],l=i[2],h=i[3],c=i[4];for(r=0;r<80;r++)n=r<20?1518500249+(a&l|~a&h):r<40?1859775393+(a^l^h):r<60?2400959708+(a&l|a&h|l&h):3395469782+(a^l^h),n+=(o<<5|o>>>27)+c+s[r],c=h,h=l,l=a<<30|a>>>2,a=o,o=n;i[0]=i[0]+o|0,i[1]=i[1]+a|0,i[2]=i[2]+l|0,i[3]=i[3]+h|0,i[4]=i[4]+c|0}return i}const Hi="▸",$i="▾",Vi="▹";class Gi{constructor(t,e,n,i,s,r,o,a,l,h){this.store=t,this.url=e,this.lang=n,this.rl=i,this.sk=s,this.Kk=o,this.Kx=a,this.Wf=l,this.jf=h,this.page=null,this.instance=null,this.pref=k.E(r),this.pref.Ht=!1}Zk(t,e){if(0!=e--)for(let n=t.firstChild;n;n=n.nextSibling)if(1==n.nodeType){const t=n;"auto"!=E.t(t,"height","auto")&&(E.F(t,"height","auto"),this.Zk(t,e)),"absolute"==E.t(t,"position","static")&&(E.F(t,"position","relative"),this.Zk(t,e))}}Qk(t){const e=this.Kk.Qk(t);return(t,n,i)=>{const s=i.behavior;if(s)switch(s.toString()){case"body-child":t.parentElement.getAttribute("data-vivliostyle-primary-entry")&&(t.querySelector("[role=doc-toc], [role=directory], nav li a, .toc, #toc")||(i.display=V.t.none));break;case"toc-node-anchor":i.color=V.t.inherit,i["text-decoration"]=V.t.none;break;case"toc-node":i.display=V.t.block,i.margin=V.u,i.padding=V.u,i["padding-inline-start"]=new V.i(1.25,"em");break;case"toc-node-first-child":i.display=V.t.inline_block,i.margin=new V.i(.2,"em"),i["vertical-align"]=V.t.top,i.color=V.t.inherit,i["text-decoration"]=V.t.none}if(!s||"toc-node"!=s.toString()&&"toc-container"!=s.toString())return e(t,n,i);const r=t.firstChild;r&&1!==r.nodeType&&""===r.textContent.trim()&&t.replaceChild(t.ownerDocument.createComment(r.textContent),r);const o=n.getAttribute("data-adapt-class");if("toc-node"==o){const t=n.firstChild;t.textContent!=Hi&&(t.textContent=Hi,E.F(t,"cursor","pointer"),t.addEventListener("click",ji,!1),t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),n.setAttribute("aria-expanded","false"),"0px"!==n.style.height&&(t.tabIndex=0))}const a=n.ownerDocument.createElement("div");if(a.setAttribute("data-adapt-process-children","true"),"toc-node"==s.toString()){const e=n.ownerDocument.createElement("div");if(e.textContent=Vi,E.F(e,"margin","0.2em 0 0 -1em"),E.F(e,"margin-inline-start","-1em"),E.F(e,"margin-inline-end","0"),E.F(e,"display","inline-block"),E.F(e,"width","1em"),E.F(e,"text-align","center"),E.F(e,"vertical-align","top"),E.F(e,"cursor","default"),E.F(e,"font-family","Menlo,sans-serif"),a.appendChild(e),E.F(a,"overflow","hidden"),a.setAttribute("data-adapt-class","toc-node"),a.setAttribute("role","treeitem"),"toc-node"==o||"toc-container"==o){E.F(a,"height","0px");const e=t.firstElementChild;e&&"a"===e.localName&&(e.tabIndex=-1)}else n.setAttribute("role","tree")}else"toc-node"==o&&(a.setAttribute("data-adapt-class","toc-container"),a.setAttribute("role","group"),a.setAttribute("aria-hidden","true"));return j.d(a)}}showTOC(t,e,n,i,s){if(this.page)return j.d(this.page);const r=this,o=j.c("showTOC"),a=new X.l(t,t);this.page=a;const l=this.url+"?viv-toc-box";return this.store.load(l).then(i=>{const l=this.store.resources[this.url];l&&l.body&&l.body.getAttribute("data-vivliostyle-primary-entry")&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);const h=r.store.gk(i),c=h.ik(n,1e5,s);e=new vi(e.window,c.fontSize,e.root,c.width,c.height);const u=r.Qk(i),d=new Di(h,i,r.lang,e,r.rl,r.sk,u,r.Kx,0,r.Wf,r.jf);r.instance=d,d.pref=r.pref,d.init().then(()=>{d.Fk(a,null).then(()=>{Array.from(a.container.querySelectorAll("[data-vivliostyle-toc-box]>*>*>*>*>*[style*='display: none']")).forEach(t=>{t.setAttribute("aria-hidden","true"),t.setAttribute("hidden","hidden")}),r.Zk(t,2),o.finish(a)})})}),o.result()}Jk(){this.page&&(this.page.container.style.visibility="hidden",this.page.container.setAttribute("aria-hidden","true"))}isTOCVisible(){return!!this.page&&"visible"===this.page.container.style.visibility}}function ji(t){const e=t.target,n=e.textContent==Hi;e.textContent=n?$i:Hi;const i=e.parentNode;e.setAttribute("aria-expanded",n?"true":"false"),i.setAttribute("aria-expanded",n?"true":"false");let s=i.firstChild;for(;s;){if(1===s.nodeType){const t=s,e=t.getAttribute("data-adapt-class");if("toc-container"===e){if(t.setAttribute("aria-hidden",n?"false":"true"),t.firstChild){s=t.firstChild;continue}}else if("toc-node"===e&&(t.style.height=n?"auto":"0px",t.children.length>=2&&(t.children[1].tabIndex=n?0:-1),t.children.length>=3&&(t.children[0].tabIndex=n?0:-1,!n))){const e=t.children[0];if(e.textContent==$i){e.textContent=Hi,e.setAttribute("aria-expanded","false"),t.setAttribute("aria-expanded","false"),s=t.children[2];continue}}}for(;!s.nextSibling&&s.parentNode!==i;)s=s.parentNode;s=s.nextSibling}t.stopPropagation()}class Xi extends Mi{constructor(){super(null),this.tS={},this.eS={},this.deobfuscators={},this.documents={},this.Zy=this.nS(),this.iS=new $.a(xi,$.b.DOCUMENT),this.sS=$.f()}nS(){const t=this;return e=>t.deobfuscators[e]}rS(t,e,n){return this.iS.load(t,e,n)}oS(t){this.iS.fetch(t)}hS(t,e,n){return this.sS.load(t,e,n)}lS(t){this.sS.fetch(t)}cS(t,e){const n=j.c("loadPubDoc");return $.c(t,null,"HEAD").then(i=>{if(i.status>=400)this.aS(t,e).then(e=>{e?n.finish(e):(h.b.error(`Failed to fetch a source document from ${t} (${i.status}${i.statusText?" "+i.statusText:""})`),n.finish(null))});else if(i.status||i.responseXML||i.responseText||i.Ml||i.contentType||/\/[^\/.]+(?:[#?]|$)/.test(t)&&(t=t.replace(/([#?]|$)/,"/$1")),"application/oebps-package+xml"==i.contentType||/\.opf(?:[#?]|$)/.test(t)){const[,i,s]=t.match(/^((?:.*\/)?)([^\/]*)$/);this.uS(i,s,e).Mt(n)}else"application/ld+json"==i.contentType||"application/webpub+json"==i.contentType||"application/audiobook+json"==i.contentType||"application/json"==i.contentType||/\.json(?:ld)?(?:[#?]|$)/.test(t)?this.hS(t,!0).then(e=>{if(!e)return h.b.error(`Received an empty response for ${t}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`),void n.finish(null);const i=new is(this,t);i.fS(e).then(()=>{n.finish(i)})}):this.dS(t).then(i=>{i?n.finish(i):this.aS(t,e).then(e=>{e?n.finish(e):(h.b.error(`Failed to load ${t}.`),n.finish(null))})})}),n.result()}aS(t,e){const n=j.c("loadEPUBDoc");t.endsWith("/")||(t+="/"),e&&this.lS(t+"?r=list"),this.oS(t+"META-INF/encryption.xml");const i=t+"META-INF/container.xml";return this.rS(i).then(i=>{if(i){const s=i.doc().child("container").child("rootfiles").child("rootfile").attribute("full-path");for(const i of s)if(i)return void this.uS(t,i,e).Mt(n);n.finish(null)}}),n.result()}uS(t,e,n){const i=this,s=t+e;let r=i.tS[s];if(r)return j.d(r);const o=j.c("loadOPF");return i.rS(s,!0,`Failed to fetch EPUB OPF ${s}`).then(e=>{e?i.rS(`${t}META-INF/encryption.xml`).then(a=>{(n?i.hS(`${t}?r=list`):j.d(null)).then(n=>{(r=new is(i,t)).pS(e,a,n,`${t}?r=manifest`).then(()=>{i.tS[s]=r,i.eS[t]=r,o.finish(r)})})}):h.b.error(`Received an empty response for EPUB OPF ${s}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),o.result()}dS(t){const e=j.c("loadWebPub");return this.load(t).then(n=>{if(n)if(n.document.querySelector("a[href='META-INF/'],a[href$='/META-INF/']"))e.finish(null);else{const i=n.document,s=new is(this,t);i.body&&i.body.setAttribute("data-vivliostyle-primary-entry",!0);const r=i.querySelector("link[rel='publication'],link[rel='manifest'][type='application/webpub+json']");if(r){const n=r.getAttribute("href");if(/^#/.test(n)){const t=E.H(i.getElementById(n.substr(1)).textContent);s.fS(t,i).then(()=>{e.finish(s)})}else this.hS(E.C(r.getAttribute("href"),t)).then(t=>{s.fS(t,i).then(()=>{e.finish(s)})})}else s.fS({},i).then(()=>{s.gS&&s.gS.src===n.url&&(i.querySelector("[role=doc-toc], [role=directory], nav, .toc, #toc")||(s.gS=null)),e.finish(s)})}else h.b.error(`Received an empty response for ${t}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),e.result()}mS(t,e){const n=j.c("EPUBDocStore.load"),i=E.I(t);return(this.documents[i]=this.Uk({status:200,statusText:"",url:i,contentType:e.contentType,responseText:null,responseXML:e,Ml:null})).Mt(n),n.result()}load(t){const e=E.I(t);let n=this.documents[e];if(n)return n.Dt()?n:j.d(n.get());{const t=j.c("EPUBDocStore.load");return(n=super.load(e,!0,`Failed to fetch a source document from ${e}`)).then(n=>{n?t.finish(n):e.startsWith("data:")?h.b.error(`Failed to load ${e}. Invalid data.`):e.startsWith("http:")&&E.h.startsWith("https:")?h.b.error(`Failed to load ${e}. Mixed Content ("http:" content on "https:" context) is not allowed.`):h.b.error(`Received an empty response for ${e}. This may be caused by the server not allowing cross-origin resource sharing (CORS).`)}),t.result()}}}class Yi{constructor(){this.id=null,this.src="",this.bS=null,this.title=null,this.wS=null,this.Zi=-1,this.ES=0,this.compressed=null,this.epage=0,this.epageCount=0,this.startPage=null,this.skipPagesBefore=null,this.xS=E.o}yS(t,e){this.id=t.getAttribute("id"),this.src=E.C(t.getAttribute("href"),e),this.bS=t.getAttribute("media-type");const n=t.getAttribute("properties");n&&(this.xS=E.f(n.split(/\s+/)))}kS(t){this.Zi=t.index,this.id=`item${t.index+1}`,this.src=t.url,this.startPage=t.startPage,this.skipPagesBefore=t.skipPagesBefore}}function Ki(t){return t.id}function Wi(t){return`1040:${function(t){const e=function(t){const e=Bi(t),n=new E.d;for(let t=0;t<e.length;t++)n.append(Ui(e[t]));return n.toString()}(t),n=new E.d;for(let t=0;t<e.length;t++)n.append((256|e.charCodeAt(t)).toString(16).substr(1));return n.toString()}(t)}`}const Zi={dcterms:"http://purl.org/dc/terms/",marc:"http://id.loc.gov/vocabulary/",media:"http://www.idpf.org/epub/vocab/overlays/#",rendition:"http://www.idpf.org/vocab/rendition/#",onix:"http://www.editeur.org/ONIX/book/codelists/current.html#",xsd:"http://www.w3.org/2001/XMLSchema#"},qi="http://idpf.org/epub/vocab/package/#",Qi={language:`${Zi.dcterms}language`,title:`${Zi.dcterms}title`,creator:`${Zi.dcterms}creator`,layout:`${Zi.rendition}layout`,SS:`${qi}title-type`,vS:`${qi}display-seq`,TS:`${qi}alternate-script`};function Ji(t,e){const n={};return(i,s)=>{let r,o;const a=i.r||n,l=s.r||n;if(t==Qi.title&&(r="main"==a[Qi.SS])!=(o="main"==l[Qi.SS]))return r?-1:1;let h=parseInt(a[Qi.vS],10);isNaN(h)&&(h=Number.MAX_VALUE);let c=parseInt(l[Qi.vS],10);return isNaN(c)&&(c=Number.MAX_VALUE),h!=c?h-c:t!=Qi.language&&e&&(r=(a[Qi.language]||a[Qi.TS])==e)!=(o=(l[Qi.language]||l[Qi.TS])==e)?r?-1:1:i.o-s.o}}function ts(){const t=window.MathJax;return t?t.Hub:null}const es={"application/xhtml+xml":!0,"image/jpeg":!0,"image/png":!0,"image/svg+xml":!0,"image/gif":!0,"audio/mp3":!0},ns="viv-id-";class is{constructor(t,e){this.store=t,this.NS=e,this.CS=null,this.PS=null,this.items=null,this.spine=null,this.RS=null,this._S=null,this.uid=null,this.bindings={},this.lang=null,this.epageCount=0,this.AS=!1,this.IS=!0,this.FS=null,this.metadata={},this.OS=null,this.gS=null,this.cover=null,this.Kx={},this.Ax=null,this.Wf=this.LS(),ts()&&(z.H[E.a.MATHML]=!0)}LS(){const t=this;return new class{Xf(t,e){const n=e+(t?`#${t}`:"");return ns+E.r(n,":")}sc(e,n){const i=e.match(/^([^#]*)#?(.*)$/);if(i){const e=i[1]||n,s=i[2];if(e&&t.items.some(t=>t.src===e))return`#${this.Xf(s,e)}`}return e}MS(t){"#"===t.charAt(0)&&(t=t.substring(1)),0===t.indexOf(ns)&&(t=t.substring(ns.length));const e=E.J(t,":").match(/^([^#]*)#?(.*)$/);return e?[e[1],e[2]]:[]}}}getMetadata(){return this.metadata}DS(t){if(t.startsWith("data:"))return t===this.NS?"":t;if(this.NS){let e=E.C("",this.NS);return t===e||t+"/"===e?"":("/"!=e.charAt(e.length-1)&&(e+="/"),t.substr(0,e.length)==e?decodeURI(t.substr(e.length)):null)}return t}pS(t,e,n,i){const r=this;this.CS=t,this.PS=e;const o=t.doc().child("package"),a=o.attribute("unique-identifier")[0];if(a){const e=t.ey(`${t.url}#${a}`);e&&(this.uid=e.textContent.replace(/[ \n\r\t]/g,""))}const l={};this.items=o.child("manifest").child("item").zy().map(e=>{const n=new Yi,i=e;n.yS(i,t.url);const s=i.getAttribute("fallback");return s&&!es[n.bS]&&(l[n.src]=s),!r.gS&&n.xS.nav&&(r.gS=n),!r.cover&&n.xS["cover-image"]&&(r.cover=n),n}),this.RS=E.w(this.items,Ki),this._S=E.w(this.items,t=>r.DS(t.src));for(const t in l){let e=t;for(;;){const n=this.RS[l[e]];if(!n)break;if(es[n.bS]){this.Kx[t]=n.src;break}e=n.src}}this.spine=o.child("spine").child("itemref").zy().map((t,e)=>{const n=t,i=n.getAttribute("idref"),s=r.RS[i];return s&&(s.wS=n,s.Zi=e),s});const h=o.child("spine").attribute("toc")[0];h&&(this.OS=this.RS[h]);const c=o.child("spine").attribute("page-progression-direction")[0];c&&(this.Ax=function(t){switch(t){case"ltr":return s.LTR;case"rtl":return s.RTL;default:throw new Error(`unknown PageProgression: ${t}`)}}(c));const u=e?e.doc().child("encryption").child("EncryptedData").predicate(Ci.Gy("EncryptionMethod",Ci.Uy("Algorithm","http://www.idpf.org/2008/embedding"))).child("CipherData").child("CipherReference").attribute("URI"):[],d=o.child("bindings").child("mediaType").zy();for(let t=0;t<d.length;t++){const e=d[t].getAttribute("handler"),n=d[t].getAttribute("media-type");n&&e&&this.RS[e]&&(this.bindings[n]=this.RS[e].src)}if(this.metadata=function(t,e){let n;if(e){n={};for(const t in Zi)n[t]=Zi[t];let t;for(;null!=(t=e.match(/^\s*([A-Z_a-z\u007F-\uFFFF][-.A-Z_a-z0-9\u007F-\uFFFF]*):\s*(\S+)/));)e=e.substr(t[0].length),n[t[1]]=t[2]}else n=Zi;const i=t=>{if(t){const e=t.match(/^\s*(([^:]*):)?(\S+)\s*$/);if(e){const t=e[2]?n[e[2]]:qi;if(t)return t+e[3]}}return null};let s=1;const r=t.jy().Vy(t=>{if("meta"==t.localName){const e=i(t.getAttribute("property"));if(e)return{name:e,value:t.textContent,id:t.getAttribute("id"),order:s++,refines:t.getAttribute("refines"),lang:null,scheme:i(t.getAttribute("scheme"))}}else if(t.namespaceURI==E.a.DC)return{name:Zi.dcterms+t.localName,order:s++,lang:t.getAttribute("xml:lang"),value:t.textContent,id:t.getAttribute("id"),refines:null,scheme:null};return null}),o=E.A(r,t=>t.refines),a=t=>E.z(t,(t,e)=>t.map(t=>{const e={v:t.value,o:t.order};if(t.schema&&(e.s=t.scheme),t.id||t.lang){let n=o[t.id];if(n||t.lang){if(t.lang){const e={name:Qi.language,value:t.lang,lang:null,id:null,refines:t.id,scheme:null,order:t.order};n?n.push(e):n=[e]}const i=E.A(n,t=>t.name);e.r=a(i)}}return e})),l=a(E.A(r,t=>t.refines?null:t.name));let h=null;l[Qi.language]&&(h=l[Qi.language][0].v);const c=t=>{for(const e in t){const n=t[e];n.sort(Ji(e,h));for(let t=0;t<n.length;t++){const e=n[t].r;e&&c(e)}}};return c(l),l}(o.child("metadata"),o.attribute("prefix")[0]),this.metadata[Qi.language]&&(this.lang=this.metadata[Qi.language][0].v),this.metadata[Qi.layout]&&(this.AS="pre-paginated"===this.metadata[Qi.layout][0].v),!n){if(u.length>0&&this.uid){const t=function(t){const e=function(t){const e=Bi(t),n=[];for(const t of e)n.push(t>>>24&255,t>>>16&255,t>>>8&255,255&t);return n}(t);return t=>{const n=j.c("deobfuscator");let i,s;return t.slice?(i=t.slice(0,1040),s=t.slice(1040,t.size)):(i=t.webkitSlice(0,1040),s=t.webkitSlice(1040,t.size-1040)),$.g(i).then(t=>{const i=new DataView(t);for(let t=0;t<i.byteLength;t++){let n=i.getUint8(t);n^=e[t%20],i.setUint8(t,n)}n.finish($.e([i,s]))}),n.result()}}(this.uid);for(let e=0;e<u.length;e++)this.store.deobfuscators[this.NS+u[e]]=t}return this.AS&&this.$S(),j.d(!0)}const f=new E.d,p={};if(u.length>0&&this.uid){const t=Wi(this.uid);for(let e=0;e<u.length;e++)p[u[e]]=t}for(let t=0;t<n.length;t++){const e=n[t],i=e.n;if(i){const t=decodeURI(i),n=this._S[t];let s=null;n&&(n.compressed=0!=e.m,n.ES=e.c,n.bS&&(s=n.bS.replace(/\s+/g,"")));const r=p[t];(s||r)&&(f.append(i),f.append(" "),f.append(s||"application/octet-stream"),r&&(f.append(" "),f.append(r)),f.append("\n"))}}return r.$S(),$.c(i,$.b.DEFAULT,"POST",f.toString(),"text/plain")}$S(){let t=0;for(const e of this.spine){const n=this.AS?1:Math.ceil(e.ES/1024);e.epage=t,e.epageCount=n,t+=n}this.epageCount=t,this.FS&&this.FS(this.epageCount)}BS(t){this.IS=t||this.AS}US(t){if(this.FS=t,this.IS)return this.AS&&0==this.epageCount&&this.$S(),j.d(!0);let e=0,n=0;const i=j.c("countEPages");return i.Ut(t=>{if(n===this.spine.length)return void t.zt();const i=this.spine[n++];i.epage=e,this.store.load(i.src).then(n=>{let s=1800;const r=n.lang||this.lang;r&&r.match(/^(ja|ko|zh)/)&&(s/=3),i.epageCount=Math.ceil(n.Dy()/s),e+=i.epageCount,this.epageCount=e,this.FS&&this.FS(this.epageCount),t.Gt()})}).Mt(i),i.result()}GS(t,e){this.RS={},this._S={},this.items=[],this.spine=this.items;const n=this.CS=new Ti(null,"",(new DOMParser).parseFromString("<spine></spine>","text/xml"));return t.forEach(t=>{const e=new Yi;e.kS(t),b.a(e.id);const i=n.document.createElement("itemref");i.setAttribute("idref",e.id),n.root.appendChild(i),e.wS=i,this.RS[e.id]=e;let s=this.DS(t.url);null==s&&(s=t.url),this._S[s]=e,this.items.push(e)}),e?this.store.mS(t[0].url,e):j.d(null)}fS(t,e){t.readingProgression&&(this.Ax=t.readingProgression),void 0===this.metadata&&(this.metadata={});const n=e&&e.title||t.name||t.metadata&&t.metadata.title;n&&(this.metadata[Qi.title]=[{v:n}]);const i=this.DS(this.NS);if(!t.readingOrder&&e&&null!==i){t.readingOrder=[encodeURI(i)];const n="[role=doc-toc] a[href],[role=directory] a[href],nav li a[href],.toc a[href],#toc a[href]";Array.from(e.querySelectorAll(n)).forEach(e=>{const n=E.I(E.C(e.getAttribute("href"),this.NS)),i=this.DS(n),s=null!==i?encodeURI(i):n;-1==t.readingOrder.indexOf(s)&&t.readingOrder.push(s)})}const s=[];let r=0,o=-1;[t.readingOrder,t.resources].forEach(e=>{e instanceof Array&&e.forEach(e=>{const n=t.readingOrder.includes(e),i="string"==typeof e?e:e.url||e.href,a="string"==typeof e?"":e.zS||e.href&&e.type||"";if(n||"text/html"===a||"application/xhtml+xml"===a||/(^|\/)([^\/]+\.(x?html|htm|xht)|[^\/.]*)([#?]|$)/.test(i)){const t={url:E.C(E.n(i),this.NS),index:r++,startPage:null,skipPagesBefore:null};"contents"===e.rel&&-1===o&&(o=t.index),s.push(t)}})});const a=j.c("initWithWebPubManifest");return this.GS(s).then(()=>{-1!==o&&(this.gS=this.items[o]),this.gS||(this.gS=this._S[i]),a.finish(!0)}),a.result()}HS(t,e){const n=this.spine[t],i=j.c("getCFI");return this.store.load(n.src).then(t=>{const s=t.kb(e);let r=null;if(s){const i=t.Sb(s,0,!1),o=e-i,a=new _;a.Uf(s,o,!1,null),n.wS&&a.Uf(n.wS,0,!1,null),r=a.toString()}i.finish(r)}),i.result()}VS(t){const e=this;return j.b("resolveFragment",n=>{if(!t)return void n.finish(null);let i,s=new _;if(s.Bf(t),e.CS){const t=s.navigate(e.CS.document);if(1!=t.node.nodeType||t.after||!t.ref)return void n.finish(null);const r=t.node,o=r.getAttribute("idref");if("itemref"!=r.localName||!o||!e.RS[o])return void n.finish(null);i=e.RS[o],s=t.ref}else i=e.spine[0];e.store.load(i.src).then(t=>{const e=s.navigate(t.document),r=t.Sb(e.node,e.offset,e.after);n.finish({Zi:i.Zi,jS:r,Hf:-1})})},(e,n)=>{h.b.warn(n,"Cannot resolve fragment:",t),e.finish(null)})}XS(t){const e=this;return j.b("resolveEPage",n=>{if(t<=0)return void n.finish({Zi:0,jS:0,Hf:-1});if(e.IS){let i=e.spine.findIndex(e=>0==e.epage&&0==e.epageCount||e.epage<=t&&e.epage+e.epageCount>t);-1==i&&(i=e.spine.length-1);let s=e.spine[i];s&&0!=s.epageCount||(s=e.spine[--i]);const r=Math.floor(t-s.epage);return void n.finish({Zi:i,jS:-1,Hf:r})}let i=E.i(e.spine.length,n=>{const i=e.spine[n];return i.epage+i.epageCount>t});i==e.spine.length&&i--;const s=e.spine[i];e.store.load(s.src).then(e=>{(t-=s.epage)>s.epageCount&&(t=s.epageCount);let r=0;if(t>0){const n=e.Dy();(r=Math.round(n*t/s.epageCount))==n&&r--}n.finish({Zi:i,jS:r,Hf:-1})})},(e,n)=>{h.b.warn(n,"Cannot resolve epage:",t),e.finish(null)})}WS(t){const e=this.spine[t.Zi];if(this.IS){const n=e.epage+t.Hf;return j.d(n)}if(t.jS<=0)return j.d(e.epage);const n=j.c("getEPage");return this.store.load(e.src).then(i=>{const s=i.Dy(),r=Math.min(s,t.jS);n.finish(e.epage+r*e.epageCount/s)}),n.result()}}const ss=(t,e)=>({page:t,position:{Zi:t.Zi,Hf:e,jS:t.offset}});class rs{constructor(t,e,n,i,s){this.opf=t,this.viewport=e,this.sk=n,this.YS=s,this.qS=[],this.KS=[],this.ZS=!1,this.pref=k.E(i),this.rl=new wi(e),this.jf=new F(t.Wf)}QS(t){const e=this.qS[t.Zi];return e?e.pages[t.Hf]:null}getCurrentPageProgression(t){if(this.opf.Ax)return this.opf.Ax;{const e=this.qS[t?t.Zi:0];return e?e.instance.Ax:null}}JS(t,e,n){e.container.style.display="none",e.container.style.visibility="visible",e.container.style.position="",e.container.style.top="",e.container.style.left="",e.container.setAttribute("data-vivliostyle-page-side",e.side);const i=t.pages[n];if(e.Wi=0==t.item.Zi&&0==n,t.pages[n]=e,this.opf.IS){if(0==n&&t.item.Zi>0){const e=this.opf.spine[t.item.Zi-1];t.item.epage=e.epage+e.epageCount}t.item.epageCount=t.pages.length,this.opf.epageCount=this.opf.spine.reduce((t,e)=>t+e.epageCount,0),this.opf.FS&&this.opf.FS(this.opf.epageCount)}if(i)t.instance.viewport.Oy.replaceChild(e.container,i.container),i.dispatchEvent({type:"replaced",target:null,currentTarget:null,preventDefault:null,tv:e});else{let i=null;if(n>0)i=t.pages[n-1].container.nextElementSibling;else for(let e=t.item.Zi+1;e<this.qS.length;e++){const t=this.qS[e];if(t&&t.pages[0]){i=t.pages[0].container;break}}t.instance.viewport.Oy.insertBefore(e.container,i)}this.YS({width:t.instance.dk,height:t.instance.fk},t.instance.uk,t.item.Zi,t.instance.nk+n)}ev(t,e){const n=j.c("renderSinglePage");let i=this.nv(t,e);const s=this;return t.instance.Fk(i,e).then(r=>{const o=(e=r)?e.page-1:t.iv.length-1;s.JS(t,i,o),s.jf.Pd(i.Zi,o);let a=null;if(e){const n=t.iv[e.page];t.iv[e.page]=e,n&&t.pages[e.page]&&(e.Js(n)||(a=s.ev(t,e)))}a||(a=j.d(!0)),a.then(()=>{const r=s.jf.Rd(i);let a=0;n.Ut(t=>{if(++a>r.length)return void t.zt();const e=r[a-1];e.refs=e.refs.filter(t=>!t.Vf()),0!==e.refs.length?s.sv(e.Zi).then(n=>{if(!n)return void t.Gt();s.jf.Nd(e.zf),s.jf._d(e.refs);const r=n.iv[e.Hf];s.ev(n,r).then(e=>{s.jf.Cd(),s.jf.Ad();const n=e.rv.position;n.Zi===i.Zi&&n.Hf===o&&(i=e.rv.page),t.Gt()})}):t.Gt()}).then(()=>{i.container.parentElement||(i=t.pages[o]),i.Yi=!e&&t.item.Zi===s.opf.spine.length-1,i.Yi&&(b.a(s.viewport),s.jf.Id(s.viewport)),n.finish({rv:ss(i,o),ov:e})})})}),n.result()}hv(t,e){let n=t.Hf,i=-1;if(n<0){i=t.jS;const s=E.i(e.iv.length,t=>e.instance.bk(e.iv[t],!0)>i);n=s===e.iv.length?e.complete?e.iv.length-1:Number.POSITIVE_INFINITY:s-1}else n===Number.POSITIVE_INFINITY&&-1!==t.jS&&(i=t.jS);return{Zi:t.Zi,Hf:n,jS:i}}lv(t,e){const n=this,i=j.c("findPage");return n.sv(t.Zi).then(s=>{if(!s)return void i.finish(null);let r,o=null;i.Ut(a=>{const l=n.hv(t,s);r=l.Hf,(o=s.pages[r])?a.zt():s.complete?(r=s.iv.length-1,o=s.pages[r],a.zt()):e?n.cv(l).then(t=>{t&&(o=t.page,r=t.position.Hf),a.zt()}):i.sleep(100).then(()=>{a.Gt()})}).then(()=>{b.a(o),i.finish(ss(o,r))})}),i.result()}cv(t){const e=this,n=j.c("renderPage");return e.sv(t.Zi).then(i=>{if(!i)return void n.finish(null);const s=e.hv(t,i);let r=s.Hf;const o=s.jS;let a=i.pages[r];a?n.finish(ss(a,r)):n.Ut(t=>{if(r<i.iv.length)return void t.zt();if(i.complete)return r=i.iv.length-1,void t.zt();let n=i.iv[i.iv.length-1];e.ev(i,n).then(e=>{const s=e.rv.page;if(n=e.ov){if(o>=0&&i.instance.bk(n)>o)return a=s,r=i.iv.length-2,void t.zt();t.Gt()}else a=s,r=e.rv.position.Hf,i.complete=!0,t.zt()})}).then(()=>{a=a||i.pages[r];const t=i.iv[r];a?n.finish(ss(a,r)):e.ev(i,t).then(t=>{t.ov||(i.complete=!0),n.finish(t.rv)})})}),n.result()}renderAllPages(){return this.av({Zi:this.opf.spine.length-1,Hf:Number.POSITIVE_INFINITY,jS:-1},!1)}av(t,e){const n=this,i=j.c("renderPagesUpto");t||(t={Zi:0,Hf:0,jS:0});const s=t.Zi,r=t.Hf;let o,a=0;return e&&(a=s),i.Ut(e=>{const i={Zi:a,Hf:a===s?r:Number.POSITIVE_INFINITY,jS:a===s?t.jS:-1};n.cv(i).then(t=>{o=t,++a>s?e.zt():e.Gt()})}).then(()=>{i.finish(o)}),i.result()}firstPage(t,e){return this.lv({Zi:0,Hf:0,jS:-1},e)}lastPage(t,e){return this.lv({Zi:this.opf.spine.length-1,Hf:Number.POSITIVE_INFINITY,jS:-1},e)}nextPage(t,e){const n=this;let i=t.Zi,s=t.Hf;const r=j.c("nextPage");return n.sv(i).then(t=>{if(t){if(t.complete&&s==t.iv.length-1){if(i>=n.opf.spine.length-1)return void r.finish(null);i++,s=0;const e=this.qS[i],o=e&&e.pages[0],a=t.pages[t.pages.length-1];o&&a&&o.side==a.side&&(e.pages.forEach(t=>{t.container&&t.container.remove()}),this.qS[i]=null,this.KS[i]=null)}else s++;n.lv({Zi:i,Hf:s,jS:-1},e).Mt(r)}else r.finish(null)}),r.result()}previousPage(t,e){let n=t.Zi,i=t.Hf;if(0==i){if(0==n)return j.d(null);n--,i=Number.POSITIVE_INFINITY}else i--;return this.lv({Zi:n,Hf:i,jS:-1},e)}uv(t,e){const n=t.side===r.LEFT,i=this.getCurrentPageProgression(e)===s.LTR;return!n&&i||n&&!i}fv(t,e){const n=j.c("getCurrentSpread"),i=this.QS(t);if(!i)return j.d({left:null,right:null});const s=i.side===r.LEFT;let o;return(o=this.uv(i,t)?this.previousPage(t,e):this.nextPage(t,e)).then(e=>{const i=this.QS(t);let r=e&&e.page;r&&r.side===i.side&&(r=null),s?n.finish({left:i,right:r}):n.finish({left:r,right:i})}),n.result()}dv(t,e){const n=this.QS(t);if(!n)return j.d(null);const i=this.uv(n,t),s=this.nextPage(t,e);if(i)return s;{const t=this;return s.Ot(i=>{if(i){if(i.page.side===n.side)return s;const r=t.nextPage(i.position,e);return r.Ot(t=>t?r:s)}return j.d(null)})}}pv(t,e){const n=this.QS(t);if(!n)return j.d(null);const i=this.uv(n,t),s=this.previousPage(t,e),r=n.container.previousElementSibling;if(i){const t=this;return s.Ot(i=>i?i.page.side===n.side?s:i.page.container!==r?s:t.previousPage(i.position,e):j.d(null))}return s}gv(t,e,n){const i=j.c("navigateToEPage"),s=this;return this.opf.XS(t).then(t=>{t?s.lv(t,n).Mt(i):i.finish(null)}),i.result()}mv(t,e,n){const i=j.c("navigateToCFI"),s=this;return s.opf.VS(t).then(t=>{t?s.lv(t,n).Mt(i):i.finish(null)}),i.result()}bv(t,e,n){h.b.debug("Navigate to",t);let i=this.opf.DS(E.I(t));if(!i){if(this.opf.CS&&t.match(/^#epubcfi\(/))i=this.opf.DS(this.opf.CS.url);else if("#"===t.charAt(0)){const e=this.opf.Wf.MS(t);this.opf.CS?null==(i=this.opf.DS(e[0]))&&(i=e[0]):i=e[0],t=i+(e[1]?`#${e[1]}`:"")}if(null==i)return j.d(null)}const s=this.opf._S[i];if(!s){if(this.opf.CS&&i==this.opf.DS(this.opf.CS.url)){const i=t.indexOf("#");if(i>=0)return this.mv(t.substr(i+1),e,n)}return j.d(null)}const r=j.c("navigateTo"),o=this;return o.sv(s.Zi).then(i=>{if(!i)return void r.finish(null);const a=i.xmldoc.ey(t);a?o.lv({Zi:s.Zi,Hf:-1,jS:i.xmldoc.Ig(a)},n).Mt(r):e.Zi!==s.Zi?o.lv({Zi:s.Zi,Hf:0,jS:-1},n).Mt(r):r.finish(null)}),r.result()}nv(t,e){const n=t.instance.viewport,s=n.document.createElement("div");s.setAttribute("data-vivliostyle-page-container","true"),s.setAttribute("role","region"),s.style.position="absolute",s.style.top="0",s.style.left="0",i||(s.style.visibility="hidden",s.setAttribute("aria-hidden","true")),n.Ay.appendChild(s);const r=n.document.createElement("div");r.setAttribute("data-vivliostyle-bleed-box","true"),s.appendChild(r);const o=new X.l(s,r);if(o.Zi=t.item.Zi,o.position=e,o.offset=t.instance.bk(e),0===o.offset){const e=this.opf.Wf.Xf("",t.item.src);r.setAttribute("id",e),o.rs(r,e)}if(n!==this.viewport){const t=k.L(this.viewport.width,this.viewport.height,n.width,n.height),e=B.m(null,new H.b(t,null),"");o.ji.push(new X.d(s,"transform",e))}return o}wv(t,e,n,i){let s=e.getAttribute("data"),r=null;if(s){s=E.C(s,t.url);let n=e.getAttribute("media-type");if(!n){const t=this.opf.DS(s);if(t){const e=this.opf._S[t];e&&(n=e.bS)}}if(n){const t=this.opf.bindings[n];if(t){(r=this.viewport.document.createElement("iframe")).style.border="none";const i=E.y(s),o=E.y(n),a=new E.d;a.append(t),a.append("?src="),a.append(i),a.append("&type="),a.append(o);for(let t=e.firstChild;t;t=t.nextSibling)if(1==t.nodeType){const e=t;if("param"==e.localName&&e.namespaceURI==E.a.XHTML){const t=e.getAttribute("name"),n=e.getAttribute("value");t&&n&&(a.append("&"),a.append(encodeURIComponent(t)),a.append("="),a.append(encodeURIComponent(n)))}}r.setAttribute("src",a.toString());const l=e.getAttribute("width");l&&r.setAttribute("width",l);const h=e.getAttribute("height");h&&r.setAttribute("height",h)}}}return r||(r=this.viewport.document.createElement("span")).setAttribute("data-adapt-process-children","true"),j.d(r)}Ev(t,e,n,i){const s=ts();if(s){const i=n.ownerDocument,r=i.createElement("span");n.appendChild(r);const o=i.importNode(e,!0);this.xv(o,t),r.appendChild(o);const a=s.queue;a.Push(["Typeset",s,r]);const l=j.c("makeMathJaxView"),h=l.suspend();return a.Push(()=>{h.schedule(r)}),l.result()}return j.d(null)}xv(t,e){if(null!=t){if(1===t.nodeType&&"mglyph"===t.tagName){const n=t.attributes;for(const i of n){if("src"!==i.name)continue;const n=E.C(i.nodeValue,e.url);i.namespaceURI?t.setAttributeNS(i.namespaceURI,i.name,n):t.setAttribute(i.name,n)}}t.firstChild&&this.xv(t.firstChild,e),t.nextSibling&&this.xv(t.nextSibling,e)}}yv(t,e,n,i){const s=n?n.ownerDocument:this.viewport.document,r=e.localName;let o;switch(r){case"t":case"tab":case"ec":case"nt":case"fraction":case"comment":case"mark":o="span";break;case"ruby":case"rp":case"rt":o=r;break;default:o="div"}const a=s.createElement(o);return a.setAttribute("data-adapt-process-children","true"),j.d(a)}Qk(t){const e=this;return(n,i,s)=>"object"==n.localName&&n.namespaceURI==E.a.XHTML?e.wv(t,n,i,s):n.namespaceURI==E.a.MATHML?e.Ev(t,n,i,s):n.namespaceURI==E.a.SSE?e.yv(t,n,i,s):n.dataset&&"true"==n.dataset.mathTypeset?e.Ev(t,n,i,s):j.d(null)}sv(t){const e=this;if(-1===t||t>=e.opf.spine.length)return j.d(null);let n=e.qS[t];if(n)return j.d(n);const i=j.c("getPageViewItem");let s=this.KS[t];if(s){const t=i.suspend();return s.push(t),i.result()}s=this.KS[t]=[];const r=e.opf.spine[t],o=e.opf.store;return o.load(r.src).then(a=>{r.title=a.document.title;const l=o.gk(a),h=e.Qk(a);let c=e.viewport;const u=l.ik(c.width,c.height,c.fontSize,e.pref);u.width==c.width&&u.height==c.height&&u.fontSize==c.fontSize||(c=new vi(c.window,u.fontSize,c.root,u.width,u.height));const d=e.qS[t-1];let f;null!==r.startPage?f=r.startPage-1:(!(t>0)||d&&d.complete?f=d?d.instance.nk+d.pages.length:0:(f=r.epage||t,e.opf.AS||f%2!=0||f++),null!==r.skipPagesBefore&&(f+=r.skipPagesBefore)),e.jf.vd(f);const p=new Di(l,a,e.opf.lang,c,e.rl,e.sk,h,e.opf.Kx,f,e.opf.Wf,e.jf,e.opf.Ax);p.pref=e.pref;const g=e.opf.metadata&&e.opf.metadata[Qi.title];p.Kt=g&&g[0]&&g[0].v||"",p.docTitle=r.title||"",p.init().then(()=>{n={item:r,xmldoc:a,instance:p,iv:[null],pages:[],complete:!1},e.qS[t]=n,i.finish(n),s.forEach(t=>{t.schedule(n)})})}),i.result()}kv(){const t=this.qS;for(const e of t)e&&e.pages.splice(0);this.viewport.clear()}Sv(){const t=this.qS;for(const e of t)if(e){const t=e.pages;for(const e of t)if(e.qi&&e.Ki)return!0}return!1}vv(){return this.qS.some(t=>t&&t.pages.length>0)}showTOC(t){const e=this.opf,n=e.gS||e.OS;if(this.ZS=t,!n)return j.d(null);if(this.Tv&&this.Tv.page)return this.Tv.page.container.style.visibility="visible",this.Tv.page.container.setAttribute("aria-hidden","false"),j.d(this.Tv.page);const i=j.c("showTOC");this.Tv||(this.Tv=new Gi(e.store,n.src,e.lang,this.rl,this.sk,this.pref,this,e.Kx,e.Wf,this.jf));const s=this.viewport,r=Math.min(350,Math.round(.67*s.width)-16),o=s.height-6,a=s.document.createElement("div");return s.root.appendChild(a),a.style.visibility="hidden",a.style.width=`${r+10}px`,a.style.maxHeight=`${o}px`,a.setAttribute("data-vivliostyle-toc-box","true"),a.setAttribute("role","navigation"),this.Tv.showTOC(a,s,r,o,this.viewport.fontSize).then(t=>{a.style.visibility="visible",a.setAttribute("aria-hidden","false"),i.finish(t)}),i.result()}Jk(){this.Tv&&this.Tv.Jk()}isTOCVisible(){return!!this.Tv&&this.Tv.isTOCVisible()}}const os="data-vivliostyle-viewer-status",as="data-vivliostyle-spread-view";var ls,hs;!function(t){t.SINGLE_PAGE="singlePage",t.SPREAD="spread",t.AUTO_SPREAD="autoSpread"}(ls||(ls={}));class cs{constructor(t,e,n,s){this.window=t,this.viewportElement=e,this.Nv=n,this.Cv=s,this.Pv=!1,this.Rv=null;const r=this;e.setAttribute("data-vivliostyle-viewer-viewport",!0),i&&e.setAttribute("data-vivliostyle-debug",!0),e.setAttribute(os,"loading");const o=t.document;this.sk=new Ye(o.head,e),this.init(),this.kick=(()=>{}),this._v=(()=>{}),this.Av=(()=>{r.Iv=!0,r.kick()}),this.Fv=this.Fv.bind(this),this.Ov=(t=>{}),this.Lv=o.getElementById("vivliostyle-page-rules"),this.actions={loadPublication:this.loadPublication,loadXML:this.loadXML,configure:this.configure,moveTo:this.moveTo,toc:this.showTOC},this.Mv()}init(){this.readyState=o.LOADING,this.Dv=[],this.opf=null,this.$v=!1,this.Bv=!1,this.Uv=0,this.Gv=0,this.Iv=!1,this.zv=!1,this.Hv=null,this.currentPage=null,this.Vv=null,this.jv=null,this.fontSize=16,this.zoom=1,this.fitToScreen=!1,this.pageViewMode=ls.SINGLE_PAGE,this.Xv=!1,this.renderAllPages=!0,this.pref=k.F(),this.Wv=[]}Mv(){const t=h.a;h.b.addListener(t.DEBUG,t=>{this.callback({t:"debug",content:t})}),h.b.addListener(t.INFO,t=>{this.callback({t:"info",content:t})}),h.b.addListener(t.WARN,t=>{this.callback({t:"warn",content:t})}),h.b.addListener(t.ERROR,t=>{this.callback({t:"error",content:t})})}callback(t){t.i=this.Nv,this.Cv(t)}Yv(t){this.readyState!==t&&(this.readyState=t,this.viewportElement.setAttribute(os,t),this.callback({t:"readystatechange"}))}loadPublication(t){g.registerStartTiming("beforeRender"),this.Yv(o.LOADING);const e=t.url,n=t.fragment,i=!!t.zipmeta,s=t.authorStyleSheet,r=t.userStyleSheet;this.viewport=null;const a=j.c("loadPublication"),l=this;return l.configure(t).then(()=>{const t=new Xi;t.init(s,r).then(()=>{const s=E.C(E.n(e),l.window.location.href);l.Dv=[s],t.cS(s,i).then(t=>{t?(l.opf=t,l.render(n).then(()=>{a.finish(!0)})):a.finish(!1)})})}),a.result()}loadXML(t){g.registerStartTiming("beforeRender"),this.Yv(o.LOADING);const e=t.url,n=t.document,i=t.fragment,s=t.authorStyleSheet,r=t.userStyleSheet;this.viewport=null;const a=j.c("loadXML"),l=this;return l.configure(t).then(()=>{const t=new Xi;t.init(s,r).then(()=>{const s=e.map((t,e)=>({url:E.C(E.n(t.url),l.window.location.href),index:e,startPage:t.startPage,skipPagesBefore:t.skipPagesBefore}));l.Dv=s.map(t=>t.url),l.opf=new is(t,""),l.opf.GS(s,n).then(()=>{l.render(i).then(()=>{a.finish(!0)})})})}),a.result()}render(t){this.qv();const e=this;let n;return(n=t?this.opf.VS(t).Ot(t=>(e.jv=t,j.d(!0))):j.d(!0)).Ot(()=>(g.registerEndTiming("beforeRender"),e.resize()))}Kv(t){const e=parseFloat(t);let n;if("string"==typeof t&&(n=t.match(/[a-z]+$/))){const t=n[0];if("em"===t||"rem"===t)return e*this.fontSize;if("ex"===t)return e*k.G.ex*this.fontSize/k.G.em;const i=k.G[t];if(i)return e*i}return e}configure(t){if("boolean"==typeof t.autoresize&&(t.autoresize?(this.Hv=null,this.window.addEventListener("resize",this.Av,!1),this.Iv=!0):this.window.removeEventListener("resize",this.Av,!1)),"number"==typeof t.fontSize){const e=t.fontSize;e>=5&&e<=72&&this.fontSize!=e&&(this.fontSize=e,this.Iv=!0)}if("object"==typeof t.viewport&&t.viewport){const e=t.viewport,n={marginLeft:this.Kv(e["margin-left"])||0,marginRight:this.Kv(e["margin-right"])||0,marginTop:this.Kv(e["margin-top"])||0,marginBottom:this.Kv(e["margin-bottom"])||0,width:this.Kv(e.width)||0,height:this.Kv(e.height)||0};(n.width>=200||n.height>=200)&&(this.window.removeEventListener("resize",this.Av,!1),this.Hv=n,this.Iv=!0)}return"boolean"==typeof t.hyphenate&&(this.pref.hyphenate=t.hyphenate,this.Iv=!0),"boolean"==typeof t.horizontal&&(this.pref.horizontal=t.horizontal,this.Iv=!0),"boolean"==typeof t.nightMode&&(this.pref.nightMode=t.nightMode,this.Iv=!0),"number"==typeof t.lineHeight&&(this.pref.lineHeight=t.lineHeight,this.Iv=!0),"number"==typeof t.columnWidth&&(this.pref.columnWidth=t.columnWidth,this.Iv=!0),"string"==typeof t.fontFamily&&(this.pref.fontFamily=t.fontFamily,this.Iv=!0),"boolean"==typeof t.load&&(this.Xv=t.load),"boolean"==typeof t.renderAllPages&&(this.renderAllPages=t.renderAllPages),"string"==typeof t.userAgentRootURL&&(E.E(t.userAgentRootURL.replace(/resources\/?$/,"")),E.G(t.userAgentRootURL)),"string"==typeof t.rootURL&&(E.E(t.rootURL),E.G(`${E.h}resources/`)),"string"==typeof t.pageViewMode&&t.pageViewMode!==this.pageViewMode&&(this.pageViewMode=t.pageViewMode,this.Iv=!0),"number"==typeof t.pageBorder&&t.pageBorder!==this.pref.pageBorder&&(this.viewport=null,this.pref.pageBorder=t.pageBorder,this.Iv=!0),"number"==typeof t.zoom&&t.zoom!==this.zoom&&(this.zoom=t.zoom,this.zv=!0),"boolean"==typeof t.fitToScreen&&t.fitToScreen!==this.fitToScreen&&(this.fitToScreen=t.fitToScreen,this.zv=!0),"object"==typeof t.defaultPaperSize&&"number"==typeof t.defaultPaperSize.width&&"number"==typeof t.defaultPaperSize.height&&(this.viewport=null,this.pref.defaultPaperSize=t.defaultPaperSize,this.Iv=!0),this.Zv(t),j.d(!0)}Zv(t){l.b(l.a.CONFIGURATION).forEach(e=>{const n=e(t);this.Iv=n.Iv||this.Iv,this.zv=n.zv||this.zv})}Fv(t){const e=this.currentPage,n=this.Vv,i=t.target;n?n.left!==i&&n.right!==i||this.Qv(t.tv):e===t.target&&this.Qv(t.tv)}Jv(t){const e=[];this.currentPage&&e.push(this.currentPage),this.Vv&&(e.push(this.Vv.left),e.push(this.Vv.right)),e.forEach(e=>{e&&t(e)})}tT(){this.Jv(t=>{t.removeEventListener("hyperlink",this.Ov,!1),t.removeEventListener("replaced",this.Fv,!1)})}eT(){this.tT(),this.Jv(t=>{E.F(t.container,"display","none"),t.container.setAttribute("aria-hidden","true")}),this.currentPage=null,this.Vv=null}nT(t){t.addEventListener("hyperlink",this.Ov,!1),t.addEventListener("replaced",this.Fv,!1),E.F(t.container,"visibility","visible"),E.F(t.container,"display","block"),t.container.setAttribute("aria-hidden","false")}iT(t){this.eT(),this.currentPage=t,t.container.style.marginLeft="",t.container.style.marginRight="",this.nT(t)}sT(t){if(this.eT(),this.Vv=t,t.left&&t.right){let e=parseFloat(t.left.container.style.width),n=parseFloat(t.right.container.style.width);e&&n&&e!==n&&(e<n?t.left.container.style.marginLeft=`${n-e}px`:t.right.container.style.marginRight=`${e-n}px`)}t.left&&(this.nT(t.left),t.right?t.left.container.removeAttribute("data-vivliostyle-unpaired-page"):t.left.container.setAttribute("data-vivliostyle-unpaired-page",!0)),t.right&&(this.nT(t.right),t.left?t.right.container.removeAttribute("data-vivliostyle-unpaired-page"):t.right.container.setAttribute("data-vivliostyle-unpaired-page",!0))}rT(){const t=j.c("reportPosition"),e=this;return b.a(e.jv),e.opf.HS(this.jv.Zi,this.jv.jS).then(n=>{const i=e.currentPage;(e.Xv&&i.fetchers.length>0?Be.c(i.fetchers):j.d(!0)).then(()=>{e.oT(i,n).Mt(t)})}),t.result()}hT(){const t=this.viewportElement;if(this.Hv){const e=this.Hv;return t.style.marginLeft=`${e.marginLeft}px`,t.style.marginRight=`${e.marginRight}px`,t.style.marginTop=`${e.marginTop}px`,t.style.marginBottom=`${e.marginBottom}px`,new vi(this.window,this.fontSize,t,e.width,e.height)}return new vi(this.window,this.fontSize,t)}lT(t){switch(this.pageViewMode){case ls.SINGLE_PAGE:return!1;case ls.SPREAD:return!0;case ls.AUTO_SPREAD:default:return t.width/t.height>=1.45&&t.width>800}}cT(t){this.pref.Ht=t,this.viewportElement.setAttribute(as,t.toString())}aT(){const t=this.hT(),e=this.lT(t),n=this.pref.Ht!==e;return this.cT(e),!(this.Hv||!this.viewport||this.viewport.fontSize!=this.fontSize||(n||t.width!=this.viewport.width||t.height!=this.viewport.height)&&(n||t.width!=this.viewport.width||t.height==this.viewport.height||!/Android|iPhone|iPad|iPod/.test(navigator.userAgent))&&(!this.uT||!this.uT.vv()||this.uT.Sv()||(this.viewport.width=t.width,this.viewport.height=t.height,this.zv=!0,0)))}fT(t,e,n,i){this.Wv[i]=t,this.dT(e,n,i)}dT(t,e,n){if(!this.Pv&&this.Lv){let e="";Object.keys(t).forEach(n=>{e+=`@page ${n}{margin:0;size:`;const i=t[n];e+=`${i.width}px ${i.height}px;}`}),this.Lv.textContent=e,this.Pv=!0}}pT(){this.Lv&&(this.Lv.textContent="",this.Pv=!1)}reset(){let t=!1,e=!1;this.uT&&(t=this.uT.isTOCVisible(),e=this.uT.ZS,this.uT.Jk(),this.uT.kv()),this.pT(),this.viewport=this.hT(),this.viewport.Ly(),this.uT=new rs(this.opf,this.viewport,this.sk,this.pref,this.fT.bind(this)),t&&this._v({a:"toc",v:"show",autohide:e})}Qv(t,e){this.zv=!1,this.tT();const n=this;return this.pref.Ht?this.uT.fv(this.jv,e).Ot(e=>(n.sT(e),n.gT(e),n.currentPage=t,j.d(null))):(this.iT(t),this.mT(t),this.currentPage=t,j.d(null))}mT(t){const e=this.bT(t.dimensions);this.viewport.zoom(t.dimensions.width,t.dimensions.height,e)}gT(t){const e=this.wT(t);this.viewport.zoom(e.width,e.height,this.bT(e))}bT(t){return this.fitToScreen?this.ET(t):this.zoom}wT(t){let e=0,n=0;return t.left&&(e+=t.left.dimensions.width,n=t.left.dimensions.height),t.right&&(e+=t.right.dimensions.width,n=Math.max(n,t.right.dimensions.height)),t.left&&t.right&&(e+=2*this.pref.pageBorder,e+=Math.abs(t.left.dimensions.width-t.right.dimensions.width)),{width:e,height:n}}queryZoomFactor(t){if(!this.currentPage)throw new Error("no page exists.");switch(t){case hs.FIT_INSIDE_VIEWPORT:{let t;return this.pref.Ht?(b.a(this.Vv),t=this.wT(this.Vv)):t=this.currentPage.dimensions,this.ET(t)}default:throw new Error(`unknown zoom type: ${t}`)}}ET(t){const e=this.viewport.width/t.width,n=this.viewport.height/t.height;return Math.min(e,n)}qv(){this.Rv&&this.Rv.interrupt(new us),this.Rv=null}resize(){if(this.Iv=!1,this.zv=!1,this.aT())return j.d(!0);const t=this;this.Yv(o.LOADING),this.qv();const e=j.a().wt().run(()=>j.b("resize",n=>{t.opf?(t.Rv=e,g.registerStartTiming("render (resize)"),t.reset(),t.jv&&(0==t.jv.Hf&&0==t.jv.jS||(t.jv.Hf=-1)),t.opf.BS(t.renderAllPages),t.uT.av(t.jv,!t.renderAllPages).then(i=>{i?(t.jv=i.position,t.Qv(i.page,!0).then(()=>{t.Yv(o.INTERACTIVE),t.opf.US(e=>{const n={t:"nav",epageCount:e,first:t.currentPage.Wi,last:t.currentPage.Yi,metadata:t.opf.metadata,docTitle:t.opf.spine[t.jv.Zi].title};(t.currentPage.Wi||0==t.jv.Hf&&t.opf.spine[t.jv.Zi].epage)&&(n.epage=t.opf.spine[t.jv.Zi].epage),t.callback(n)}).then(()=>{t.rT().then(i=>{(t.renderAllPages?t.uT.renderAllPages():j.d(null)).then(()=>{t.Rv===e&&(t.Rv=null),g.registerEndTiming("render (resize)"),t.renderAllPages&&t.Yv(o.COMPLETE),t.callback({t:"loaded"}),n.finish(i)})})})})):n.finish(!1)})):n.finish(!1)},(t,e)=>{if(!(e instanceof us))throw e;g.registerEndTiming("render (resize)"),h.b.debug(e.message)}));return j.d(!0)}oT(t,e){const n=j.c("sendLocationNotification"),i={t:"nav",first:t.Wi,last:t.Yi,metadata:this.opf.metadata,docTitle:this.opf.spine[t.Zi].title},s=this;return this.opf.WS(s.jv).then(t=>{i.epage=t,i.epageCount=s.opf.epageCount,e&&(i.cfi=e),s.callback(i),n.finish(!0)}),n.result()}getCurrentPageProgression(){return this.uT?this.uT.getCurrentPageProgression(this.jv):null}moveTo(t){let e;const n=this;if(this.readyState!==o.COMPLETE&&"next"!==t.where&&this.Yv(o.LOADING),"string"==typeof t.where){let i;switch(t.where){case"next":i=this.pref.Ht?this.uT.dv:this.uT.nextPage;break;case"previous":i=this.pref.Ht?this.uT.pv:this.uT.previousPage;break;case"last":i=this.uT.lastPage;break;case"first":i=this.uT.firstPage;break;default:return j.d(!0)}i&&(e=(()=>i.call(n.uT,n.jv,!n.renderAllPages)))}else if("number"==typeof t.epage){const i=t.epage;e=(()=>n.uT.gv(i,n.jv,!n.renderAllPages))}else{if("string"!=typeof t.url)return j.d(!0);{const i=t.url;e=(()=>n.uT.bv(i,n.jv,!n.renderAllPages))}}const i=j.c("moveTo");return e.call(n.uT).then(t=>{let e;if(t){n.jv=t.position;const i=j.c("moveTo.showCurrent");e=i.result(),n.Qv(t.page,!n.renderAllPages).then(()=>{n.rT().Mt(i)})}else e=j.d(!0);e.then(t=>{n.readyState===o.LOADING&&n.Yv(o.INTERACTIVE),i.finish(t)})}),i.result()}showTOC(t){const e=!!t.autohide,n=t.v,i=this.uT.isTOCVisible(),s=e!=this.uT.ZS&&"hide"!=n;if(i){if("show"==n&&!s)return j.d(!0)}else if("hide"==n)return j.d(!0);if(i&&"show"!=n)return this.uT.Jk(),j.d(!0);{const t=this,n=j.c("showTOC");return this.uT.showTOC(e).then(i=>{if(i){if(s&&(i.listeners={}),e){const e=()=>{t.uT.Jk()};i.addEventListener("hyperlink",e,!1)}i.addEventListener("hyperlink",t.Ov,!1)}n.finish(!0)}),n.result()}}xT(t){const e=this,n=t.a||"";return j.b("runCommand",i=>{const s=e.actions[n];s?s.call(e,t).then(()=>{e.callback({t:"done",a:n}),i.finish(!0)}):(h.b.error("No such action:",n),i.finish(!0))},(t,e)=>{h.b.error(e,"Error during action:",n),t.finish(!0)})}yT(t){let e=ds(t),n=null;const i=this;j.e(()=>{const t=j.c("commandLoop"),s=j.a().wt();return i.Ov=(t=>{const e=t,n="#"===e.href.charAt(0)||i.Dv.some(t=>e.href.substr(0,t.length)==t);if(n){t.preventDefault();const r={t:"hyperlink",href:e.href,internal:n};s.run(()=>(i.callback(r),j.d(!0)))}}),t.Ut(t=>{if(i.Iv)i.resize().then(()=>{t.Gt()});else if(i.zv)i.currentPage&&i.Qv(i.currentPage).then(()=>{t.Gt()});else if(e){const n=e;e=null,i.xT(n).then(()=>{t.Gt()})}else{const e=j.c("waitForCommand");n=e.suspend(self),e.result().then(()=>{t.Gt()})}}).Mt(t),t.result()}),i.kick=(()=>{const t=n;t&&(n=null,t.schedule(!0))}),i._v=(t=>!e&&(e=ds(t),i.kick(),!0)),this.window.adapt_command=i._v}}(hs||(hs={})).FIT_INSIDE_VIEWPORT="fit inside viewport";class us extends Error{constructor(){super(),this.name="RenderingCanceledError",this.message="Page rendering has been canceled",this.stack=(new Error).stack}}function ds(t){return"string"==typeof t?E.H(t):t}const fs=s;function ps(t){const e={};return Object.keys(t).forEach(n=>{const i=t[n];switch(n){case"autoResize":e.autoresize=i;break;case"pageBorderWidth":e.pageBorder=i;break;default:e[n]=i}}),e}function gs(t){function e(t){return"number"==typeof t?t:null}function n(t){return"string"==typeof t?{url:t,startPage:null,skipPagesBefore:null}:{url:t.url,startPage:e(t.startPage),skipPagesBefore:e(t.skipPagesBefore)}}return Array.isArray(t)?t.map(n):t?[n(t)]:null}var ms;!function(t){t.PREVIOUS="previous",t.NEXT="next",t.LEFT="left",t.RIGHT="right",t.FIRST="first",t.LAST="last",t.EPAGE="epage"}(ms||(ms={}));const bs=ls,Es={Viewer:class{constructor(t,e){var n;this.settings=t,this.initialized=!1,n=t.debug,i=n,this.viewer_=new cs(t.window||window,t.viewportElement,"main",this.dispatcher.bind(this)),this.options={kT:!0,fontSize:16,ST:1,renderAllPages:!0,pageViewMode:bs.AUTO_SPREAD,zoom:1,fitToScreen:!1,defaultPaperSize:void 0},e&&this.setOptions(e),this.vT=new E.c,Object.defineProperty(this,"readyState",{get(){return this.viewer_.readyState}})}setOptions(t){const e=Object.assign({a:"configure"},ps(t));this.viewer_._v(e),Object.assign(this.options,t)}dispatcher(t){const e={type:t.t},n=t;Object.keys(n).forEach(t=>{"t"!==t&&(e[t]=n[t])}),this.vT.dispatchEvent(e)}addListener(t,e){this.vT.addEventListener(t,e,!1)}removeListener(t,e){this.vT.removeEventListener(t,e,!1)}loadDocument(t,e,n){t||this.vT.dispatchEvent({type:"error",content:"No URL specified"}),this.TT(t,null,e,n)}loadPublication(t,e,n){t||this.vT.dispatchEvent({type:"error",content:"No URL specified"}),this.TT(null,t,e,n)}TT(t,e,n,i){const s=n||{};function r(t){return t?t.map(t=>({url:t.url||null,text:t.text||null})):void 0}const o=r(s.authorStyleSheet),a=r(s.userStyleSheet);i&&Object.assign(this.options,i);const l=Object.assign({a:t?"loadXML":"loadPublication",userAgentRootURL:this.settings.userAgentRootURL,url:gs(t)||e,document:s.documentObject,fragment:s.fragment,authorStyleSheet:o,userStyleSheet:a},ps(this.options));this.initialized?this.viewer_._v(l):(this.initialized=!0,this.viewer_.yT(l))}getCurrentPageProgression(){return this.viewer_.getCurrentPageProgression()}NT(t){switch(t){case ms.LEFT:return this.getCurrentPageProgression()===fs.LTR?ms.PREVIOUS:ms.NEXT;case ms.RIGHT:return this.getCurrentPageProgression()===fs.LTR?ms.NEXT:ms.PREVIOUS;default:return t}}navigateToPage(t,e){t===ms.EPAGE?this.viewer_._v({a:"moveTo",epage:e}):this.viewer_._v({a:"moveTo",where:this.NT(t)})}navigateToInternalUrl(t){this.viewer_._v({a:"moveTo",url:t})}isTOCVisible(){return this.viewer_.uT&&this.viewer_.uT.opf&&(this.viewer_.uT.opf.gS||this.viewer_.uT.opf.OS)?!!this.viewer_.uT.isTOCVisible():null}showTOC(t,e){const n=null==t?"toggle":t?"show":"hide";this.viewer_._v({a:"toc",v:n,autohide:e})}queryZoomFactor(t){return this.viewer_.queryZoomFactor(t)}getPageSizes(){return this.viewer_.Wv}},PageViewMode:bs,ZoomType:hs};g.Of("load_vivliostyle"),e.default={constants:a,plugin:l.c,profile:m,viewer:Es}}]).default},"object"==typeof n&&"object"==typeof e?e.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof n?n.vivliostyle=s():i.vivliostyle=s()},{}]},{},[5]);